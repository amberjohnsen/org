(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{1483:function(e,t,n){"use strict";n.r(t);var r=n(20),o=n(417),a=n(25),i=n(12),s=n(430),c=n(1875);t.default=Object(o.connect)(function(e){var t=Object(a.getConfig)(e),n=Object(i.shouldShowTermsOfService)(e);return{diagnosticsEnabled:"true"===t.DiagnosticsEnabled,noAccounts:"true"===t.NoAccounts,diagnosticId:t.DiagnosticId,showTermsOfService:n}},function(e){return{actions:Object(r.bindActionCreators)({loadMeAndConfig:s.b},e)}})(c.a)},1490:function(e,t,n){"use strict";n.d(t,"a",function(){return g});n(88),n(43),n(32),n(33),n(24);var r=n(7),o=n.n(r),a=n(55),i=n(30),s=n.n(i),c=n(130),l=n.n(c);function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t,n){return t&&f(e.prototype,t),n&&f(e,n),e}function m(e,t){return!t||"object"!==u(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var g=function(e){function t(){return p(this,t),m(this,h(t).apply(this,arguments))}return b(t,l.a.Renderer),d(t,[{key:"link",value:function(e,t,n){return"!"===e[0]?'<a href="'.concat(e.substring(1,e.length),'" rel="noreferrer" target="_blank">').concat(n,"</a>"):'<a href="'.concat(e,'">').concat(n,"</a>")}},{key:"paragraph",value:function(e){return e}}]),t}(),v=function(e){function t(){return p(this,t),m(this,h(t).apply(this,arguments))}return b(t,o.a.PureComponent),d(t,[{key:"render",value:function(){var e=this.props.intl.formatMessage({id:this.props.id,defaultMessage:this.props.defaultMessage},this.props.values),t=l()(e,{breaks:!0,sanitize:!0,renderer:new g});return o.a.createElement("span",{dangerouslySetInnerHTML:{__html:t}})}}],[{key:"propTypes",get:function(){return{intl:a.i.isRequired,id:s.a.string.isRequired,defaultMessage:s.a.string.isRequired,values:s.a.object}}}]),t}();t.b=Object(a.h)(v)},1492:function(e,t,n){"use strict";n.d(t,"b",function(){return I}),n.d(t,"c",function(){return x}),n.d(t,"n",function(){return A}),n.d(t,"i",function(){return L}),n.d(t,"j",function(){return D}),n.d(t,"k",function(){return U}),n.d(t,"l",function(){return q}),n.d(t,"m",function(){return H}),n.d(t,"h",function(){return F}),n.d(t,"g",function(){return B}),n.d(t,"d",function(){return V}),n.d(t,"e",function(){return W}),n.d(t,"o",function(){return K}),n.d(t,"a",function(){return z}),n.d(t,"f",function(){return Y});n(106),n(24),n(107),n(74);var r=n(147),o=n(75),a=n(35),i=n(25),s=n(34),c=n(12),l=n(16),u=n(6),p=n(119),f=n(423),d=n(215),m=n(307),h=n(304),b=n(430),y=n(1589),g=n(1590),v=n(1678),E=n(306),_=n(97),O=n(1620),w=n(13),C=n(216),S=n(1734),P=n(0),j=n(1621),T=n(23);function k(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function N(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){k(a,r,o,i,s,"next",e)}function s(e){k(a,r,o,i,s,"throw",e)}i(void 0)})}}var R=w.a.dispatch,M=w.a.getState;function I(e){var t=this;function n(){return(n=N(regeneratorRuntime.mark(function e(t,n,r){var a,i,s,l,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=M(),i=Object(c.getCurrentUserId)(a),s=T.F(t),e.next=5,Object(o.createDirectChannel)(i,s)(R,M);case 5:l=e.sent,(u=l.data)?n(u):r();case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function a(e){var t=M(),n=R(Object(o.getMyChannelMember)(e.id)),a=Object(l.getCurrentChannelId)(t),i=Object(c.getCurrentUserId)(t),p=e.team_id||Object(s.getCurrentTeamId)(t),f=Object(_.c)(t),d=Object(_.k)(t)===P.A.PIN,b=Object(l.getMyChannelMember)(t,e.id);if(n.then(function(){R(Object(o.getChannelStats)(e.id)),R(Object(o.markChannelAsRead)(e.id,a)),R(Object(o.markChannelAsViewed)(e.id,a))}),0===e.delete_at){var y=C.a.getPreviousChannelName(i,p);y!==e.name&&(C.a.setPenultimateChannelName(i,p,y),C.a.setPreviousChannelName(i,p,e.name))}f&&d&&R(Object(h.q)(P.A.PIN,e.id)),Object(m.j)(),R(Object(r.batchActions)([{type:u.ChannelTypes.SELECT_CHANNEL,data:e.id},{type:P.e.SELECT_CHANNEL_WITH_MEMBER,data:e.id,channel:e,member:b||{}}]))}e.fake?function(e,t,r){n.apply(this,arguments)}(e,function(e){a(e)},function(){p.a.push("/"+t.state.currentTeam.name)}):a(e)}function x(){R(Object(h.b)())}function A(){v.a.handleViewAction({type:P.e.TOGGLE_SHORTCUTS_MODAL,value:!0})}function L(e){v.a.handleViewAction({type:P.e.TOGGLE_CHANNEL_NAME_UPDATE_MODAL,value:!0,channel:e})}function D(e){v.a.handleViewAction({type:P.e.TOGGLE_GET_POST_LINK_MODAL,value:!0,post:e})}function U(e){v.a.handleViewAction({type:P.e.TOGGLE_GET_PUBLIC_LINK_MODAL,value:!0,fileId:e})}function q(){v.a.handleViewAction({type:P.i.ActionTypes.TOGGLE_GET_TEAM_INVITE_LINK_MODAL,value:!0})}function H(e){v.a.handleViewAction({type:P.e.TOGGLE_LEAVE_PRIVATE_CHANNEL_MODAL,value:e})}function F(e,t,n){var r=T.D(),o={id:T.r(),user_id:"0",channel_id:t||Object(l.getCurrentChannelId)(M()),message:e,type:P.y.EPHEMERAL,create_at:r,update_at:r,root_id:n,parent_id:n,props:{}};R(Object(f.e)(o))}function B(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",a=arguments.length>5?arguments[5]:void 0,i={id:T.r(),user_id:e.id,channel_id:r||Object(l.getCurrentChannelId)(M()),message:"",type:P.y.EPHEMERAL_ADD_TO_CHANNEL,create_at:a,update_at:a,root_id:o,parent_id:o,props:{username:e.username,addedUsername:t,addedUserId:n}};R(Object(f.e)(i))}var G=0;function V(e,t){return R(function(){var n=N(regeneratorRuntime.mark(function n(r,o){var a,s,c,u,p;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a=o(),s=Object(i.getConfig)(a),c=Date.now(),u=Object(l.getCurrentChannelStats)(a),p=u?u.member_count:0,c-G>s.TimeBetweenUserTypingUpdatesMilliseconds&&p<s.MaxNotificationsPerChannel&&"true"===s.EnableUserTypingMessages&&(S.a.userTyping(e,t),G=c),n.abrupt("return",{data:!0});case 7:case"end":return n.stop()}},n)}));return function(e,t){return n.apply(this,arguments)}}())}function W(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/",t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];(!(arguments.length>2&&void 0!==arguments[2])||arguments[2])&&C.a.setWasLoggedIn(!1),R(Object(a.logout)()).then(function(){t&&O.a.signalLogout(),O.a.clear(),Object(d.e)(),g.a(),Object(b.a)(),p.a.push(e)}).catch(function(){p.a.push(e)})}function K(){return function(e){e(Object(h.b)()),e(Object(y.a)()),e(Object(h.a)())}}function z(e){R({type:P.e.BROWSER_CHANGE_FOCUS,focus:e})}function Y(){return Q.apply(this,arguments)}function Q(){return(Q=N(regeneratorRuntime.mark(function e(){var t,n,r,i,u,f,d,m,h,b,y;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=M(),!T.O(Object(s.getTeamMemberships)(t))){e.next=5;break}return e.next=5,R(Object(a.loadMe)());case 5:if(t=M(),n=Object(c.getCurrentUserId)(t),r=Object(E.a)(t),i=C.a.getPreviousTeamId(n),u=Object(s.getTeam)(t,i),f=Object(s.getMyTeamMember)(t,i),u&&f&&f.team_id||(u=null,(d=Object(s.getMyTeams)(t)).length>0&&(d=Object(j.a)(d,r))&&d[0]&&(u=d[0])),!n||!u){e.next=28;break}if(m=C.a.getPreviousChannelName(n,u.id),!(h=Object(l.getChannelByName)(t,m))||h.team_id!==u.id){e.next=20;break}R(Object(o.selectChannel)(h.id)),m=h.name,e.next=25;break;case 20:return e.next=22,R(Object(o.getChannelByNameAndTeamName)(u.name,m));case 22:b=e.sent,(y=b.data)&&R(Object(o.selectChannel)(y.id));case 25:p.a.push("/".concat(u.name,"/channels/").concat(m)),e.next=29;break;case 28:n&&p.a.push("/select_team");case 29:case"end":return e.stop()}},e)}))).apply(this,arguments)}},1493:function(e,t,n){"use strict";n.d(t,"a",function(){return h});n(88),n(43),n(32),n(33),n(24),n(44);var r=n(30),o=n.n(r),a=n(7),i=n.n(a),s=n(55);function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){m(e,t,n[t])})}return e}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t){return!t||"object"!==c(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=p(this,f(t).call(this,e))).state={},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(t,i.a.Component),n=t,(r=[{key:"render",value:function(){var e=i.a.createElement(s.c,{id:"loading_screen.loading",defaultMessage:"Loading"});return this.props.message&&(e=this.props.message),i.a.createElement("div",{className:"loading-screen",style:l({position:this.props.position},this.props.style)},i.a.createElement("div",{className:"loading__content"},i.a.createElement("h3",null,e),i.a.createElement("div",{className:"round round-1"}),i.a.createElement("div",{className:"round round-2"}),i.a.createElement("div",{className:"round round-3"})))}}])&&u(n.prototype,r),o&&u(n,o),t}();m(h,"propTypes",{position:o.a.oneOf(["absolute","fixed","relative","static","inherit"]),style:o.a.object,message:o.a.node}),m(h,"defaultProps",{position:"relative",style:{}})},1497:function(e,t,n){"use strict";n.d(t,"a",function(){return h});n(88),n(43);var r=n(30),o=n.n(r),a=n(7),i=n.n(a),s=n(1738),c=n(55);function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=p(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==l(o)&&"function"!=typeof o?f(r):o,m(f(n),"handleKeypress",function(e){"Enter"===e.key&&n.props.show&&n.handleConfirm()}),m(f(n),"handleConfirm",function(){var e=!!n.refs.checkbox&&n.refs.checkbox.checked;n.props.onConfirm(e)}),m(f(n),"handleCancel",function(){var e=!!n.refs.checkbox&&n.refs.checkbox.checked;n.props.onCancel(e)}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(t,i.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){this.props.show&&document.addEventListener("keydown",this.handleKeypress)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeypress)}},{key:"shouldComponentUpdate",value:function(e){return e.show!==this.props.show}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.props.show&&!e.show?document.removeEventListener("keydown",this.handleKeypress):!this.props.show&&e.show&&document.addEventListener("keydown",this.handleKeypress)}},{key:"render",value:function(){var e,t,n;return this.props.showCheckbox&&(e=i.a.createElement("div",{className:"checkbox text-right margin-bottom--none"},i.a.createElement("label",null,i.a.createElement("input",{ref:"checkbox",type:"checkbox"}),this.props.checkboxText))),t=this.props.cancelButtonText?this.props.cancelButtonText:i.a.createElement(c.c,{id:"confirm_modal.cancel",defaultMessage:"Cancel"}),this.props.hideCancel||(n=i.a.createElement("button",{type:"button",className:"btn btn-link btn-cancel",onClick:this.handleCancel},t)),i.a.createElement(s.a,{className:"modal-confirm "+this.props.modalClass,dialogClassName:"a11y__modal",show:this.props.show,onHide:this.props.onCancel,onExited:this.props.onExited,id:"confirmModal",role:"dialog","aria-labelledby":"confirmModalLabel"},i.a.createElement(s.a.Header,{closeButton:!1},i.a.createElement(s.a.Title,{componentClass:"h1",id:"confirmModalLabel"},this.props.title)),i.a.createElement(s.a.Body,null,this.props.message,e),i.a.createElement(s.a.Footer,null,n,i.a.createElement("button",{autoFocus:!0,type:"button",className:this.props.confirmButtonClass,onClick:this.handleConfirm,id:"confirmModalButton"},this.props.confirmButtonText)))}}])&&u(n.prototype,r),o&&u(n,o),t}();m(h,"propTypes",{show:o.a.bool.isRequired,title:o.a.node,message:o.a.node,confirmButtonClass:o.a.string,modalClass:o.a.string,confirmButtonText:o.a.node,cancelButtonText:o.a.node,showCheckbox:o.a.bool,checkboxText:o.a.node,onConfirm:o.a.func.isRequired,onCancel:o.a.func.isRequired,onExited:o.a.func,hideCancel:o.a.bool}),m(h,"defaultProps",{title:"",message:"",confirmButtonClass:"btn btn-primary",confirmButtonText:"",modalClass:""})},1498:function(e,t,n){"use strict";n.d(t,"a",function(){return h});n(88),n(43),n(32),n(33),n(24),n(44),n(209);var r=n(30),o=n.n(r),a=n(7),i=n.n(a),s=n(55);function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=p(t).call(this,e),n=!o||"object"!==c(o)&&"function"!=typeof o?f(r):o,m(f(n),"focus",function(){n.input.current.focus()}),n.input=i.a.createRef(),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(t,i.a.Component),n=t,(r=[{key:"shouldComponentUpdate",value:function(e){return e.value!==this.props.value||e.placeholder.id!==this.props.placeholder.id||e.placeholder.defaultMessage!==this.props.placeholder.defaultMessage}},{key:"render",value:function(){var e=this.context.intl.formatMessage,t=this.props,n=t.placeholder,r=l(t,["placeholder"]),o=e(n);return i.a.createElement("input",Object.assign({ref:this.input},r,{placeholder:o}))}},{key:"value",get:function(){return this.input.current.value},set:function(e){this.input.current.value=e}}])&&u(n.prototype,r),o&&u(n,o),t}();m(h,"propTypes",{placeholder:o.a.shape({id:o.a.string.isRequired,defaultMessage:o.a.string.isRequired}).isRequired,value:o.a.string}),m(h,"contextTypes",{intl:s.i.isRequired})},1500:function(e,t,n){"use strict";n.d(t,"a",function(){return f});n(88),n(43),n(32);var r=n(30),o=n.n(r),a=n(7),i=n.n(a);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),l(this,u(t).apply(this,arguments))}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(t,i.a.Component),n=t,a=[{key:"propTypes",get:function(){return{type:o.a.node,error:o.a.node,textClassName:o.a.string,iconClassName:o.a.string,margin:o.a.bool,errors:o.a.arrayOf(o.a.node)}}},{key:"defaultProps",get:function(){return{error:null,errors:[]}}}],(r=[{key:"render",value:function(){if(!this.props.error&&0===this.props.errors.length)return null;var e=this.props.error;if(!e){var t=!0,n=!1,r=void 0;try{for(var o,a=this.props.errors[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var s=o.value;s&&(e=s)}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}}return e?"modal"===this.props.type?i.a.createElement("div",{className:"form-group"},i.a.createElement("label",{className:"col-sm-12 has-error"},e)):"backstage"===this.props.type?i.a.createElement("div",{className:"pull-left has-error"},i.a.createElement("label",{className:"control-label"},e)):this.props.margin?i.a.createElement("div",{className:"form-group has-error"},i.a.createElement("label",{className:"control-label"},e)):i.a.createElement("div",{className:"col-sm-12 ".concat(this.props.textClassName||"has-error")},i.a.createElement("label",{className:"control-label"},i.a.createElement("i",{className:"fa ".concat(this.props.iconClassName||"fa-exclamation-circle")})," ",e)):null}}])&&c(n.prototype,r),a&&c(n,a),t}()},1501:function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"a",function(){return a});var r=n(0);function o(e){return function(t){t({type:r.e.MODAL_OPEN,modalId:e.modalId,dialogProps:e.dialogProps,dialogType:e.dialogType})}}function a(e){return function(t){t({type:r.e.MODAL_CLOSE,modalId:e})}}},1505:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var r=n(7),o=n.n(r),a=n(30),i=n.n(a),s=n(55),c=n(1676);function l(e){return o.a.createElement(c.a,{className:"BotBadge "+e.className,show:e.show},o.a.createElement(s.c,{id:"post_info.bot",defaultMessage:"BOT"}))}l.propTypes={className:i.a.string,show:i.a.bool},l.defaultProps={show:!0,className:""}},1506:function(e,t,n){"use strict";n.d(t,"a",function(){return y});n(88),n(43);var r=n(30),o=n.n(r),a=n(7),i=n.n(a),s=n(55),c=n(1520),l=n(0),u=n(23);function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var y=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=d(t).call(this,e),n=!o||"object"!==p(o)&&"function"!=typeof o?m(r):o,b(m(n),"onKeyDown",function(e){n.props.shiftEnter&&e.keyCode===l.Q.KeyCodes.ENTER&&e.shiftKey||Object(u.S)(e,l.Q.KeyCodes.ENTER)&&n.props.submit&&"SELECT"!==e.target.tagName&&e.target.parentElement&&"react-select__input"!==e.target.parentElement.className&&!e.target.classList.contains("btn-cancel")&&n.handleSubmit(e)}),b(m(n),"handleSubmit",function(e){e.preventDefault(),n.props.setting?n.props.submit(n.props.setting):n.props.submit()}),b(m(n),"handleUpdateSection",function(e){n.props.updateSection(n.props.section),e.preventDefault()}),n.settingList=i.a.createRef(),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(t,i.a.PureComponent),n=t,(r=[{key:"componentDidMount",value:function(){if(this.settingList.current){var e=this.settingList.current.querySelectorAll('.btn:not(.save-button):not(.btn-cancel), input.form-control, select, textarea, [tabindex]:not([tabindex="-1"])');e.length>0?e[0].focus():this.settingList.current.focus()}document.addEventListener("keydown",this.onKeyDown)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.onKeyDown)}},{key:"render",value:function(){var e=null;this.props.clientError&&(e=i.a.createElement("div",{className:"form-group"},i.a.createElement("label",{id:"clientError",className:"col-sm-12 has-error"},this.props.clientError)));var t=null;this.props.serverError&&(t=i.a.createElement("div",{className:"form-group"},i.a.createElement("label",{id:"serverError",className:"col-sm-12 has-error"},this.props.serverError)));var n=null,r="setting-list__hint";"top"===this.props.infoPosition&&(r="padding-bottom x2"),this.props.extraInfo&&(n=i.a.createElement("div",{className:r},this.props.extraInfo));var o="";this.props.submit&&(o=i.a.createElement(c.a,{defaultMessage:this.props.saveButtonText,saving:this.props.saving,disabled:this.props.saving,onClick:this.handleSubmit}));var a,l,u=this.props.inputs;a="full"===this.props.width?"col-sm-12":"medium"===this.props.width?"col-sm-10 col-sm-offset-2":"col-sm-9 col-sm-offset-3",this.props.title&&(l=i.a.createElement("li",{id:"settingTitle",className:"col-sm-12 section-title"},this.props.title));var p,f=i.a.createElement("li",{className:"setting-list-item",role:"presentation"},u,n);return"top"===this.props.infoPosition&&(f=i.a.createElement("li",{role:"presentation"},n,u)),p=this.props.cancelButtonText?this.props.cancelButtonText:i.a.createElement(s.c,{id:"setting_item_max.cancel",defaultMessage:"Cancel"}),i.a.createElement("ul",{className:"section-max form-horizontal ".concat(this.props.containerStyle)},l,i.a.createElement("li",{className:a},i.a.createElement("ul",{tabIndex:"-1",ref:this.settingList,role:"presentation",className:"setting-list"},f,i.a.createElement("li",{className:"setting-list-item"},i.a.createElement("hr",null),this.props.submitExtra,t,e,o,i.a.createElement("button",{id:"cancelSetting",className:"btn btn-sm btn-cancel cursor--pointer style--none",onClick:this.handleUpdateSection},p)))))}}])&&f(n.prototype,r),o&&f(n,o),t}();b(y,"defaultProps",{infoPosition:"bottom",saving:!1,section:"",containerStyle:""}),b(y,"propTypes",{inputs:o.a.node,containerStyle:o.a.string,clientError:o.a.oneOfType([o.a.string,o.a.object]),serverError:o.a.string,extraInfo:o.a.element,infoPosition:o.a.string,section:o.a.string,updateSection:o.a.func,setting:o.a.string,submit:o.a.func,submitExtra:o.a.node,saving:o.a.bool,title:o.a.node,width:o.a.string,cancelButtonText:o.a.node,shiftEnter:o.a.bool,saveButtonText:o.a.string})},1510:function(e,t,n){"use strict";n(106),n(24),n(74),n(107);var r=n(147),o=n(75),a=n(65),i=n(35),s=n(14),c=n(16),l=n(34),u=n(12),p=n(36),f=n(186),d=n(425),m=n.n(d),h=n(1523),b=n(1660),y=function(e,t){return e.views.channel.lastGetPosts[t]},g=function(e){return e.websocket},v=n(119),E=n(0),_=n(23),O=n(216);function w(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function C(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){w(a,r,o,i,s,"next",e)}function s(e){w(a,r,o,i,s,"throw",e)}i(void 0)})}}function S(){return function(e){e({type:E.e.UPDATE_MOBILE_VIEW,data:Object(_.U)()})}}function P(){return function(){var e=C(regeneratorRuntime.mark(function e(t,n){var r,o,a,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=n(),o=Object(c.getCurrentChannel)(r),a=Object(c.getChannelsNameMapInCurrentTeam)(r),i=Object(f.getChannelByName)(a,Object(b.a)(r)),o.id===i.id&&(i=Object(f.getChannelByName)(a,Object(c.getRedirectChannelNameForTeam)(r,Object(l.getCurrentTeamId)(r)))),e.abrupt("return",t(T(i)));case 6:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()}function j(e){return function(){var t=C(regeneratorRuntime.mark(function t(n,r){var o,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=r(),a=Object(c.getChannel)(o,e),t.abrupt("return",n(T(a)));case 3:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()}function T(e){return function(){var t=C(regeneratorRuntime.mark(function t(n,r){var o,a,i,s,p;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(o=r(),a=Object(l.getCurrentRelativeTeamUrl)(o),!e.fake&&!e.userId){t.next=15;break}if(i=e.userId?e.name:e.display_name,s=Object(u.getUserByUsername)(o,i)){t.next=7;break}return t.abrupt("return",{error:!0});case 7:return t.next=9,n(Object(h.e)(s.id));case 9:if(!t.sent.error){t.next=12;break}return t.abrupt("return",{error:!0});case 12:v.a.push("".concat(a,"/messages/@").concat(e.name)),t.next=16;break;case 15:e.type===E.i.GM_CHANNEL?(p=Object(c.getChannel)(o,e.id),v.a.push("".concat(a,"/channels/").concat(p.name))):v.a.push("".concat(a,"/channels/").concat(e.name));case 16:return t.abrupt("return",{data:!0});case 17:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()}function k(e){return function(){var t=C(regeneratorRuntime.mark(function t(n,r){var a,i,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=r(),i=Object(u.getCurrentUserId)(a),s=Object(l.getCurrentTeamId)(a),t.abrupt("return",n(Object(o.joinChannel)(i,s,e)));case 4:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()}function N(e){return function(){var t=C(regeneratorRuntime.mark(function t(n,r){var a,i,s,c,d,m,h;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=r(),i=Object(p.getMyPreferences)(a),s=Object(u.getCurrentUserId)(a),c=Object(l.getCurrentTeamId)(a),Object(f.isFavoriteChannel)(i,e)&&n(Object(o.unfavoriteChannel)(e)),d=Object(l.getCurrentRelativeTeamUrl)(a),O.a.removePreviousChannelName(s,c),v.a.push(d),t.next=10,n(Object(o.leaveChannel)(e));case 10:if(m=t.sent,!(h=m.error)){t.next=14;break}return t.abrupt("return",{error:h});case 14:return t.abrupt("return",{data:!0});case 15:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()}function R(e,t){return function(){var n=C(regeneratorRuntime.mark(function n(r,o){var a,s;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a=o(),s=Object(l.getCurrentTeamId)(a),n.abrupt("return",r(Object(i.autocompleteUsers)(e,s,t)));case 3:case"end":return n.stop()}},n)}));return function(e,t){return n.apply(this,arguments)}}()}function M(e){return function(){var t=C(regeneratorRuntime.mark(function t(n){var r,o,i,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=Date.now(),t.next=3,n(a.getPostsUnread(e));case 3:if(o=t.sent,i=o.data,!(s=o.error)){t.next=8;break}return t.abrupt("return",{error:s,atLatestMessage:!1,atOldestmessage:!1});case 8:return n({type:E.e.INCREASE_POST_VISIBILITY,data:e,amount:i.order.length}),""===i.next_post_id&&n({type:E.e.RECEIVED_POSTS_FOR_CHANNEL_AT_TIME,channelId:e,time:r}),t.abrupt("return",{atLatestMessage:""===i.next_post_id,atOldestmessage:""===i.prev_post_id});case 11:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}function I(e,t){return function(){var n=C(regeneratorRuntime.mark(function n(r){var o,i,c;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r(a.getPostsAround(e,t,s.Posts.POST_CHUNK_SIZE/2));case 2:if(o=n.sent,i=o.data,!(c=o.error)){n.next=7;break}return n.abrupt("return",{error:c,atLatestMessage:!1,atOldestmessage:!1});case 7:return r({type:E.e.INCREASE_POST_VISIBILITY,data:e,amount:i.order.length}),n.abrupt("return",{atLatestMessage:""===i.next_post_id,atOldestmessage:""===i.prev_post_id});case 9:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()}function x(e){return function(){var t=C(regeneratorRuntime.mark(function t(n){var r,o,i,c;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=Date.now(),t.next=3,n(a.getPosts(e,0,s.Posts.POST_CHUNK_SIZE/2));case 3:if(o=t.sent,i=o.data,!(c=o.error)){t.next=8;break}return t.abrupt("return",{error:c,atLatestMessage:!1,atOldestmessage:!1});case 8:return n({type:E.e.RECEIVED_POSTS_FOR_CHANNEL_AT_TIME,channelId:e,time:r}),t.abrupt("return",{data:i,atLatestMessage:""===i.next_post_id,atOldestmessage:""===i.prev_post_id});case 10:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}function A(e){var t=e.channelId,n=e.postId,o=e.type;return function(){var e=C(regeneratorRuntime.mark(function e(i){var s,c,l,u,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s=E.i.POST_CHUNK_SIZE/2,i({type:E.e.LOADING_POSTS,data:!0,channelId:t}),c=0,o!==E.x.BEFORE_ID){e.next=9;break}return e.next=6,i(a.getPostsBefore(t,n,c,s));case 6:l=e.sent,e.next=12;break;case 9:return e.next=11,i(a.getPostsAfter(t,n,c,s));case 11:l=e.sent;case 12:if(u=l.data,p=[{type:E.e.LOADING_POSTS,data:!1,channelId:t}],!l.error){e.next=16;break}return e.abrupt("return",{error:l.error,moreToLoad:!0});case 16:return p.push({type:E.e.INCREASE_POST_VISIBILITY,data:t,amount:u.order.length}),i(Object(r.batchActions)(p)),e.abrupt("return",{moreToLoad:o===E.x.BEFORE_ID?""!==u.prev_post_id:""!==u.next_post_id});case 19:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}function L(e,t){return function(){var n=C(regeneratorRuntime.mark(function n(r,o){var i,s,c,l,u,p,f,d;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return i=Date.now(),s=o(),c=g(s),l=t,(u=y(s,e))&&u<c.lastDisconnectAt&&(l=u),n.next=8,r(a.getPostsSince(e,l));case 8:return p=n.sent,f=p.data,d=p.error,f&&r({type:E.e.RECEIVED_POSTS_FOR_CHANNEL_AT_TIME,channelId:e,time:i}),n.abrupt("return",{data:f,error:d});case 13:case"end":return n.stop()}},n)}));return function(e,t){return n.apply(this,arguments)}}()}function D(){return function(){m.a.emit(E.l.POST_LIST_SCROLL_CHANGE,!0)}}function U(){return function(){m.a.emit(E.l.POST_LIST_SCROLL_CHANGE,!1)}}n.d(t,"b",function(){return S}),n.d(t,"c",function(){return P}),n.d(t,"m",function(){return j}),n.d(t,"l",function(){return T}),n.d(t,"d",function(){return k}),n.d(t,"e",function(){return N}),n.d(t,"a",function(){return R}),n.d(t,"i",function(){return M}),n.d(t,"h",function(){return I}),n.d(t,"f",function(){return x}),n.d(t,"g",function(){return A}),n.d(t,"n",function(){return L}),n.d(t,"k",function(){return D}),n.d(t,"j",function(){return U})},1514:function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.d(t,"a",function(){return o});var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.latestPrefix="",this.latestComplete=!0,this.disableDispatches=!1,this.requestStarted=!1}var t,n,o;return t=e,(n=[{key:"handlePretextChanged",value:function(e){}},{key:"resetRequest",value:function(){this.requestStarted=!1}},{key:"startNewRequest",value:function(e){this.latestPrefix=e,this.latestComplete=!1,this.requestStarted=!0}},{key:"shouldCancelDispatch",value:function(e){if(this.disableDispatches)return!0;if(!this.requestStarted)return!0;if(e===this.latestPrefix)this.latestComplete=!0;else if(this.latestComplete)return!0;return!1}},{key:"allowDividers",value:function(){return!0}},{key:"presentationType",value:function(){return"text"}}])&&r(t.prototype,n),o&&r(t,o),e}()},1515:function(e,t,n){"use strict";n.d(t,"a",function(){return b});n(88),n(43);var r=n(30),o=n.n(r),a=n(7),i=n.n(a);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),e}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var d,m,h,b=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=c(t).call(this,e))||"object"!==s(o)&&"function"!=typeof o?l(r):o).handleClick=n.handleClick.bind(l(n)),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(t,i.a.Component),p(t,null,[{key:"propTypes",get:function(){return{item:o.a.oneOfType([o.a.object,o.a.string]).isRequired,term:o.a.string.isRequired,matchedPretext:o.a.string.isRequired,isSelection:o.a.bool,onClick:o.a.func}}}]),p(t,[{key:"handleClick",value:function(e){e.preventDefault(),this.props.onClick(this.props.term,this.props.matchedPretext)}}]),t}();h={role:"button",tabIndex:-1},(m="baseProps")in(d=b)?Object.defineProperty(d,m,{value:h,enumerable:!0,configurable:!0,writable:!0}):d[m]=h},1516:function(e,t,n){"use strict";var r=n(7),o=n.n(r),a=n(30),i=n.n(a),s=n(1597),c=function(e){var t=e.onClick,n=e.ariaLabel,r=e.text,a=e.extraText,i=e.id;return o.a.createElement("button",{id:i,"aria-label":n,className:"style--none"+(a?" MenuItem__help":""),onClick:t},r,a&&o.a.createElement("span",{className:"extra-text"},a))};c.propTypes={onClick:i.a.func.isRequired,ariaLabel:i.a.string,text:i.a.oneOfType([i.a.string,i.a.node]).isRequired,extraText:i.a.string,id:i.a.string};var l=Object(s.a)(c);l.displayName="MenuItemAction",t.a=l},1517:function(e,t,n){"use strict";n.d(t,"a",function(){return b});n(88),n(43);var r=n(30),o=n.n(r),a=n(7),i=n.n(a),s=n(55),c=n(23),l=n(1788);function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var b=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=f(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==u(o)&&"function"!=typeof o?d(r):o,h(d(n),"getEdit",function(e){n.edit=e}),h(d(n),"handleUpdateSection",function(e){e.preventDefault(),n.props.updateSection(n.props.section)}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(t,i.a.PureComponent),n=t,(r=[{key:"componentDidMount",value:function(){this.props.focused&&this.edit&&this.edit.focus()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.focused&&this.edit&&this.edit.focus()}},{key:"render",value:function(){var e=null,t=null;return!this.props.disableOpen&&Object(c.U)()?e=i.a.createElement("div",{className:"section-min__edit"},i.a.createElement("button",{id:this.props.section+"Edit",className:"color--link cursor--pointer style--none",onClick:this.handleUpdateSection,ref:this.getEdit,"aria-labelledby":this.props.section+"Title "+this.props.section+"Edit"},i.a.createElement(l.a,null),this.props.describe)):this.props.disableOpen||(e=i.a.createElement("div",{className:"section-min__edit"},i.a.createElement("button",{id:this.props.section+"Edit",className:"color--link cursor--pointer style--none text-left",onClick:this.handleUpdateSection,ref:this.getEdit,"aria-labelledby":this.props.section+"Title "+this.props.section+"Edit"},i.a.createElement(l.a,null),i.a.createElement(s.c,{id:"setting_item_min.edit",defaultMessage:"Edit"}))),t=i.a.createElement("div",{id:this.props.section+"Desc",className:"section-min__describe"},this.props.describe)),i.a.createElement("div",{className:"section-min",onClick:this.handleUpdateSection},i.a.createElement("div",{className:"d-flex"},i.a.createElement("div",{id:this.props.section+"Title",className:"section-min__title"},this.props.title),e),t)}}])&&p(n.prototype,r),o&&p(n,o),t}();h(b,"defaultProps",{section:"",focused:!1}),h(b,"propTypes",{title:o.a.node,disableOpen:o.a.bool,focused:o.a.bool,section:o.a.string,updateSection:o.a.func,describe:o.a.node})},1520:function(e,t,n){"use strict";n.d(t,"a",function(){return b});n(88),n(43),n(32),n(33),n(24),n(44),n(209);var r=n(30),o=n.n(r),a=n(7),i=n.n(a),s=n(55),c=n(1525);function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var b=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),f(this,d(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(t,i.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e=this.context.intl.formatMessage,t=this.props,n=t.saving,r=t.disabled,o=t.savingMessage,a=t.defaultMessage,s=t.btnClass,l=t.extraClasses,p=u(t,["saving","disabled","savingMessage","defaultMessage","btnClass","extraClasses"]),f="save-button btn";r&&!n||(f+=" "+s),l&&(f+=" "+l);var d=o||e({id:"save_button.saving",defaultMessage:"Saving"}),m=a||e({id:"save_button.save",defaultMessage:"Save"});return i.a.createElement("button",Object.assign({type:"submit",id:"saveSetting",className:f,disabled:r},p),i.a.createElement(c.a,{loading:n,text:d},i.a.createElement("span",null,m)))}}])&&p(n.prototype,r),o&&p(n,o),t}();h(b,"propTypes",{saving:o.a.bool.isRequired,disabled:o.a.bool,savingMessage:o.a.node,defaultMessage:o.a.node,btnClass:o.a.string,extraClasses:o.a.string}),h(b,"defaultProps",{disabled:!1,btnClass:"btn-primary",extraClasses:""}),h(b,"contextTypes",{intl:s.i})},1523:function(e,t,n){"use strict";n.d(t,"e",function(){return w}),n.d(t,"f",function(){return C}),n.d(t,"d",function(){return S}),n.d(t,"g",function(){return P}),n.d(t,"b",function(){return j}),n.d(t,"c",function(){return k}),n.d(t,"a",function(){return R});n(44),n(106),n(33),n(108),n(88),n(43),n(32),n(155),n(24),n(107);var r=n(147),o=n(6),a=n(75),i=n(132),s=n(212),c=n(16),l=n(34),u=n(12),p=n(421),f=n(307),d=n(13),m=n(119),h=n(0),b=n(23);function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){g(e,t,n[t])})}return e}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function E(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){v(a,r,o,i,s,"next",e)}function s(e){v(a,r,o,i,s,"throw",e)}i(void 0)})}}var _=d.a.dispatch,O=d.a.getState;function w(e){return function(){var t=E(regeneratorRuntime.mark(function t(n,s){var l,f,d,m,g,v,E,_;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(l=s(),f=Object(u.getCurrentUserId)(l),d=Object(b.t)(f,e),m=Object(c.getChannelByName)(l,d)){t.next=6;break}return t.abrupt("return",n(a.createDirectChannel(f,e)));case 6:return Object(p.d)("api","api_channels_join_direct"),g=Date.now(),v={category:h.z.CATEGORY_DIRECT_CHANNEL_SHOW,name:e,value:"true"},E={category:h.z.CATEGORY_CHANNEL_OPEN_TIME,name:m.id,value:g.toString()},_=[{type:o.PreferenceTypes.RECEIVED_PREFERENCES,data:[v]},{type:o.PreferenceTypes.RECEIVED_PREFERENCES,data:[E]}],n(Object(r.batchActions)(_)),n(Object(i.savePreferences)(f,[y({user_id:f},v),y({user_id:f},E)])),t.abrupt("return",{data:m});case 14:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()}function C(e){return function(){var t=E(regeneratorRuntime.mark(function t(n,r){var o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n(a.createGroupChannel(e));case 2:return(o=t.sent).error&&m.a.push(Object(l.getCurrentTeamUrl)(r())),t.abrupt("return",o);case 5:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()}function S(){return function(){var e=E(regeneratorRuntime.mark(function e(t,n){var r,o,i,s,u,p,d,m,b;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=n(),o=Object(c.getUnreadChannelIds)(r),e.next=4,t(a.fetchMyChannelsAndMembers(Object(l.getCurrentTeamId)(r)));case 4:for(i=!0,s=!1,u=void 0,e.prev=7,p=o[Symbol.iterator]();!(i=(d=p.next()).done);i=!0)m=d.value,(b=Object(c.getChannel)(r,m))&&b.type===h.i.DM_CHANNEL?Object(f.d)(b.id):b&&b.type===h.i.GM_CHANNEL&&Object(f.e)(b.id);e.next=15;break;case 11:e.prev=11,e.t0=e.catch(7),s=!0,u=e.t0;case 15:e.prev=15,e.prev=16,i||null==p.return||p.return();case 18:if(e.prev=18,!s){e.next=21;break}throw u;case 21:return e.finish(18);case 22:return e.finish(15);case 23:Object(f.j)();case 24:case"end":return e.stop()}},e,null,[[7,11,15,23],[16,,18,22]])}));return function(t,n){return e.apply(this,arguments)}}()}function P(e){return function(){var t=E(regeneratorRuntime.mark(function t(n,r){var o,i,c,u,p,f,d;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(o=r(),i=Object(l.getCurrentTeamId)(o)){t.next=4;break}throw new Error("No team id");case 4:return t.next=6,n(a.searchChannels(i,e));case 6:if(c=t.sent,u=c.data,p=c.error,!u){t.next=13;break}return f=Object(s.getMyChannelMemberships)(o),d=u.filter(function(e){return!f[e.id]}),t.abrupt("return",{data:d});case 13:return t.abrupt("return",{error:p});case 14:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()}function j(e,t,n){return T.apply(this,arguments)}function T(){return(T=E(regeneratorRuntime.mark(function e(t,n,r){var o,i,s,c,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=O(),i=Object(l.getCurrentTeamId)(o)){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,a.autocompleteChannels(i,t)(_,O);case 6:s=e.sent,c=s.data,u=s.error,c&&n?n(c):u&&r&&r(y({id:u.server_error_id},u));case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}function k(e,t,n){return N.apply(this,arguments)}function N(){return(N=E(regeneratorRuntime.mark(function e(t,n,r){var o,i,s,c,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=O(),i=Object(l.getCurrentTeamId)(o)){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,a.autocompleteChannelsForSearch(i,t)(_,O);case 6:s=e.sent,c=s.data,u=s.error,c&&n?n(c):u&&r&&r(y({id:u.server_error_id},u));case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}function R(e,t){return function(){var n=E(regeneratorRuntime.mark(function n(r){var o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,o=t.map(function(t){return r(a.addChannelMember(e,t))}),n.next=4,Promise.all(o);case 4:return n.abrupt("return",n.sent);case 7:return n.prev=7,n.t0=n.catch(0),n.abrupt("return",{error:n.t0});case 10:case"end":return n.stop()}},n,null,[[0,7]])}));return function(e){return n.apply(this,arguments)}}()}},1525:function(e,t,n){"use strict";n.d(t,"a",function(){return m});n(88),n(43);var r=n(30),o=n.n(r),a=n(7),i=n.n(a),s=n(1538);function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return!t||"object"!==c(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var m=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),u(this,p(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(t,i.a.Component),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.text,n=e.loading,r=e.children;return n?i.a.createElement(s.a,{text:t}):r}}])&&l(n.prototype,r),o&&l(n,o),t}();d(m,"propTypes",{loading:o.a.bool.isRequired,text:o.a.node,children:o.a.node}),d(m,"defaultProps",{loading:!0,text:null,children:null})},1528:function(e,t,n){"use strict";n.d(t,"a",function(){return b});n(88),n(43);var r=n(30),o=n.n(r),a=n(7),i=n.n(a),s=n(23);function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return!t||"object"!==c(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var d,m,h,b=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=u(this,p(t).call(this,e))).node=i.a.createRef(),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(t,i.a.PureComponent),n=t,(r=[{key:"rect",value:function(){return this.node&&this.node.current?this.node.current.getBoundingClientRect():null}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.openUp,r=e.openLeft,o=e.id,a=e.ariaLabel,c=e.customStyles,l={};return c?l=c:(r&&!Object(s.U)()&&(l.left="inherit",l.right=0),n&&!Object(s.U)()&&(l.bottom="100%",l.top="auto")),i.a.createElement("ul",{id:o,className:"a11y__popup Menu dropdown-menu",ref:this.node,style:l,role:"menu","aria-label":a},t)}}])&&l(n.prototype,r),o&&l(n,o),t}();d=b,m="propTypes",h={children:o.a.node,openLeft:o.a.bool,openUp:o.a.bool,id:o.a.string,ariaLabel:o.a.string.isRequired,customStyles:o.a.object},m in d?Object.defineProperty(d,m,{value:h,enumerable:!0,configurable:!0,writable:!0}):d[m]=h},1530:function(e,t,n){"use strict";n(209);var r=n(417),o=n(121),a=n(14),i=n(16),s=n(25),c=n(36),l=n(34),u=n(12),p=n(302),f=(n(88),n(43),n(30)),d=n.n(f),m=n(7),h=n.n(m),b=n(1653),y=n(87);function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function E(e,t){return!t||"object"!==g(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function O(e,t){return(O=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var C=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),E(this,_(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&O(e,t)}(t,h.a.PureComponent),n=t,(r=[{key:"render",value:function(){if(!this.props.enableFormatting)return h.a.createElement("span",null,this.props.message);var e=Object.assign({autolinkedUrlSchemes:this.props.autolinkedUrlSchemes,siteURL:this.props.siteURL,mentionKeys:this.props.mentionKeys,atMentions:!0,channelNamesMap:this.props.channelNamesMap,proxyImages:this.props.hasImageProxy&&this.props.proxyImages,team:this.props.team,minimumHashtagLength:this.props.minimumHashtagLength},this.props.options),t=y.e(this.props.message,e);return Object(b.a)(t,this.props.isRHS,{imageProps:this.props.imageProps,imagesMetadata:this.props.imagesMetadata,hasPluginTooltips:this.props.hasPluginTooltips})}}])&&v(n.prototype,r),o&&v(n,o),t}();w(C,"propTypes",{channelNamesMap:d.a.object.isRequired,autolinkedUrlSchemes:d.a.array,enableFormatting:d.a.bool.isRequired,isRHS:d.a.bool,mentionKeys:d.a.arrayOf(d.a.object).isRequired,message:d.a.string.isRequired,options:d.a.object,siteURL:d.a.string.isRequired,team:d.a.object.isRequired,hasImageProxy:d.a.bool.isRequired,minimumHashtagLength:d.a.number,proxyImages:d.a.bool,imageProps:d.a.object,imagesMetadata:d.a.object,hasPluginTooltips:d.a.bool}),w(C,"defaultProps",{options:{},isRHS:!1,proxyImages:!0,imagesMetadata:{}});t.a=Object(r.connect)(function(){var e=Object(o.a)(i.getChannelsNameMapInCurrentTeam,function(e,t){return t&&t.channelNamesMap},function(e,t){return t?Object.assign({},t,e):e});return function(t,n){var r=Object(s.getConfig)(t);return{autolinkedUrlSchemes:Object(s.getAutolinkedUrlSchemes)(t),channelNamesMap:e(t,n),enableFormatting:Object(c.getBool)(t,a.Preferences.CATEGORY_ADVANCED_SETTINGS,"formatting",!0),mentionKeys:Object(u.getCurrentUserMentionKeys)(t),siteURL:Object(p.e)(),team:Object(l.getCurrentTeam)(t),hasImageProxy:"true"===r.HasImageProxy,minimumHashtagLength:parseInt(r.MinimumHashtagLength,10)}}})(C)},1531:function(e,t,n){"use strict";n(88),n(43);var r=n(30),o=n.n(r),a=n(7),i=n.n(a),s=n(0),c=n(2355),l=n(2381),u=n(23);function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var y=80,g=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,n=!(o=(e=d(t)).call.apply(e,[this].concat(i)))||"object"!==p(o)&&"function"!=typeof o?m(r):o,b(m(n),"onEntering",function(e){var t=Object(c.a)(e);Object(c.b)({from:{opacity:0},to:{opacity:1},duration:y}).start(t.set)}),b(m(n),"onExiting",function(e){var t=Object(c.a)(e);Object(c.b)({from:{opacity:1},to:{opacity:0},duration:y}).start(t.set)}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(t,i.a.PureComponent),n=t,(r=[{key:"render",value:function(){return i.a.createElement(l.a,{in:this.props.show,classNames:"MenuWrapperAnimation",enter:!0,exit:!0,mountOnEnter:!0,unmountOnExit:!0,onEntering:!Object(u.U)()&&this.onEntering,onExiting:!Object(u.U)()&&this.onExiting,timeout:{enter:y,exit:y}},this.props.children)}}])&&f(n.prototype,r),o&&f(n,o),t}();function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function E(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function O(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function w(e,t){return(w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function C(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}b(g,"propTypes",{children:o.a.node,show:o.a.bool.isRequired}),n.d(t,"a",function(){return S});var S=function(e){function t(e){var n,r,o;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),!Array.isArray(e.children)||2!==e.children.length)throw new Error("MenuWrapper needs exactly 2 children");return r=this,o=_(t).call(this,e),n=!o||"object"!==v(o)&&"function"!=typeof o?O(r):o,C(O(n),"keyboardClose",function(e){e.key===s.Q.KeyCodes.ESCAPE[0]&&n.close(),e.key===s.Q.KeyCodes.TAB[0]&&n.closeOnBlur(e)}),C(O(n),"closeOnBlur",function(e){n.node.current&&n.node.current.contains(e.target)||n.close()}),C(O(n),"close",function(){n.state.open&&(n.setState({open:!1}),n.props.onToggle&&n.props.onToggle(!1))}),C(O(n),"toggle",function(){var e=!n.state.open;n.setState({open:e}),n.props.onToggle&&n.props.onToggle(e)}),n.state={open:!1},n.node=i.a.createRef(),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w(e,t)}(t,i.a.PureComponent),n=t,(r=[{key:"componentDidMount",value:function(){document.addEventListener("click",this.closeOnBlur,!0),document.addEventListener("keyup",this.keyboardClose,!0)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.closeOnBlur,!0),document.removeEventListener("keyup",this.keyboardClose,!0)}},{key:"render",value:function(){var e=this.props.children,t=this.props.animationComponent;return i.a.createElement("div",{className:"MenuWrapper "+this.props.className,onClick:this.toggle,ref:this.node},e[0],i.a.createElement(t,{show:this.state.open},e[1]))}}])&&E(n.prototype,r),o&&E(n,o),t}();C(S,"propTypes",{children:o.a.node,className:o.a.string,onToggle:o.a.func,animationComponent:o.a.any.isRequired}),C(S,"defaultProps",{className:"",animationComponent:g})},1535:function(e,t,n){"use strict";n.d(t,"a",function(){return m});n(88),n(43);var r=n(30),o=n.n(r),a=n(7),i=n.n(a),s=n(55);function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return!t||"object"!==c(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var m=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),u(this,p(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(t,i.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e="fa fa-warning"+(this.props.additionalClassName?" "+this.props.additionalClassName:"");return i.a.createElement(s.c,{id:"generic_icons.warning",defaultMessage:"Warning Icon"},function(t){return i.a.createElement("i",{className:e,title:t})})}}])&&l(n.prototype,r),o&&l(n,o),t}();d(m,"propTypes",{additionalClassName:o.a.string}),d(m,"defaultProps",{additionalClassName:null})},1538:function(e,t,n){"use strict";n.d(t,"a",function(){return m});n(88),n(43);var r=n(30),o=n.n(r),a=n(7),i=n.n(a),s=n(55);function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return!t||"object"!==c(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var m=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),u(this,p(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(t,i.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e=this.context.intl.formatMessage;return i.a.createElement("span",{id:"loadingSpinner",className:"LoadingSpinner"+(this.props.text?" with-text":"")},i.a.createElement("span",{className:"fa fa-spinner fa-fw fa-pulse spinner",title:e({id:"generic_icons.loading",defaultMessage:"Loading Icon"})}),this.props.text)}}])&&l(n.prototype,r),o&&l(n,o),t}();d(m,"propTypes",{text:o.a.node}),d(m,"defaultProps",{text:null}),d(m,"contextTypes",{intl:s.i.isRequired})},1541:function(e,t,n){"use strict";n.d(t,"b",function(){return s}),n.d(t,"a",function(){return c}),n.d(t,"f",function(){return l}),n.d(t,"d",function(){return u}),n.d(t,"c",function(){return p}),n.d(t,"e",function(){return f});n(300),n(301),n(211);var r=n(2023),o=n.n(r),a=n(0),i=n(39);function s(e){var t="true"===e.EnableFileAttachments,n="true"===e.EnableMobileFileUpload;return!!t&&(!i.n()||n)}function c(e){return!i.n()||"true"===e.EnableMobileFileDownload}function l(e){var t=e;return e.length>a.Q.MAX_FILENAME_LENGTH&&(t=e.substring(0,Math.min(a.Q.MAX_FILENAME_LENGTH,e.length))+"..."),t}function u(e){var t=e.split("/"),n=t[0],r=t[1];if("video"===n)return"video";if("audio"===n)return"audio";if("image"===n)return"image";if(r){if("pdf"===r)return"pdf";if(r.includes("vnd.ms-excel")||r.includes("spreadsheetml")||r.includes("vnd.sun.xml.calc")||r.includes("opendocument.spreadsheet"))return"spreadsheet";if(r.includes("vnd.ms-powerpoint")||r.includes("presentationml")||r.includes("vnd.sun.xml.impress")||r.includes("opendocument.presentation"))return"presentation";if("msword"===r||r.includes("vnd.ms-word")||r.includes("officedocument.wordprocessingml")||r.includes("application/x-mswrite"))return"word"}return"other"}function p(e){var t=new DataView(e);if(65496!==t.getUint16(0,!1))return-2;for(var n=t.byteLength,r=2;r<n;){var o=t.getUint16(r,!1);if(r+=2,65505===o){if(1165519206!==t.getUint32(r+=2,!1))return-1;var a=18761===t.getUint16(r+=6,!1);r+=t.getUint32(r+4,a);var i=t.getUint16(r,a);r+=2;for(var s=0;s<i;s++)if(274===t.getUint16(r+12*s,a))return t.getUint16(r+12*s+8,a)}else{if(65280!=(65280&o))break;r+=t.getUint16(r,!1)}}return-1}function f(e){var t=o()(e);return{transform:t.transform,transformOrigin:t["transform-origin"]}}},1545:function(e,t,n){"use strict";n.d(t,"a",function(){return b});n(88),n(43);var r=n(30),o=n.n(r),a=n(7),i=n.n(a),s=n(1762),c=n(1731),l=n(1614);function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var b=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=f(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==u(o)&&"function"!=typeof o?d(r):o,h(d(n),"hideProfilePopover",function(){n.refs.overlay.hide()}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(t,i.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e="string"==typeof this.props.profileSrc&&""!==this.props.profileSrc?this.props.profileSrc:this.props.src,t="profile-icon ".concat(this.props.isEmoji?"emoji":"");return this.props.userId?i.a.createElement(s.a,{ref:"overlay",trigger:"click",placement:"right",rootClose:!0,overlay:i.a.createElement(c.a,{userId:this.props.userId,src:e,isBusy:this.props.isBusy,hide:this.hideProfilePopover,isRHS:this.props.isRHS,hasMention:this.props.hasMention})},i.a.createElement("span",{className:"status-wrapper ".concat(this.props.wrapperClass)},i.a.createElement("span",{className:t},i.a.createElement("img",{className:"more-modal__image",alt:"".concat(this.props.username||"user"," profile image"),width:this.props.width,height:this.props.width,src:this.props.src})),i.a.createElement(l.a,{status:this.props.status}))):i.a.createElement("span",{className:"status-wrapper"},i.a.createElement("span",{className:t},i.a.createElement("img",{className:"more-modal__image",alt:"",height:this.props.width,width:this.props.width,src:this.props.src})),i.a.createElement(l.a,{status:this.props.status}))}}])&&p(n.prototype,r),o&&p(n,o),t}();h(b,"defaultProps",{width:"36",height:"36",isRHS:!1,isEmoji:!1,hasMention:!1,wrapperClass:""}),h(b,"propTypes",{src:o.a.string.isRequired,profileSrc:o.a.string,status:o.a.string,width:o.a.string,height:o.a.string,userId:o.a.string,username:o.a.string,isBusy:o.a.bool,isRHS:o.a.bool,hasMention:o.a.bool,isEmoji:o.a.bool,wrapperClass:o.a.string})},1546:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return s});n(106),n(24),n(107);var r=n(0);function o(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function a(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var i=e.apply(t,n);function s(e){o(i,r,a,s,c,"next",e)}function c(e){o(i,r,a,s,c,"throw",e)}s(void 0)})}}function i(e){return function(){var t=a(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n({type:r.B.SET_MODAL_SEARCH,data:e}),t.abrupt("return",{data:!0});case 2:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}function s(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return function(){var o=a(regeneratorRuntime.mark(function o(a){return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return a({type:r.B.SET_SYSTEM_USERS_SEARCH,data:{term:e,team:t,filter:n}}),o.abrupt("return",{data:!0});case 2:case"end":return o.stop()}},o)}));return function(e){return o.apply(this,arguments)}}()}},1548:function(e,t,n){"use strict";var r=n(417),o=n(36),a=(n(88),n(43),n(32),n(33),n(24),n(44),n(209),n(305),n(30)),i=n.n(a),s=n(7),c=n.n(s);function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){h(e,t,n[t])})}return e}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var b=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),f(this,d(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(t,c.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e,t=this,n=this.props.pluggableName;if(this.props.children)e=c.a.Children.only(this.props.children).type;else if(!n)return null;var r=this.props.components,o=e?this.props.children.props:{},a=n||e.getComponentName(),i=u({},this.props);if(Reflect.deleteProperty(i,"children"),Reflect.deleteProperty(i,"components"),Reflect.deleteProperty(i,"pluggableName"),i=u({},i,o),r.hasOwnProperty(a)){var s=r[a];this.props.pluggableId&&(s=s.filter(function(e){return e.id===t.props.pluggableId}));var l=s.map(function(e){var n=e.component;return c.a.createElement(n,Object.assign({},i,{theme:t.props.theme,key:a+e.id}))});return c.a.createElement(c.a.Fragment,null,l)}return null==e?null:c.a.cloneElement(this.props.children,u({},i))}}])&&p(n.prototype,r),o&&p(n,o),t}();h(b,"propTypes",{children:i.a.element,pluggableName:i.a.string,components:i.a.object.isRequired,theme:i.a.object.isRequired,pluggableId:i.a.string});t.a=Object(r.connect)(function(e){return{components:e.plugins.components,theme:Object(o.getTheme)(e)}})(b)},1552:function(e,t,n){"use strict";n.d(t,"a",function(){return p});n(88),n(43);var r=n(7),o=n.n(r),a=n(55);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),c(this,l(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,o.a.PureComponent),n=t,(r=[{key:"render",value:function(){return o.a.createElement("span",this.props,o.a.createElement(a.c,{id:"generic_icons.channel.public",defaultMessage:"Public Channel Icon"},function(e){return o.a.createElement("svg",{width:"13px",height:"13px",viewBox:"0 0 14 14",role:"icon","aria-label":e},o.a.createElement("g",{stroke:"none",strokeWidth:"1",fill:"inherit",fillRule:"evenodd"},o.a.createElement("g",{transform:"translate(-115.000000, -147.000000)",fillRule:"nonzero",fill:"inherit"},o.a.createElement("g",{transform:"translate(95.000000, 0.000000)"},o.a.createElement("g",{transform:"translate(20.000000, 113.000000)"},o.a.createElement("g",{transform:"translate(0.000000, 34.000000)"},o.a.createElement("path",{d:"M10.409,0.893375 C9.40275,0.329875 8.24075,0.00875 7,0 C3.13075,0 0,3.140375 0,7 C0,10.521875 2.594375,13.42775 5.97625,13.93 C6.314875,13.974625 6.6535,14 7,14 C8.24075,14 9.40275,13.678875 10.409,13.1145 C12.551875,11.918375 14,9.6285 14,7 C13.99125,4.3715 12.551875,2.090375 10.409,0.893375 Z M11.554375,4.375 L9.431625,4.375 C9.302125,3.5 9.10875,2.736125 8.86725,2.085125 C10.003875,2.519125 10.9515,3.5 11.554375,4.375 Z M6.941375,1.73775 C6.960625,1.736875 6.979875,1.73425 7,1.73425 C7.020125,1.73425 7.039375,1.736875 7.058625,1.73775 C7.340375,2.172625 7.697375,3.5 7.92225,4.375 L6.07775,4.375 C6.302625,3.5 6.659625,2.172625 6.941375,1.73775 Z M1.81475,7.875 C1.7675,7.875 1.73425,7.29925 1.73425,7 C1.73425,6.70075 1.764875,6.125 1.813,6.125 L4.396875,6.125 C4.384625,6.125 4.375,6.7025 4.375,7 C4.375,7.2975 4.384625,7.875 4.396875,7.875 L1.81475,7.875 Z M4.354875,11.54475 C4.346125,11.54475 4.337375,11.54475 4.337375,11.536 C3.548125,11.07575 2.893625,10.5 2.436875,9.625 L4.568375,9.625 C4.697875,10.5 4.890375,11.262125 5.131875,11.91225 C4.8615,11.81075 4.599875,11.692625 4.354875,11.54475 Z M4.568375,4.375 L2.443875,4.375 C3.045875,3.5 3.994375,2.517375 5.131875,2.083375 C4.89125,2.734375 4.697875,3.5 4.568375,4.375 Z M7.0595,12.26225 C7.039375,12.26225 7.020125,12.26575 7,12.26575 C6.979875,12.26575 6.960625,12.26225 6.9405,12.26225 C6.65875,11.8265 6.302625,11.375 6.07775,9.625 L7.921375,9.625 C7.697375,11.375 7.34125,11.8265 7.0595,12.26225 Z M8.11125,7.875 L5.88875,7.875 C5.873875,7.875 5.8625,7.30625 5.8625,7 C5.8625,6.69375 5.873875,6.125 5.88875,6.125 L8.11125,6.125 C8.126125,6.125 8.1375,6.69375 8.1375,7 C8.1375,7.30625 8.126125,7.875 8.11125,7.875 Z M10.409,11.0075 C10.13075,11.242 9.828,11.45025 9.506875,11.631375 C9.30125,11.74075 9.086875,11.839625 8.8655,11.923625 C9.107,11.270875 9.30125,10.5 9.431625,9.625 L11.557875,9.625 C11.25425,10.5 10.8675,10.618125 10.409,11.0075 Z M9.603125,7.875 C9.615375,7.875 9.625,7.2975 9.625,7 C9.625,6.7025 9.615375,6.125 9.603125,6.125 L12.186125,6.125 C12.235125,6.125 12.26575,6.70075 12.26575,7 C12.26575,7.29925 12.233375,7.875 12.18525,7.875 L9.603125,7.875 Z"})))))))}))}}])&&s(n.prototype,r),i&&s(n,i),t}()},1553:function(e,t,n){"use strict";n.d(t,"a",function(){return p});n(88),n(43);var r=n(7),o=n.n(r),a=n(55);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),c(this,l(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,o.a.PureComponent),n=t,(r=[{key:"render",value:function(){return o.a.createElement("span",this.props,o.a.createElement(a.c,{id:"generic_icons.channel.private",defaultMessage:"Private Channel Icon"},function(e){return o.a.createElement("svg",{width:"12px",height:"13px",viewBox:"0 0 13 15",role:"icon",title:e},o.a.createElement("g",{stroke:"none",strokeWidth:"1",fill:"inherit",fillRule:"evenodd"},o.a.createElement("g",{transform:"translate(-116.000000, -175.000000)",fillRule:"nonzero",fill:"inherit"},o.a.createElement("g",{transform:"translate(95.000000, 0.000000)"},o.a.createElement("g",{transform:"translate(20.000000, 113.000000)"},o.a.createElement("g",{transform:"translate(1.000000, 62.000000)"},o.a.createElement("path",{d:"M12.0714286,6.5 L11.1428571,6.5 L11.1428571,4.64285714 C11.1428571,2.07814286 9.06471429,0 6.5,0 C3.93528571,0 1.85714286,2.07814286 1.85714286,4.64285714 L1.85714286,6.5 L0.928571429,6.5 C0.415071429,6.5 0,7.00792857 0,7.52142857 L0,13.9285714 C0,14.4420714 0.415071429,14.8571429 0.928571429,14.8571429 L12.0714286,14.8571429 C12.5849286,14.8571429 13,14.4420714 13,13.9285714 L13,7.52142857 C13,7.00792857 12.5849286,6.5 12.0714286,6.5 Z M6.5,1.85714286 C8.03585714,1.85714286 9.28571429,3.107 9.28571429,4.64285714 L9.28571429,6.5 L8.35714286,6.5 L4.64285714,6.5 L3.71428571,6.5 L3.71428571,4.64285714 C3.71428571,3.107 4.96414286,1.85714286 6.5,1.85714286 Z"})))))))}))}}])&&s(n.prototype,r),i&&s(n,i),t}()},1557:function(e,t,n){"use strict";var r=n(417),o=n(20),a=n(12),i=n(96),s=n(14),c=n(25),l=n(1988),u=n(109),p=n(1532),f=n(1691),d=(n(88),n(43),n(7)),m=n.n(d),h=n(30),b=n.n(h),y=n(0),g=n(55),v=n(13),E=5184e6,_=1296e6;function O(){var e=Object(c.getLicense)(v.a.getState());return"true"===e.IsLicensed&&Date.now()-parseInt(e.ExpiresAt,10)>_}var w=n(56),C=n(1490),S=n(1765),P=n(1762);function j(e){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function T(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function k(e){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function N(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function R(e,t){return(R=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function M(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var I=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=k(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==j(o)&&"function"!=typeof o?N(r):o,M(N(n),"handleClose",function(e){e.preventDefault(),n.props.handleClose&&n.props.handleClose()}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&R(e,t)}(t,m.a.PureComponent),n=t,(r=[{key:"componentDidMount",value:function(){var e=document.body.getAttribute("announcementBarCount")||0;e++,document.body.classList.add("announcement-bar--fixed"),document.body.setAttribute("announcementBarCount",e)}},{key:"componentWillUnmount",value:function(){var e=document.body.getAttribute("announcementBarCount");e--,document.body.setAttribute("announcementBarCount",e),0===e&&document.body.classList.remove("announcement-bar--fixed")}},{key:"render",value:function(){if(!this.props.message)return null;var e,t="announcement-bar",n={},r={};this.props.color&&this.props.textColor?(n.backgroundColor=this.props.color,n.color=this.props.textColor,r.color=this.props.textColor):this.props.type===y.h.DEVELOPER?t="announcement-bar announcement-bar-developer":this.props.type===y.h.CRITICAL?t="announcement-bar announcement-bar-critical":this.props.type===y.h.SUCCESS&&(t="announcement-bar announcement-bar-success"),this.props.showCloseButton&&(e=m.a.createElement("a",{href:"#",className:"announcement-bar__close",style:r,onClick:this.handleClose},"×"));var o=this.props.message;"string"==typeof o&&(o=m.a.createElement(C.b,{id:this.props.message}));var a=m.a.createElement(S.a,{id:"announcement-bar__tooltip"},o);return m.a.createElement("div",{className:t,style:n},m.a.createElement(P.a,{delayShow:y.i.OVERLAY_TIME_DELAY,placement:"bottom",overlay:a},m.a.createElement("span",null,o)),e)}}])&&T(n.prototype,r),o&&T(n,o),t}();M(I,"propTypes",{showCloseButton:b.a.bool,color:b.a.string,textColor:b.a.string,type:b.a.string,message:b.a.node.isRequired,handleClose:b.a.func}),M(I,"defaultProps",{showCloseButton:!1,color:"",textColor:"",type:y.h.CRITICAL,handleClose:null});n(32),n(33),n(24),n(44),n(209);var x=n(87);function A(e){return(A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function L(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function D(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function U(e){return(U=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function q(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function H(e,t){return(H=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function F(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var B="__announcement__",G=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=U(t).call(this,e),n=!o||"object"!==A(o)&&"function"!=typeof o?q(r):o,F(q(n),"handleDismiss",function(){n.props.allowDismissal&&(localStorage.setItem(B+n.props.text,!0),n.setState({dismissed:!0}),n.props.onDismissal&&n.props.onDismissal())}),n.state={dismissed:!0},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&H(e,t)}(t,m.a.PureComponent),n=t,o=[{key:"getDerivedStateFromProps",value:function(e){return{dismissed:localStorage.getItem(B+e.text)}}}],(r=[{key:"render",value:function(){if(this.state.dismissed)return null;var e=this.props,t=e.allowDismissal,n=e.text,r=L(e,["allowDismissal","text"]);return m.a.createElement(I,Object.assign({},r,{showCloseButton:t,handleClose:this.handleDismiss,message:m.a.createElement("span",{dangerouslySetInnerHTML:{__html:x.e(n,{singleline:!0,mentionHighlight:!1})}})}))}}])&&D(n.prototype,r),o&&D(n,o),t}();function V(e){return(V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function W(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function K(e){return(K=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function z(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Y(e,t){return(Y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Q(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}F(G,"propTypes",{allowDismissal:b.a.bool.isRequired,text:b.a.string.isRequired,onDismissal:b.a.func});var Z=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=K(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==V(o)&&"function"!=typeof o?z(r):o,Q(z(n),"dismissExpiringLicense",function(){n.props.actions.dismissNotice(y.g.LICENSE_EXPIRING)}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Y(e,t)}(t,m.a.PureComponent),n=t,(r=[{key:"render",value:function(){if(this.props.canViewSystemErrors){var e="https://licensing.mattermost.com/renew?id="+this.props.license.id+"&user_count="+this.props.totalUsers;if(O())return m.a.createElement(I,{type:y.h.CRITICAL,message:m.a.createElement(C.b,{id:y.g.LICENSE_EXPIRED,defaultMessage:"Enterprise license is expired and some features may be disabled. [Please renew](!{link}).",values:{link:e}})});if("true"===(t=Object(c.getLicense)(v.a.getState())).IsLicensed&&parseInt(t.ExpiresAt,10)-Date.now()<0)return m.a.createElement(I,{type:y.h.CRITICAL,message:m.a.createElement(C.b,{id:y.g.LICENSE_EXPIRED,defaultMessage:"Enterprise license is expired and some features may be disabled. [Please renew](!{link}).",values:{link:e}})});if(function(){var e=Object(c.getLicense)(v.a.getState());return"true"===e.IsLicensed&&parseInt(e.ExpiresAt,10)-Date.now()<=E}()&&!this.props.dismissedExpiringLicense)return m.a.createElement(I,{showCloseButton:!0,handleClose:this.dismissExpiringLicense,type:y.h.ANNOUNCEMENT,message:m.a.createElement(C.b,{id:y.g.LICENSE_EXPIRING,defaultMessage:"Enterprise license expires on {date, date, long}. [Please renew](!{link}).",values:{date:new Date(parseInt(this.props.license.ExpiresAt,10)),link:e}})})}else if(O())return m.a.createElement(I,{type:y.h.CRITICAL,message:m.a.createElement(g.c,{id:y.g.LICENSE_PAST_GRACE,defaultMessage:"Enterprise license is expired and some features may be disabled. Please contact your System Administrator for details."})});var t,n=this.context.intl.formatMessage;if("true"!==this.props.config.SendEmailNotifications&&"true"===this.props.config.EnablePreviewModeBanner){var r=n({id:y.g.PREVIEW_MODE,defaultMessage:"Preview Mode: Email notifications have not been configured"});return m.a.createElement(G,{allowDismissal:!0,text:r,type:y.h.ANNOUNCEMENT})}if(this.props.canViewSystemErrors&&""===this.props.config.SiteURL){var o,a;"true"===this.props.config.EnableSignUpWithGitLab?(o=Object(w.b)("announcement_bar.error.site_url_gitlab.full"),a="Please configure your [Site URL](https://docs.mattermost.com/administration/config-settings.html#site-url) in the [System Console](/admin_console/environment/web_server) or in gitlab.rb if you're using GitLab Mattermost."):(o=Object(w.b)("announcement_bar.error.site_url.full"),a="Please configure your [Site URL](https://docs.mattermost.com/administration/config-settings.html#site-url) in the [System Console](/admin_console/environment/web_server).");var i=n({id:o,defaultMessage:a});return m.a.createElement(G,{allowDismissal:!0,text:i,type:y.h.ANNOUNCEMENT})}return null}}])&&W(n.prototype,r),o&&W(n,o),t}();Q(Z,"propTypes",{config:b.a.object,license:b.a.object,user:b.a.object,canViewSystemErrors:b.a.bool.isRequired,totalUsers:b.a.number,dismissedExpiringLicense:b.a.bool,actions:b.a.shape({dismissNotice:b.a.func.isRequired}).isRequired}),Q(Z,"contextTypes",{intl:g.i});var J=Object(r.connect)(function(e){return{dismissedExpiringLicense:Boolean(e.views.notice.hasBeenDismissed[y.g.LICENSE_EXPIRING])}},function(e){return{actions:Object(o.bindActionCreators)({dismissNotice:f.a},e)}})(Z),X=n(1777);function $(e){return($="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ee(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function te(e){return(te=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ne(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function re(e,t){return(re=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function oe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ae=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,n=!(o=te(t).call(this,e))||"object"!==$(o)&&"function"!=typeof o?ne(r):o,oe(ne(n),"reloadPage",function(){window.location.reload()}),n.state={serverVersionOnAppLoad:e.serverVersion},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&re(e,t)}(t,m.a.PureComponent),n=t,o=[{key:"getDerivedStateFromProps",value:function(e,t){return!t.serverVersionOnAppLoad&&e.serverVersion?{serverVersionOnAppLoad:e.serverVersion}:null}}],(r=[{key:"render",value:function(){var e=this.state.serverVersionOnAppLoad,t=this.props.serverVersion;return e?Object(X.a)(e,t)?null:m.a.createElement(I,{type:y.h.ANNOUNCEMENT,message:m.a.createElement(m.a.Fragment,null,m.a.createElement(g.c,{id:"version_bar.new",defaultMessage:"A new version of Mattermost is available."})," ",m.a.createElement("a",{onClick:this.reloadPage},m.a.createElement(g.c,{id:"version_bar.refresh",defaultMessage:"Refresh the app now"})),".")}):null}}])&&ee(n.prototype,r),o&&ee(n,o),t}();oe(ae,"propTypes",{serverVersion:b.a.string});var ie=Object(r.connect)(function(e){return{serverVersion:e.entities.general.serverVersion}})(ae);function se(e){return(se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ce(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function le(e,t){return!t||"object"!==se(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ue(e){return(ue=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function pe(e,t){return(pe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var fe,de,me,he=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),le(this,ue(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pe(e,t)}(t,m.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e=null;"true"===this.props.config.EnableBanner&&this.props.config.BannerText.trim()&&(e=m.a.createElement(G,{color:this.props.config.BannerColor,textColor:this.props.config.BannerTextColor,allowDismissal:"true"===this.props.config.AllowBannerDismissal,text:this.props.config.BannerText}));var t=null;return this.props.latestError&&(t=m.a.createElement(I,{type:this.props.latestError.error.type,message:this.props.latestError.error.message,showCloseButton:!0,handleClose:this.props.actions.dismissError})),m.a.createElement(m.a.Fragment,null,e,t,m.a.createElement(ie,null),m.a.createElement(J,{config:this.props.config,license:this.props.license,canViewSystemErrors:this.props.canViewSystemErrors,totalUsers:this.props.totalUsers,user:this.props.user}))}}])&&ce(n.prototype,r),o&&ce(n,o),t}();fe=he,de="propTypes",me={license:b.a.object,config:b.a.object,user:b.a.shape({email:b.a.string.isRequired,email_verified:b.a.bool}),canViewSystemErrors:b.a.bool.isRequired,latestError:b.a.object,totalUsers:b.a.number,actions:b.a.shape({dismissError:b.a.func.isRequired}).isRequired},de in fe?Object.defineProperty(fe,de,{value:me,enumerable:!0,configurable:!0,writable:!0}):fe[de]=me;t.a=Object(r.connect)(function(e){var t=Object(i.haveISystemPermission)(e,{permission:s.Permissions.MANAGE_SYSTEM}),n=Object(c.getLicense)(e),r=Object(c.getConfig)(e),o=Object(a.getCurrentUser)(e),u=Object(l.getDisplayableErrors)(e),p=e.entities.admin.analytics.TOTAL_USERS,f=null;return u&&u.length>=1&&(f=u[0]),{license:n,config:r,user:o,canViewSystemErrors:t,latestError:f,totalUsers:p}},function(e){var t=u.dismissError.bind(null,0);return{actions:Object(o.bindActionCreators)({getStandardAnalytics:p.getStandardAnalytics,dismissError:t,dismissNotice:f.a},e)}})(he)},1559:function(e,t,n){"use strict";n.d(t,"a",function(){return h});n(88),n(43),n(32),n(33),n(24),n(44),n(209);var r=n(30),o=n.n(r),a=n(7),i=n.n(a),s=n(1525);function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t){return!t||"object"!==c(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),p(this,f(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(t,a["PureComponent"]),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.spinning,n=e.spinningText,r=e.children,o=l(e,["spinning","spinningText","children"]);return i.a.createElement("button",Object.assign({className:"btn btn-primary",disabled:t},o),i.a.createElement(s.a,{loading:t,text:n},r))}}])&&u(n.prototype,r),o&&u(n,o),t}();m(h,"defaultProps",{spinning:!1}),m(h,"propTypes",{children:o.a.node,spinning:o.a.bool.isRequired,spinningText:o.a.node.isRequired,onClick:o.a.func})},1560:function(e,t,n){"use strict";n.d(t,"a",function(){return _});n(33),n(24),n(44),n(209),n(305),n(88),n(43),n(32),n(431);var r=n(30),o=n.n(r),a=n(7),i=n.n(a),s=n(425),c=n.n(s),l=n(1677),u=n(0),p=n(39),f=n(23);function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(e,t){return(g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var E=u.Q.KeyCodes,_=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=b(t).call(this,e),n=!o||"object"!==d(o)&&"function"!=typeof o?y(r):o,v(y(n),"handleMentionKeyClick",function(e,t){if(n.props.isRHS===t){var r="@"+e;n.props.value&&/[^\s]$/.test(n.props.value)&&(r=" "+r),n.addTextAtCaret(r,"")}}),v(y(n),"getTextbox",function(){if(!n.refs.input)return null;var e=n.refs.input.getInput();return e.getDOMNode?e.getDOMNode():e}),v(y(n),"recalculateSize",function(){var e=n.refs.input.getInput();e.recalculateSize&&e.recalculateSize()}),v(y(n),"handleEmitClearSuggestions",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;setTimeout(function(){n.clear()},e)}),v(y(n),"preventSuggestionListClose",function(){n.preventSuggestionListCloseFlag=!0}),v(y(n),"handleFocusOut",function(e){n.preventSuggestionListCloseFlag?n.preventSuggestionListCloseFlag=!1:n.container.contains(e.relatedTarget)||p.g()&&!e.relatedTarget||(n.handleEmitClearSuggestions(),n.setState({focused:!1}),n.props.onBlur&&n.props.onBlur())}),v(y(n),"handleFocusIn",function(e){n.container.contains(e.relatedTarget)||n.preventSuggestionListCloseFlag||(n.setState({focused:!0}),(n.props.openOnFocus||n.props.openWhenEmpty)&&setTimeout(function(){var e=n.getTextbox();if(e){var t=e.value.substring(0,e.selectionEnd);(n.props.openWhenEmpty||t.length>=n.props.requiredCharacters)&&n.handlePretextChanged(t)}}),n.props.onFocus&&n.props.onFocus())}),v(y(n),"handleChange",function(e){var t=n.getTextbox(),r=t.value.substring(0,t.selectionEnd).toLowerCase();n.composing||n.pretext===r||n.handlePretextChanged(r),n.props.onChange&&n.props.onChange(e)}),v(y(n),"handleCompositionStart",function(){n.composing=!0,n.props.onComposition&&n.props.onComposition()}),v(y(n),"handleCompositionUpdate",function(e){if(e.data){var t=n.getTextbox(),r=t.value.substring(0,t.selectionStart)+e.data;n.handlePretextChanged(r),n.props.onComposition&&n.props.onComposition()}}),v(y(n),"handleCompositionEnd",function(){n.composing=!1,n.props.onComposition&&n.props.onComposition()}),v(y(n),"addTextAtCaret",function(e,r){var o,a=n.getTextbox(),i=a.selectionEnd,s=n.props.value,c=a.value.substring(0,a.selectionEnd),l=!1;if(c.toLowerCase().endsWith(r.toLowerCase()))o=c.substring(0,c.length-r.length);else{var u=e.substring(r.length),p=t.findOverlap(c,u);l=0===p.length,o=c.substring(0,c.length-p.length-r.length)}var d,m=s.substring(i);if(d=l?c:o+e+" "+m,a.value=d,n.props.onChange){var h={target:a};n.props.onChange(h)}window.requestAnimationFrame(function(){a.value===d&&f.ib(a,o.length+e.length+1)})}),v(y(n),"replaceText",function(e){var t=n.getTextbox();if(t.value=e,n.props.onChange){var r={target:t};n.props.onChange(r)}}),v(y(n),"handleCompleteWord",function(e,t){if(n.props.replaceAllInputOnSelect?n.replaceText(e):n.addTextAtCaret(e,t),n.props.onItemSelected)for(var r=n.state.items,o=n.state.terms,a=0;a<o.length;a++)if(o[a]===e){n.props.onItemSelected(r[a]);break}n.clear(),n.refs.input.focus();var i=!0,s=!1,c=void 0;try{for(var l,u=n.props.providers[Symbol.iterator]();!(i=(l=u.next()).done);i=!0){var p=l.value;p.handleCompleteWord&&p.handleCompleteWord(e,t)}}catch(e){s=!0,c=e}finally{try{i||null==u.return||u.return()}finally{if(s)throw c}}}),v(y(n),"selectNext",function(){n.setSelectionByDelta(1)}),v(y(n),"selectPrevious",function(){n.setSelectionByDelta(-1)}),v(y(n),"setSelectionByDelta",function(e){var t=n.state.terms.indexOf(n.state.selection);-1!==t?((t+=e)<0?t=0:t>n.state.terms.length-1&&(t=n.state.terms.length-1),n.setState({selection:n.state.terms[t]})):n.setState({selection:""})}),v(y(n),"clear",function(){n.setState({cleared:!0,matchedPretext:[],terms:[],items:[],components:[]})}),v(y(n),"hasSuggestions",function(){return n.state.items.some(function(e){return!e.loading})}),v(y(n),"handleKeyDown",function(e){if((n.props.openWhenEmpty||n.props.value)&&n.hasSuggestions())if(f.S(e,E.UP))n.selectPrevious(),e.preventDefault();else if(f.S(e,E.DOWN))n.selectNext(),e.preventDefault();else if(f.S(e,E.ENTER)||n.props.completeOnTab&&f.S(e,E.TAB)){for(var t="",r=0;r<n.state.terms.length;r++)n.state.terms[r]===n.state.selection&&(t=n.state.matchedPretext[r]);n.pretext.endsWith(t)?n.handleCompleteWord(n.state.selection,t):(clearTimeout(n.timeoutId),n.nonDebouncedPretextChanged(n.pretext,!0)),n.props.onKeyDown&&n.props.onKeyDown(e),e.preventDefault()}else f.S(e,E.ESCAPE)?(n.clear(),n.setState({presentationType:"text"}),e.preventDefault(),e.stopPropagation()):n.props.onKeyDown&&n.props.onKeyDown(e);else n.props.onKeyDown&&n.props.onKeyDown(e)}),v(y(n),"handleReceivedSuggestions",function(e){for(var t=[],r=[],o=0;o<e.terms.length;o++)t.push(e.component),r.push(e.matchedPretext);var a=e.terms,i=e.items,s=n.state.selection;return a.length>0?n.state.selection&&-1!==a.indexOf(n.state.selection)||(s=a[0]):n.state.selection&&(s=""),n.setState({cleared:!1,selection:s,terms:a,items:i,components:t,matchedPretext:r}),{selection:s,matchedPretext:e.matchedPretext}}),v(y(n),"handleReceivedSuggestionsAndComplete",function(e){var t=n.handleReceivedSuggestions(e),r=t.selection,o=t.matchedPretext;r&&n.handleCompleteWord(r,o)}),v(y(n),"nonDebouncedPretextChanged",function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];n.pretext=e;var r=!1,o=n.handleReceivedSuggestions;t&&(o=n.handleReceivedSuggestionsAndComplete);var a=!0,i=!1,s=void 0;try{for(var c,l=n.props.providers[Symbol.iterator]();!(a=(c=l.next()).done);a=!0){var u=c.value;if(r=u.handlePretextChanged(e,o)||r){n.setState({presentationType:u.presentationType(),allowDividers:u.allowDividers()});break}}}catch(e){i=!0,s=e}finally{try{a||null==l.return||l.return()}finally{if(i)throw s}}r||n.clear()}),v(y(n),"debouncedPretextChanged",function(e){clearTimeout(n.timeoutId),n.timeoutId=setTimeout(function(){return n.nonDebouncedPretextChanged(e)},u.Q.SEARCH_TIMEOUT_MILLISECONDS)}),v(y(n),"handlePretextChanged",function(e){n.pretext=e,n.debouncedPretextChanged(e)}),v(y(n),"blur",function(){n.refs.input.blur()}),v(y(n),"setContainerRef",function(e){n.container&&(n.container.removeEventListener("focusin",n.handleFocusIn),n.container.removeEventListener("focusout",n.handleFocusOut)),e&&(e.addEventListener("focusin",n.handleFocusIn),e.addEventListener("focusout",n.handleFocusOut)),n.container=e}),n.suggestionReadOut=i.a.createRef(),n.composing=!1,n.pretext="",n.timeoutId="",n.preventSuggestionListCloseFlag=!1,n.state={focused:!1,cleared:!0,matchedPretext:[],items:[],terms:[],components:[],selection:"",allowDividers:!0,presentationType:"text"},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}(t,i.a.Component),n=t,o=[{key:"findOverlap",value:function(e,t){for(var n=e.toLowerCase(),r=t.toLowerCase(),o=r.length;o>0;o--){var a=r.substring(0,o);if(n.endsWith(a))return a}return""}}],(r=[{key:"componentDidMount",value:function(){this.props.listenForMentionKeyClick&&c.a.addListener("mention_key_click",this.handleMentionKeyClick)}},{key:"componentWillUnmount",value:function(){c.a.removeListener("mention_key_click",this.handleMentionKeyClick)}},{key:"componentDidUpdate",value:function(e){if(e.contextId!==this.props.contextId){var t=this.getTextbox(),n=t.value.substring(0,t.selectionEnd).toLowerCase();this.handlePretextChanged(n)}}},{key:"render",value:function(){var e=this.props,t=e.listComponent,n=e.dateComponent,r=e.listStyle,o=e.renderNoResults,a=m(e,["listComponent","dateComponent","listStyle","renderNoResults"]),s=this.props.renderDividers&&this.state.allowDividers;Reflect.deleteProperty(a,"providers"),Reflect.deleteProperty(a,"onChange"),Reflect.deleteProperty(a,"onComposition"),Reflect.deleteProperty(a,"onItemSelected"),Reflect.deleteProperty(a,"completeOnTab"),Reflect.deleteProperty(a,"isRHS"),Reflect.deleteProperty(a,"requiredCharacters"),Reflect.deleteProperty(a,"openOnFocus"),Reflect.deleteProperty(a,"openWhenEmpty"),Reflect.deleteProperty(a,"onFocus"),Reflect.deleteProperty(a,"onBlur"),Reflect.deleteProperty(a,"containerClass"),Reflect.deleteProperty(a,"replaceAllInputOnSelect"),Reflect.deleteProperty(a,"renderDividers"),Reflect.deleteProperty(a,"contextId"),Reflect.deleteProperty(a,"listenForMentionKeyClick");var c=t,u=n;return i.a.createElement("div",{ref:this.setContainerRef,className:this.props.containerClass},i.a.createElement("div",{ref:this.suggestionReadOut,"aria-live":"polite",role:"alert",className:"sr-only"}),i.a.createElement(l.a,Object.assign({ref:"input",autoComplete:"off"},a,{onInput:this.handleChange,onCompositionStart:this.handleCompositionStart,onCompositionUpdate:this.handleCompositionUpdate,onCompositionEnd:this.handleCompositionEnd,onKeyDown:this.handleKeyDown})),(this.props.openWhenEmpty||this.props.value.length>=this.props.requiredCharacters)&&"text"===this.state.presentationType&&i.a.createElement(c,{ref:"list",ariaLiveRef:this.suggestionReadOut,open:this.state.focused,pretext:this.pretext,location:r,renderDividers:s,renderNoResults:o,onCompleteWord:this.handleCompleteWord,preventClose:this.preventSuggestionListClose,cleared:this.state.cleared,matchedPretext:this.state.matchedPretext,items:this.state.items,terms:this.state.terms,selection:this.state.selection,components:this.state.components}),(this.props.openWhenEmpty||this.props.value.length>=this.props.requiredCharacters)&&"date"===this.state.presentationType&&i.a.createElement(u,{ref:"date",items:this.state.items,terms:this.state.terms,components:this.state.components,matchedPretext:this.state.matchedPretext,onCompleteWord:this.handleCompleteWord}))}}])&&h(n.prototype,r),o&&h(n,o),t}();v(_,"propTypes",{listComponent:o.a.func.isRequired,dateComponent:o.a.func,value:o.a.string.isRequired,providers:o.a.arrayOf(o.a.object),listStyle:o.a.string,containerClass:o.a.string,renderDividers:o.a.bool,renderNoResults:o.a.bool,completeOnTab:o.a.bool,onFocus:o.a.func,onBlur:o.a.func,onChange:o.a.func,onKeyDown:o.a.func,onComposition:o.a.func,onItemSelected:o.a.func,isRHS:o.a.bool,requiredCharacters:o.a.number,openOnFocus:o.a.bool,disabled:o.a.bool,openWhenEmpty:o.a.bool,replaceAllInputOnSelect:o.a.bool,contextId:o.a.string,listenForMentionKeyClick:o.a.bool}),v(_,"defaultProps",{listStyle:"top",containerClass:"",renderDividers:!1,renderNoResults:!1,completeOnTab:!0,isRHS:!1,requiredCharacters:1,openOnFocus:!1,openWhenEmpty:!1,replaceAllInputOnSelect:!1,listenForMentionKeyClick:!1})},1561:function(e,t,n){"use strict";n.d(t,"a",function(){return _});n(88),n(43);var r=n(183),o=n.n(r),a=n(30),i=n.n(a),s=n(7),c=n.n(s),l=n(418),u=n.n(l),p=n(55),f=n(23),d=n(1490),m=n(1538);function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=y(t).call(this,e))||"object"!==h(o)&&"function"!=typeof o?g(r):o).getContent=n.getContent.bind(g(n)),n.suggestionReadOut=c.a.createRef(),n.scrollToItem=n.scrollToItem.bind(g(n)),n.currentLabel="",n.currentItem={},n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}(t,c.a.PureComponent),n=t,(r=[{key:"componentDidUpdate",value:function(e){this.props.selection!==e.selection&&this.props.selection&&this.scrollToItem(this.props.selection),Object(f.O)(this.currentItem)||this.generateLabel(this.currentItem)}},{key:"componentWillUnmount",value:function(){this.removeLabel()}},{key:"announceLabel",value:function(){var e=this.props.ariaLiveRef.current;e&&(e.innerHTML=this.currentLabel)}},{key:"removeLabel",value:function(){var e=this.props.ariaLiveRef.current;e&&(e.innerHTML="")}},{key:"generateLabel",value:function(e){e.username?(this.currentLabel=e.username,(e.first_name||e.last_name)&&e.nickname?this.currentLabel+=" ".concat(e.first_name," ").concat(e.last_name," ").concat(e.nickname):e.nickname?this.currentLabel+=" ".concat(e.nickname):(e.first_name||e.last_name)&&(this.currentLabel+=" ".concat(e.first_name," ").concat(e.last_name))):"mention.channels"===e.type&&(this.currentLabel=e.channel.display_name),this.currentLabel&&(this.currentLabel=this.currentLabel.toLowerCase()),this.announceLabel()}},{key:"getContent",value:function(){return o()(u.a.findDOMNode(this.refs.content))}},{key:"scrollToItem",value:function(e){var t=this.getContent();if(t&&0!==t.length){var n=t[0].clientHeight;if(n<t[0].scrollHeight){var r=t.scrollTop(),a=parseInt(t.css("padding-top"),10),i=parseInt(t.css("padding-top"),10),s=o()(u.a.findDOMNode(this.refs[e]));if(0===s.length)return;var c=s[0].offsetTop-parseInt(s.css("margin-top"),10),l=parseInt(s.css("margin-bottom"),10)+parseInt(s.css("padding-bottom"),10),p=s[0].offsetTop+s.height()+l;c-a<r?t.scrollTop(c-a):p+a+i>r+n&&t.scrollTop(p-n+a+i)}}}},{key:"renderDivider",value:function(e){return c.a.createElement("div",{key:e+"-divider",className:"suggestion-list__divider"},c.a.createElement("span",null,c.a.createElement(p.c,{id:"suggestion."+e})))}},{key:"renderNoResults",value:function(){return c.a.createElement("div",{key:"list-no-results",className:"suggestion-list__no-results"},c.a.createElement(d.b,{id:"suggestion_list.no_matches",defaultMessage:"No items match __{value}__",values:{value:this.props.pretext||'""'}}))}},{key:"render",value:function(){if(!this.props.open||this.props.cleared)return null;var e,t=[];if(0===this.props.items.length){if(!this.props.renderNoResults)return null;t.push(this.renderNoResults())}for(var n=0;n<this.props.items.length;n++){var r=this.props.items[n],o=this.props.terms[n],a=o===this.props.selection,i=this.props.components[n];this.props.renderDividers&&r.type!==e&&(t.push(this.renderDivider(r.type)),e=r.type),r.loading?t.push(c.a.createElement(m.a,{key:r.type})):(a&&(this.currentItem=r),t.push(c.a.createElement(i,{key:o,ref:o,item:this.props.items[n],term:o,matchedPretext:this.props.matchedPretext[n],isSelection:a,onClick:this.props.onCompleteWord})))}var s="suggestion-list suggestion-list--"+this.props.location,l="suggestion-list__content suggestion-list__content--"+this.props.location;return c.a.createElement("div",{className:s},c.a.createElement("div",{id:"suggestionList",ref:"content",className:l,onMouseDown:this.props.preventClose},t))}}])&&b(n.prototype,r),a&&b(n,a),t}();E(_,"propTypes",{ariaLiveRef:i.a.object,open:i.a.bool.isRequired,location:i.a.string,renderDividers:i.a.bool,renderNoResults:i.a.bool,onCompleteWord:i.a.func.isRequired,preventClose:i.a.func,pretext:i.a.string.isRequired,cleared:i.a.bool.isRequired,matchedPretext:i.a.array.isRequired,items:i.a.array.isRequired,terms:i.a.array.isRequired,selection:i.a.string.isRequired,components:i.a.array.isRequired}),E(_,"defaultProps",{renderDividers:!1,renderNoResults:!1})},1564:function(e,t,n){"use strict";n.d(t,"d",function(){return d}),n.d(t,"b",function(){return m}),n.d(t,"a",function(){return h}),n.d(t,"c",function(){return b}),n.d(t,"e",function(){return y});n(43),n(32),n(33),n(44),n(106),n(24),n(107);var r=n(6),o=n(75),a=n(303),i=n(16),s=n(35),c=n(119);function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){u(e,t,n[t])})}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function f(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){p(a,r,o,i,s,"next",e)}function s(e){p(a,r,o,i,s,"throw",e)}i(void 0)})}}function d(e,t){return function(){var n=f(regeneratorRuntime.mark(function n(r,c){var l;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r(a.removeUserFromTeam(e,t));case 2:return l=n.sent,r(Object(s.getUser)(t)),r(a.getTeamStats(e)),r(Object(o.getChannelStats)(Object(i.getCurrentChannelId)(c()))),n.abrupt("return",l);case 7:case"end":return n.stop()}},n)}));return function(e,t){return n.apply(this,arguments)}}()}function m(e,t){return function(){var n=f(regeneratorRuntime.mark(function n(o){var i,s,c,u,p;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,o(a.addUserToTeamFromInvite(e,t));case 2:if(i=n.sent,s=i.data,c=i.error,!s){n.next=12;break}return n.next=8,o(a.getTeam(s.team_id));case 8:return u=n.sent,p=u.data,o({type:r.TeamTypes.RECEIVED_MY_TEAM_MEMBER,data:l({},s,{delete_at:0,msg_count:0,mention_count:0})}),n.abrupt("return",{data:p});case 12:return n.abrupt("return",{error:c});case 13:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()}function h(e,t){return function(){var n=f(regeneratorRuntime.mark(function n(o){var i,s,c,u,p;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,o(a.addUserToTeam(e,t));case 2:if(i=n.sent,s=i.data,c=i.error,!s){n.next=12;break}return n.next=8,o(a.getTeam(s.team_id));case 8:return u=n.sent,p=u.data,o({type:r.TeamTypes.RECEIVED_MY_TEAM_MEMBER,data:l({},s,{delete_at:0,msg_count:0,mention_count:0})}),n.abrupt("return",{data:p});case 12:return n.abrupt("return",{error:c});case 13:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()}function b(e,t){return function(){var n=f(regeneratorRuntime.mark(function n(r,s){var c,l,u;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r(a.addUsersToTeam(e,t));case 2:if(c=n.sent,l=c.data,!(u=c.error)){n.next=7;break}return n.abrupt("return",{error:u});case 7:return r(Object(o.getChannelStats)(Object(i.getCurrentChannelId)(s()))),n.abrupt("return",{data:l});case 9:case"end":return n.stop()}},n)}));return function(e,t){return n.apply(this,arguments)}}()}function y(e){return function(t,n){t(Object(o.viewChannel)(Object(i.getCurrentChannelId)(n()))),c.a.push(e)}}},1570:function(e,t,n){"use strict";n(88),n(43),n(32);var r=n(417),o=n(96),a=n(30),i=n.n(a),s=n(7),c=n.n(s);function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),p(this,f(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(t,c.a.Component),n=t,(r=[{key:"render",value:function(){return this.props.hasPermission&&!this.props.invert?this.props.children:!this.props.hasPermission&&this.props.invert?this.props.children:null}}])&&u(n.prototype,r),o&&u(n,o),t}();m(h,"defaultProps",{invert:!1}),m(h,"propTypes",{permissions:i.a.arrayOf(i.a.string).isRequired,hasPermission:i.a.bool.isRequired,invert:i.a.bool.isRequired,children:i.a.node.isRequired});t.a=Object(r.connect)(function(e,t){var n=!0,r=!1,a=void 0;try{for(var i,s=t.permissions[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var c=i.value;if(Object(o.haveISystemPermission)(e,{permission:c}))return{hasPermission:!0}}}catch(e){r=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw a}}return{hasPermission:!1}})(h)},1571:function(e,t,n){"use strict";n(44),n(108),n(210),n(155),n(88),n(43),n(209),n(32),n(33),n(24);var r=n(30),o=n.n(r),a=n(7),i=n.n(a),s=n(55),c=n(1735),l=n(0),u=n(1520),p=n(23),f=n(1493);function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var g=l.Q.KeyCodes,v=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=h(t).call(this,e))||"object"!==d(o)&&"function"!=typeof o?b(r):o).defaultOptionRenderer=n.defaultOptionRenderer.bind(b(n)),n.handleArrowPress=n.handleArrowPress.bind(b(n)),n.setSelected=n.setSelected.bind(b(n)),n.toSelect=-1,n.state={selected:-1},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(t,i.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleArrowPress)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleArrowPress)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.setState({selected:this.toSelect});var t=e.options;t&&t.length>0&&this.toSelect>=0&&this.props.onSelect(t[this.toSelect])}},{key:"componentDidUpdate",value:function(e,t){if(t.selected!==this.state.selected&&this.refs.list&&this.refs.selected){var n=this.refs.selected.getBoundingClientRect().top,r=this.refs.selected.getBoundingClientRect().bottom,o=this.refs.list.getBoundingClientRect().top;r>this.refs.list.getBoundingClientRect().bottom?this.refs.selected.scrollIntoView(!1):n<o&&this.refs.selected.scrollIntoView(!0)}}},{key:"setSelected",value:function(e){this.toSelect=e}},{key:"handleArrowPress",value:function(e){if(!Object(p.e)(e)||!e.shiftKey){var t=this.props.options;if(0!==t.length){var n;switch(e.key){case g.DOWN[0]:if(-1===this.state.selected){n=0;break}n=Math.min(this.state.selected+1,t.length-1);break;case g.UP[0]:if(-1===this.state.selected){n=0;break}n=Math.max(this.state.selected-1,0);break;default:return}e.preventDefault(),this.setState({selected:n}),this.setSelected(n),this.props.onSelect(t[n])}}}},{key:"defaultOptionRenderer",value:function(e,t,n){var r="";return t&&(r="more-modal__row--selected"),i.a.createElement("div",{ref:t?"selected":e.value,className:r,key:"multiselectoption"+e.value,onClick:function(){return n(e)}},e.label)}},{key:"render",value:function(){var e,t=this,n=this.props.options;if(this.props.loading)e=i.a.createElement("div",{"aria-hidden":!0},i.a.createElement(f.a,{position:"absolute",key:"loading"}));else if(null==n||0===n.length)e=i.a.createElement("div",{key:"no-users-found",className:"no-channel-message"},i.a.createElement("p",{className:"primary-message"},i.a.createElement(s.c,{id:"multiselect.list.notFound",defaultMessage:"No items found"})));else{var r;r=this.props.optionRenderer?this.props.optionRenderer:this.defaultOptionRenderer;var o=n.map(function(e,n){return r(e,t.state.selected===n,t.props.onAdd)}),a=n[this.state.selected],c=this.props.ariaLabelRenderer(a);e=i.a.createElement("div",{className:"more-modal__list"},i.a.createElement("div",{className:"sr-only","aria-live":"polite"},c),i.a.createElement("div",{ref:"list",role:"presentation","aria-hidden":!0},o))}return i.a.createElement("div",{className:"multi-select__wrapper","aria-live":"polite"},e)}}])&&m(n.prototype,r),o&&m(n,o),t}();function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){j(e,t,n[t])})}return e}function _(e){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function O(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function w(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function C(e){return(C=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function S(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function P(e,t){return(P=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function j(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}v.defaultProps={options:[],perPage:50,onAction:function(){return null}},v.propTypes={options:o.a.arrayOf(o.a.object),optionRenderer:o.a.func,ariaLabelRenderer:o.a.func,page:o.a.number,perPage:o.a.number,onPageChange:o.a.func,onAdd:o.a.func,onSelect:o.a.func,loading:o.a.bool},n.d(t,"a",function(){return k});var T=l.i.KeyCodes,k=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=C(t).call(this,e),n=!o||"object"!==_(o)&&"function"!=typeof o?S(r):o,j(S(n),"handleA11yActivateEvent",function(){n.setState({a11yActive:!0})}),j(S(n),"handleA11yDeactivateEvent",function(){n.setState({a11yActive:!1})}),j(S(n),"nextPage",function(){n.props.handlePageChange&&n.props.handlePageChange(n.state.page+1,n.state.page),n.refs.list&&n.refs.list.setSelected(0),n.setState({page:n.state.page+1})}),j(S(n),"prevPage",function(){0!==n.state.page&&(n.props.handlePageChange&&n.props.handlePageChange(n.state.page-1,n.state.page),n.refs.list.setSelected(0),n.setState({page:n.state.page-1}))}),j(S(n),"resetPaging",function(){n.setState({page:0})}),j(S(n),"onSelect",function(e){n.selected=e}),j(S(n),"onAdd",function(e){if(!(n.props.maxValues&&n.props.values.length>=n.props.maxValues)){for(var t=0;t<n.props.values.length;t++)if(n.props.values[t].id===e.id)return;n.props.handleAdd(e),n.selected=null,n.refs.reactSelect.select.handleInputChange({currentTarget:{value:""}}),n.onInput(""),n.refs.reactSelect.focus();var r=n.props.submitImmediatelyOn;r&&r(e)&&n.props.handleSubmit([e])}}),j(S(n),"onInput",function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"input-blur"!==t.action&&"menu-close"!==t.action&&n.state.input!==e&&(n.setState({input:e}),""===e?n.refs.list.setSelected(-1):n.refs.list.setSelected(0),n.selected=null,n.props.handleInput(e,S(n)))}),j(S(n),"onInputKeyDown",function(e){switch(e.key){case T.ENTER[0]:e.preventDefault()}}),j(S(n),"handleEnterPress",function(e){switch(e.key){case T.ENTER[0]:if(null==n.selected)return void n.props.handleSubmit();n.onAdd(n.selected)}}),j(S(n),"handleOnClick",function(e){e.preventDefault(),n.props.handleSubmit()}),j(S(n),"onChange",function(e,t){if("remove-value"===t.action||"pop-value"===t.action){for(var r=O(n.props.values),o=0;o<r.length;o++)if(r[o].id===t.removedValue.id){r.splice(o,1);break}n.props.handleDelete(r)}}),n.selected=null,n.state={page:0,input:""},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&P(e,t)}(t,i.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleEnterPress),this.refs.reactSelect&&(this.refs.reactSelect.select.inputRef.addEventListener(l.c.ACTIVATE,this.handleA11yActivateEvent),this.refs.reactSelect.select.inputRef.addEventListener(l.c.DEACTIVATE,this.handleA11yDeactivateEvent),this.refs.reactSelect.focus())}},{key:"componentWillUnmount",value:function(){this.refs.reactSelect.select.inputRef.removeEventListener(l.c.ACTIVATE,this.handleA11yActivateEvent),this.refs.reactSelect.select.inputRef.removeEventListener(l.c.DEACTIVATE,this.handleA11yDeactivateEvent),document.removeEventListener("keydown",this.handleEnterPress)}},{key:"render",value:function(){var e,t,n=this,r=Object.assign([],this.props.options),o=this.props,a=o.totalCount,l=o.users,p=o.values;this.props.numRemainingText?e=this.props.numRemainingText:null!=this.props.maxValues&&(e=i.a.createElement(s.c,{id:"multiselect.numRemaining",defaultMessage:"You can add {num, number} more. ",values:{num:this.props.maxValues-this.props.values.length}})),this.props.buttonSubmitText?t=this.props.buttonSubmitText:null!=this.props.maxValues&&(t=i.a.createElement(s.c,{id:"multiselect.go",defaultMessage:"Go"}));var f,d,m,h=[];this.props.noteText&&(m=i.a.createElement("div",{className:"multi-select__note"},i.a.createElement("div",{className:"note__icon"},i.a.createElement(s.c,{id:"generic_icons.info",defaultMessage:"Info Icon"},function(e){return i.a.createElement("span",{className:"fa fa-info",title:e})})),i.a.createElement("div",null,this.props.noteText)));for(var b,y={},g=0;g<p.length;g++)y[p[g].id]=!0;for(var E=r.length-1;E>=0;E--)y[r[E].id]&&r.splice(E,1);if(r&&r.length>this.props.perPage){var _=this.state.page*this.props.perPage,O=_+this.props.perPage;h=r.slice(_,O),this.props.loading||(r.length>O&&(f=i.a.createElement("button",{className:"btn btn-link filter-control filter-control__next",onClick:this.nextPage},i.a.createElement(s.c,{id:"filtered_user_list.next",defaultMessage:"Next"}))),this.state.page>0&&(d=i.a.createElement("button",{className:"btn btn-link filter-control filter-control__prev",onClick:this.prevPage},i.a.createElement(s.c,{id:"filtered_user_list.prev",defaultMessage:"Previous"}))))}else h=r;return l&&l.length&&a&&(b=i.a.createElement(s.c,{id:"multiselect.numMembers",defaultMessage:"{memberOptions, number} of {totalCount, number} members",values:{memberOptions:h.length,totalCount:this.props.totalCount}})),i.a.createElement("div",{className:"filtered-user-list"},i.a.createElement("div",{className:"filter-row filter-row--full"},i.a.createElement("div",{className:"multi-select__container"},i.a.createElement(c.a,{id:"selectItems",ref:"reactSelect",isMulti:!0,options:this.props.options,styles:M,components:{Menu:N,IndicatorsContainer:N,MultiValueLabel:R(this.props.valueRenderer)},isClearable:!1,openMenuOnFocus:!1,menuIsOpen:!1,onInputChange:this.onInput,onKeyDown:this.onInputKeyDown,onChange:this.onChange,value:this.props.values,placeholder:this.props.placeholderText,inputValue:this.state.input,getOptionValue:function(e){return e.id},getOptionLabel:function(e){return n.props.ariaLabelRenderer(e)},"aria-label":this.props.placeholderText,className:this.state.a11yActive?"multi-select__focused":""}),i.a.createElement(u.a,{id:"saveItems",saving:this.props.saving,disabled:this.props.saving,onClick:this.handleOnClick,defaultMessage:t,savingMessage:this.props.buttonSubmitLoadingText})),i.a.createElement("div",{className:"multi-select__help"},e,b),i.a.createElement("div",{className:"multi-select__help"},m)),i.a.createElement(v,{ref:"list",options:h,optionRenderer:this.props.optionRenderer,ariaLabelRenderer:this.props.ariaLabelRenderer,page:this.state.page,perPage:this.props.perPage,onPageChange:this.props.handlePageChange,onAdd:this.onAdd,onSelect:this.onSelect,loading:this.props.loading}),i.a.createElement("div",{className:"filter-controls"},d,f))}}])&&w(n.prototype,r),o&&w(n,o),t}();j(k,"propTypes",{users:o.a.arrayOf(o.a.object),totalCount:o.a.number,options:o.a.arrayOf(o.a.object),optionRenderer:o.a.func,values:o.a.arrayOf(o.a.object),valueRenderer:o.a.func,ariaLabelRenderer:o.a.func.isRequired,handleInput:o.a.func,handleDelete:o.a.func,perPage:o.a.number,handlePageChange:o.a.func,handleAdd:o.a.func,handleSubmit:o.a.func,noteText:o.a.node,maxValues:o.a.number,numRemainingText:o.a.node,buttonSubmitText:o.a.node,buttonSubmitLoadingText:o.a.node,submitImmediatelyOn:o.a.func,saving:o.a.bool,loading:o.a.bool,placeholderText:o.a.string}),j(k,"defaultProps",{ariaLabelRenderer:function(e){if(!e)return null;return e.label}});var N=function(){return null},R=function(e){return function(t){return i.a.createElement("div",{style:{paddingRight:"5px",paddingLeft:"5px",borderRight:"1px solid rgba(0, 126, 255, 0.24)"}},i.a.createElement(e,t))}},M={container:function(){return{display:"table-cell",paddingRight:"15px",verticalAlign:"top",width:"100%"}},control:function(e){return E({},e,{borderRadius:"1px",borderColor:"hsl(0,0%,80%)",minHeight:"36px","&:hover":{},boxShadow:"",backgroundColor:"hsl(0,0%,100%)"})},multiValue:function(e){return E({},e,{whiteSpace:"nowrap",border:"1px solid rgba(0, 126, 255, 0.24)",backgroundColor:"rgba(0, 126, 255, 0.08)",color:"#007eff"})},multiValueRemove:function(e){return E({},e,{":hover":{backgroundColor:"rgba(0, 126, 255, 0.15)"}})}}},1575:function(e,t,n){"use strict";n.d(t,"a",function(){return p});n(88),n(43);var r=n(7),o=n.n(r),a=n(55);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),c(this,l(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,o.a.PureComponent),n=t,(r=[{key:"render",value:function(){return o.a.createElement("span",this.props,o.a.createElement(a.c,{id:"generic_icons.archive",defaultMessage:"Archive Icon"},function(e){return o.a.createElement("svg",{width:"14",height:"14",viewBox:"0 0 14 14",role:"icon","aria-label":e},o.a.createElement("path",{d:"M8.5 6.5q0-0.203-0.148-0.352t-0.352-0.148h-2q-0.203 0-0.352 0.148t-0.148 0.352 0.148 0.352 0.352 0.148h2q0.203 0 0.352-0.148t0.148-0.352zM13 5v7.5q0 0.203-0.148 0.352t-0.352 0.148h-11q-0.203 0-0.352-0.148t-0.148-0.352v-7.5q0-0.203 0.148-0.352t0.352-0.148h11q0.203 0 0.352 0.148t0.148 0.352zM13.5 1.5v2q0 0.203-0.148 0.352t-0.352 0.148h-12q-0.203 0-0.352-0.148t-0.148-0.352v-2q0-0.203 0.148-0.352t0.352-0.148h12q0.203 0 0.352 0.148t0.148 0.352z"}))}))}}])&&s(n.prototype,r),i&&s(n,i),t}()},1578:function(e,t,n){"use strict";n.d(t,"a",function(){return p});n(88),n(43);var r=n(7),o=n.n(r),a=n(55);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),c(this,l(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,o.a.PureComponent),n=t,(r=[{key:"render",value:function(){return o.a.createElement(a.c,{id:"generic_icons.success",defaultMessage:"Success Icon"},function(e){return o.a.createElement("i",{className:"fa fa-check",title:e})})}}])&&s(n.prototype,r),i&&s(n,i),t}()},1580:function(e,t,n){"use strict";function r(e,t){return e.views.modals.modalState[t]&&e.views.modals.modalState[t].open}n.d(t,"a",function(){return r})},1581:function(e,t,n){"use strict";n.d(t,"a",function(){return p});n(88),n(43);var r=n(7),o=n.n(r),a=n(55);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),c(this,l(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,o.a.PureComponent),n=t,(r=[{key:"render",value:function(){return o.a.createElement(a.c,{id:"generic_icons.add",defaultMessage:"Add Icon"},function(e){return o.a.createElement("i",{className:"fa fa-plus",title:e})})}}])&&s(n.prototype,r),i&&s(n,i),t}()},1588:function(e,t,n){"use strict";n(88),n(43),n(32);var r=n(417),o=n(96),a=n(30),i=n.n(a),s=n(7),c=n.n(s);function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),p(this,f(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(t,c.a.Component),n=t,(r=[{key:"render",value:function(){return this.props.hasPermission&&!this.props.invert?this.props.children:!this.props.hasPermission&&this.props.invert?this.props.children:null}}])&&u(n.prototype,r),o&&u(n,o),t}();m(h,"defaultProps",{invert:!1}),m(h,"propTypes",{teamId:i.a.string,permissions:i.a.arrayOf(i.a.string).isRequired,hasPermission:i.a.bool.isRequired,invert:i.a.bool.isRequired,children:i.a.node.isRequired});t.a=Object(r.connect)(function(e,t){if(!t.teamId)return{hasPermission:!1};var n=!0,r=!1,a=void 0;try{for(var i,s=t.permissions[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var c=i.value;if(Object(o.haveITeamPermission)(e,{team:t.teamId,permission:c}))return{hasPermission:!0}}}catch(e){r=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw a}}return{hasPermission:!1}})(h)},1589:function(e,t,n){"use strict";n.d(t,"c",function(){return o}),n.d(t,"b",function(){return a}),n.d(t,"a",function(){return i});var r=n(0),o=function(){return function(e){return e({type:r.e.TOGGLE_LHS})}},a=function(){return function(e){return e({type:r.e.OPEN_LHS})}},i=function(){return function(e){return e({type:r.e.CLOSE_LHS})}}},1590:function(e,t,n){"use strict";(function(e){n.d(t,"b",function(){return V}),n.d(t,"a",function(){return W}),n.d(t,"d",function(){return z}),n.d(t,"i",function(){return Y}),n.d(t,"c",function(){return Q}),n.d(t,"f",function(){return X}),n.d(t,"g",function(){return $}),n.d(t,"e",function(){return ee}),n.d(t,"j",function(){return te}),n.d(t,"h",function(){return ne});n(107),n(106),n(43),n(44),n(300),n(301),n(947),n(422),n(185),n(74),n(120),n(32),n(33),n(419),n(305),n(155),n(24);var r=n(147),o=n(6),a=n(14),i=n(75),s=n(251),c=n(65),l=n(109),u=n(303),p=n(35),f=n(31),d=n(12),m=n(34),h=n(25),b=n(16),y=n(62),g=n(97),v=n(1501),E=n(1893),_=n(304),O=n(1510),w=n(119),C=n(1523),S=n(1492),P=n(423),j=n(215),T=n(307),k=n(13),N=n(1734),R=n(1871),M=n(0),I=n(420),x=n(302),A=n(2369),L=n(1733);function D(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function U(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){q(e,t,n[t])})}return e}function q(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var H=k.a.dispatch,F=k.a.getState,B=7,G={};function V(){if(window.WebSocket){var e=Object(h.getConfig)(F()),t="";e.WebsocketURL?t=e.WebsocketURL:("https:"===(t=new URL(Object(x.e)())).protocol?t.protocol="wss:":t.protocol="ws:",/:\d+$/.test(t.host)||("wss:"===t.protocol?t.host+=":"+e.WebsocketSecurePort:t.host+=":"+e.WebsocketPort),t=t.toString()),t.length>0&&"/"===t[t.length-1]&&(t=t.substring(0,t.length-1)),t+=f.Client4.getUrlVersion()+"/websocket",N.a.setEventCallback(ae),N.a.setFirstConnectCallback(re),N.a.setReconnectCallback(function(){return Q(!1)}),N.a.setMissedEventCallback(function(){return Q(!1)}),N.a.setCloseCallback(oe),N.a.initialize(t)}else console.log("Browser does not support websocket")}function W(){N.a.close()}var K={};function z(e,t){K[e]=t}function Y(e){Reflect.deleteProperty(K,e)}function Q(){(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&(W(),V()),H({type:o.GeneralTypes.WEBSOCKET_SUCCESS,timestamp:Date.now()}),Object(R.c)(),Object.values(K).forEach(function(e){e&&"function"==typeof e&&e()});var e=F();if(e.entities.teams.currentTeamId){var t=Object(b.getCurrentChannelId)(e),n=Object(y.getMostRecentPostIdInChannel)(e,t),r=Object(y.getPost)(e,n);H(Object(C.d)()),H(r?Object(O.n)(t,r.create_at):Object(c.getPosts)(t)),j.a(),H(u.getMyTeamUnreads())}e.websocket.lastDisconnectAt&&H(Object(p.checkForModifiedUsers)()),H(Object(E.b)()),H(Object(l.clearErrors)())}var Z="",J=9e5;function X(){clearInterval(Z),Z=setInterval(function(){null!=Object(d.getCurrentUser)(F())&&Q(!1)},J)}function $(){clearInterval(Z)}function ee(e,t,n){G[e]||(G[e]={}),G[e][t]=n}function te(e,t){var n=G[e];n&&Reflect.deleteProperty(n,t)}function ne(e){Reflect.deleteProperty(G,e)}function re(){H(Object(r.batchActions)([{type:o.GeneralTypes.WEBSOCKET_SUCCESS,timestamp:Date.now()},Object(l.clearErrors)()]))}function oe(e){e>B&&H(Object(l.logError)({type:"critical",message:M.g.WEBSOCKET_PORT_ERROR},!0)),H(Object(r.batchActions)([{type:o.GeneralTypes.WEBSOCKET_FAILURE,timestamp:Date.now()},Object(E.a)()]))}function ae(t){switch(t.event){case M.E.POSTED:case M.E.EPHEMERAL_MESSAGE:pe(t);break;case M.E.POST_EDITED:!function(e){var t=JSON.parse(e.data.post);H(Object(c.receivedPost)(t)),Object(c.getProfilesAndStatusesForPosts)([t],H,F);var n=Object(b.getCurrentChannelId)(F());n===e.broadcast.channel_id&&window.isActive&&H(Object(i.viewChannel)(n))}(t);break;case M.E.POST_DELETED:!function(e){var t=JSON.parse(e.data.post);H(Object(c.postDeleted)(t))}(t);break;case M.E.LEAVE_TEAM:!function(t){var n=F();H(Object(r.batchActions)([{type:o.UserTypes.RECEIVED_PROFILE_NOT_IN_TEAM,data:{id:t.data.team_id,user_id:t.data.user_id}},{type:o.TeamTypes.REMOVE_MEMBER_FROM_TEAM,data:{team_id:t.data.team_id,user_id:t.data.user_id}}])),Object(d.getCurrentUserId)(n)===t.data.user_id&&(H({type:o.TeamTypes.LEAVE_TEAM,data:{id:t.data.team_id}}),Object(m.getCurrentTeamId)(n)===t.data.team_id&&(e.location.pathname.startsWith("/admin_console")||S.f()))}(t);break;case M.E.UPDATE_TEAM:!function(e){H({type:o.TeamTypes.UPDATED_TEAM,data:JSON.parse(e.data.team)})}(t);break;case M.E.DELETE_TEAM:!function(e){var t=JSON.parse(e.data.team),n=k.a.getState(),a=n.entities.teams.teams;if(t&&a&&a[t.id]&&0===a[t.id].delete_at){var i=n.entities.users.currentUserId,s=n.entities.teams,c=s.currentTeamId,l=s.myMembers,u=Object.values(l),p=u.find(function(e){return e.user_id===i&&e.team_id===c}),f="";if(t&&p&&t.id===p.team_id){var d={};Object(m.getMyTeams)(n).forEach(function(e){d[e.id]=e});for(var h=0;h<u.length;h++){var y=u[h].team_id;if(d&&d[y]&&0===d[y].delete_at&&t.id!==y){f=y;break}}}if(H(Object(r.batchActions)([{type:o.TeamTypes.RECEIVED_TEAM_DELETED,data:{id:t.id}},{type:o.TeamTypes.UPDATED_TEAM,data:t}])),f){H({type:o.TeamTypes.SELECT_TEAM,data:f});var g=F(),v=Object(b.getRedirectChannelNameForTeam)(g,f);w.a.push("".concat(Object(m.getCurrentTeamUrl)(g),"/channels/").concat(v))}else w.a.push("/")}}(t);break;case M.E.ADDED_TO_TEAM:!function(e){fe.apply(this,arguments)}(t);break;case M.E.USER_ADDED:!function(e){var t=Object(b.getCurrentChannelId)(F());t===e.broadcast.channel_id&&(H(Object(i.getChannelStats)(t)),H({type:o.UserTypes.RECEIVED_PROFILE_IN_CHANNEL,data:{id:e.broadcast.channel_id,user_id:e.data.user_id}}));var n=Object(m.getCurrentTeamId)(F()),r=Object(d.getCurrentUserId)(F());n===e.data.team_id&&r===e.data.user_id&&H(Object(i.getChannelAndMyMember)(e.broadcast.channel_id))}(t);break;case M.E.USER_REMOVED:!function(e){var t=F(),n=Object(b.getCurrentChannel)(t)||{},r=Object(d.getCurrentUserId)(t);if(e.broadcast.user_id===r){H(Object(C.d)());var a=Object(g.n)(t);if(e.data.channel_id===a&&H(Object(_.b)()),e.data.channel_id===n.id)if(e.data.remover_id===e.broadcast.user_id)w.a.push(Object(m.getCurrentRelativeTeamUrl)(t));else{var s=Object(d.getUser)(t,e.data.remover_id)||{};H(Object(v.b)({modalId:M.r.REMOVED_FROM_CHANNEL,dialogType:A.a,dialogProps:{channelName:n.display_name,remover:s.username}}))}H({type:o.ChannelTypes.LEAVE_CHANNEL,data:{id:e.data.channel_id,user_id:e.broadcast.user_id}})}else e.broadcast.channel_id===n.id&&(H(Object(i.getChannelStats)(n.id)),H({type:o.UserTypes.RECEIVED_PROFILE_NOT_IN_CHANNEL,data:{id:e.broadcast.channel_id,user_id:e.data.user_id}}))}(t);break;case M.E.USER_UPDATED:!function(e){var t=Object(d.getCurrentUser)(F()),n=e.data.user;t.id===n.id?n.update_at>t.update_at&&Object(p.getMe)()(H,F):H({type:o.UserTypes.RECEIVED_PROFILE,data:n})}(t);break;case M.E.ROLE_ADDED:!function(e){var t=JSON.parse(e.data.role);H({type:o.RoleTypes.RECEIVED_ROLE,data:t})}(t);break;case M.E.ROLE_REMOVED:!function(e){var t=JSON.parse(e.data.role);H({type:o.RoleTypes.ROLE_DELETED,data:t})}(t);break;case M.E.MEMBERROLE_UPDATED:!function(e){H({type:o.TeamTypes.RECEIVED_MY_TEAM_MEMBER,data:e.data.member})}(t);break;case M.E.ROLE_UPDATED:!function(e){var t=JSON.parse(e.data.role);H({type:o.RoleTypes.RECEIVED_ROLE,data:t})}(t);break;case M.E.CHANNEL_CREATED:!function(e){var t=e.data.channel_id,n=e.data.team_id,r=F();Object(m.getCurrentTeamId)(r)!==n||Object(b.getChannel)(r,t)||H(Object(i.getChannelAndMyMember)(t))}(t);break;case M.E.CHANNEL_DELETED:!function(e){var t=F(),n="true"===Object(h.getConfig)(t).ExperimentalViewArchivedChannels;if(Object(b.getCurrentChannelId)(t)===e.data.channel_id&&!n){var r=Object(m.getCurrentRelativeTeamUrl)(t),a=Object(m.getCurrentTeamId)(t),i=Object(b.getRedirectChannelNameForTeam)(t,a);w.a.push(r+"/channels/"+i)}H({type:o.ChannelTypes.RECEIVED_CHANNEL_DELETED,data:{id:e.data.channel_id,team_id:e.broadcast.team_id,deleteAt:e.data.delete_at,viewArchivedChannels:n}})}(t);break;case M.E.CHANNEL_CONVERTED:!function(e){var t=e.data.channel_id;if(t){var n=Object(b.getChannel)(F(),t);n&&H({type:o.ChannelTypes.RECEIVED_CHANNEL,data:U({},n,{type:a.General.PRIVATE_CHANNEL})})}}(t);break;case M.E.CHANNEL_UPDATED:1;break;case M.E.CHANNEL_MEMBER_UPDATED:!function(e){var t=JSON.parse(e.data.channelMember);H({type:o.ChannelTypes.RECEIVED_MY_CHANNEL_MEMBER,data:t})}(t);break;case M.E.DIRECT_ADDED:!function(e){H(Object(i.getChannelAndMyMember)(e.broadcast.channel_id))}(t);break;case M.E.PREFERENCE_CHANGED:!function(e){var t=JSON.parse(e.data.preference);H({type:o.PreferenceTypes.RECEIVED_PREFERENCES,data:[t]}),de(t)&&Object(T.j)()}(t);break;case M.E.PREFERENCES_CHANGED:!function(e){var t=JSON.parse(e.data.preferences);H({type:o.PreferenceTypes.RECEIVED_PREFERENCES,data:t}),-1!==t.findIndex(de)&&Object(T.j)()}(t);break;case M.E.PREFERENCES_DELETED:!function(e){var t=JSON.parse(e.data.preferences);H({type:o.PreferenceTypes.DELETED_PREFERENCES,data:t})}(t);break;case M.E.TYPING:H(function(e){return function(t,n){var r=n(),o=Object(h.getConfig)(r),i=Object(d.getCurrentUserId)(r),s=e.data.user_id,c={id:e.broadcast.channel_id+e.data.parent_id,userId:s,now:Date.now()};t({type:a.WebsocketEvents.TYPING,data:c}),setTimeout(function(){t({type:a.WebsocketEvents.STOP_TYPING,data:c})},parseInt(o.TimeBetweenUserTypingUpdatesMilliseconds,10)),s!==i&&t(Object(p.getMissingProfilesByIds)([s]));var l=Object(d.getStatusForUserId)(r,s);l!==a.General.ONLINE&&t(Object(p.getStatusesByIds)([s]))}}(t));break;case M.E.STATUS_CHANGED:!function(e){H({type:o.UserTypes.RECEIVED_STATUSES,data:[{user_id:e.data.user_id,status:e.data.status}]})}(t);break;case M.E.HELLO:!function(e){Object(s.setServerVersion)(e.data.server_version)(H,F)}(t);break;case M.E.REACTION_ADDED:!function(e){var t=JSON.parse(e.data.reaction);H(Object(c.getCustomEmojiForReaction)(t.emoji_name)),H({type:o.PostTypes.RECEIVED_REACTION,data:t})}(t);break;case M.E.REACTION_REMOVED:!function(e){var t=JSON.parse(e.data.reaction);H({type:o.PostTypes.REACTION_DELETED,data:t})}(t);break;case M.E.EMOJI_ADDED:!function(e){var t=JSON.parse(e.data.emoji);H({type:o.EmojiTypes.RECEIVED_CUSTOM_EMOJI,data:t})}(t);break;case M.E.CHANNEL_VIEWED:!function(e){window.isActive&&Object(b.getCurrentChannelId)(F())===e.data.channel_id||Object(d.getCurrentUserId)(F())!==e.broadcast.user_id||H(Object(i.markChannelAsRead)(e.data.channel_id,"",!1))}(t);break;case M.E.PLUGIN_ENABLED:!function(e){var t=e.data.manifest;k.a.dispatch({type:M.e.RECEIVED_WEBAPP_PLUGIN,data:t}),Object(R.b)(t).catch(function(e){console.error(e.message)})}(t);break;case M.E.PLUGIN_DISABLED:!function(e){var t=e.data.manifest;k.a.dispatch({type:M.e.REMOVED_WEBAPP_PLUGIN,data:t}),Object(R.d)(t)}(t);break;case M.E.USER_ROLE_UPDATED:!function(t){var n=k.a.getState().entities.users.profiles[t.data.user_id];if(n){var r=t.data.roles,a=n.roles.includes(M.i.PERMISSIONS_SYSTEM_ADMIN)&&!r.includes(M.i.PERMISSIONS_SYSTEM_ADMIN);k.a.dispatch({type:o.UserTypes.RECEIVED_PROFILE,data:U({},n,{roles:r})}),a&&e.location.pathname.startsWith("/admin_console")&&S.f()}}(t);break;case M.E.CONFIG_CHANGED:!function(e){k.a.dispatch({type:o.GeneralTypes.CLIENT_CONFIG_RECEIVED,data:e.data.config})}(t);break;case M.E.LICENSE_CHANGED:!function(e){k.a.dispatch({type:o.GeneralTypes.CLIENT_LICENSE_RECEIVED,data:e.data.license})}(t);break;case M.E.PLUGIN_STATUSES_CHANGED:!function(e){k.a.dispatch({type:o.AdminTypes.RECEIVED_PLUGIN_STATUSES,data:e.data.plugin_statuses})}(t);break;case M.E.OPEN_DIALOG:!function(e){var t=e.data&&e.data.dialog||{},n=JSON.parse(t);k.a.dispatch({type:o.IntegrationTypes.RECEIVED_DIALOG,data:n});var r=F().entities.integrations.dialogTriggerId;if(n.trigger_id!==r)return;k.a.dispatch(Object(v.b)({modalId:M.r.INTERACTIVE_DIALOG,dialogType:L.a}))}(t)}Object.values(G).forEach(function(e){e&&e.hasOwnProperty(t.event)&&"function"==typeof e[t.event]&&e[t.event](t)})}var ie,se,ce,le,ue,pe=(ie=100,ce=[],le=0,ue=function(){se=null,ce.length>0&&H(function(e){return function(t,n){var o=e.map(function(e){return JSON.parse(e.data.post)}),a=o.map(c.receivedNewPost);t(Object(r.batchActions)(a)),Object(c.getProfilesAndStatusesForPosts)(o,t,n)}}(ce)),ce=[],le=0},function(e){se&&le>2?(ce.push(e)>200&&(ce=[],console.log("channel broken because of too many incoming messages")),clearTimeout(se),se=setTimeout(ue,ie)):(le+=1,H(function(e){return function(t,n){var r=JSON.parse(e.data.post);t(Object(P.e)(r,e)),Object(c.getProfilesAndStatusesForPosts)([r],t,n),r.user_id===Object(d.getCurrentUserId)(n())||Object(I.e)(r)||t({type:o.UserTypes.RECEIVED_STATUSES,data:[{user_id:r.user_id,status:M.O.ONLINE}]})}}(e)),clearTimeout(se),se=setTimeout(ue,ie))});function fe(){var e;return e=regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H(u.getTeam(t.data.team_id));case 2:return e.next=4,H(u.getMyTeamMembers());case 4:return e.next=6,H(u.getMyTeamUnreads());case 6:case"end":return e.stop()}},e)}),(fe=function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){D(a,r,o,i,s,"next",e)}function s(e){D(a,r,o,i,s,"throw",e)}i(void 0)})}).apply(this,arguments)}function de(e){return e.category===M.i.Preferences.CATEGORY_DIRECT_CHANNEL_SHOW&&"true"===e.value}}).call(this,n(41))},1594:function(e,t,n){"use strict";n.d(t,"a",function(){return b});n(88),n(43),n(32),n(33),n(24),n(44),n(209),n(305),n(74);var r=n(30),o=n.n(r),a=n(7),i=n.n(a),s=n(23),c=n(1769);function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var b=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=f(t).call(this,e),n=!o||"object"!==l(o)&&"function"!=typeof o?d(r):o,h(d(n),"handleLoad",function(e){if(n.mounted){var t=e.target;n.props.onImageLoaded&&t.naturalHeight&&n.props.onImageLoaded({height:t.naturalHeight,width:t.naturalWidth}),n.setState({loaded:!0,error:!1})}}),h(d(n),"handleError",function(){n.mounted&&(n.props.onImageLoadFail&&n.props.onImageLoadFail(),n.setState({error:!0}))}),h(d(n),"onEnterKeyDown",function(e){"Enter"===e.key&&n.props.onClick(e)}),h(d(n),"renderImageLoaderIfNeeded",function(){return n.state.loaded||!n.props.showLoader||n.state.error?null:i.a.createElement("div",{style:{position:"absolute",top:"50%",transform:"translate(-50%, -50%)",left:"50%"}},i.a.createElement(c.a,{containerClass:"file__image-loading"}))}),h(d(n),"renderImageOrPlaceholder",function(){var e,t=n.props,r=t.dimensions,o=t.fileInfo,a=t.src,c=u(t,["dimensions","fileInfo","src"]),l={},p=Object(s.ab)("file_attachment.thumbnail","file thumbnail");return o&&(p+=" ".concat(o.name).toLowerCase()),r&&r.width&&!n.state.loaded&&(e=i.a.createElement("div",{className:"image-loading__container ".concat(n.props.className),style:{maxWidth:r.width}},i.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(r.width," ").concat(r.height),style:{verticalAlign:"middle",maxHeight:r.height,maxWidth:r.width}}))),Reflect.deleteProperty(c,"showLoader"),Reflect.deleteProperty(c,"onImageLoaded"),Reflect.deleteProperty(c,"onImageLoadFail"),!n.state.loaded&&r&&(l={position:"absolute",top:0,height:1,width:1,visibility:"hidden",overflow:"hidden"}),i.a.createElement(i.a.Fragment,null,e,i.a.createElement("div",{className:"style--none file-preview__button",style:l},i.a.createElement("img",Object.assign({},c,{"aria-label":p,tabIndex:"0",onKeyDown:n.onEnterKeyDown,className:n.props.className,src:a,onError:n.handleError,onLoad:n.handleLoad}))))}),n.state={loaded:!1},n.heightTimeout=0,n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(t,i.a.PureComponent),n=t,(r=[{key:"componentDidMount",value:function(){this.mounted=!0}},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"render",value:function(){return i.a.createElement(i.a.Fragment,null,this.renderImageLoaderIfNeeded(),this.renderImageOrPlaceholder())}}])&&p(n.prototype,r),o&&p(n,o),t}();h(b,"propTypes",{src:o.a.string.isRequired,dimensions:o.a.object,fileInfo:o.a.object,showLoader:o.a.bool,onImageLoaded:o.a.func,onImageLoadFail:o.a.func,onClick:o.a.func,className:o.a.string})},1597:function(e,t,n){"use strict";n.d(t,"a",function(){return m});n(88),n(43),n(32),n(33),n(24),n(44),n(209);var r=n(7),o=n.n(r),a=n(30),i=n.n(a);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m(e){var t=function(t){function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),u(this,p(n).apply(this,arguments))}var r,a,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(n,o.a.PureComponent),r=n,(a=[{key:"render",value:function(){var t=this.props,n=t.id,r=t.show,a=t.icon,i=t.text,s=c(t,["id","show","icon","text"]);if(!r)return null;var l=i;return a&&(l=o.a.createElement(o.a.Fragment,null,o.a.createElement("span",{className:"icon"},a),i)),o.a.createElement("li",{className:"MenuItem",role:"menuitem",id:n},o.a.createElement(e,Object.assign({text:l},s)))}}])&&l(r.prototype,a),i&&l(r,i),n}();return d(t,"propTypes",{show:i.a.bool,id:i.a.string,icon:i.a.node,text:i.a.string}),d(t,"defaultProps",{show:!0}),t}},1598:function(e,t,n){"use strict";n.d(t,"c",function(){return h}),n.d(t,"e",function(){return y}),n.d(t,"b",function(){return v}),n.d(t,"d",function(){return _}),n.d(t,"a",function(){return w});n(106),n(32),n(33),n(24),n(44),n(107);var r=n(1784),o=n.n(r),a=n(1511),i=n(35),s=n(12),c=n(0),l=n(1501),u=n(1733),p=n(13);function f(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function d(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){f(a,r,o,i,s,"next",e)}function s(e){f(a,r,o,i,s,"throw",e)}i(void 0)})}}var m=100;function h(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:m;return function(){var r=d(regeneratorRuntime.mark(function r(o){var i,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,o(a.getIncomingHooks(e,t,n));case 2:i=r.sent,(s=i.data)&&o(b(s));case 5:case"end":return r.stop()}},r)}));return function(e){return r.apply(this,arguments)}}()}function b(e){return function(){var t=d(regeneratorRuntime.mark(function t(n,r){var o,a,c,l,u;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:for(o=r(),a={},c=0;c<e.length;c++)l=e[c],Object(s.getUser)(o,l.user_id)||(a[l.user_id]=!0);if(0!==(u=Object.keys(a)).length){t.next=6;break}return t.abrupt("return");case 6:n(Object(i.getProfilesByIds)(u));case 7:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()}function y(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:m;return function(){var r=d(regeneratorRuntime.mark(function r(o){var i,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,o(a.getOutgoingHooks("",e,t,n));case 2:i=r.sent,(s=i.data)&&o(g(s));case 5:case"end":return r.stop()}},r)}));return function(e){return r.apply(this,arguments)}}()}function g(e){return function(){var t=d(regeneratorRuntime.mark(function t(n,r){var o,a,c,l,u;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:for(o=r(),a={},c=0;c<e.length;c++)l=e[c],Object(s.getUser)(o,l.creator_id)||(a[l.creator_id]=!0);if(0!==(u=Object.keys(a)).length){t.next=6;break}return t.abrupt("return");case 6:n(Object(i.getProfilesByIds)(u));case 7:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()}function v(e){return function(){var t=d(regeneratorRuntime.mark(function t(n){var r,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n(a.getCustomTeamCommands(e));case 2:r=t.sent,(o=r.data)&&n(E(o));case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}function E(e){return function(){var t=d(regeneratorRuntime.mark(function t(n,r){var o,a,c,l,u;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:for(o=r(),a={},c=0;c<e.length;c++)l=e[c],Object(s.getUser)(o,l.creator_id)||(a[l.creator_id]=!0);if(0!==(u=Object.keys(a)).length){t.next=6;break}return t.abrupt("return");case 6:n(Object(i.getProfilesByIds)(u));case 7:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()}function _(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:m;return function(){var n=d(regeneratorRuntime.mark(function n(r){var o,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r(a.getOAuthApps(e,t));case 2:o=n.sent,(i=o.data)&&r(O(i));case 5:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()}function O(e){return function(){var t=d(regeneratorRuntime.mark(function t(n,r){var o,a,c,l,u;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:for(o=r(),a={},c=0;c<e.length;c++)l=e[c],Object(s.getUser)(o,l.creator_id)||(a[l.creator_id]=!0);if(0!==(u=Object.keys(a)).length){t.next=6;break}return t.abrupt("return");case 6:n(Object(i.getProfilesByIds)(u));case 7:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()}function w(e,t,n,r){o.a.get("https://www.googleapis.com/youtube/v3/videos").query({part:"snippet",id:t,key:e}).end(function(e,t){return e?r(e):(t.body||console.error("Missing response body for getYoutubeVideoInfo"),n(t.body))})}var C="";p.a.subscribe(function(){var e=p.a.getState(),t=e.entities.integrations.dialogTriggerId;t!==C&&(C=t,(e.entities.integrations.dialog||{}).trigger_id===t&&p.a.dispatch(Object(l.b)({modalId:c.r.INTERACTIVE_DIALOG,dialogType:u.a})))})},1599:function(e,t,n){"use strict";n.d(t,"a",function(){return p});n(88),n(43);var r=n(7),o=n.n(r),a=n(55);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),c(this,l(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,o.a.PureComponent),n=t,(r=[{key:"render",value:function(){return o.a.createElement("span",this.props,o.a.createElement(a.c,{id:"generic_icons.search",defaultMessage:"Search Icon"},function(e){return o.a.createElement("svg",{width:"14px",height:"14px",viewBox:"0 0 19 18",role:"icon","aria-label":e},o.a.createElement("g",{stroke:"inherit",strokeWidth:"1",fill:"none",fillRule:"evenodd"},o.a.createElement("g",{transform:"translate(-719.000000, -20.000000)",strokeWidth:"1.5"},o.a.createElement("g",{transform:"translate(0.000000, 1.000000)"},o.a.createElement("g",{transform:"translate(63.000000, 10.000000)"},o.a.createElement("g",{transform:"translate(657.000000, 10.000000)"},o.a.createElement("circle",{cx:"7",cy:"7",r:"7"}),o.a.createElement("path",{d:"M12.5,11.5 L16.5,15.5",strokeLinecap:"round"})))))))}))}}])&&s(n.prototype,r),i&&s(n,i),t}()},1600:function(e,t,n){"use strict";n.d(t,"a",function(){return p});n(88),n(43);var r=n(7),o=n.n(r),a=n(55);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),c(this,l(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,o.a.PureComponent),n=t,(r=[{key:"render",value:function(){return o.a.createElement(a.c,{id:"generic_icons.back",defaultMessage:"Back Icon"},function(e){return o.a.createElement("i",{className:"fa fa-angle-left",title:e})})}}])&&s(n.prototype,r),i&&s(n,i),t}()},1602:function(e,t,n){"use strict";n.d(t,"a",function(){return d});n(88),n(43),n(32),n(33),n(24),n(44),n(209);var r=n(30),o=n.n(r),a=n(7),i=n.n(a);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var d=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=u(t).call(this,e))||"object"!==s(o)&&"function"!=typeof o?p(r):o).show=n.show.bind(p(n)),n.hide=n.hide.bind(p(n)),n.state={show:!1},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(t,i.a.Component),n=t,(r=[{key:"show",value:function(e){e&&e.preventDefault(),this.setState({show:!0})}},{key:"hide",value:function(){this.setState({show:!1})}},{key:"render",value:function(){var e,t=this,n=this.props,r=n.children,o=n.dialogType,a=n.dialogProps,s=n.onClick,l=c(n,["children","dialogType","dialogProps","onClick"]),u=this.show;return s&&(u=function(e){s(),t.show(e)}),this.state.show&&(e=i.a.createElement(o,Object.assign({},a,{onHide:function(){t.hide(),a.onHide&&a.onHide()}}))),i.a.createElement("button",Object.assign({},l,{className:"style--none "+l.className,onClick:u}),r,e)}}])&&l(n.prototype,r),o&&l(n,o),t}();d.propTypes={children:o.a.node.isRequired,dialogType:o.a.func.isRequired,dialogProps:o.a.object,onClick:o.a.func,className:o.a.string},d.defaultProps={dialogProps:{},className:""}},1614:function(e,t,n){"use strict";n(88),n(43);var r=n(30),o=n.n(r),a=n(7),i=n.n(a),s=n(55);function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return!t||"object"!==c(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var d=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),u(this,p(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(t,i.a.PureComponent),n=t,(r=[{key:"render",value:function(){return i.a.createElement("span",this.props,i.a.createElement(s.c,{id:"mobile.set_status.away.icon",defaultMessage:"Away Icon"},function(e){return i.a.createElement("svg",{width:"13px",height:"13px",viewBox:"0 0 12 12",style:m,role:"icon","aria-label":e},i.a.createElement("path",{className:"away--icon",d:"M9.081,5.712C9.267,5.712 9.417,5.863 9.417,6.048L9.417,9.086L11.864,10.499C12.025,10.592 12.08,10.797 11.987,10.958L11.482,11.832C11.39,11.993 11.184,12.048 11.023,11.955L7.904,10.154C7.788,10.087 7.727,9.961 7.737,9.836C7.736,9.827 7.736,9.818 7.736,9.809L7.736,6.048C7.736,5.863 7.886,5.712 8.072,5.712L9.081,5.712ZM4.812,11.513L4.605,11.513C2.325,11.41 0.253,10.374 0.046,9.027C-0.058,8.923 0.046,8.509 0.046,8.405C0.15,7.576 0.357,6.437 0.771,5.815C0.978,5.401 2.015,5.297 2.015,5.297C2.015,5.297 2.015,7.369 4.605,7.369L5.019,7.369C4.915,7.784 4.812,8.198 4.812,8.612C4.812,9.648 5.226,10.581 5.848,11.41C5.537,11.513 5.123,11.513 4.812,11.513ZM4.605,0.117C6.034,0.117 7.195,1.277 7.195,2.707C7.195,4.136 6.034,5.297 4.605,5.297C3.175,5.297 2.015,4.136 2.015,2.707C2.015,1.277 3.175,0.117 4.605,0.117Z"}))}))}}])&&l(n.prototype,r),o&&l(n,o),t}(),m={fillRule:"evenodd",clipRule:"evenodd",strokeLinejoin:"round",strokeMiterlimit:1.41421};function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function y(e,t){return!t||"object"!==h(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var E=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),y(this,g(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}(t,i.a.PureComponent),n=t,(r=[{key:"render",value:function(){return i.a.createElement("span",this.props,i.a.createElement(s.c,{id:"mobile.set_status.away.icon",defaultMessage:"Away Icon"},function(e){return i.a.createElement("svg",{width:"100%",height:"100%",viewBox:"0 0 20 20",style:_,role:"icon","aria-label":e},i.a.createElement("path",{className:"away--icon",d:"M10,0C15.519,0 20,4.481 20,10C20,15.519 15.519,20 10,20C4.481,20 0,15.519 0,10C0,4.481 4.481,0 10,0ZM10.27,3C10.949,3 11.5,3.586 11.5,4.307L11.5,9.379L15.002,12.881C15.492,13.37 15.499,14.158 15.019,14.638L14.638,15.019C14.158,15.499 13.37,15.492 12.881,15.002L8.887,11.008C8.739,10.861 8.636,10.686 8.576,10.501C8.528,10.402 8.5,10.299 8.5,10.193L8.5,4.307C8.5,3.586 9.051,3 9.73,3L10.27,3Z"}))}))}}])&&b(n.prototype,r),o&&b(n,o),t}(),_={fillRule:"evenodd",clipRule:"evenodd",strokeLinejoin:"round",strokeMiterlimit:1.41421};function O(e){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function w(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function C(e,t){return!t||"object"!==O(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function P(e,t){return(P=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var j=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),C(this,S(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&P(e,t)}(t,i.a.PureComponent),n=t,(r=[{key:"render",value:function(){return i.a.createElement("span",this.props,i.a.createElement(s.c,{id:"mobile.set_status.dnd.icon",defaultMessage:"Do Not Disturb Icon"},function(e){return i.a.createElement("svg",{id:"Layer_1",x:"0px",y:"0px",width:"13px",height:"13px",viewBox:"-299 391 12 12",style:T,role:"icon","aria-label":e},i.a.createElement("g",null,i.a.createElement("ellipse",{className:"dnd--icon",cx:"-294.6",cy:"394",rx:"2.5",ry:"2.5"}),i.a.createElement("path",{className:"dnd--icon",d:"M-293.8,399.4c0-0.4,0.1-0.7,0.2-1c-0.3,0.1-0.6,0.2-1,0.2c-2.5,0-2.5-2-2.5-2s-1,0.1-1.2,0.5c-0.4,0.6-0.6,1.7-0.7,2.5 c0,0.1-0.1,0.5,0,0.6c0.2,1.3,2.2,2.3,4.4,2.4c0,0,0.1,0,0.1,0c0,0,0.1,0,0.1,0c0.7,0,1.4-0.1,2-0.3 C-293.3,401.5-293.8,400.5-293.8,399.4z"})),i.a.createElement("path",{className:"dnd--icon",d:"M-287,400c0,0.1-0.1,0.1-0.1,0.1l-4.9,0c-0.1,0-0.1-0.1-0.1-0.1v-1.6c0-0.1,0.1-0.1,0.1-0.1l4.9,0c0.1,0,0.1,0.1,0.1,0.1 V400z"}))}))}}])&&w(n.prototype,r),o&&w(n,o),t}(),T={enableBackground:"new -299 391 12 12"};function k(e){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function N(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function R(e,t){return!t||"object"!==k(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function M(e){return(M=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function I(e,t){return(I=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var x=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),R(this,M(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&I(e,t)}(t,i.a.PureComponent),n=t,(r=[{key:"render",value:function(){return i.a.createElement("span",this.props,i.a.createElement(s.c,{id:"mobile.set_status.dnd.icon",defaultMessage:"Do Not Disturb Icon"},function(e){return i.a.createElement("svg",{width:"100%",height:"100%",viewBox:"0 0 20 20",style:A,role:"icon","aria-label":e},i.a.createElement("path",{className:"dnd--icon",d:"M10,0c5.519,0 10,4.481 10,10c0,5.519 -4.481,10 -10,10c-5.519,0 -10,-4.481 -10,-10c0,-5.519 4.481,-10 10,-10Zm5.25,8.5l-10.5,0c-0.414,0 -0.75,0.336 -0.75,0.75l0,1.5c0,0.414 0.336,0.75 0.75,0.75l10.5,0c0.414,0 0.75,-0.336 0.75,-0.75l0,-1.5c0,-0.414 -0.336,-0.75 -0.75,-0.75Z"}))}))}}])&&N(n.prototype,r),o&&N(n,o),t}(),A={fillRule:"evenodd",clipRule:"evenodd",strokeLinejoin:"round",strokeMiterlimit:1.41421};function L(e){return(L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function D(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function U(e,t){return!t||"object"!==L(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function q(e){return(q=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function H(e,t){return(H=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var F=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),U(this,q(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&H(e,t)}(t,i.a.PureComponent),n=t,(r=[{key:"render",value:function(){return i.a.createElement("span",this.props,i.a.createElement(s.c,{id:"mobile.set_status.offline.icon",defaultMessage:"Offline Icon"},function(e){return i.a.createElement("svg",{id:"Layer_1",x:"0px",y:"0px",width:"13px",height:"13px",viewBox:"-299 391 12 12",style:B,role:"icon","aria-label":e},i.a.createElement("g",null,i.a.createElement("g",null,i.a.createElement("ellipse",{className:"offline--icon",cx:"-294.5",cy:"394",rx:"2.5",ry:"2.5"}),i.a.createElement("path",{className:"offline--icon",d:"M-294.3,399.7c0-0.4,0.1-0.8,0.2-1.2c-0.1,0-0.2,0-0.4,0c-2.5,0-2.5-2-2.5-2s-1,0.1-1.2,0.5c-0.4,0.6-0.6,1.7-0.7,2.5 c0,0.1-0.1,0.5,0,0.6c0.2,1.3,2.2,2.3,4.4,2.4h0.1h0.1c0.3,0,0.7,0,1-0.1C-293.9,401.6-294.3,400.7-294.3,399.7z"}))),i.a.createElement("g",null,i.a.createElement("path",{className:"offline--icon",d:"M-288.9,399.4l1.8-1.8c0.1-0.1,0.1-0.3,0-0.3l-0.7-0.7c-0.1-0.1-0.3-0.1-0.3,0l-1.8,1.8l-1.8-1.8c-0.1-0.1-0.3-0.1-0.3,0 l-0.7,0.7c-0.1,0.1-0.1,0.3,0,0.3l1.8,1.8l-1.8,1.8c-0.1,0.1-0.1,0.3,0,0.3l0.7,0.7c0.1,0.1,0.3,0.1,0.3,0l1.8-1.8l1.8,1.8 c0.1,0.1,0.3,0.1,0.3,0l0.7-0.7c0.1-0.1,0.1-0.3,0-0.3L-288.9,399.4z"})))}))}}])&&D(n.prototype,r),o&&D(n,o),t}(),B={enableBackground:"new -299 391 12 12"};function G(e){return(G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function V(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function W(e,t){return!t||"object"!==G(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function K(e){return(K=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function z(e,t){return(z=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Y=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),W(this,K(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&z(e,t)}(t,i.a.PureComponent),n=t,(r=[{key:"render",value:function(){return i.a.createElement("span",this.props,i.a.createElement(s.c,{id:"mobile.set_status.offline.icon",defaultMessage:"Offline Icon"},function(e){return i.a.createElement("svg",{width:"100%",height:"100%",className:"offline--icon",viewBox:"0 0 20 20",style:Q,role:"icon","aria-label":e},i.a.createElement("path",{d:"M10,0c5.519,0 10,4.481 10,10c0,5.519 -4.481,10 -10,10c-5.519,0 -10,-4.481 -10,-10c0,-5.519 4.481,-10 10,-10Zm0,2c4.415,0 8,3.585 8,8c0,4.415 -3.585,8 -8,8c-4.415,0 -8,-3.585 -8,-8c0,-4.415 3.585,-8 8,-8Z"}))}))}}])&&V(n.prototype,r),o&&V(n,o),t}(),Q={fillRule:"evenodd",clipRule:"evenodd",strokeLinejoin:"round",strokeMiterlimit:1.41421};function Z(e){return(Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function J(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function X(e,t){return!t||"object"!==Z(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $(e){return($=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ee(e,t){return(ee=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var te=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),X(this,$(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ee(e,t)}(t,i.a.PureComponent),n=t,(r=[{key:"render",value:function(){return i.a.createElement("span",this.props,i.a.createElement(s.c,{id:"mobile.set_status.online.icon",defaultMessage:"Online Icon"},function(e){return i.a.createElement("svg",{id:"Layer_1",x:"0px",y:"0px",width:"13px",height:"13px",viewBox:"-243 245 12 12",style:ne,role:"icon","aria-label":e},i.a.createElement("g",null,i.a.createElement("path",{className:"online--icon",d:"M-236,250.5C-236,250.5-236,250.5-236,250.5C-236,250.5-236,250.5-236,250.5C-236,250.5-236,250.5-236,250.5z"}),i.a.createElement("ellipse",{className:"online--icon",cx:"-238.5",cy:"248",rx:"2.5",ry:"2.5"})),i.a.createElement("path",{className:"online--icon",d:"M-238.9,253.8c0-0.4,0.1-0.9,0.2-1.3c-2.2-0.2-2.2-2-2.2-2s-1,0.1-1.2,0.5c-0.4,0.6-0.6,1.7-0.7,2.5c0,0.1-0.1,0.5,0,0.6 c0.2,1.3,2.2,2.3,4.4,2.4c0,0,0.1,0,0.1,0c0,0,0.1,0,0.1,0c0,0,0.1,0,0.1,0C-238.7,255.7-238.9,254.8-238.9,253.8z"}),i.a.createElement("g",null,i.a.createElement("g",null,i.a.createElement("path",{className:"online--icon",d:"M-232.3,250.1l1.3,1.3c0,0,0,0.1,0,0.1l-4.1,4.1c0,0,0,0-0.1,0c0,0,0,0,0,0l-2.7-2.7c0,0,0-0.1,0-0.1l1.2-1.2 c0,0,0.1,0,0.1,0l1.4,1.4l2.9-2.9C-232.4,250.1-232.3,250.1-232.3,250.1z"}))))}))}}])&&J(n.prototype,r),o&&J(n,o),t}(),ne={enableBackground:"new -243 245 12 12"};function re(e){return(re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function oe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ae(e,t){return!t||"object"!==re(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ie(e){return(ie=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function se(e,t){return(se=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ce=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ae(this,ie(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&se(e,t)}(t,i.a.PureComponent),n=t,(r=[{key:"render",value:function(){return i.a.createElement("span",this.props,i.a.createElement(s.c,{id:"mobile.set_status.online.icon",defaultMessage:"Online Icon"},function(e){return i.a.createElement("svg",{width:"100%",height:"100%",viewBox:"0 0 20 20",style:le,role:"icon","aria-label":e},i.a.createElement("path",{className:"online--icon",d:"M10,0c5.519,0 10,4.481 10,10c0,5.519 -4.481,10 -10,10c-5.519,0 -10,-4.481 -10,-10c0,-5.519 4.481,-10 10,-10Zm6.19,7.18c0,0.208 -0.075,0.384 -0.224,0.53l-5.782,5.64l-1.087,1.059c-0.149,0.146 -0.33,0.218 -0.543,0.218c-0.213,0 -0.394,-0.072 -0.543,-0.218l-1.086,-1.059l-2.891,-2.82c-0.149,-0.146 -0.224,-0.322 -0.224,-0.53c0,-0.208 0.075,-0.384 0.224,-0.53l1.086,-1.059c0.149,-0.146 0.33,-0.218 0.543,-0.218c0.213,0 0.394,0.072 0.543,0.218l2.348,2.298l5.24,-5.118c0.149,-0.146 0.33,-0.218 0.543,-0.218c0.213,0 0.394,0.072 0.543,0.218l1.086,1.059c0.149,0.146 0.224,0.322 0.224,0.53Z"}))}))}}])&&oe(n.prototype,r),o&&oe(n,o),t}(),le={fillRule:"evenodd",clipRule:"evenodd",strokeLinejoin:"round",strokeMiterlimit:1.41421};function ue(e){return(ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fe(e,t){return!t||"object"!==ue(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function de(e){return(de=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function me(e,t){return(me=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function he(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"a",function(){return be});var be=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),fe(this,de(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&me(e,t)}(t,i.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.button,n=e.status,r=e.type;if(!n)return null;var o="status "+this.props.className;t&&(o=this.props.className);var a="span";return a="avatar"===r?"online"===n?te:"away"===n?d:"dnd"===n?j:F:"online"===n?ce:"away"===n?E:"dnd"===n?x:Y,i.a.createElement(a,{className:o})}}])&&pe(n.prototype,r),o&&pe(n,o),t}();he(be,"propTypes",{button:o.a.bool,status:o.a.string,className:o.a.string,type:o.a.string}),he(be,"defaultProps",{className:"",button:!1})},1620:function(e,t,n){"use strict";var r=n(119),o=n(205),a=n(146),i=n(13),s=n(0),c=n(23);function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=i.a.dispatch,p=i.a.getState,f=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,(n=[{key:"setItem",value:function(e,t){u(a.f(e,t))}},{key:"getItem",value:function(e,t){return o.d(e,t)(p())}},{key:"removeItem",value:function(e){u(a.d(e))}},{key:"setGlobalItem",value:function(e,t){u(a.e(e,t))}},{key:"getGlobalItem",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return o.c(e,t)(p())}},{key:"removeGlobalItem",value:function(e){u(a.c(e))}},{key:"signalLogout",value:function(){if(this.isLocalStorageSupported()){var e=c.r();c.fb(s.G.ANNOUNCEMENT),sessionStorage.setItem(s.G.LOGOUT,e),localStorage.setItem(s.G.LOGOUT,e),localStorage.removeItem(s.G.LOGOUT)}}},{key:"isSignallingLogout",value:function(e){return e===sessionStorage.getItem(s.G.LOGOUT)}},{key:"signalLogin",value:function(){if(this.isLocalStorageSupported()){var e=c.r();sessionStorage.setItem(s.G.LOGIN,e),localStorage.setItem(s.G.LOGIN,e),localStorage.removeItem(s.G.LOGIN)}}},{key:"isSignallingLogin",value:function(e){return e===sessionStorage.getItem(s.G.LOGIN)}},{key:"clear",value:function(e){u(a.b(e))}},{key:"isLocalStorageSupported",value:function(){if(this.hasCheckedLocalStorage)return this.localStorageSupported;this.localStorageSupported=!1;try{localStorage.setItem("__testLocal__","1"),"1"===localStorage.getItem("__testLocal__")&&(this.localStorageSupported=!0),localStorage.removeItem("__testLocal__","1")}catch(e){this.localStorageSupported=!1}try{sessionStorage.setItem("__testSession__","1"),sessionStorage.removeItem("__testSession__")}catch(e){r.a.push("/error?type="+s.k.LOCAL_STORAGE)}return this.hasCheckedLocalStorage=!0,this.localStorageSupported}},{key:"hasSeenLandingPage",value:function(){return localStorage.getItem(s.G.LANDING_PAGE_SEEN)}},{key:"setLandingPageSeen",value:function(e){localStorage.setItem(s.G.LANDING_PAGE_SEEN,e)}}])&&l(t.prototype,n),i&&l(t,i),e}());t.a=f},1621:function(e,t,n){"use strict";n.d(t,"a",function(){return r});n(74);function r(e,t){return e?e.filter(function(e){return e&&!e.delete_at>0&&null!=e.display_name}).sort(function(e,n){return function(e,t,n){return t.display_name!==n.display_name?t.display_name.localeCompare(n.display_name,e,{numeric:!0}):t.name.localeCompare(n.name,e,{numeric:!0})}(t,e,n)}):[]}},1635:function(e,t,n){e.exports=n.p+"files/002bcefbc1ddd0bbe72d15a7873f7a78.png"},1636:function(e,t,n){"use strict";n.d(t,"a",function(){return h});n(88),n(43);var r=n(30),o=n.n(r),a=n(7),i=n.n(a);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f,d,m,h=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),l(this,u(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(t,i.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e=this.props.children,t=this.props.divider||i.a.createElement("li",{className:"MenuGroup menu-divider"});return i.a.createElement(i.a.Fragment,null,t,e)}}])&&c(n.prototype,r),o&&c(n,o),t}();f=h,d="propTypes",m={divider:o.a.node,children:o.a.node},d in f?Object.defineProperty(f,d,{value:m,enumerable:!0,configurable:!0,writable:!0}):f[d]=m},1637:function(e,t,n){"use strict";n.d(t,"a",function(){return p});n(88),n(43);var r=n(7),o=n.n(r),a=n(55);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),c(this,l(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,o.a.PureComponent),n=t,(r=[{key:"render",value:function(){return o.a.createElement("span",this.props,o.a.createElement(a.c,{id:"generic_icons.menu",defaultMessage:"Menu Icon"},function(e){return o.a.createElement("svg",{width:"16px",height:"10px",viewBox:"0 0 16 10",version:"1.1",role:"icon",title:e},o.a.createElement("g",{stroke:"none",strokeWidth:"1",fill:"inherit",fillRule:"evenodd"},o.a.createElement("g",{transform:"translate(-188.000000, -38.000000)",fillRule:"nonzero",fill:"inherit"},o.a.createElement("g",null,o.a.createElement("g",null,o.a.createElement("g",{transform:"translate(188.000000, 38.000000)"},o.a.createElement("path",{d:"M15.5,0 C15.776,0 16,0.224 16,0.5 L16,1.5 C16,1.776 15.776,2 15.5,2 L0.5,2 C0.224,2 0,1.776 0,1.5 L0,0.5 C0,0.224 0.224,0 0.5,0 L15.5,0 Z M15.5,4 C15.776,4 16,4.224 16,4.5 L16,5.5 C16,5.776 15.776,6 15.5,6 L0.5,6 C0.224,6 0,5.776 0,5.5 L0,4.5 C0,4.224 0.224,4 0.5,4 L15.5,4 Z M15.5,8 C15.776,8 16,8.224 16,8.5 L16,9.5 C16,9.776 15.776,10 15.5,10 L0.5,10 C0.224,10 0,9.776 0,9.5 L0,8.5 C0,8.224 0.224,8 0.5,8 L15.5,8 Z"})))))))}))}}])&&s(n.prototype,r),i&&s(n,i),t}()},1653:function(e,t,n){"use strict";n(43),n(32),n(33),n(24),n(44),n(209),n(74);var r=n(7),o=n.n(r),a=n(1925),i=n(1866),s=(n(88),n(30)),c=n.n(s),l=n(55);function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t){return!t||"object"!==u(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var h,b,y,g=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=f(this,d(t).call(this,e))).state={katex:null},n}var r,a,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(t,o.a.Component),r=t,(a=[{key:"componentDidMount",value:function(){var e=this;n.e(33).then(n.t.bind(null,2380,7)).then(function(t){e.setState({katex:t})})}},{key:"render",value:function(){if(null==this.state.katex)return o.a.createElement("div",{className:"post-body--code tex"},this.props.content);try{var e=this.state.katex.renderToString(this.props.content,{throwOnError:!1,displayMode:!0});return o.a.createElement("div",{className:"post-body--code tex",dangerouslySetInnerHTML:{__html:e}})}catch(e){return o.a.createElement("div",{className:"post-body--code tex"},o.a.createElement(l.c,{id:"katex.error",defaultMessage:"Couldn't compile your Latex code. Please review the syntax and try again."}))}}}])&&p(r.prototype,a),i&&p(r,i),t}();h=g,b="propTypes",y={content:c.a.string.isRequired},b in h?Object.defineProperty(h,b,{value:y,enumerable:!0,configurable:!0,writable:!0}):h[b]=y;var v=n(1970),E=n(1654),_=n(1594);function O(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function w(e){var t=e.imageMetadata,n=e.src,r=O(e,["imageMetadata","src"]);return o.a.createElement(E.a,{src:n,imageMetadata:t},function(e){return e?o.a.createElement(_.a,Object.assign({},r,{src:e})):o.a.createElement("a",{className:"theme markdown__link",href:n,rel:"noopener noreferrer",target:"_blank",title:r.title},r.alt)})}w.propTypes={alt:c.a.string,imageMetadata:c.a.object,src:c.a.string.isRequired,title:c.a.string};var C=n(417),S=n(247),P=n(128);function j(e){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function T(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function k(e,t){return!t||"object"!==j(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function N(e){return(N=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function R(e,t){return(R=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var M=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),k(this,N(t).apply(this,arguments))}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&R(e,t)}(t,o.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e=":"+this.props.name+":";return this.props.imageUrl?o.a.createElement("span",{alt:e,className:"emoticon",title:e,style:{backgroundImage:"url("+this.props.imageUrl+")"}}):e}}])&&T(n.prototype,r),a&&T(n,a),t}();!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(M,"propTypes",{name:c.a.string.isRequired,imageUrl:c.a.string.isRequired});var I=Object(C.connect)(function(e,t){var n=Object(P.a)(e).get(t.name);return{imageUrl:n?Object(S.getEmojiImageUrl)(n):""}})(M);function x(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function A(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}t.a=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e)return null;var r=new a.Parser,s=new a.ProcessNodeDefinitions(o.a),c=[{replaceChildren:!1,shouldProcessNode:function(e){return"tag"===e.type&&"input"===e.name&&"checkbox"===e.attribs.type},processNode:function(e){var t=e.attribs||{};return e.attribs.checked=Boolean(t.checked),o.a.createElement("input",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){A(e,t,n[t])})}return e}({},e.attribs))}}];n.hasPluginTooltips&&c.push({replaceChildren:!0,shouldProcessNode:function(e){return"tag"===e.type&&"a"===e.name&&e.attribs.href},processNode:function(e,t){return o.a.createElement(v.a,{href:e.attribs.href,title:t[0]})}});"mentions"in n&&!n.mentions||c.push({replaceChildren:!0,shouldProcessNode:function(e){return e.attribs&&e.attribs["data-mention"]},processNode:function(e,n){var r=e.attribs["data-mention"];return o.a.createElement(i.a,{mentionName:r,isRHS:t,hasMention:!0},n)}});"emoji"in n&&!n.emoji||c.push({replaceChildren:!0,shouldProcessNode:function(e){return e.attribs&&e.attribs["data-emoticon"]},processNode:function(e){var t=e.attribs["data-emoticon"];return o.a.createElement(I,{name:t})}});return"images"in n&&!n.images||c.push({shouldProcessNode:function(e){return"tag"===e.type&&"img"===e.name},processNode:function(e){var t=e.attribs,r=t.class,a=x(t,["class"]);return o.a.createElement(w,Object.assign({className:r,imageMetadata:n.imagesMetadata&&n.imagesMetadata[a.src]},a,n.imageProps))}}),"latex"in n&&!n.latex||c.push({shouldProcessNode:function(e){return e.attribs&&e.attribs["data-latex"]},processNode:function(e){return o.a.createElement(g,{content:e.attribs["data-latex"]})}}),c.push({shouldProcessNode:function(){return!0},processNode:s.processDefaultNode}),r.parseWithInstructions(e,function(){return!0},c)}},1654:function(e,t,n){"use strict";var r=n(417),o=n(25),a=(n(88),n(43),n(30)),i=n.n(a),s=n(7),c=n.n(s),l=n(420);function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var b=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=f(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==u(o)&&"function"!=typeof o?d(r):o,h(d(n),"shouldRenderImage",function(){return n.props.enableSVGs||!(n.props.imageMetadata&&"svg"===n.props.imageMetadata.format)}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(t,c.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e=Object(l.f)(this.props.src,this.props.hasImageProxy);return this.shouldRenderImage()||(e=""),this.props.children(e)}}])&&p(n.prototype,r),o&&p(n,o),t}();h(b,"propTypes",{children:i.a.func.isRequired,enableSVGs:i.a.bool.isRequired,hasImageProxy:i.a.bool.isRequired,imageMetadata:i.a.object,src:i.a.string.isRequired});t.a=Object(r.connect)(function(e){var t=Object(o.getConfig)(e);return{enableSVGs:"true"===t.EnableSVGs,hasImageProxy:"true"===t.HasImageProxy}})(b)},1655:function(e,t,n){"use strict";var r=n(417),o=n(20),a=n(1501),i=(n(88),n(43),n(32),n(33),n(24),n(44),n(209),n(30)),s=n.n(i),c=n(7),l=n.n(c),u=n(55);function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m(e,t){return!t||"object"!==p(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var g=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),m(this,h(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}(t,l.a.Component),n=t,(r=[{key:"show",value:function(e){e&&e.preventDefault();var t=this.props,n={modalId:t.modalId,dialogProps:t.dialogProps,dialogType:t.dialogType};this.props.actions.openModal(n)}},{key:"render",value:function(){var e=this,t=this.props,n=t.children,r=t.onClick,o=f(t,["children","onClick"]),a=this.context.intl.formatMessage,i="".concat(o.accessibilityLabel," ").concat(a({id:"accessibility.button.dialog",defaultMessage:"Dialog"}));delete o.modalId,delete o.dialogType,delete o.dialogProps,delete o.accessibilityLabel;var s=function(){return e.show()};return r&&(s=function(t){r(),e.show(t)}),l.a.createElement("button",Object.assign({},o,{className:"style--none "+o.className,"data-toggle":"modal toggle","aria-label":i,onClick:s}),n)}}])&&d(n.prototype,r),o&&d(n,o),t}();y(g,"propTypes",{accessibilityLabel:s.a.string,children:s.a.node.isRequired,modalId:s.a.string.isRequired,dialogType:s.a.func.isRequired,dialogProps:s.a.object,onClick:s.a.func,className:s.a.string,actions:s.a.shape({openModal:s.a.func.isRequired}).isRequired}),y(g,"defaultProps",{dialogProps:{},className:""}),y(g,"contextTypes",{intl:u.i.isRequired});t.a=Object(r.connect)(null,function(e){return{actions:Object(o.bindActionCreators)({openModal:a.b},e)}})(g)},1656:function(e,t,n){"use strict";var r=n(417),o=n(20),a=n(35),i=n(25),s=n(12),c=(n(88),n(43),n(183)),l=n.n(c),u=n(7),p=n.n(u),f=n(1738),d=n(418),m=n.n(d),h=n(55),b=n(30),y=n.n(b),g=n(0),v=n(23),E=n(56),_=n(1497),O=n(427),w=n(1964),C=n.n(w),S=n(1761),P=n.n(S);function j(e){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function T(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function k(e){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function N(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function R(e,t){return(R=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function M(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var I=Object(h.g)({general:{id:Object(E.b)("user.settings.modal.general"),defaultMessage:"General"},security:{id:Object(E.b)("user.settings.modal.security"),defaultMessage:"Security"},notifications:{id:Object(E.b)("user.settings.modal.notifications"),defaultMessage:"Notifications"},display:{id:Object(E.b)("user.settings.modal.display"),defaultMessage:"Display"},sidebar:{id:Object(E.b)("user.settings.modal.sidebar"),defaultMessage:"Sidebar"},advanced:{id:Object(E.b)("user.settings.modal.advanced"),defaultMessage:"Advanced"},checkEmail:{id:"user.settings.general.checkEmail",defaultMessage:"Check your email at {email} to verify the address. Cannot find the email?"},confirmTitle:{id:Object(E.b)("user.settings.modal.confirmTitle"),defaultMessage:"Discard Changes?"},confirmMsg:{id:Object(E.b)("user.settings.modal.confirmMsg"),defaultMessage:"You have unsaved changes, are you sure you want to discard them?"},confirmBtns:{id:Object(E.b)("user.settings.modal.confirmBtns"),defaultMessage:"Yes, Discard"}}),x=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=k(t).call(this,e),n=!o||"object"!==j(o)&&"function"!=typeof o?N(r):o,M(N(n),"handleResend",function(e){n.setState({resendStatus:"sending"}),n.props.actions.sendVerificationEmail(e).then(function(e){var t=e.data,r=e.error;t?n.setState({resendStatus:"success"}):r&&n.setState({resendStatus:"failure"})})}),M(N(n),"handleKeyDown",function(e){v.e(e)&&e.shiftKey&&v.S(e,g.Q.KeyCodes.A)&&n.handleHide()}),M(N(n),"handleHide",function(){n.requireConfirm?n.showConfirmModal(function(){return n.handleHide()}):n.setState({show:!1})}),M(N(n),"handleHidden",function(){n.setState({active_tab:"general",active_section:"",prev_active_section:"dummySectionName"}),n.props.onHide()}),M(N(n),"handleCollapse",function(){l()(m.a.findDOMNode(n.modalBodyRef.current)).closest(".modal-dialog").removeClass("display--content"),n.setState({active_tab:"",active_section:"",prev_active_section:""})}),M(N(n),"handleConfirm",function(){n.setState({showConfirmModal:!1,enforceFocus:!0}),n.requireConfirm=!1,n.customConfirmAction=null,n.afterConfirm&&(n.afterConfirm(),n.afterConfirm=null)}),M(N(n),"handleCancelConfirmation",function(){n.setState({showConfirmModal:!1,enforceFocus:!0}),n.afterConfirm=null}),M(N(n),"showConfirmModal",function(e){e&&(n.afterConfirm=e),n.customConfirmAction?n.customConfirmAction(n.handleConfirm):n.setState({showConfirmModal:!0,enforceFocus:!1})}),M(N(n),"closeModal",function(){n.requireConfirm?n.showConfirmModal(n.closeModal):n.handleHide()}),M(N(n),"collapseModal",function(){n.requireConfirm?n.showConfirmModal(n.collapseModal):n.handleCollapse()}),M(N(n),"updateTab",function(e,t){!t&&n.requireConfirm?n.showConfirmModal(function(){return n.updateTab(e,!0)}):n.setState({active_tab:e,active_section:"",prev_active_section:"dummySectionName"})}),M(N(n),"updateSection",function(e,t){!t&&n.requireConfirm?n.showConfirmModal(function(){return n.updateSection(e,!0)}):n.setState({prev_active_section:e?"":n.state.active_section,active_section:e})}),n.state={active_tab:"general",active_section:"",prev_active_section:"dummySectionName",showConfirmModal:!1,enforceFocus:!0,show:!0},n.requireConfirm=!1,n.customConfirmAction=null,n.modalBodyRef=p.a.createRef(),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&R(e,t)}(t,p.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(e,t){v.U()||l()(".settings-content .minimize-settings").perfectScrollbar("update"),this.state.active_tab!==t.active_tab&&l()(m.a.findDOMNode(this.modalBodyRef.current)).scrollTop(0)}},{key:"render",value:function(){var e=this,t=this.props.intl.formatMessage;if(null==this.props.currentUser)return p.a.createElement("div",null);var n=[];return n.push({name:"general",uiName:t(I.general),icon:"icon fa fa-gear",iconTitle:v.ab("user.settings.general.icon","General Settings Icon")}),n.push({name:"security",uiName:t(I.security),icon:"icon fa fa-lock",iconTitle:v.ab("user.settings.security.icon","Security Settings Icon")}),n.push({name:"notifications",uiName:t(I.notifications),icon:"icon fa fa-exclamation-circle",iconTitle:v.ab("user.settings.notifications.icon","Notification Settings Icon")}),n.push({name:"display",uiName:t(I.display),icon:"icon fa fa-eye",iconTitle:v.ab("user.settings.display.icon","Display Settings Icon")}),n.push({name:"sidebar",uiName:t(I.sidebar),icon:"icon fa fa-columns",iconTitle:v.ab("user.settings.sidebar.icon","Sidebar Settings Icon")}),n.push({name:"advanced",uiName:t(I.advanced),icon:"icon fa fa-list-alt",iconTitle:v.ab("user.settings.advance.icon","Advanced Settings Icon")}),p.a.createElement(f.a,{id:"accountSettingsModal",dialogClassName:"a11y__modal settings-modal",show:this.state.show,onHide:this.handleHide,onExited:this.handleHidden,enforceFocus:this.state.enforceFocus,role:"dialog","aria-labelledby":"accountSettingsModalLabel"},p.a.createElement(f.a.Header,{id:"accountSettingsHeader",closeButton:!0},p.a.createElement(f.a.Title,{componentClass:"h1",id:"accountSettingsModalLabel"},p.a.createElement(h.c,{id:"user.settings.modal.title",defaultMessage:"Account Settings"}))),p.a.createElement(f.a.Body,{ref:this.modalBodyRef},p.a.createElement("div",{className:"settings-table"},p.a.createElement("div",{className:"settings-links"},p.a.createElement(O.a,{doLoad:P.a,tabs:n,activeTab:this.state.active_tab,updateTab:this.updateTab})),p.a.createElement("div",{className:"settings-content minimize-settings"},p.a.createElement(O.a,{doLoad:C.a,activeTab:this.state.active_tab,activeSection:this.state.active_section,prevActiveSection:this.state.prev_active_section,updateSection:this.updateSection,updateTab:this.updateTab,closeModal:this.closeModal,collapseModal:this.collapseModal,setEnforceFocus:function(t){return e.setState({enforceFocus:t})},setRequireConfirm:function(t,n){e.requireConfirm=t,e.customConfirmAction=n}})))),p.a.createElement(_.a,{title:t(I.confirmTitle),message:t(I.confirmMsg),confirmButtonText:t(I.confirmBtns),show:this.state.showConfirmModal,onConfirm:this.handleConfirm,onCancel:this.handleCancelConfirmation}))}}])&&T(n.prototype,r),o&&T(n,o),t}();M(x,"propTypes",{currentUser:y.a.object.isRequired,onHide:y.a.func.isRequired,intl:h.i.isRequired,actions:y.a.shape({sendVerificationEmail:y.a.func.isRequred}).isRequired});var A=Object(h.h)(x);t.a=Object(r.connect)(function(e){var t=Object(i.getConfig)(e),n="true"===t.CloseUnusedDirectMessages,r="true"===t.ExperimentalChannelOrganization,o="true"===t.SendEmailNotifications,a="true"===t.RequireEmailVerification;return{currentUser:Object(s.getCurrentUser)(e),closeUnusedDirectMessages:n,experimentalChannelOrganization:r,sendEmailNotifications:o,requireEmailVerification:a}},function(e){return{actions:Object(o.bindActionCreators)({sendVerificationEmail:a.sendVerificationEmail},e)}})(A)},1657:function(e,t,n){"use strict";n(74),n(313),n(299);var r=n(417),o=n(20),a=n(1566),i=n(1601),s=n(16),c=n(1546),l=(n(210),n(155),n(88),n(43),n(422),n(106),n(108),n(209),n(32),n(33),n(24),n(107),n(30)),u=n.n(l),p=n(7),f=n.n(p),d=n(1738),m=n(55),h=n(14),b=n(0),y=n(23),g=n(1571),v=n(1635),E=n.n(v),_=n(1581);function O(e){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function w(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function C(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function S(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){C(a,r,o,i,s,"next",e)}function s(e){C(a,r,o,i,s,"throw",e)}i(void 0)})}}function P(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function j(e){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function T(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function k(e,t){return(k=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function N(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var R=50,M=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=j(t).call(this,e),n=!o||"object"!==O(o)&&"function"!=typeof o?T(r):o,N(T(n),"handleHide",function(){n.props.actions.setModalSearchTerm(""),n.setState({show:!1})}),N(T(n),"handleExit",function(){n.props.onHide&&n.props.onHide()}),N(T(n),"handleResponse",function(e){var t=null;e&&e.message&&(t=e.message),n.setState({saving:!1,addError:t})}),N(T(n),"handleSubmit",function(){var e=S(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.preventDefault(),0!==(r=n.state.values.map(function(e){return e.id})).length){e.next=4;break}return e.abrupt("return");case 4:if(!n.props.skipCommit){e.next=8;break}return n.props.onAddCallback&&n.props.onAddCallback(r),n.handleHide(),e.abrupt("return");case 8:n.setState({saving:!0}),r.forEach(function(){var e=S(regeneratorRuntime.mark(function e(t){var r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.props.actions.linkGroupSyncable(t,n.props.currentChannelId,h.Groups.SYNCABLE_TYPE_CHANNEL,{auto_add:!0});case 2:r=e.sent,o=r.error,n.handleResponse(o),o||n.handleHide();case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),N(T(n),"addValue",function(e){var t=Object.assign([],n.state.values),r=t.map(function(e){return e.id});e&&e.id&&-1===r.indexOf(e.id)&&t.push(e),n.setState({values:t})}),N(T(n),"setGroupsLoadingState",function(e){n.setState({loadingGroups:e})}),N(T(n),"handlePageChange",function(e,t){e>t&&(n.setGroupsLoadingState(!0),n.props.actions.getGroupsNotAssociatedToChannel(n.props.currentChannelId,n.props.searchTerm,e,R+1).then(function(){n.setGroupsLoadingState(!1)}))}),N(T(n),"handleDelete",function(e){n.setState({values:e})}),N(T(n),"search",function(e){n.props.actions.setModalSearchTerm(e)}),n.searchTimeoutId=0,n.state={values:[],show:!0,search:!1,saving:!1,addError:null,loadingGroups:!0},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&k(e,t)}(t,f.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){var e=this;Promise.all([this.props.actions.getGroupsNotAssociatedToChannel(this.props.currentChannelId,"",0,R+1),this.props.actions.getAllGroupsAssociatedToChannel(this.props.currentChannelId)]).then(function(){e.setGroupsLoadingState(!1)})}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this;if(this.props.searchTerm!==e.searchTerm){clearTimeout(this.searchTimeoutId);var n=e.searchTerm;if(""===n)return;this.searchTimeoutId=setTimeout(S(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.setGroupsLoadingState(!0),e.next=3,t.props.actions.getGroupsNotAssociatedToChannel(t.props.currentChannelId,n);case 3:t.setGroupsLoadingState(!1);case 4:case"end":return e.stop()}},e)})),b.Q.SEARCH_TIMEOUT_MILLISECONDS)}}},{key:"renderOption",value:function(e,t,n){var r=t?"more-modal__row--selected":"";return f.a.createElement("div",{key:e.id,ref:t?"selected":e.id,className:"more-modal__row clickable "+r,onClick:function(){return n(e)}},f.a.createElement("img",{className:"more-modal__image",src:E.a,alt:"group picture",width:"32",height:"32"}),f.a.createElement("div",{className:"more-modal__details"},f.a.createElement("div",{className:"more-modal__name"},e.display_name," ","-"," ",f.a.createElement("span",{className:"more-modal__name_sub"},f.a.createElement(m.c,{id:"numMembers",defaultMessage:"{num, number} {num, plural, one {member} other {members}}",values:{num:e.member_count}})))),f.a.createElement("div",{className:"more-modal__actions"},f.a.createElement("div",{className:"more-modal__actions--round"},f.a.createElement(_.a,null))))}},{key:"renderValue",value:function(e){return e.data.display_name}},{key:"render",value:function(){var e=this,t=f.a.createElement("div",{id:"numGroupsRemaining"},f.a.createElement(m.c,{id:"multiselect.numGroupsRemaining",defaultMessage:"Use ↑↓ to browse, ↵ to select. You can add {num, number} more {num, plural, one {group} other {groups}}. ",values:{num:10-this.state.values.length}})),n=Object(y.ab)("multiselect.add","Add"),r=Object(y.ab)("multiselect.adding","Adding..."),o=null;this.state.addError&&(o=f.a.createElement("div",{className:"has-error col-sm-12"},f.a.createElement("label",{className:"control-label font-weight--normal"},this.state.addError)));var a=this.props.groups;if(this.props.excludeGroups){a=a.filter(function(t){return!e.props.excludeGroups.find(function(e){return e.id===t.id})})}if(this.props.includeGroups){a=[].concat(w(a),w(this.props.includeGroups.filter(function(t){return e.props.includeGroups.find(function(e){return e.id===t.id})})))}return f.a.createElement(d.a,{id:"addGroupsToChannelModal",dialogClassName:"a11y__modal more-modal more-direct-channels",show:this.state.show,onHide:this.handleHide,onExited:this.handleExit},f.a.createElement(d.a.Header,{closeButton:!0},f.a.createElement(d.a.Title,null,f.a.createElement(m.c,{id:"add_groups_to_channel.title",defaultMessage:"Add New Groups To {channelName} Channel",values:{channelName:f.a.createElement("strong",null,this.props.currentChannelName)}}))),f.a.createElement(d.a.Body,null,o,f.a.createElement(g.a,{key:"addGroupsToChannelKey",options:a,optionRenderer:this.renderOption,values:this.state.values,valueRenderer:this.renderValue,perPage:R,handlePageChange:this.handlePageChange,handleInput:this.search,handleDelete:this.handleDelete,handleAdd:this.addValue,handleSubmit:this.handleSubmit,maxValues:10,numRemainingText:t,buttonSubmitText:n,buttonSubmitLoadingText:r,saving:this.state.saving,loading:this.state.loadingGroups,placeholderText:Object(y.ab)("multiselect.addGroupsPlaceholder","Search and add groups")})))}}])&&P(n.prototype,r),o&&P(n,o),t}();N(M,"propTypes",{currentChannelName:u.a.string.isRequired,currentChannelId:u.a.string.isRequired,searchTerm:u.a.string.isRequired,groups:u.a.array.isRequired,excludeGroups:u.a.arrayOf(u.a.object),includeGroups:u.a.arrayOf(u.a.object),onHide:u.a.func,skipCommit:u.a.bool,onAddCallback:u.a.func,actions:u.a.shape({getGroupsNotAssociatedToChannel:u.a.func.isRequired,setModalSearchTerm:u.a.func.isRequired,linkGroupSyncable:u.a.func.isRequired,getAllGroupsAssociatedToChannel:u.a.func.isRequired}).isRequired});t.a=Object(r.connect)(function(e,t){var n=e.views.search.modalSearch,r=t.channel||Object(s.getCurrentChannel)(e)||{},o=Object(i.getGroupsNotAssociatedToChannel)(e,r.id);if(n){var a=RegExp(n,"i");o=o.filter(function(e){return a.test(e.display_name)||a.test(e.name)})}return{currentChannelName:r.display_name,currentChannelId:r.id,skipCommit:t.skipCommit,onAddCallback:t.onAddCallback,excludeGroups:t.excludeGroups,searchTerm:n,groups:o}},function(e){return{actions:Object(o.bindActionCreators)({getGroupsNotAssociatedToChannel:a.getGroupsNotAssociatedToChannel,setModalSearchTerm:c.a,linkGroupSyncable:a.linkGroupSyncable,getAllGroupsAssociatedToChannel:a.getAllGroupsAssociatedToChannel},e)}})(M)},1658:function(e,t,n){"use strict";n(74),n(313),n(299);var r=n(417),o=n(20),a=n(1566),i=n(1601),s=n(34),c=n(1546),l=(n(210),n(155),n(88),n(43),n(422),n(106),n(108),n(209),n(32),n(33),n(24),n(107),n(30)),u=n.n(l),p=n(7),f=n.n(p),d=n(1738),m=n(55),h=n(14),b=n(0),y=n(23),g=n(1571),v=n(1635),E=n.n(v),_=n(1581);function O(e){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function w(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function C(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function S(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){C(a,r,o,i,s,"next",e)}function s(e){C(a,r,o,i,s,"throw",e)}i(void 0)})}}function P(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function j(e){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function T(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function k(e,t){return(k=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function N(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var R=50,M=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=j(t).call(this,e),n=!o||"object"!==O(o)&&"function"!=typeof o?T(r):o,N(T(n),"handleHide",function(){n.props.actions.setModalSearchTerm(""),n.setState({show:!1})}),N(T(n),"handleExit",function(){n.props.onHide&&n.props.onHide()}),N(T(n),"handleResponse",function(e){var t=null;e&&e.message&&(t=e.message),n.setState({saving:!1,addError:t})}),N(T(n),"handleSubmit",function(){var e=S(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.preventDefault(),0!==(r=n.state.values.map(function(e){return e.id})).length){e.next=4;break}return e.abrupt("return");case 4:if(!n.props.skipCommit){e.next=8;break}return n.props.onAddCallback&&n.props.onAddCallback(r),n.handleHide(),e.abrupt("return");case 8:n.setState({saving:!0}),r.forEach(function(){var e=S(regeneratorRuntime.mark(function e(t){var r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.props.actions.linkGroupSyncable(t,n.props.currentTeamId,h.Groups.SYNCABLE_TYPE_TEAM,{auto_add:!0});case 2:r=e.sent,o=r.error,n.handleResponse(o),o||n.handleHide();case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),N(T(n),"addValue",function(e){var t=Object.assign([],n.state.values),r=t.map(function(e){return e.id});e&&e.id&&-1===r.indexOf(e.id)&&t.push(e),n.setState({values:t})}),N(T(n),"setGroupsLoadingState",function(e){n.setState({loadingGroups:e})}),N(T(n),"handlePageChange",function(e,t){e>t&&(n.setGroupsLoadingState(!0),n.props.actions.getGroupsNotAssociatedToTeam(n.props.currentTeamId,n.props.searchTerm,e,R+1).then(function(){n.setGroupsLoadingState(!1)}))}),N(T(n),"handleDelete",function(e){n.setState({values:e})}),N(T(n),"search",function(e){n.props.actions.setModalSearchTerm(e)}),n.searchTimeoutId=0,n.state={values:[],show:!0,search:!1,saving:!1,addError:null,loadingGroups:!0},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&k(e,t)}(t,f.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){var e=this;Promise.all([this.props.actions.getGroupsNotAssociatedToTeam(this.props.currentTeamId,"",0,R+1),this.props.actions.getAllGroupsAssociatedToTeam(this.props.currentTeamId)]).then(function(){e.setGroupsLoadingState(!1)})}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this;if(this.props.searchTerm!==e.searchTerm){clearTimeout(this.searchTimeoutId);var n=e.searchTerm;if(""===n)return;this.searchTimeoutId=setTimeout(S(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.setGroupsLoadingState(!0),e.next=3,t.props.actions.getGroupsNotAssociatedToTeam(t.props.currentTeamId,n);case 3:t.setGroupsLoadingState(!1);case 4:case"end":return e.stop()}},e)})),b.Q.SEARCH_TIMEOUT_MILLISECONDS)}}},{key:"renderOption",value:function(e,t,n){var r=t?"more-modal__row--selected":"";return f.a.createElement("div",{key:e.id,ref:t?"selected":e.id,className:"more-modal__row clickable "+r,onClick:function(){return n(e)}},f.a.createElement("img",{className:"more-modal__image",src:E.a,alt:"group picture",width:"32",height:"32"}),f.a.createElement("div",{className:"more-modal__details"},f.a.createElement("div",{className:"more-modal__name"},e.display_name," ","-"," ",f.a.createElement("span",{className:"more-modal__name_sub"},f.a.createElement(m.c,{id:"numMembers",defaultMessage:"{num, number} {num, plural, one {member} other {members}}",values:{num:e.member_count}})))),f.a.createElement("div",{className:"more-modal__actions"},f.a.createElement("div",{className:"more-modal__actions--round"},f.a.createElement(_.a,null))))}},{key:"renderValue",value:function(e){return e.data.display_name}},{key:"render",value:function(){var e=this,t=f.a.createElement("div",{id:"numGroupsRemaining"},f.a.createElement(m.c,{id:"multiselect.numGroupsRemaining",defaultMessage:"Use ↑↓ to browse, ↵ to select. You can add {num, number} more {num, plural, one {group} other {groups}}. ",values:{num:10-this.state.values.length}})),n=Object(y.ab)("multiselect.add","Add"),r=Object(y.ab)("multiselect.adding","Adding..."),o=null;this.state.addError&&(o=f.a.createElement("div",{className:"has-error col-sm-12"},f.a.createElement("label",{className:"control-label font-weight--normal"},this.state.addError)));var a=this.props.groups;if(this.props.excludeGroups){a=a.filter(function(t){return!e.props.excludeGroups.find(function(e){return e.id===t.id})})}if(this.props.includeGroups){a=[].concat(w(a),w(this.props.includeGroups.filter(function(t){return e.props.includeGroups.find(function(e){return e.id===t.id})})))}return f.a.createElement(d.a,{id:"addGroupsToTeamModal",dialogClassName:"a11y__modal more-modal more-direct-channels",show:this.state.show,onHide:this.handleHide,onExited:this.handleExit},f.a.createElement(d.a.Header,{closeButton:!0},f.a.createElement(d.a.Title,{componentClass:"h1"},f.a.createElement(m.c,{id:"add_groups_to_team.title",defaultMessage:"Add New Groups To {teamName} Team",values:{teamName:f.a.createElement("strong",null,this.props.currentTeamName)}}))),f.a.createElement(d.a.Body,null,o,f.a.createElement(g.a,{key:"addGroupsToTeamKey",options:a,optionRenderer:this.renderOption,values:this.state.values,valueRenderer:this.renderValue,perPage:R,handlePageChange:this.handlePageChange,handleInput:this.search,handleDelete:this.handleDelete,handleAdd:this.addValue,handleSubmit:this.handleSubmit,maxValues:10,numRemainingText:t,buttonSubmitText:n,buttonSubmitLoadingText:r,saving:this.state.saving,loading:this.state.loadingGroups,placeholderText:Object(y.ab)("multiselect.addGroupsPlaceholder","Search and add groups")})))}}])&&P(n.prototype,r),o&&P(n,o),t}();N(M,"propTypes",{currentTeamName:u.a.string.isRequired,currentTeamId:u.a.string.isRequired,searchTerm:u.a.string.isRequired,groups:u.a.array.isRequired,excludeGroups:u.a.arrayOf(u.a.object),includeGroups:u.a.arrayOf(u.a.object),onHide:u.a.func,skipCommit:u.a.bool,onAddCallback:u.a.func,actions:u.a.shape({getGroupsNotAssociatedToTeam:u.a.func.isRequired,setModalSearchTerm:u.a.func.isRequired,linkGroupSyncable:u.a.func.isRequired,getAllGroupsAssociatedToTeam:u.a.func.isRequired}).isRequired});t.a=Object(r.connect)(function(e,t){var n=e.views.search.modalSearch,r=t.team||Object(s.getCurrentTeam)(e)||{},o=Object(i.getGroupsNotAssociatedToTeam)(e,r.id);if(n){var a=RegExp(n,"i");o=o.filter(function(e){return a.test(e.display_name)||a.test(e.name)})}return{currentTeamName:r.display_name,currentTeamId:r.id,skipCommit:t.skipCommit,onAddCallback:t.onAddCallback,excludeGroups:t.excludeGroups,searchTerm:n,groups:o}},function(e){return{actions:Object(o.bindActionCreators)({getGroupsNotAssociatedToTeam:a.getGroupsNotAssociatedToTeam,setModalSearchTerm:c.a,linkGroupSyncable:a.linkGroupSyncable,getAllGroupsAssociatedToTeam:a.getAllGroupsAssociatedToTeam},e)}})(M)},1659:function(e,t,n){"use strict";var r=n(417),o=n(25),a=n(1541),i=(n(88),n(43),n(74),n(30)),s=n.n(i),c=n(7),l=n.n(c),u=n(23);function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t){return!t||"object"!==p(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var b,y,g,v=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),d(this,m(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(t,l.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e=this.props.fileInfo,t=this.props.fileUrl,n=[];""!==e.extension&&n.push(u.ab("file_info_preview.type","File type ")+e.extension.toUpperCase()),n.push(u.ab("file_info_preview.size","Size ")+u.p(e.size));var r=n.join(", "),o=null;return o=this.props.canDownloadFiles?l.a.createElement("a",{className:"file-details__preview",href:t,target:"_blank",rel:"noopener noreferrer"},l.a.createElement("span",{className:"file-details__preview-helper"}),l.a.createElement("img",{alt:"file preview",src:u.x(e)})):l.a.createElement("span",{className:"file-details__preview"},l.a.createElement("span",{className:"file-details__preview-helper"}),l.a.createElement("img",{alt:"file preview",src:u.x(e)})),l.a.createElement("div",{className:"file-details__container"},o,l.a.createElement("div",{className:"file-details"},l.a.createElement("div",{className:"file-details__name"},e.name),l.a.createElement("div",{className:"file-details__info"},r)))}}])&&f(n.prototype,r),o&&f(n,o),t}();b=v,y="propTypes",g={fileInfo:s.a.object.isRequired,fileUrl:s.a.string.isRequired,canDownloadFiles:s.a.bool.isRequired},y in b?Object.defineProperty(b,y,{value:g,enumerable:!0,configurable:!0,writable:!0}):b[y]=g;t.a=Object(r.connect)(function(e){var t=Object(o.getConfig)(e);return{canDownloadFiles:Object(a.a)(t)}})(v)},1660:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"c",function(){return s}),n.d(t,"b",function(){return c});var r=n(34),o=n(12),a=n(216),i=function(e){var t=Object(o.getCurrentUserId)(e),n=Object(r.getCurrentTeamId)(e);return a.a.getPreviousChannelName(t,n)},s=function(e){var t=Object(o.getCurrentUserId)(e),n=Object(r.getCurrentTeamId)(e);return a.a.getPenultimateChannelName(t,n)},c=function(e,t){var n=Object(o.getCurrentUserId)(e),i=Object(r.getTeamByName)(e,t),s=i&&i.id;return a.a.getPreviousChannelName(n,s)}},1675:function(e,t,n){"use strict";n.d(t,"a",function(){return E});n(88),n(43),n(209);var r=n(7),o=n.n(r),a=n(31),i=n(307),s=n(23),c=n(1505),l=n(1514),u=n(1515);function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m(e,t,n){return t&&d(e.prototype,t),n&&d(e,n),e}function h(e,t){return!t||"object"!==p(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}function g(e,t){return(g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var v=function(e){function t(){return f(this,t),h(this,b(t).apply(this,arguments))}return y(t,u["a"]),m(t,[{key:"render",value:function(){var e=this.props,t=e.item,n="suggestion-list__item mentions__name";e.isSelection&&(n+=" suggestion--selected");var r=t.username,i="";return(t.first_name||t.last_name)&&t.nickname?i="- ".concat(s.z(t)," (").concat(t.nickname,")"):t.nickname?i="- (".concat(t.nickname,")"):(t.first_name||t.last_name)&&(i="- ".concat(s.z(t))),o.a.createElement("div",Object.assign({className:n,onClick:this.handleClick},u.a.baseProps),o.a.createElement("img",{alt:"",className:"admin-setting-user__image",src:a.Client4.getUsersRoute()+"/"+t.id+"/image?_="+(t.last_picture_update||0)}),o.a.createElement("span",{className:"admin-setting-user--align"},"@"+r),o.a.createElement(c.a,{show:Boolean(t.is_bot)}),o.a.createElement("span",{className:"admin-setting-user__fullname"}," ",i))}}]),t}(),E=function(e){function t(){return f(this,t),h(this,b(t).apply(this,arguments))}return y(t,l["a"]),m(t,[{key:"handlePretextChanged",value:function(e,t){var n=this,r=e.toLowerCase();return this.startNewRequest(r),Object(i.b)(r,function(e){if(!n.shouldCancelDispatch(r)){var o=Object.assign([],e.users);t({matchedPretext:r,terms:o.map(function(e){return e.username}),items:o,component:v})}}),!0}}]),t}()},1676:function(e,t,n){"use strict";n.d(t,"a",function(){return d});n(88),n(43);var r=n(7),o=n.n(r),a=n(30),i=n.n(a);n(1921);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),l(this,u(t).apply(this,arguments))}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){return this.props.show?o.a.createElement("div",{className:"Badge"},o.a.createElement("div",{className:"Badge__box "+this.props.className},this.props.children)):null}}])&&c(n.prototype,r),a&&c(n,a),t}();f(d,"propTypes",{show:i.a.bool.isRequired,children:i.a.node.isRequired,className:i.a.string}),f(d,"defaultProps",{show:!0,className:""})},1677:function(e,t,n){"use strict";n.d(t,"a",function(){return m});n(88),n(43),n(32),n(33),n(24),n(44),n(305);var r=n(30),o=n.n(r),a=n(7),i=n.n(a);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var m=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return r=this,o=(e=u(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==s(o)&&"function"!=typeof o?p(r):o,d(p(n),"updateInputFromProps",function(){n.input&&n.input.value!==n.props.value&&(n.input.value=n.props.value)}),d(p(n),"getInput",function(){return n.input}),d(p(n),"setInput",function(e){n.input=e}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(t,i.a.PureComponent),n=t,(r=[{key:"componentDidUpdate",value:function(e){e.value!==this.props.value&&(this.props.delayInputUpdate?requestAnimationFrame(this.updateInputFromProps):this.updateInputFromProps())}},{key:"focus",value:function(){this.input.focus()}},{key:"blur",value:function(){this.input.blur()}},{key:"render",value:function(){var e=this.props,t=e.value,n=e.inputComponent,r=c(e,["value","inputComponent"]);return Reflect.deleteProperty(r,"delayInputUpdate"),i.a.createElement(n||"input",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){d(e,t,n[t])})}return e}({},r,{ref:this.setInput,defaultValue:t}))}},{key:"value",get:function(){return this.input.value},set:function(e){this.input.value=e}}])&&l(n.prototype,r),o&&l(n,o),t}();d(m,"propTypes",{delayInputUpdate:o.a.bool,inputComponent:o.a.func,value:o.a.string.isRequired}),d(m,"defaultProps",{delayInputUpdate:!1,value:""})},1678:function(e,t,n){"use strict";n(209);var r=n(1922),o=n(0).Q.PayloadSources,a=Object.assign(new r.Dispatcher,{handleServerAction:function(e){e.type||console.warn("handleServerAction called with undefined action type");var t={source:o.SERVER_ACTION,action:e};this.dispatch(t)},handleViewAction:function(e){e.type||console.warn("handleViewAction called with undefined action type");var t={source:o.VIEW_ACTION,action:e};this.dispatch(t)}});t.a=a},1691:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(0);function o(e){return function(t){return t({type:r.e.DISMISS_NOTICE,data:e}),{data:!0}}}},1692:function(e,t,n){"use strict";n.d(t,"a",function(){return p});n(88),n(43);var r=n(7),o=n.n(r),a=n(55);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),c(this,l(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,o.a.PureComponent),n=t,(r=[{key:"render",value:function(){return o.a.createElement("span",this.props,o.a.createElement(a.c,{id:"generic_icons.mattermost",defaultMessage:"Mattermost Logo"},function(e){return o.a.createElement("svg",{version:"1.1",id:"Layer_1",x:"0px",y:"0px",viewBox:"0 0 500 500",style:f.background,role:"icon","aria-label":e},o.a.createElement("g",{id:"XMLID_1_"},o.a.createElement("g",{id:"XMLID_3_"},o.a.createElement("path",{id:"XMLID_4_",style:f.st0,d:"M396.9,47.7l2.6,53.1c43,47.5,60,114.8,38.6,178.1c-32,94.4-137.4,144.1-235.4,110.9 S51.1,253.1,83,158.7C104.5,95.2,159.2,52,222.5,40.5l34.2-40.4C150-2.8,49.3,63.4,13.3,169.9C-31,300.6,39.1,442.5,169.9,486.7 s272.6-25.8,316.9-156.6C522.7,223.9,483.1,110.3,396.9,47.7z"})),o.a.createElement("path",{id:"XMLID_2_",style:f.st0,d:"M335.6,204.3l-1.8-74.2l-1.5-42.7l-1-37c0,0,0.2-17.8-0.4-22c-0.1-0.9-0.4-1.6-0.7-2.2 c0-0.1-0.1-0.2-0.1-0.3c0-0.1-0.1-0.2-0.1-0.2c-0.7-1.2-1.8-2.1-3.1-2.6c-1.4-0.5-2.9-0.4-4.2,0.2c0,0-0.1,0-0.1,0 c-0.2,0.1-0.3,0.1-0.4,0.2c-0.6,0.3-1.2,0.7-1.8,1.3c-3,3-13.7,17.2-13.7,17.2l-23.2,28.8l-27.1,33l-46.5,57.8 c0,0-21.3,26.6-16.6,59.4s29.1,48.7,48,55.1c18.9,6.4,48,8.5,71.6-14.7C336.4,238.4,335.6,204.3,335.6,204.3z"})))}))}}])&&s(n.prototype,r),i&&s(n,i),t}(),f={background:{enableBackground:"new 0 0 500 500"},st0:{fillRule:"evenodd",clipRule:"evenodd"}}},1693:function(e,t,n){e.exports=n.p+"files/325472601571f31e1bf00674c368d335.gif"},1696:function(e,t,n){"use strict";var r=n(7),o=n.n(r),a=n(30),i=n.n(a),s=n(1655),c=n(1597),l=function(e){var t=e.modalId,n=e.dialogType,r=e.dialogProps,a=e.text;return o.a.createElement(s.a,{accessibilityLabel:a,modalId:t,dialogType:n,dialogProps:r},a)};l.propTypes={modalId:i.a.string.isRequired,dialogType:i.a.func.isRequired,dialogProps:i.a.object,text:i.a.oneOfType([i.a.string,i.a.node]).isRequired};var u=Object(c.a)(l);u.displayName="MenuItemToggleModalRedux",t.a=u},1731:function(e,t,n){"use strict";var r=n(417),o=n(20),a=n(12),i=n(34),s=n(16),c=n(1523),l=(n(106),n(32),n(33),n(24),n(108),n(107),n(303)),u=n(75),p=n(97);function f(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function d(e){return function(){var t,n=(t=regeneratorRuntime.mark(function t(n,r){var o,a,c,f,d;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=r(),a=Object(i.getCurrentTeamId)(o),c=Object(p.o)(o),f=Object(s.getCurrentChannel)(o),d=!1===c.exists?f.id:c.channel_id,t.abrupt("return",Promise.all([n(Object(l.getTeamMember)(a,e)),n(Object(u.getChannelMember)(d,e))]));case 6:case"end":return t.stop()}},t)}),function(){var e=this,n=arguments;return new Promise(function(r,o){var a=t.apply(e,n);function i(e){f(a,r,o,i,s,"next",e)}function s(e){f(a,r,o,i,s,"throw",e)}i(void 0)})});return function(e,t){return n.apply(this,arguments)}}()}var m=n(1501),h=n(242),b=(n(44),n(88),n(43),n(209),n(30)),y=n.n(b),g=n(7),v=n.n(g),E=n(1762),_=n(1765),O=n(1766),w=n(55),C=n(425),S=n.n(C),P=n(1869),j=n(1656),T=n(119),k=n(1492),N=n(0),R=n(23),M=n(1548),I=n(1738),x=n(110),A=(n(74),n(300),n(301),n(185),n(952),n(212)),L=n(25),D=n(435),U=n(96),q=n(14),H=n(186),F=n(109),B=n(1552),G=n(1553),V=n(1575),W=n(13),K=n(1514),z=n(1515);function Y(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function Q(e){return(Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Z(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function J(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function X(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $(e,t,n){return t&&X(e.prototype,t),n&&X(e,n),e}function ee(e,t){return!t||"object"!==Q(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function te(e,t,n){return(te="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ne(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function ne(e){return(ne=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function re(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&oe(e,t)}function oe(e,t){return(oe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ae=function(e){function t(){return J(this,t),ee(this,ne(t).apply(this,arguments))}return re(t,z["a"]),$(t,[{key:"render",value:function(){var e=this.props,t=e.item,n=e.isSelection,r=t.channel,o=r.delete_at&&0!==r.delete_at,a="mentions__name";n&&(a+=" suggestion--selected");var i=r.display_name,s=null;return o?s=v.a.createElement(V.a,{className:"icon icon__archive"}):r.type===N.i.OPEN_CHANNEL?s=v.a.createElement(B.a,{className:"icon icon__globe icon--body"}):r.type===N.i.PRIVATE_CHANNEL&&(s=v.a.createElement(G.a,{className:"icon icon__lock icon--body"})),v.a.createElement("div",Object.assign({onClick:this.handleClick,className:a},z.a.baseProps),s,i)}}],[{key:"propTypes",get:function(){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){Z(e,t,n[t])})}return e}({},te(ne(t),"propTypes",this))}}]),t}(),ie="";function se(e,t){var n=!!e.channel.delete_at&&0!==e.channel.delete_at,r=!!t.channel.delete_at&&0!==t.channel.delete_at;if(n&&!r)return 1;if(!n&&r)return-1;var o=Object(D.getCurrentUserLocale)(W.a.getState()),a=e.channel,i=t.channel,s=a.display_name.toLowerCase(),c=i.display_name.toLowerCase(),l=s.startsWith(ie),u=c.startsWith(ie);return l&&u?Object(H.sortChannelsByTypeAndDisplayName)(o,a,i):l||u?l?-1:1:Object(H.sortChannelsByTypeAndDisplayName)(o,a,i)}var ce=function(e){function t(){return J(this,t),ee(this,ne(t).apply(this,arguments))}return re(t,K["a"]),$(t,[{key:"makeChannelSearchFilter",value:function(e){var t=e.toLowerCase();return function(e){var n=W.a.getState(),r=e.id,o=Object(i.getCurrentTeamId)(n),a=e.display_name;return e.type===N.i.OPEN_CHANNEL&&Object(U.haveIChannelPermission)(n,{channel:r,team:o,permission:q.Permissions.MANAGE_PUBLIC_CHANNEL_MEMBERS})?a.toLowerCase().includes(t):!(e.type!==N.i.PRIVATE_CHANNEL||!Object(U.haveIChannelPermission)(n,{channel:r,team:o,permission:q.Permissions.MANAGE_PRIVATE_CHANNEL_MEMBERS}))&&a.toLowerCase().includes(t)}}},{key:"handlePretextChanged",value:function(e,t){if(e){ie=e,this.startNewRequest(e);var n=W.a.getState(),r=Object(s.getChannelsInCurrentTeam)(n);this.formatChannelsAndDispatch(e,t,r),this.fetchChannels(e,t)}return!0}},{key:"fetchChannels",value:function(){var e,t=(e=regeneratorRuntime.mark(function e(t,n){var r,o,a,c,l,p,f;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=W.a.getState(),o=Object(i.getCurrentTeamId)(r)){e.next=4;break}return e.abrupt("return");case 4:return a=u.autocompleteChannelsForSearch(o,t)(W.a.dispatch,W.a.getState),c=[],e.prev=6,e.next=9,a;case 9:l=e.sent,p=l.data,c=p,e.next=17;break;case 14:e.prev=14,e.t0=e.catch(6),W.a.dispatch(Object(F.logError)(e.t0));case 17:if(!this.shouldCancelDispatch(t)){e.next=19;break}return e.abrupt("return");case 19:f=Object(s.getChannelsInCurrentTeam)(r).concat(c),this.formatChannelsAndDispatch(t,n,f);case 21:case"end":return e.stop()}},e,this,[[6,14]])}),function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){Y(a,r,o,i,s,"next",e)}function s(e){Y(a,r,o,i,s,"throw",e)}i(void 0)})});return function(e,n){return t.apply(this,arguments)}}()},{key:"formatChannelsAndDispatch",value:function(e,t,n){var r=[],o=W.a.getState(),a=Object(A.getMyChannelMemberships)(o);if(!this.shouldCancelDispatch(e)){for(var i={},s=this.makeChannelSearchFilter(e),c="true"===Object(L.getConfig)(o).ExperimentalViewArchivedChannels,l=0,u=Object.keys(n);l<u.length;l++){var p=n[u[l]];if(p&&(!i[p.id]&&s(p))){var f=Object.assign({},p),d=0!==p.delete_at,m={channel:f,name:f.name,deactivated:!1};if(!c&&d)continue;if(!a[p.id])continue;if(d&&!a[p.id])continue;if(p.type===N.i.OPEN_CHANNEL)m.type=N.i.OPEN_CHANNEL;else{if(p.type!==N.i.PRIVATE_CHANNEL)continue;m.type=N.i.PRIVATE_CHANNEL}i[p.id]=!0,r.push(m)}}t({matchedPretext:e,terms:r.sort(se).map(function(e){return e.channel.name}),items:r,component:ae})}}}]),t}(),le=n(1560),ue=n(1561);function pe(e){return(pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function de(e){return(de=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function me(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function he(e,t){return(he=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function be(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ye=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=de(t).call(this,e),n=!o||"object"!==pe(o)&&"function"!=typeof o?me(r):o,be(me(n),"enableChannelProvider",function(){n.suggestionProviders[0].disableDispatches=!1}),be(me(n),"focusTextbox",function(){if(null!=n.channelSearchBox){var e=n.channelSearchBox.getTextbox();document.activeElement!==e&&(e.focus(),Object(R.eb)(e))}}),be(me(n),"onInputChange",function(e){n.setState({text:e.target.value,selectedChannelId:null})}),be(me(n),"onHide",function(){n.setState({show:!1}),n.props.onHide()}),be(me(n),"setSearchBoxRef",function(e){n.channelSearchBox=e,n.focusTextbox()}),be(me(n),"handleSubmitError",function(e){e&&n.setState({submitError:e.message,saving:!1})}),be(me(n),"didSelectChannel",function(e){var t=e.channel,r=n.props.user.id;n.setState({text:t.display_name,selectedChannelId:t.id,checkingForMembership:!0,submitError:""}),n.props.actions.getChannelMember(t.id,r).then(function(){n.setState({checkingForMembership:!1})})}),be(me(n),"handleSubmit",function(e){e&&e.preventDefault&&e.preventDefault();var t=n.state.selectedChannelId,r=n.props.user;t&&(n.isUserMemberOfChannel(t)||n.state.saving||(n.setState({saving:!0}),n.props.actions.addChannelMember(t,r.id).then(function(e){var t=e.error;t?n.handleSubmitError(t):n.onHide()})))}),be(me(n),"isUserMemberOfChannel",function(e){var t=n.props.user,r=n.props.channelMembers;return!!e&&(!!r[e]&&Boolean(r[e][t.id]))}),n.state={show:!0,saving:!1,checkingForMembership:!1,text:"",selectedChannelId:null,submitError:""},n.suggestionProviders=[new ce],n.enableChannelProvider(),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&he(e,t)}(t,v.a.Component),n=t,(r=[{key:"render",value:function(){var e,t=this.props.user,n=this.state.selectedChannelId,r=this.isUserMemberOfChannel(n),o=Object(x.getFullName)(t);o||(o="@".concat(t.username)),this.state.saving||(this.state.submitError?e=v.a.createElement("label",{id:"add-user-to-channel-modal__invite-error",className:"modal__error has-error control-label"},this.state.submitError):r&&(e=v.a.createElement("label",{id:"add-user-to-channel-modal__user-is-member",className:"modal__error has-error control-label"},v.a.createElement(w.c,{id:"add_user_to_channel_modal.membershipExistsError",defaultMessage:"{name} is already a member of that channel",values:{name:o}}))));var a=v.a.createElement(w.c,{id:"add_user_to_channel_modal.help",defaultMessage:"Type to find a channel. Use ↑↓ to browse, ↵ to select, ESC to dismiss."}),i=v.a.createElement(le.a,{ref:this.setSearchBoxRef,className:"form-control focused",onChange:this.onInputChange,value:this.state.text,onKeyDown:this.handleKeyDown,onItemSelected:this.didSelectChannel,listComponent:ue.a,maxLength:"64",providers:this.suggestionProviders,listStyle:"bottom",completeOnTab:!1,renderDividers:!1,delayInputUpdate:!0,openWhenEmpty:!0}),s=r||this.state.checkingForMembership||Boolean(!this.state.selectedChannelId)||this.state.saving;return v.a.createElement(I.a,{dialogClassName:"a11y__modal modal--overflow",show:this.state.show,onHide:this.onHide,onExited:this.props.onHide,ref:"modal",enforceFocus:!0,role:"dialog","aria-labelledby":"addChannelModalLabel"},v.a.createElement(I.a.Header,{closeButton:!0},v.a.createElement(I.a.Title,{componentClass:"h1",id:"addChannelModalLabel"},v.a.createElement(w.c,{id:"add_user_to_channel_modal.title",defaultMessage:"Add {name} to a channel",values:{name:o}}))),v.a.createElement("form",{role:"form",onSubmit:this.handleSubmit},v.a.createElement(I.a.Body,null,v.a.createElement("div",{className:"modal__hint"},a),i,v.a.createElement("div",null,e,v.a.createElement("br",null))),v.a.createElement(I.a.Footer,null,v.a.createElement("button",{type:"button",className:"btn btn-link",onClick:this.onHide},v.a.createElement(w.c,{id:"add_user_to_channel_modal.cancel",defaultMessage:"Cancel"})),v.a.createElement("button",{type:"button",id:"add-user-to-channel-modal__add-button",className:"btn btn-primary",onClick:this.handleSubmit,disabled:s},v.a.createElement(w.c,{id:"add_user_to_channel_modal.add",defaultMessage:"Add"})))))}}])&&fe(n.prototype,r),o&&fe(n,o),t}();be(ye,"propTypes",{onHide:y.a.func.isRequired,user:y.a.object.isRequired,channelMembers:y.a.object.isRequired,actions:y.a.shape({addChannelMember:y.a.func.isRequired,getChannelMember:y.a.func.isRequired}).isRequired});var ge=Object(r.connect)(function(e){return{channelMembers:Object(s.getChannelMembersInChannels)(e)||{}}},function(e){return{actions:Object(o.bindActionCreators)({addChannelMember:u.addChannelMember,getChannelMember:u.getChannelMember},e)}})(ye),ve=n(1655);function Ee(e){return(Ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _e(e){return(_e=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Oe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function we(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ce(e,t,n){return t&&we(e.prototype,t),n&&we(e,n),e}function Se(e,t){return(Se=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Pe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var je=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=_e(t).call(this,e))||"object"!==Ee(o)&&"function"!=typeof o?Oe(r):o).handleShowDirectChannel=n.handleShowDirectChannel.bind(Oe(n)),n.handleMentionKeyClick=n.handleMentionKeyClick.bind(Oe(n)),n.handleEditAccountSettings=n.handleEditAccountSettings.bind(Oe(n)),n.state={loadingDMChannel:-1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Se(e,t)}(t,v.a.PureComponent),Ce(t,null,[{key:"getComponentName",value:function(){return"ProfilePopover"}}]),Ce(t,[{key:"componentDidMount",value:function(){this.props.actions.getMembershipForCurrentEntities(this.props.userId)}},{key:"handleShowDirectChannel",value:function(e){var t=this,n=this.props.actions;if(e.preventDefault(),this.props.user){var r=this.props.user;-1===this.state.loadingDMChannel&&(this.setState({loadingDMChannel:r.id}),n.openDirectChannelToUserId(r.id).then(function(e){e.error||(R.U()&&k.c(),t.setState({loadingDMChannel:-1}),t.props.hide&&t.props.hide(),T.a.push("".concat(t.props.teamUrl,"/messages/@").concat(r.username)))}))}}},{key:"handleMentionKeyClick",value:function(e){e.preventDefault(),this.props.user&&(this.props.hide&&this.props.hide(),S.a.emit("mention_key_click",this.props.user.username,this.props.isRHS))}},{key:"handleEditAccountSettings",value:function(e){e.preventDefault(),this.props.user&&(this.props.hide&&this.props.hide(),this.props.actions.openModal({ModalId:N.r.USER_SETTINGS,dialogType:j.a}))}},{key:"render",value:function(){if(!this.props.user)return null;var e=Object.assign({},this.props);delete e.user,delete e.userId,delete e.src,delete e.status,delete e.hideStatus,delete e.isBusy,delete e.hide,delete e.isRHS,delete e.hasMention,delete e.dispatch,delete e.enableTimezone,delete e.currentUserId,delete e.currentTeamId,delete e.teamUrl,delete e.actions,delete e.isTeamAdmin,delete e.isChannelAdmin,delete e.canManageAnyChannelMembersInCurrentTeam,delete e.intl;var t=this.props.intl.formatMessage,n=[];n.push(v.a.createElement("img",{className:"user-popover__image",alt:"".concat(this.props.user.username||"user"," profile image"),src:this.props.src,height:"128",width:"128",key:"user-popover-image"}));var r=R.z(this.props.user);if((r||this.props.user.position)&&n.push(v.a.createElement("hr",{key:"user-popover-hr",className:"divider divider--expanded"})),r&&n.push(v.a.createElement(E.a,{delayShow:N.Q.OVERLAY_TIME_DELAY,placement:"top",overlay:v.a.createElement(_.a,{id:"fullNameTooltip"},r),key:"user-popover-fullname"},v.a.createElement("div",{className:"overflow--ellipsis text-nowrap"},v.a.createElement("strong",null,r)))),this.props.user.is_bot&&n.push(v.a.createElement("div",{key:"bot-description",className:"overflow--ellipsis text-nowrap"},this.props.user.bot_description)),this.props.user.position){var o=this.props.user.position.substring(0,N.Q.MAX_POSITION_LENGTH);n.push(v.a.createElement(E.a,{delayShow:N.Q.OVERLAY_TIME_DELAY,placement:"top",overlay:v.a.createElement(_.a,{id:"positionTooltip"},o),key:"user-popover-position"},v.a.createElement("div",{className:"overflow--ellipsis text-nowrap padding-bottom padding-top half"},o)))}var a,i=this.props.user.email;if(i&&!this.props.user.is_bot&&(n.push(v.a.createElement("hr",{key:"user-popover-hr2",className:"divider divider--expanded"})),n.push(v.a.createElement("div",{"data-toggle":"tooltip",title:i,key:"user-popover-email"},v.a.createElement("a",{href:"mailto:"+i,className:"text-nowrap text-lowercase user-popover__email padding-bottom half"},i)))),n.push(v.a.createElement(M.a,{key:"profilePopoverPluggable2",pluggableName:"PopoverUserAttributes",user:this.props.user,status:this.props.hideStatus?null:this.props.status})),this.props.enableTimezone&&this.props.user.timezone&&n.push(v.a.createElement("div",{key:"user-popover-local-time",className:"padding-bottom half"},v.a.createElement(w.c,{id:"user_profile.account.localTime",defaultMessage:"Local Time: "}),v.a.createElement(P.a,{userTimezone:this.props.user.timezone}))),this.props.user.id===this.props.currentUserId&&n.push(v.a.createElement("div",{"data-toggle":"tooltip",key:"user-popover-settings",className:"popover__row first"},v.a.createElement("a",{href:"#",onClick:this.handleEditAccountSettings},v.a.createElement("i",{className:"fa fa-pencil-square-o",title:t({id:"generic_icons.edit",defaultMessage:"Edit Icon"})}),v.a.createElement(w.c,{id:"user_profile.account.editSettings",defaultMessage:"Edit Account Settings"})))),this.props.user.id!==this.props.currentUserId&&(n.push(v.a.createElement("div",{"data-toggle":"tooltip",key:"user-popover-dm",className:"popover__row first"},v.a.createElement("a",{href:"#",className:"text-nowrap user-popover__email",onClick:this.handleShowDirectChannel},v.a.createElement("i",{className:"fa fa-paper-plane",title:t({id:"user_profile.send.dm.icon",defaultMessage:"Send Message Icon"})}),v.a.createElement(w.c,{id:"user_profile.send.dm",defaultMessage:"Send Message"})))),this.props.canManageAnyChannelMembersInCurrentTeam&&this.props.isInCurrentTeam)){var s=t({id:"user_profile.add_user_to_channel",defaultMessage:"Add to a Channel"});n.push(v.a.createElement("div",{"data-toggle":"tooltip",className:"popover__row first",key:"user-popover-add-to-channel"},v.a.createElement("a",{href:"#",className:"text-nowrap"},v.a.createElement(ve.a,{accessibilityLabel:s,ref:"addUserToChannelModalButton",modalId:N.r.ADD_USER_TO_CHANNEL,role:"menuitem",dialogType:ge,dialogProps:{user:this.props.user},onClick:this.props.hide},v.a.createElement("i",{className:"fa fa-user-plus",title:t({id:"user_profile.add_user_to_channel.icon",defaultMessage:"Add User to Channel Icon"})}),s))))}n.push(v.a.createElement(M.a,{key:"profilePopoverPluggable3",pluggableName:"PopoverUserActions",user:this.props.user,status:this.props.hideStatus?null:this.props.status})),this.props.user.is_bot?a=v.a.createElement("span",{className:"user-popover__role"},R.ab("bots.is_bot","BOT")):R.W(this.props.user.roles)?a=v.a.createElement("span",{className:"user-popover__role"},R.ab("admin.permissions.roles.system_admin.name","System Admin")):this.props.isTeamAdmin?a=v.a.createElement("span",{className:"user-popover__role"},R.ab("admin.permissions.roles.team_admin.name","Team Admin")):this.props.isChannelAdmin&&(a=v.a.createElement("span",{className:"user-popover__role"},R.ab("admin.permissions.roles.channel_admin.name","Channel Admin")));var c="@".concat(this.props.user.username);return this.props.hasMention&&(c=v.a.createElement("a",{onClick:this.handleMentionKeyClick},c)),c=v.a.createElement("span",null,v.a.createElement("span",{className:"user-popover__username"},c),a),v.a.createElement(O.a,Object.assign({},e,{title:c,id:"user-profile-popover"}),n)}}]),t}();Pe(je,"propTypes",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){Pe(e,t,n[t])})}return e}({src:y.a.string.isRequired,user:y.a.object,status:y.a.string,hideStatus:y.a.bool,hide:y.a.func,isRHS:y.a.bool,currentTeamId:y.a.string.isRequired,currentUserId:y.a.string.isRequired,hasMention:y.a.bool,isInCurrentTeam:y.a.bool.isRequired,teamUrl:y.a.string.isRequired,isTeamAdmin:y.a.bool.isRequired,isChannelAdmin:y.a.bool.isRequired,canManageAnyChannelMembersInCurrentTeam:y.a.bool.isRequired,actions:y.a.shape({getMembershipForCurrentEntities:y.a.func.isRequired,openDirectChannelToUserId:y.a.func.isRequired,openModal:y.a.func.isRequired}).isRequired,intl:w.i.isRequired},O.a.propTypes)),Pe(je,"defaultProps",{isRHS:!1,hasMention:!1,status:N.O.OFFLINE}),delete je.propTypes.id;var Te=Object(w.h)(je);t.a=Object(r.connect)(function(e,t){var n=t.userId,r=Object(i.getCurrentTeam)(e),o=Object(i.getTeamMember)(e,r.id,n),c=!1;o&&o.scheme_admin&&(c=!0);var l,u=Object(p.o)(e),f=Object(s.getCurrentChannel)(e);l=!1===u.exists?f.id:u.channel_id;var d=Object(s.getChannelMembersInChannels)(e)[l][n],m=!1;return"search"!==Object(p.k)(e)&&null!=d&&d.scheme_admin&&(m=!0),{currentTeamId:r.id,currentUserId:Object(a.getCurrentUserId)(e),enableTimezone:Object(h.a)(e),isTeamAdmin:c,isChannelAdmin:m,isInCurrentTeam:Boolean(o),canManageAnyChannelMembersInCurrentTeam:Object(s.canManageAnyChannelMembersInCurrentTeam)(e),status:Object(a.getStatusForUserId)(e,n),teamUrl:Object(i.getCurrentRelativeTeamUrl)(e),user:Object(a.getUser)(e,n)}},function(e){return{actions:Object(o.bindActionCreators)({openDirectChannelToUserId:c.e,openModal:m.b,getMembershipForCurrentEntities:d},e)}})(Te)},1732:function(e,t,n){"use strict";n(74);var r=n(417),o=n(121),a=n(20),i=n(36),s=n(25),c=n(96),l=n(132),u=n(14),p=n(1532),f=n(1691),d=n(0),m=n(7),h=n.n(m),b=n(1490),y=n(1777),g=n(39),v=n(434),E=n.n(v),_=[{name:"apiv3_deprecation",adminOnly:!0,title:h.a.createElement(b.b,{id:"system_notice.title",defaultMessage:"**Notice**\\nfrom Mattermost"}),icon:E.a,body:h.a.createElement(b.b,{id:"system_notice.body.api3",defaultMessage:"If you’ve created or installed integrations in the last two years, find out how [recent changes](!https://about.mattermost.com/default-apiv3-deprecation-guide) may have affected them."}),allowForget:!0,show:function(e,t){return!(t.InstallationDate>=new Date(2018,5,16,0,0,0,0).getTime())}},{name:"advanced_permissions",adminOnly:!0,title:h.a.createElement(b.b,{id:"system_notice.title",defaultMessage:"**Notice**\\nfrom Mattermost"}),icon:E.a,body:h.a.createElement(b.b,{id:"system_notice.body.permissions",defaultMessage:"Some policy and permission System Console settings have moved with the release of [advanced permissions](!https://about.mattermost.com/default-advanced-permissions) in Enterprise E10 and E20."}),allowForget:!0,show:function(e,t,n){return"false"!==n.IsLicensed&&(!(t.InstallationDate>new Date(2018,5,16,0,0,0,0).getTime())&&!("true"===n.IsLicensed&&n.IssuedAt>new Date(2018,5,16,0,0,0,0).getTime()))}},{name:"ee_upgrade_advice",adminOnly:!0,title:h.a.createElement(b.b,{id:"system_notice.title",defaultMessage:"**Notice**\\nfrom Mattermost"}),icon:E.a,body:h.a.createElement(b.b,{id:"system_notice.body.ee_upgrade_advice",defaultMessage:"Enterprise Edition is recommended to ensure optimal operation and reliability. [Learn more](!https://mattermost.com/performance)."}),allowForget:!1,show:function(e,t,n,r){return!!r.hasOwnProperty("TOTAL_USERS")&&(!(r.TOTAL_USERS<1e4)&&("true"!==n.IsLicensed||"true"!==n.Cluster))}},{name:"ie11_deprecation",title:h.a.createElement(b.b,{id:"system_notice.title",defaultMessage:"**Notice**\\nfrom Mattermost"}),icon:E.a,allowForget:!1,body:h.a.createElement(b.b,{id:"system_notice.body.ie11_deprecation",defaultMessage:"Your browser, IE11, will no longer be supported in an upcoming release. [Find out how to move to another browser in one simple step](!https://forum.mattermost.org/t/mattermost-is-dropping-support-for-internet-explorer-ie11-in-v5-16/7575)."}),show:function(e){return!y.b(e,"5.16.0")&&!!g.f()}}],O=(n(88),n(43),n(32),n(30)),w=n.n(O),C=n(55),S=n(1692);function P(e){return(P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function j(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function T(e){return(T=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function k(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function N(e,t){return(N=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function R(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var M=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=T(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==P(o)&&"function"!=typeof o?k(r):o,R(k(n),"getCurrentNotice",function(){var e=!0,t=!1,r=void 0;try{for(var o,a=n.props.notices[Symbol.iterator]();!(e=(o=a.next()).done);e=!0){var i=o.value;if(!n.props.dismissedNotices[i.name]&&(!n.props.preferences[i.name]&&(!i.adminOnly||n.props.isSystemAdmin)&&i.show(n.props.serverVersion,n.props.config,n.props.license,n.props.analytics)))return i}}catch(e){t=!0,r=e}finally{try{e||null==a.return||a.return()}finally{if(t)throw r}}return null}),R(k(n),"hide",function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=n.getCurrentNotice();t&&(e||n.props.actions.savePreferences(n.props.currentUserId,[{user_id:n.props.currentUserId,category:d.z.CATEGORY_SYSTEM_NOTICE,name:t.name,value:"dismissed"}]),n.props.actions.dismissNotice(t.name))}),R(k(n),"hideAndRemind",function(){n.hide(!0)}),R(k(n),"hideAndForget",function(){n.hide(!1)}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&N(e,t)}(t,h.a.PureComponent),n=t,(r=[{key:"componentDidMount",value:function(){this.props.isSystemAdmin&&this.props.actions.getStandardAnalytics()}},{key:"componentDidUpdate",value:function(e){e.isSystemAdmin!==this.props.isSystemAdmin&&this.props.isSystemAdmin&&this.props.actions.getStandardAnalytics()}},{key:"render",value:function(){var e,t=this.getCurrentNotice(),n=this.context.intl.formatMessage;return null==t?null:(t.adminOnly&&(e=h.a.createElement("div",{className:"system-notice__info"},h.a.createElement("i",{className:"fa fa-eye",title:n({id:"system_notice.adminVisible.icon",defaultMessage:"Only visible to System Admins Icon"})}),h.a.createElement(C.c,{id:"system_notice.adminVisible",defaultMessage:"Only visible to System Admins"}))),h.a.createElement("div",{className:"system-notice bg--white shadow--2"},h.a.createElement("div",{className:"system-notice__header"},h.a.createElement("div",{className:"system-notice__logo"},h.a.createElement(S.a,null)),h.a.createElement("div",{className:"system-notice__title"},t.title)),h.a.createElement("div",{className:"system-notice__body"},t.body),e,h.a.createElement("div",{className:"system-notice__footer"},h.a.createElement("button",{id:"systemnotice_remindme",className:"btn btn-transparent",onClick:this.hideAndRemind},h.a.createElement(C.c,{id:"system_notice.remind_me",defaultMessage:"Remind me later"})),t.allowForget&&h.a.createElement("button",{id:"systemnotice_dontshow",className:"btn btn-transparent",onClick:this.hideAndForget},h.a.createElement(C.c,{id:"system_notice.dont_show",defaultMessage:"Don't show again"})))))}}])&&j(n.prototype,r),o&&j(n,o),t}();R(M,"propTypes",{currentUserId:w.a.string.isRequired,notices:w.a.arrayOf(w.a.object).isRequired,preferences:w.a.object.isRequired,dismissedNotices:w.a.object.isRequired,isSystemAdmin:w.a.bool,serverVersion:w.a.string.isRequired,config:w.a.object.isRequired,license:w.a.object.isRequired,analytics:w.a.object,actions:w.a.shape({savePreferences:w.a.func.isRequired,dismissNotice:w.a.func.isRequired,getStandardAnalytics:w.a.func.isRequired}).isRequired}),R(M,"contextTypes",{intl:C.i.isRequired});t.a=Object(r.connect)(function(){var e=Object(i.makeGetCategory)(),t=Object(o.a)(e,function(e){var t={};return e.forEach(function(e){t[e.name]=e}),t});return function(e){var n=Object(s.getLicense)(e),r=Object(s.getConfig)(e),o=e.entities.general.serverVersion,a=e.entities.admin.analytics;return{currentUserId:e.entities.users.currentUserId,preferences:t(e,d.z.CATEGORY_SYSTEM_NOTICE),dismissedNotices:e.views.notice.hasBeenDismissed,isSystemAdmin:Object(c.haveISystemPermission)(e,{permission:u.Permissions.MANAGE_SYSTEM}),notices:_,config:r,license:n,serverVersion:o,analytics:a}}},function(e){return{actions:Object(a.bindActionCreators)({savePreferences:l.savePreferences,dismissNotice:f.a,getStandardAnalytics:p.getStandardAnalytics},e)}})(M)},1733:function(e,t,n){"use strict";var r=n(417),o=n(20),a=n(1511),i=(n(88),n(43),n(106),n(44),n(74),n(32),n(33),n(24),n(107),n(7)),s=n.n(i),c=n(30),l=n.n(c),u=n(1738),p=n(55),f=n(1920),d=n(1559),m=n(23),h=(n(300),n(301),n(1750)),b=n(1675),y=n(1751),g=n(1868),v=n(1752);function E(e){return(E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function w(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function C(e,t){return(C=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function S(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var P=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=O(t).call(this,e),n=!o||"object"!==E(o)&&"function"!=typeof o?w(r):o,S(w(n),"handleSelected",function(e){var t=n.props,r=t.name,o=t.dataSource,a=t.onChange;"users"===o?(a(r,e.id),n.setState({value:e.username})):"channels"===o?(a(r,e.id),n.setState({value:e.display_name})):(a(r,e.value),n.setState({value:e.text}))}),n.providers=[],"select"===e.type&&("users"===e.dataSource?n.providers=[new b.a]:"channels"===e.dataSource?n.providers=[new y.a]:e.options&&(n.providers=[new h.a(e.options)])),n.state={value:""},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&C(e,t)}(t,s.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.name,n=e.subtype,r=e.displayName,o=e.value,a=e.placeholder,i=e.onChange,c=e.helpText,l=e.errorText,u=e.optional,f=this.props,d=f.type,m=f.maxLength,h=r;h=u?s.a.createElement(s.a.Fragment,null,r+" ",s.a.createElement("span",{className:"font-weight--normal light"},s.a.createElement(p.c,{id:"interactive_dialog.element.optional",defaultMessage:"(optional)"}))):s.a.createElement(s.a.Fragment,null,r,s.a.createElement("span",{className:"error-text"}," *"));var b=c;return l&&(b=s.a.createElement(s.a.Fragment,null,c,s.a.createElement("div",{className:"error-text margin-top x2"},l))),"text"===d||"textarea"===d?("text"===d?(m=m||150,d=n&&g.a.validTypes.includes(n)?n:"input"):m=m||3e3,s.a.createElement(g.a,{id:t,type:d,label:h,maxLength:m,value:o||"",placeholder:a,helpText:b,onChange:i,resizable:!1})):"select"===d?s.a.createElement(v.a,{id:t,providers:this.providers,onSelected:this.handleSelected,label:h,helpText:b,placeholder:a,value:this.state.value}):null}}])&&_(n.prototype,r),o&&_(n,o),t}();function j(e){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function T(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function k(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function N(e){return(N=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function R(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function M(e,t){return(M=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function I(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}S(P,"propTypes",{displayName:l.a.string.isRequired,name:l.a.string.isRequired,type:l.a.string.isRequired,subtype:l.a.string,placeholder:l.a.string,helpText:l.a.string,errorText:l.a.node,maxLength:l.a.number,dataSource:l.a.string,optional:l.a.bool,options:l.a.arrayOf(l.a.object),value:l.a.any,onChange:l.a.func});var x=function(e){function t(e){var n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=N(t).call(this,e),n=!o||"object"!==j(o)&&"function"!=typeof o?R(r):o,I(R(n),"handleSubmit",function(){var e,t=(e=regeneratorRuntime.mark(function e(t){var r,o,a,i,c,l,u,d,m,h;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),r=n.props.elements,o=n.state.values,a={},r&&r.forEach(function(e){var t=Object(f.checkDialogElementForError)(e,o[e.name]);t&&(a[e.name]=s.a.createElement(p.c,{id:t.id,defaultMessage:t.defaultMessage,values:t.values}))}),n.setState({errors:a}),0===Object.keys(a).length){e.next=8;break}return e.abrupt("return");case 8:return i=n.props,c=i.url,l=i.callbackId,u=i.state,d={url:c,callback_id:l,state:u,submission:o},n.setState({submitting:!0}),e.next=13,n.props.actions.submitInteractiveDialog(d);case 13:if(m=e.sent,h=m.data,n.setState({submitting:!1}),h&&h.errors&&0!==Object.keys(h.errors).length){e.next=19;break}return n.handleHide(!0),e.abrupt("return");case 19:if(!Object(f.checkIfErrorsMatchElements)(h.errors,r)){e.next=22;break}return n.setState({errors:h.errors}),e.abrupt("return");case 22:n.handleHide(!0);case 23:case"end":return e.stop()}},e)}),function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){T(a,r,o,i,s,"next",e)}function s(e){T(a,r,o,i,s,"throw",e)}i(void 0)})});return function(e){return t.apply(this,arguments)}}()),I(R(n),"onHide",function(){n.handleHide(!1)}),I(R(n),"handleHide",function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=n.props,r=t.url,o=t.callbackId,a=t.state,i=t.notifyOnCancel;if(!e&&i){var s={url:r,callback_id:o,state:a,cancelled:!0};n.props.actions.submitInteractiveDialog(s)}n.setState({show:!1})}),I(R(n),"onChange",function(e,t){var r=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){I(e,t,n[t])})}return e}({},n.state.values,I({},e,t));n.setState({values:r})});var a={};return null!=e.elements&&e.elements.forEach(function(e){a[e.name]=e.default||null}),n.state={show:!0,values:a,errors:{},submitting:!1},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&M(e,t)}(t,s.a.Component),n=t,(r=[{key:"render",value:function(){var e,t=this,n=this.props,r=n.title,o=n.iconUrl,a=n.submitLabel,i=n.elements,c=s.a.createElement(p.c,{id:"interactive_dialog.submit",defaultMessage:"Submit"});return a&&(c=a),o&&(e=s.a.createElement("img",{id:"interactiveDialogIconUrl",alt:"modal title icon",className:"more-modal__image",width:"36",height:"36",src:o})),s.a.createElement(u.a,{id:"interactiveDialogModal",dialogClassName:"a11y__modal about-modal",show:this.state.show,onHide:this.onHide,onExited:this.props.onHide,backdrop:"static",role:"dialog","aria-labelledby":"interactiveDialogModalLabel"},s.a.createElement(u.a.Header,{closeButton:!0,style:{borderBottom:null==i&&"0px"}},s.a.createElement(u.a.Title,{componentClass:"h1",id:"interactiveDialogModalLabel"},e,r)),i&&s.a.createElement(u.a.Body,null,i.map(function(e){return s.a.createElement(P,{key:"dialogelement"+e.name,displayName:e.display_name,name:e.name,type:e.type,subtype:e.subtype,helpText:e.help_text,errorText:t.state.errors[e.name],placeholder:e.placeholder,minLength:e.min_length,maxLength:e.max_length,dataSource:e.data_source,optional:e.optional,options:e.options,value:t.state.values[e.name],onChange:t.onChange})})),s.a.createElement(u.a.Footer,null,s.a.createElement("button",{id:"interactiveDialogCancel",type:"button",className:"btn btn-link cancel-button",onClick:this.onHide},s.a.createElement(p.c,{id:"interactive_dialog.cancel",defaultMessage:"Cancel"})),s.a.createElement(d.a,{id:"interactiveDialogSubmit",type:"button",className:"btn btn-primary save-button",onClick:this.handleSubmit,spinning:this.state.submitting,spinningText:Object(m.ab)("interactive_dialog.submitting","Submitting...")},c)))}}])&&k(n.prototype,r),o&&k(n,o),t}();I(x,"propTypes",{url:l.a.string.isRequired,callbackId:l.a.string,elements:l.a.arrayOf(l.a.object),title:l.a.string.isRequired,iconUrl:l.a.string,submitLabel:l.a.string,notifyOnCancel:l.a.bool,state:l.a.string,onHide:l.a.func,actions:l.a.shape({submitInteractiveDialog:l.a.func.isRequired}).isRequired});t.a=Object(r.connect)(function(e){var t=e.entities.integrations.dialog;return t&&t.dialog?{url:t.url,callbackId:t.dialog.callback_id,elements:t.dialog.elements,title:t.dialog.title,iconUrl:t.dialog.icon_url,submitLabel:t.dialog.submit_label,notifyOnCancel:t.dialog.notify_on_cancel,state:t.dialog.state}:{}},function(e){return{actions:Object(o.bindActionCreators)({submitInteractiveDialog:a.submitInteractiveDialog},e)}})(x)},1734:function(e,t,n){"use strict";n(305);function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.conn=null,this.connectionUrl=null,this.sequence=1,this.eventSequence=0,this.connectFailCount=0,this.eventCallback=null,this.responseCallbacks={},this.firstConnectCallback=null,this.reconnectCallback=null,this.missedEventCallback=null,this.errorCallback=null,this.closeCallback=null}var t,n,o;return t=e,(n=[{key:"initialize",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.connectionUrl,n=arguments.length>1?arguments[1]:void 0;this.conn||(null!=t?(0===this.connectFailCount&&console.log("websocket connecting to "+t),this.conn=new WebSocket(t),this.connectionUrl=t,this.conn.onopen=function(){e.eventSequence=0,n&&e.sendMessage("authentication_challenge",{token:n}),e.connectFailCount>0?(console.log("websocket re-established connection"),e.reconnectCallback&&e.reconnectCallback()):e.firstConnectCallback&&e.firstConnectCallback(),e.connectFailCount=0},this.conn.onclose=function(){e.conn=null,e.sequence=1,0===e.connectFailCount&&console.log("websocket closed"),e.connectFailCount++,e.closeCallback&&e.closeCallback(e.connectFailCount);var r=3e3;e.connectFailCount>7&&(r=3e3*e.connectFailCount*e.connectFailCount)>3e5&&(r=3e5),setTimeout(function(){e.initialize(t,n)},r)},this.conn.onerror=function(t){e.connectFailCount<=1&&(console.log("websocket error"),console.log(t)),e.errorCallback&&e.errorCallback(t)},this.conn.onmessage=function(t){var n=JSON.parse(t.data);n.seq_reply?(n.error&&console.log(n),e.responseCallbacks[n.seq_reply]&&(e.responseCallbacks[n.seq_reply](n),Reflect.deleteProperty(e.responseCallbacks,n.seq_reply))):e.eventCallback&&(n.seq!==e.eventSequence&&e.missedEventCallback&&(console.log("missed websocket event, act_seq="+n.seq+" exp_seq="+e.eventSequence),e.missedEventCallback()),e.eventSequence=n.seq+1,e.eventCallback(n))}):console.log("websocket must have connection url"))}},{key:"setEventCallback",value:function(e){this.eventCallback=e}},{key:"setFirstConnectCallback",value:function(e){this.firstConnectCallback=e}},{key:"setReconnectCallback",value:function(e){this.reconnectCallback=e}},{key:"setMissedEventCallback",value:function(e){this.missedEventCallback=e}},{key:"setErrorCallback",value:function(e){this.errorCallback=e}},{key:"setCloseCallback",value:function(e){this.closeCallback=e}},{key:"close",value:function(){this.connectFailCount=0,this.sequence=1,this.conn&&this.conn.readyState===WebSocket.OPEN&&(this.conn.onclose=function(){},this.conn.close(),this.conn=null,console.log("websocket closed"))}},{key:"sendMessage",value:function(e,t,n){var r={action:e,seq:this.sequence++,data:t};n&&(this.responseCallbacks[r.seq]=n),this.conn&&this.conn.readyState===WebSocket.OPEN?this.conn.send(JSON.stringify(r)):this.conn&&this.conn.readyState!==WebSocket.CLOSED||(this.conn=null,this.initialize())}},{key:"userTyping",value:function(e,t,n){var r={};r.channel_id=e,r.parent_id=t,this.sendMessage("user_typing",r,n)}},{key:"userUpdateActiveStatus",value:function(e,t,n){var r={user_is_active:e,manual:t};this.sendMessage("user_update_active_status",r,n)}},{key:"getStatuses",value:function(e){this.sendMessage("get_statuses",null,e)}},{key:"getStatusesByIds",value:function(e,t){var n={};n.user_ids=e,this.sendMessage("get_statuses_by_ids",n,t)}}])&&r(t.prototype,n),o&&r(t,o),e}());t.a=o},1750:function(e,t,n){"use strict";n.d(t,"a",function(){return g});n(106),n(24),n(107),n(88),n(43),n(209);var r=n(7),o=n.n(r),a=n(1514),i=n(1515);function s(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function c(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){s(a,r,o,i,c,"next",e)}function c(e){s(a,r,o,i,c,"throw",e)}i(void 0)})}}function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t,n){return t&&p(e.prototype,t),n&&p(e,n),e}function d(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var y=function(e){function t(){return u(this,t),d(this,m(t).apply(this,arguments))}return h(t,i["a"]),f(t,[{key:"render",value:function(){var e=this.props,t=e.item,n="mentions__name";return e.isSelection&&(n+=" suggestion--selected"),o.a.createElement("div",Object.assign({className:n,onClick:this.handleClick},i.a.baseProps),t.text)}}]),t}(),g=function(e){function t(e){var n;return u(this,t),(n=d(this,m(t).call(this))).options=e,n}return h(t,a["a"]),f(t,[{key:"handlePretextChanged",value:function(e,t){return 0===e.length?(this.displayAllOptions(t),!0):!!e&&(this.filterOptions(e,t),!0)}},{key:"displayAllOptions",value:function(){var e=c(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=this.options.map(function(e){return e.text}),t({matchedPretext:"",terms:n,items:this.options,component:y});case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"filterOptions",value:function(){var e=c(regeneratorRuntime.mark(function e(t,n){var r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=this.options.filter(function(e){return e.text.toLowerCase().indexOf(t)>=0}),o=r.map(function(e){return e.text}),n({matchedPretext:t,terms:o,items:r,component:y});case 3:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()}]),t}()},1751:function(e,t,n){"use strict";n.d(t,"a",function(){return y});n(88),n(43),n(209),n(74);var r=n(7),o=n.n(r),a=n(1523),i=n(1514),s=n(1515);function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),e}function f(e,t){return!t||"object"!==c(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var b=function(e){function t(){return l(this,t),f(this,d(t).apply(this,arguments))}return m(t,s["a"]),p(t,[{key:"render",value:function(){var e=this.props.isSelection,t=this.props.item,n=t.display_name,r=t.purpose,a="mentions__name no-flex";e&&(a+=" suggestion--selected");var i="(~"+t.name+")";return o.a.createElement("div",Object.assign({className:a,onClick:this.handleClick},s.a.baseProps),o.a.createElement("div",{className:"mention__align"},o.a.createElement("span",null,n),o.a.createElement("span",{className:"mention__channelname"}," ",i)),o.a.createElement("div",{className:"mention__purpose"},r))}}]),t}(),y=function(e){function t(){return l(this,t),f(this,d(t).apply(this,arguments))}return m(t,i["a"]),p(t,[{key:"handlePretextChanged",value:function(e,t){var n=this,r=e.toLowerCase();return this.startNewRequest(r),Object(a.b)(r,function(e){if(!n.shouldCancelDispatch(r)){var o=Object.assign([],e);t({matchedPretext:r,terms:o.map(function(e){return e.display_name}),items:o,component:b})}}),!0}}]),t}()},1752:function(e,t,n){"use strict";n.d(t,"a",function(){return h});n(88),n(43);var r=n(30),o=n.n(r),a=n(7),i=n.n(a),s=n(1560),c=n(1561);function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=p(t).call(this,e),n=!o||"object"!==l(o)&&"function"!=typeof o?f(r):o,m(f(n),"onChange",function(e){e&&e.target&&n.setState({input:e.target.value})}),m(f(n),"handleSelected",function(e){n.setState({input:""}),n.props.onSelected&&n.props.onSelected(e),requestAnimationFrame(function(){n.suggestionRef&&n.suggestionRef.blur()})}),m(f(n),"setSuggestionRef",function(e){n.suggestionRef=e}),m(f(n),"onFocus",function(){n.setState({focused:!0})}),m(f(n),"onBlur",function(){n.setState({focused:!1})}),n.state={input:""},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(t,i.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e,t,n=this.props,r=n.providers,o=n.placeholder,a=n.footer,l=n.label,u=n.labelClassName,p=n.helpText,f=n.inputClassName,d=n.value,m=this.state.focused,h=this.state.input;return m||(h=d),l&&(e=i.a.createElement("label",{className:"control-label "+u},l)),p&&(t=i.a.createElement("div",{className:"help-text"},p)),i.a.createElement("div",{className:"form-group"},e,i.a.createElement("div",{className:f},i.a.createElement(s.a,{placeholder:o,ref:this.setSuggestionRef,listComponent:c.a,className:"form-control",containerClass:"select-suggestion-container",value:h,onChange:this.onChange,onItemSelected:this.handleSelected,onFocus:this.onFocus,onBlur:this.onBlur,providers:r,completeOnTab:!0,renderDividers:!1,renderNoResults:!0,openOnFocus:!0,openWhenEmpty:!0,replaceAllInputOnSelect:!0}),t,a))}}])&&u(n.prototype,r),o&&u(n,o),t}();m(h,"propTypes",{providers:o.a.array.isRequired,value:o.a.string.isRequired,onSelected:o.a.func,label:o.a.node,labelClassName:o.a.string,inputClassName:o.a.string,helpText:o.a.node,placeholder:o.a.string,footer:o.a.node}),m(h,"defaultProps",{value:"",id:"",labelClassName:"",inputClassName:""})},1761:function(e,t,n){e.exports=function(e){n.e(32).then(function(t){e(n(2257))}.bind(null,n)).catch(n.oe)}},1767:function(e,t,n){"use strict";function r(e,t,n){var r=n.above,o=n.below;return e.top>r?"top":t-e.bottom>(o||r)?"bottom":"left"}n.d(t,"a",function(){return r})},1769:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(30),o=n.n(r),a=n(7),i=n.n(a),s=n(1538);function c(e){var t=e.loading,n=e.progress,r=e.containerClass,o=i.a.createElement("span",{className:"loader-percent"});return n&&(o=i.a.createElement("span",{className:"loader-percent"},"".concat(t," ").concat(n,"%"))),i.a.createElement("div",{className:r},i.a.createElement(s.a,null),o)}c.propTypes={progress:o.a.number,loading:o.a.string,containerClass:o.a.string},c.defaultProps={containerClass:"view-image__loading"}},1775:function(e,t,n){e.exports=function(e){n.e(26).then(function(t){e(n(2363))}.bind(null,n)).catch(n.oe)}},1776:function(e,t,n){"use strict";n.d(t,"a",function(){return a});n(0).k.PAGE_NOT_FOUND;var r=["/mfa/setup","/mfa/confirm"],o=["","email","ldap"];function a(e,t,n,a){return!("true"!==t.MFA||"true"!==n.EnableMultifactorAuthentication||"true"!==n.EnforceMultifactorAuthentication||-1!==r.indexOf(a)||!e||e.mfa_active||-1===o.indexOf(e.auth_service))}},1777:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o});n(211);function r(e,t){if(e===t)return!0;return(e||"").split(".").slice(0,-2).join(".")===(t||"").split(".").slice(0,-2).join(".")}function o(e,t){if(e===t)return!0;for(var n=(e||"").split(".").filter(function(e){return null!==/^[0-9]+$/.exec(e)}),r=(t||"").split(".").filter(function(e){return null!==/^[0-9]+$/.exec(e)}),o=0;o<Math.max(n.length,r.length);o++){if((n[o]||0)>(r[o]||0))return!0;if((n[o]||0)<(r[o]||0))return!1}return!0}},1780:function(e,t,n){"use strict";n.d(t,"a",function(){return m});n(88),n(43),n(32),n(33),n(24),n(44),n(209),n(305);var r=n(30),o=n.n(r),a=n(7),i=n.n(a);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var m=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=u(t).call(this,e),n=!o||"object"!==s(o)&&"function"!=typeof o?p(r):o,d(p(n),"recalculateSize",function(){if(n.refs.reference&&n.refs.textarea){var e=n.refs.reference.scrollHeight,t=n.refs.textarea;if(e>0&&e!==n.height){var r=getComputedStyle(t),o=parseInt(r.borderTopWidth,10)+parseInt(r.borderBottomWidth,10);t.style.height=String(e+o)+"px",n.height=e,n.props.onHeightChange&&n.props.onHeightChange(e,parseInt(r.maxHeight,10))}}}),d(p(n),"getDOMNode",function(){return n.refs.textarea}),d(p(n),"handleChange",function(e){n.props.onChange&&n.props.onChange(e)}),n.height=0,n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(t,i.a.Component),n=t,(r=[{key:"focus",value:function(){this.refs.textarea.focus()}},{key:"blur",value:function(){this.refs.textarea.blur()}},{key:"componentDidMount",value:function(){this.recalculateSize()}},{key:"componentDidUpdate",value:function(){this.recalculateSize()}},{key:"render",value:function(){var e=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){d(e,t,n[t])})}return e}({},this.props);Reflect.deleteProperty(e,"onHeightChange"),Reflect.deleteProperty(e,"providers"),Reflect.deleteProperty(e,"channelId");var t=e.value,n=e.defaultValue,r=e.placeholder,o=e.disabled,a=e.onInput,s=e.id,l=c(e,["value","defaultValue","placeholder","disabled","onInput","id"]),u={};this.height<=0?u.rows=1:u.height=this.height;var p=null,f=r.toLowerCase();return this.props.value||this.props.defaultValue||(p=i.a.createElement("div",Object.assign({},l,{style:h.placeholder}),r)),i.a.createElement("div",null,p,i.a.createElement("textarea",Object.assign({ref:"textarea",id:s},u,l,{role:"textbox","aria-label":f,disabled:o,onChange:this.handleChange,onInput:a,value:t,defaultValue:n})),i.a.createElement("div",{style:h.container},i.a.createElement("textarea",Object.assign({ref:"reference",id:s+"-reference",style:h.reference,disabled:!0,rows:"1"},l,{value:t||n}))))}},{key:"value",get:function(){return this.refs.textarea.value},set:function(e){this.refs.textarea.value=e}},{key:"selectionStart",get:function(){return this.refs.textarea.selectionStart},set:function(e){this.refs.textarea.selectionStart=e}},{key:"selectionEnd",get:function(){return this.refs.textarea.selectionEnd},set:function(e){this.refs.textarea.selectionEnd=e}}])&&l(n.prototype,r),o&&l(n,o),t}();d(m,"propTypes",{value:o.a.string,defaultValue:o.a.string,placeholder:o.a.string,onChange:o.a.func,onHeightChange:o.a.func}),d(m,"defaultProps",{placeholder:""});var h={container:{height:0,overflow:"hidden"},reference:{height:"auto",width:"100%"},placeholder:{overflow:"hidden",textOverflow:"ellipsis",opacity:.5,pointerEvents:"none",position:"absolute",whiteSpace:"nowrap"}}},1788:function(e,t,n){"use strict";n.d(t,"a",function(){return p});n(88),n(43);var r=n(7),o=n.n(r),a=n(55);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),c(this,l(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,o.a.PureComponent),n=t,(r=[{key:"render",value:function(){return o.a.createElement(a.c,{id:"generic_icons.edit",defaultMessage:"Edit Icon"},function(e){return o.a.createElement("i",{className:"fa fa-pencil",title:e})})}}])&&s(n.prototype,r),i&&s(n,i),t}()},1789:function(e,t,n){"use strict";n.d(t,"a",function(){return O});n(88),n(43),n(32),n(33),n(24),n(44);var r=n(30),o=n.n(r),a=n(7),i=n.n(a),s=n(55),c=n(1762),l=n(1765),u=n(0),p=n(23),f=n(1541),d=n(1525),m=n(1500),h=n(1490);function b(e){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function E(e,t){return(E=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var O=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=g(t).call(this,e),n=!o||"object"!==b(o)&&"function"!=typeof o?v(r):o,_(v(n),"handleCancel",function(e){n.setState({removeSrc:!1,setDefaultSrc:!1}),n.props.updateSection(e)}),_(v(n),"handleFileSelected",function(){n.confirmButton.current&&n.confirmButton.current.focus()}),_(v(n),"handleSave",function(e){e.preventDefault(),n.state.removeSrc?n.props.onRemove():n.state.setDefaultSrc?n.props.onSetDefault():n.props.onSubmit()}),_(v(n),"handleRemoveSrc",function(e){e.preventDefault(),n.setState({removeSrc:!0}),n.focusFirstElement()}),_(v(n),"handleSetDefaultSrc",function(e){e.preventDefault(),n.setState({setDefaultSrc:!0}),n.focusFirstElement()}),_(v(n),"handleFileChange",function(e){n.setState({removeSrc:!1,setDefaultSrc:!1}),n.props.onFileChange(e)}),_(v(n),"handleInputFile",function(){n.selectInput.current.value="",n.selectInput.current.click()}),_(v(n),"setPicture",function(e){if(e){n.previewBlob=URL.createObjectURL(e);var t=new FileReader;t.onload=function(e){var t=f.c(e.target.result),r=f.e(t);n.setState({image:n.previewBlob,orientationStyles:r})},t.readAsArrayBuffer(e)}}),_(v(n),"renderImg",function(){var e=n.props.imageContext;if(n.props.file){var t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){_(e,t,n[t])})}return e}({backgroundImage:"url("+n.state.image+")"},n.state.orientationStyles);return i.a.createElement("div",{className:"".concat(e,"-img-preview")},i.a.createElement("div",{className:"img-preview__image"},i.a.createElement("div",{alt:"".concat(e," image preview"),style:t,className:"".concat(e,"-img-preview")})))}if(n.state.setDefaultSrc)return i.a.createElement("img",{className:"".concat(e,"-img"),alt:"".concat(e," image"),src:n.props.defaultImageSrc});if(n.props.src&&!n.state.removeSrc){var r,o,a=i.a.createElement("img",{className:"".concat(e,"-img"),alt:"".concat(e," image"),src:n.props.src});return n.props.onRemove||n.props.onSetDefault?(n.props.onRemove?(r=i.a.createElement(s.c,{id:"setting_picture.remove",defaultMessage:"Remove this icon"}),o=n.handleRemoveSrc):n.props.onSetDefault&&(r=i.a.createElement(s.c,{id:"setting_picture.remove_profile_picture",defaultMessage:"Remove profile picture"}),o=n.handleSetDefaultSrc),i.a.createElement("div",{className:"".concat(e,"-img__container")},i.a.createElement("div",{className:"img-preview__image","aria-hidden":!0},a),i.a.createElement(c.a,{delayShow:u.i.OVERLAY_TIME_DELAY,placement:"right",overlay:i.a.createElement(l.a,{id:"removeIcon"},i.a.createElement("div",{"aria-hidden":!0},r))},i.a.createElement("button",{className:"".concat(e,"-img__remove"),onClick:o},i.a.createElement("span",{"aria-hidden":!0},"×"),i.a.createElement("span",{className:"sr-only"},r))))):a}return null}),n.settingList=i.a.createRef(),n.selectInput=i.a.createRef(),n.confirmButton=i.a.createRef(),n.state={image:null,removeSrc:!1,setDefaultSrc:!1},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&E(e,t)}(t,a["Component"]),n=t,(r=[{key:"focusFirstElement",value:function(){this.settingList.current&&this.settingList.current.focus()}},{key:"componentDidMount",value:function(){this.focusFirstElement(),this.selectInput.current&&this.selectInput.current.addEventListener("input",this.handleFileSelected)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.file!==this.props.file&&(this.setState({image:null}),this.setPicture(e.file))}},{key:"componentWillUnmount",value:function(){this.previewBlob&&URL.revokeObjectURL(this.previewBlob),this.selectInput.current&&this.selectInput.current.removeEventListener("input",this.handleFileSelected)}},{key:"render",value:function(){var e,t,n=this.props.imageContext,r=this.renderImg(),o="btn btn-sm",a=!1;return this.props.submitActive||this.state.removeSrc||this.state.setDefaultSrc?o+=" btn-primary":(o+=" btn-inactive disabled",a=!0),e="team"===n?i.a.createElement(h.b,{id:"setting_picture.help.team",defaultMessage:"Upload a team icon in BMP, JPG or PNG format.\\nSquare images with a solid background color are recommended."}):i.a.createElement(s.c,{id:"setting_picture.help.profile",defaultMessage:"Upload a picture in BMP, JPG or PNG format. Maximum file size: {max}",values:{max:Object(p.p)(this.props.maxFileSize)}}),r&&(t=i.a.createElement("li",{className:"setting-list-item",role:"presentation"},r)),i.a.createElement("ul",{className:"section-max form-horizontal"},i.a.createElement("li",{className:"col-xs-12 section-title"},this.props.title),i.a.createElement("li",{className:"col-xs-offset-3 col-xs-8"},i.a.createElement("ul",{className:"setting-list",ref:this.settingList,tabIndex:"-1","aria-label":this.props.title,"aria-describedby":"setting-picture__helptext"},t,i.a.createElement("li",{id:"setting-picture__helptext",className:"setting-list-item padding-top x2",role:"presentation"},e),i.a.createElement("li",{className:"setting-list-item",role:"presentation"},i.a.createElement("hr",null),i.a.createElement(m.a,{errors:[this.props.clientError,this.props.serverError],type:"modal"}),i.a.createElement("input",{ref:this.selectInput,className:"hidden",accept:".jpg,.png,.bmp",type:"file",onChange:this.handleFileChange,disabled:this.props.loadingPicture,"aria-hidden":!0,tabIndex:"-1"}),i.a.createElement("button",{className:"btn btn-sm btn-primary btn-file sel-btn",disabled:this.props.loadingPicture,onClick:this.handleInputFile,"aria-label":Object(p.ab)("setting_picture.select","Select")},i.a.createElement(s.c,{id:"setting_picture.select",defaultMessage:"Select"})),i.a.createElement("button",{tabIndex:a?"-1":"0",ref:this.confirmButton,className:o,onClick:this.props.loadingPicture?function(){return!0}:this.handleSave,"aria-label":this.props.loadingPicture?Object(p.ab)("setting_picture.uploading","Uploading..."):Object(p.ab)("setting_picture.save","Save")},i.a.createElement(d.a,{loading:this.props.loadingPicture,text:Object(p.ab)("setting_picture.uploading","Uploading...")},i.a.createElement(s.c,{id:"setting_picture.save",defaultMessage:"Save"}))),i.a.createElement("button",{className:"btn btn-link btn-sm theme",href:"#",onClick:this.handleCancel,"aria-label":Object(p.ab)("setting_picture.cancel","Cancel")},i.a.createElement(s.c,{id:"setting_picture.cancel",defaultMessage:"Cancel"}))))))}}])&&y(n.prototype,r),o&&y(n,o),t}();_(O,"defaultProps",{imageContext:"profile"}),_(O,"propTypes",{clientError:o.a.string,serverError:o.a.string,src:o.a.string,defaultImageSrc:o.a.string,file:o.a.object,loadingPicture:o.a.bool,submitActive:o.a.bool,onRemove:o.a.func,onSetDefault:o.a.func,onSubmit:o.a.func,title:o.a.string,onFileChange:o.a.func,updateSection:o.a.func,imageContext:o.a.string,maxFileSize:o.a.number})},1793:function(e,t,n){"use strict";var r=n(7),o=n.n(r),a=n(30),i=n.n(a),s=n(1597),c=function(e){var t=e.url,n=e.text;return o.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:t},n)};c.propTypes={url:i.a.string.isRequired,text:i.a.oneOfType([i.a.string,i.a.node]).isRequired};var l=Object(s.a)(c);l.displayName="MenuItemExternalLink",t.a=l},1865:function(e,t,n){"use strict";n(88),n(43),n(299);var r=n(183),o=n.n(r),a=n(30),i=n.n(a),s=n(7),c=n.n(s),l=n(418),u=n.n(l),p=n(55),f=n(1677),d=n(0),m=n(1493),h=n(417),b=n(12),y=(n(209),n(155),n(24),n(31)),g=n(23),v=n(1545),E=n(1505),_=n(1490);function O(e){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function w(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function C(e,t){return!t||"object"!==O(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function P(e,t){return(P=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function j(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var T=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),C(this,S(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&P(e,t)}(t,c.a.Component),n=t,(r=[{key:"render",value:function(){var e=this,t=null;this.props.actions&&(t=this.props.actions.map(function(t,n){return c.a.createElement(t,Object.assign({key:n.toString(),user:e.props.user,index:e.props.index,totalUsers:e.props.totalUsers},e.props.actionProps,e.props.actionUserProps))}));var n,r=this.props.user.email,o="more-modal__description";this.props.extraInfo&&this.props.extraInfo.length>0?(r=c.a.createElement(_.b,{id:"admin.user_item.emailTitle",defaultMessage:"**Email:** {email}",values:{email:this.props.user.email}}),o=""):n=this.props.user.status?this.props.user.status:this.props.status,this.props.user.is_bot&&(n=null,r=null);var a=null,i=null;return this.props.userCount>=0&&(a=g.h("userListRowName"+this.props.userCount),i=g.h("userListRowEmail"+this.props.userCount)),c.a.createElement("div",{key:this.props.user.id,className:"more-modal__row"},c.a.createElement(v.a,{src:y.Client4.getProfilePictureUrl(this.props.user.id,this.props.user.last_picture_update),status:n,width:"32",height:"32"}),c.a.createElement("div",{className:"more-modal__details"},c.a.createElement("div",{id:a,className:"more-modal__name"},g.m(this.props.user),c.a.createElement(E.a,{className:"badge-popoverlist",show:Boolean(this.props.user.is_bot)})),c.a.createElement("div",{id:i,className:o},r),this.props.extraInfo),c.a.createElement("div",{className:"more-modal__actions"},t))}}])&&w(n.prototype,r),o&&w(n,o),t}();j(T,"propTypes",{user:i.a.object.isRequired,status:i.a.string,extraInfo:i.a.arrayOf(i.a.object),actions:i.a.arrayOf(i.a.func),actionProps:i.a.object,actionUserProps:i.a.object,index:i.a.number,totalUsers:i.a.number,userCount:i.a.number}),j(T,"defaultProps",{extraInfo:[],actions:[],actionProps:{},actionUserProps:{}});var k=Object(h.connect)(function(e,t){var n=t.user||{};return{status:Object(b.getStatusForUserId)(e,n.id)}})(T);function N(e){return(N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function R(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function M(e){return(M=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function I(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function x(e,t){return(x=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function A(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var L=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=M(t).call(this,e))||"object"!==N(o)&&"function"!=typeof o?I(r):o).scrollToTop=n.scrollToTop.bind(I(n)),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&x(e,t)}(t,c.a.Component),n=t,(r=[{key:"scrollToTop",value:function(){this.refs.container&&(this.refs.container.scrollTop=0)}},{key:"render",value:function(){var e,t=this,n=this.props.users,r=this.props.rowComponentType;return null==n?c.a.createElement(m.a,null):(e=n.length>0?n.map(function(e,o){return c.a.createElement(r,{key:e.id,user:e,extraInfo:t.props.extraInfo[e.id],actions:t.props.actions,actionProps:t.props.actionProps,actionUserProps:t.props.actionUserProps[e.id],index:o,totalUsers:n.length,userCount:o>=0&&o<d.Q.TEST_ID_COUNT?o:-1})}):c.a.createElement("div",{key:"no-users-found",className:"more-modal__placeholder-row"},c.a.createElement("p",null,c.a.createElement(p.c,{id:"user_list.notFound",defaultMessage:"No users found"}))),c.a.createElement("div",{ref:"container"},e))}}])&&R(n.prototype,r),o&&R(n,o),t}();A(L,"propTypes",{users:i.a.arrayOf(i.a.object),extraInfo:i.a.object,actions:i.a.arrayOf(i.a.func),actionProps:i.a.object,actionUserProps:i.a.object,rowComponentType:i.a.func}),A(L,"defaultProps",{users:[],extraInfo:{},actions:[],actionProps:{},rowComponentType:k});var D=n(1498),U=n(56);function q(e){return(q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function H(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function F(e){return(F=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function B(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function G(e,t){return(G=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function V(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"a",function(){return W});var W=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=F(t).call(this,e))||"object"!==q(o)&&"function"!=typeof o?B(r):o).nextPage=n.nextPage.bind(B(n)),n.previousPage=n.previousPage.bind(B(n)),n.focusSearchBar=n.focusSearchBar.bind(B(n)),n.handleInput=n.handleInput.bind(B(n)),n.renderCount=n.renderCount.bind(B(n)),n.nextTimeoutId=0,n.state={nextDisabled:!1},n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&G(e,t)}(t,c.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){this.focusSearchBar()}},{key:"componentDidUpdate",value:function(e){this.props.page===e.page&&this.props.term===e.term||this.refs.userList.scrollToTop()}},{key:"componentWillUnmount",value:function(){clearTimeout(this.nextTimeoutId)}},{key:"nextPage",value:function(e){var t=this;e.preventDefault(),this.setState({nextDisabled:!0}),this.nextTimeoutId=setTimeout(function(){return t.setState({nextDisabled:!1})},500),this.props.nextPage(),o()(u.a.findDOMNode(this.refs.channelListScroll)).scrollTop(0)}},{key:"previousPage",value:function(e){e.preventDefault(),this.props.previousPage(),o()(u.a.findDOMNode(this.refs.channelListScroll)).scrollTop(0)}},{key:"focusSearchBar",value:function(){this.props.focusOnMount&&this.refs.filter.focus()}},{key:"handleInput",value:function(e){this.props.onTermChange(e.target.value),this.props.search(e.target.value)}},{key:"renderCount",value:function(e){if(!e)return null;if(this.props.filter)return null;var t,n,r=e.length,o=this.props.total,a=Boolean(this.props.term);return a?(t=-1,n=-1):(t=this.props.page*this.props.usersPerPage,n=Math.min(t+this.props.usersPerPage,o)),this.props.renderCount?this.props.renderCount(r,this.props.total,t,n,a):this.props.total?a?c.a.createElement(p.c,{id:"filtered_user_list.countTotal",defaultMessage:"{count, number} {count, plural, one {member} other {members}} of {total, number} total",values:{count:r,total:o}}):c.a.createElement(p.c,{id:"filtered_user_list.countTotalPage",defaultMessage:"{startCount, number} - {endCount, number} {count, plural, one {member} other {members}} of {total, number} total",values:{count:r,startCount:t+1,endCount:n,total:o}}):null}},{key:"render",value:function(){var e,t,n,r;if(this.props.term||!this.props.users)n=this.props.users;else if(!this.props.term){var o=this.props.page*this.props.usersPerPage,a=o+this.props.usersPerPage;n=this.props.users.slice(o,a),a<this.props.users.length&&(e=c.a.createElement("button",{id:"searchableUserListNextBtn",className:"btn btn-link filter-control filter-control__next",onClick:this.nextPage,disabled:this.state.nextDisabled},c.a.createElement(p.c,{id:"filtered_user_list.next",defaultMessage:"Next"}))),this.props.page>0&&(t=c.a.createElement("button",{id:"searchableUserListPrevBtn",className:"btn btn-link filter-control filter-control__prev",onClick:this.previousPage},c.a.createElement(p.c,{id:"filtered_user_list.prev",defaultMessage:"Previous"})))}return r=this.props.renderFilterRow?this.props.renderFilterRow(this.handleInput):c.a.createElement("div",{className:"col-xs-12"},c.a.createElement(f.a,{id:"searchUsersInput",ref:"filter",className:"form-control filter-textbox",placeholder:{id:Object(U.b)("filtered_user_list.search"),defaultMessage:"Search users"},inputComponent:D.a,value:this.props.term,onInput:this.handleInput})),c.a.createElement("div",{className:"filtered-user-list"},c.a.createElement("div",{className:"filter-row"},r,c.a.createElement("div",{className:"col-sm-12"},c.a.createElement("span",{id:"searchableUserListTotal",className:"member-count pull-left","aria-live":"polite"},this.renderCount(n)))),c.a.createElement("div",{className:"more-modal__list"},c.a.createElement(L,{ref:"userList",users:n,extraInfo:this.props.extraInfo,actions:this.props.actions,actionProps:this.props.actionProps,actionUserProps:this.props.actionUserProps,rowComponentType:this.props.rowComponentType})),c.a.createElement("div",{className:"filter-controls"},t,e))}}])&&H(n.prototype,r),a&&H(n,a),t}();V(W,"propTypes",{users:i.a.arrayOf(i.a.object),usersPerPage:i.a.number,total:i.a.number,extraInfo:i.a.object,nextPage:i.a.func.isRequired,previousPage:i.a.func.isRequired,search:i.a.func.isRequired,actions:i.a.arrayOf(i.a.func),actionProps:i.a.object,actionUserProps:i.a.object,focusOnMount:i.a.bool,renderCount:i.a.func,filter:i.a.string,renderFilterRow:i.a.func,page:i.a.number.isRequired,term:i.a.string.isRequired,onTermChange:i.a.func.isRequired,rowComponentType:i.a.func}),V(W,"defaultProps",{users:[],usersPerPage:50,extraInfo:{},actions:[],actionProps:{},actionUserProps:{},showTeamToggle:!1,focusOnMount:!1})},1866:function(e,t,n){"use strict";var r=n(417),o=n(36),a=n(12),i=(n(88),n(43),n(30)),s=n.n(i),c=n(7),l=n.n(c),u=n(1684),p=n(31),f=n(110),d=n(1731),m=n(1767);function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _=300,O=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=y(t).call(this,e),n=!o||"object"!==h(o)&&"function"!=typeof o?g(r):o,E(g(n),"handleClick",function(e){var t=n.overlayRef.current.getBoundingClientRect(),r=Object(m.a)(t,window.innerHeight,{above:_});n.setState({target:e.target,show:!n.state.show,placement:r})}),E(g(n),"hideOverlay",function(){n.setState({show:!1})}),n.state={user:n.getUserFromMentionName(e),show:!1},n.overlayRef=l.a.createRef(),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}(t,l.a.PureComponent),n=t,(r=[{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.mentionName===this.props.mentionName&&e.usersByUsername===this.props.usersByUsername||this.setState({user:this.getUserFromMentionName(e)})}},{key:"getUserFromMentionName",value:function(e){for(var t=e.usersByUsername,n=e.mentionName.toLowerCase();n.length>0;){if(t.hasOwnProperty(n))return t[n];if(!/[._-]$/.test(n))break;n=n.substring(0,n.length-1)}return""}},{key:"render",value:function(){if(!this.state.user)return l.a.createElement(l.a.Fragment,null,this.props.children);var e=this.state.user,t=this.props.mentionName.substring(e.username.length),n="mention-link";return e.id===this.props.currentUserId&&(n+=" mention--highlight"),l.a.createElement("span",null,l.a.createElement(u.a,{placement:this.state.placement,show:this.state.show,target:this.state.target,rootClose:!0,onHide:this.hideOverlay},l.a.createElement(d.a,{userId:e.id,src:p.Client4.getProfilePictureUrl(e.id,e.last_picture_update),isRHS:this.props.isRHS,hasMention:this.props.hasMention,hide:this.hideOverlay})),l.a.createElement("a",{className:n,onClick:this.handleClick,ref:this.overlayRef},"@"+Object(f.displayUsername)(e,this.props.teammateNameDisplay)),t)}}])&&b(n.prototype,r),o&&b(n,o),t}();E(O,"propTypes",{children:s.a.node,currentUserId:s.a.string.isRequired,hasMention:s.a.bool,isRHS:s.a.bool,mentionName:s.a.string.isRequired,teammateNameDisplay:s.a.string.isRequired,usersByUsername:s.a.object.isRequired}),E(O,"defaultProps",{isRHS:!1,hasMention:!1});t.a=Object(r.connect)(function(e){return{currentUserId:Object(a.getCurrentUserId)(e),teammateNameDisplay:Object(o.getTeammateNameDisplaySetting)(e),usersByUsername:Object(a.getUsersByUsername)(e)}})(O)},1867:function(e,t,n){"use strict";var r=n(417),o=n(20),a=n(1501),i=(n(88),n(43),n(32),n(33),n(24),n(44),n(209),n(30)),s=n.n(i),c=n(7),l=n.n(c);function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t){return!t||"object"!==u(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var b,y,g,v=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),d(this,m(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(t,l.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.modals,n=p(e,["modals"]),r=t.modalState;if(!t)return l.a.createElement("div",null);var o=[];for(var a in r)if(r.hasOwnProperty(a)){var i=r[a];if(i.open){var s=l.a.createElement(i.dialogType,Object.assign({},i.dialogProps,{onHide:n.actions.closeModal.bind(this,a),key:"".concat(a,"_modal")}));o.push(s)}}return l.a.createElement("div",null,o)}}])&&f(n.prototype,r),o&&f(n,o),t}();b=v,y="propTypes",g={modals:s.a.object.isRequired,actions:s.a.shape({closeModal:s.a.func.isRequired}).isRequired},y in b?Object.defineProperty(b,y,{value:g,enumerable:!0,configurable:!0,writable:!0}):b[y]=g;t.a=Object(r.connect)(function(e){return{modals:e.views.modals}},function(e){return{actions:Object(o.bindActionCreators)({closeModal:a.a},e)}})(v)},1868:function(e,t,n){"use strict";n(88),n(43),n(300),n(301);var r=n(30),o=n.n(r),a=n(7),i=n.n(a),s=function(e){var t=e.children,n=e.footer,r=e.helpText,o=e.inputId,a=e.label,s=e.labelClassName,c=e.inputClassName;return i.a.createElement("div",{className:"form-group"},i.a.createElement("label",{className:"control-label "+s,htmlFor:o},a),i.a.createElement("div",{className:c},t,i.a.createElement("div",{className:"help-text"},r),n))};s.propTypes={inputId:o.a.string,label:o.a.node.isRequired,labelClassName:o.a.string,inputClassName:o.a.string,children:o.a.node.isRequired,helpText:o.a.node,footer:o.a.node};var c=s;function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"a",function(){return h});var h=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=p(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==l(o)&&"function"!=typeof o?f(r):o,m(f(n),"handleChange",function(e){"number"===n.props.type?n.props.onChange(n.props.id,parseInt(e.target.value,10)):n.props.onChange(n.props.id,e.target.value)}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(t,i.a.Component),n=t,(r=[{key:"render",value:function(){var e=this.props.resizable,t=this.props.type,n=null;if("textarea"===t){var r={};e||(r.resize="none"),n=i.a.createElement("textarea",{id:this.props.id,style:r,className:"form-control",rows:"5",placeholder:this.props.placeholder,value:this.props.value,maxLength:this.props.maxLength,onChange:this.handleChange,disabled:this.props.disabled})}else t=["input","email","tel","number","url"].includes(t)?t:"input",n=i.a.createElement("input",{id:this.props.id,className:"form-control",type:t,placeholder:this.props.placeholder,value:this.props.value,maxLength:this.props.maxLength,onChange:this.handleChange,disabled:this.props.disabled});return i.a.createElement(c,{label:this.props.label,labelClassName:this.props.labelClassName,inputClassName:this.props.inputClassName,helpText:this.props.helpText,inputId:this.props.id,footer:this.props.footer},n)}}])&&u(n.prototype,r),o&&u(n,o),t}();m(h,"validTypes",["input","textarea","number","email","tel","url"]),m(h,"propTypes",{id:o.a.string.isRequired,label:o.a.node.isRequired,labelClassName:o.a.string,placeholder:o.a.string,helpText:o.a.node,footer:o.a.node,value:o.a.oneOfType([o.a.string,o.a.number]).isRequired,inputClassName:o.a.string,maxLength:o.a.number,resizable:o.a.bool,onChange:o.a.func,disabled:o.a.bool,type:o.a.oneOf(h.validTypes)}),m(h,"defaultProps",{labelClassName:"",inputClassName:"",type:"input",maxLength:null,resizable:!0})},1869:function(e,t,n){"use strict";var r=n(417),o=n(12),a=n(312),i=n(310),s=n(36),c=n(242),l=n(0),u=(n(88),n(43),n(209),n(155),n(24),n(30)),p=n.n(u),f=n(7),d=n.n(f),m=n(55),h=n(297),b=n.n(h);function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function v(e,t){return!t||"object"!==y(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function E(e){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _(e,t){return(_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var O,w,C,S=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),v(this,E(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_(e,t)}(t,d.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.enableTimezone,n=e.eventTime,r=e.timeZone,o=e.useMilitaryTime,a=n?new Date(n):new Date,i=b()(a);t&&r?(i.tz(r),i=i.toString()+" ("+i.tz()+")"):i=i.toString();var s=t&&r?{timeZone:r}:{};return d.a.createElement("time",{"aria-label":a,className:"post__time",dateTime:a.toISOString(),title:i,id:"localDateTime"},d.a.createElement(m.d,Object.assign({},s,{hour12:!o,value:a})))}}])&&g(n.prototype,r),o&&g(n,o),t}();O=S,w="propTypes",C={eventTime:p.a.number,useMilitaryTime:p.a.bool,timeZone:p.a.string,enableTimezone:p.a.bool},w in O?Object.defineProperty(O,w,{value:C,enumerable:!0,configurable:!0,writable:!0}):O[w]=C;t.a=Object(r.connect)(function(e,t){var n,r=Object(o.getCurrentUserId)(e);return n=t.userTimezone?t.userTimezone:Object(a.getUserTimezone)(e,r),{enableTimezone:Object(c.a)(e),useMilitaryTime:Object(s.getBool)(e,l.z.CATEGORY_DISPLAY_SETTINGS,l.z.USE_MILITARY_TIME,!1),timeZone:Object(i.getUserCurrentTimezone)(n)}})(S)},1870:function(e,t,n){"use strict";var r=n(417),o=n(25),a=n(0),i=n(1580),s=(n(88),n(43),n(30)),c=n.n(s),l=n(7),u=n.n(l),p=n(1738),f=n(55),d=n(1490),m=n(1692);function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=y(t).call(this,e))||"object"!==h(o)&&"function"!=typeof o?g(r):o).doHide=n.doHide.bind(g(n)),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}(t,u.a.PureComponent),n=t,(r=[{key:"doHide",value:function(){this.props.onHide()}},{key:"render",value:function(){var e,t,n,r,o=this.props.config,a=this.props.license,i=u.a.createElement(f.c,{id:"about.teamEditiont0",defaultMessage:"Team Edition"}),s=u.a.createElement(f.c,{id:"about.teamEditionSt",defaultMessage:"All your team communication in one place, instantly searchable and accessible anywhere."}),c=u.a.createElement("div",null,u.a.createElement(f.c,{id:"about.teamEditionLearn",defaultMessage:"Join the Mattermost community at "}),u.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"http://www.mattermost.org/"},"mattermost.org"));"true"===o.BuildEnterpriseReady&&(i=u.a.createElement(f.c,{id:"about.teamEditiont1",defaultMessage:"Enterprise Edition"}),s=u.a.createElement(f.c,{id:"about.enterpriseEditionSt",defaultMessage:"Modern communication from behind your firewall."}),c=u.a.createElement("div",null,u.a.createElement(f.c,{id:"about.enterpriseEditionLearn",defaultMessage:"Learn more about Enterprise Edition at "}),u.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"http://about.mattermost.com/"},"about.mattermost.com")),"true"===a.IsLicensed&&(i=u.a.createElement(f.c,{id:"about.enterpriseEditione1",defaultMessage:"Enterprise Edition"}),e=u.a.createElement("div",{className:"form-group"},u.a.createElement(f.c,{id:"about.licensed",defaultMessage:"Licensed to:"})," ",a.Company))),o.TermsOfServiceLink&&(t=u.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:o.TermsOfServiceLink},u.a.createElement(f.c,{id:"about.tos",defaultMessage:"Terms of Service"}))),o.PrivacyPolicyLink&&(n=u.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:o.PrivacyPolicyLink},u.a.createElement(f.c,{id:"about.privacy",defaultMessage:"Privacy Policy"}))),o.TermsOfServiceLink&&o.PrivacyPolicyLink&&(r=u.a.createElement("span",null," - "));var l=u.a.createElement("div",null,u.a.createElement(f.c,{id:"about.buildnumber",defaultMessage:"Build Number:"}),u.a.createElement("span",{id:"buildnumberString"}," "+o.BuildNumber));isNaN(o.BuildNumber)&&(l=null);var h=o.BuildNumber;return isNaN(o.BuildNumber)||(h="ci"),u.a.createElement(p.a,{dialogClassName:"a11y__modal about-modal",show:this.props.show,onHide:this.doHide,role:"dialog","aria-labelledby":"aboutModalLabel"},u.a.createElement(p.a.Header,{closeButton:!0},u.a.createElement(p.a.Title,{componentClass:"h1",id:"aboutModalLabel"},u.a.createElement(f.c,{id:"about.title",values:{appTitle:o.SiteName||"Mattermost"},defaultMessage:"About {appTitle}"}))),u.a.createElement(p.a.Body,null,u.a.createElement("div",{className:"about-modal__content"},u.a.createElement("div",{className:"about-modal__logo"},u.a.createElement(m.a,null)),u.a.createElement("div",null,u.a.createElement("h3",{className:"about-modal__title"},"Mattermost"," ",i),u.a.createElement("p",{className:"about-modal__subtitle padding-bottom"},s),u.a.createElement("div",{className:"form-group less"},u.a.createElement("div",null,u.a.createElement(f.c,{id:"about.version",defaultMessage:"Mattermost Version:"}),u.a.createElement("span",{id:"versionString"}," "+h)),u.a.createElement("div",null,u.a.createElement(f.c,{id:"about.dbversion",defaultMessage:"Database Schema Version:"}),u.a.createElement("span",{id:"dbversionString"}," "+o.Version)),l,u.a.createElement("div",null,u.a.createElement(f.c,{id:"about.database",defaultMessage:"Database:"})," "+o.SQLDriverName)),e)),u.a.createElement("div",{className:"about-modal__footer"},c,u.a.createElement("div",{className:"form-group"},u.a.createElement("div",{className:"about-modal__copyright"},u.a.createElement(f.c,{id:"about.copyright",defaultMessage:"Copyright 2015 - {currentYear} Mattermost, Inc. All rights reserved",values:{currentYear:(new Date).getFullYear()}})),u.a.createElement("div",{className:"about-modal__links"},t,r,n))),u.a.createElement("div",{className:"about-modal__notice form-group padding-top x2"},u.a.createElement("p",null,u.a.createElement(d.b,{id:"about.notice",defaultMessage:"Mattermost is made possible by the open source software used in our [server](!https://about.mattermost.com/platform-notice-txt/), [desktop](!https://about.mattermost.com/desktop-notice-txt/) and [mobile](!https://about.mattermost.com/mobile-notice-txt/) apps."}))),u.a.createElement("div",{className:"about-modal__hash"},u.a.createElement("p",null,u.a.createElement(f.c,{id:"about.hash",defaultMessage:"Build Hash:"})," ",o.BuildHash,u.a.createElement("br",null),u.a.createElement(f.c,{id:"about.hashee",defaultMessage:"EE Build Hash:"})," ",o.BuildHashEnterprise,u.a.createElement("br",null),u.a.createElement(f.c,{id:"about.hashwebapp",defaultMessage:"Webapp Build Hash:"})," ",this.props.webappBuildHash||"ccc3f4adf595e8b6dcdc950980f9b58594a79700\n"),u.a.createElement("p",null,u.a.createElement(f.c,{id:"about.date",defaultMessage:"Build Date:"})," ",o.BuildDate))))}}])&&b(n.prototype,r),o&&b(n,o),t}();E(_,"defaultProps",{show:!1}),E(_,"propTypes",{show:c.a.bool.isRequired,onHide:c.a.func.isRequired,config:c.a.object.isRequired,license:c.a.object.isRequired,webappBuildHash:c.a.string});t.a=Object(r.connect)(function(e){var t=a.r.ABOUT;return{config:Object(o.getConfig)(e),license:Object(o.getLicense)(e),show:Object(i.a)(e,t)}})(_)},1871:function(e,t,n){"use strict";n(44),n(419),n(32),n(33),n(108),n(120),n(300),n(301),n(106),n(24),n(107);var r=n(31),o=n(13),a=n(0),i=n(302),s=n(7),c=n.n(s),l=n(441),u=n.n(l),p=n(1590),f=n(304),d=n(430),m=n(23);function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function b(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Object(m.r)();return o.a.dispatch({type:a.e.RECEIVED_PLUGIN_COMPONENT,name:e,data:{id:r,pluginId:t,component:n}}),r}var y=function(e){return"function"==typeof e?c.a.createElement(e):e},g=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=t}var t,n,r;return t=e,(n=[{key:"registerRootComponent",value:function(e){return b("Root",this.id,e)}},{key:"registerPopoverUserAttributesComponent",value:function(e){return b("PopoverUserAttributes",this.id,e)}},{key:"registerPopoverUserActionsComponent",value:function(e){return b("PopoverUserActions",this.id,e)}},{key:"registerLeftSidebarHeaderComponent",value:function(e){return b("LeftSidebarHeader",this.id,e)}},{key:"registerBottomTeamSidebarComponent",value:function(e){return b("BottomTeamSidebar",this.id,e)}},{key:"registerPostMessageAttachmentComponent",value:function(e){return b("PostMessageAttachment",this.id,e)}},{key:"registerLinkTooltipComponent",value:function(e){return b("LinkTooltip",this.id,e)}},{key:"registerChannelHeaderButtonAction",value:function(e,t,n,r){var i=Object(m.r)(),s={id:i,pluginId:this.id,icon:y(e),action:t,dropdownText:y(n),tooltipText:r};return o.a.dispatch({type:a.e.RECEIVED_PLUGIN_COMPONENT,name:"ChannelHeaderButton",data:s}),o.a.dispatch({type:a.e.RECEIVED_PLUGIN_COMPONENT,name:"MobileChannelHeaderButton",data:s}),i}},{key:"registerPostTypeComponent",value:function(e,t){var n=Object(m.r)();return o.a.dispatch({type:a.e.RECEIVED_PLUGIN_POST_COMPONENT,data:{id:n,pluginId:this.id,type:e,component:t}}),n}},{key:"registerPostCardTypeComponent",value:function(e,t){var n=Object(m.r)();return o.a.dispatch({type:a.e.RECEIVED_PLUGIN_POST_CARD_COMPONENT,data:{id:n,pluginId:this.id,type:e,component:t}}),n}},{key:"registerMainMenuAction",value:function(e,t,n){var r=Object(m.r)();return o.a.dispatch({type:a.e.RECEIVED_PLUGIN_COMPONENT,name:"MainMenu",data:{id:r,pluginId:this.id,text:y(e),action:t,mobileIcon:y(n)}}),r}},{key:"registerPostDropdownMenuAction",value:function(e,t,n){var r=Object(m.r)();return o.a.dispatch({type:a.e.RECEIVED_PLUGIN_COMPONENT,name:"PostDropdownMenu",data:{id:r,pluginId:this.id,text:y(e),action:t,filter:n}}),r}},{key:"registerPostDropdownMenuComponent",value:function(e){return b("PostDropdownMenuItem",this.id,e)}},{key:"registerFileUploadMethod",value:function(e,t,n){var r=Object(m.r)();return o.a.dispatch({type:a.e.RECEIVED_PLUGIN_COMPONENT,name:"FileUploadMethod",data:{id:r,pluginId:this.id,text:n,action:t,icon:e}}),r}},{key:"registerFilesWillUploadHook",value:function(e){var t=Object(m.r)();return o.a.dispatch({type:a.e.RECEIVED_PLUGIN_COMPONENT,name:"FilesWillUploadHook",data:{id:t,pluginId:this.id,hook:e}}),t}},{key:"unregisterComponent",value:function(e){o.a.dispatch({type:a.e.REMOVED_PLUGIN_COMPONENT,id:e})}},{key:"unregisterPostTypeComponent",value:function(e){o.a.dispatch({type:a.e.REMOVED_PLUGIN_POST_COMPONENT,id:e})}},{key:"registerReducer",value:function(e){u.a.register("plugins-"+this.id,e)}},{key:"registerWebSocketEventHandler",value:function(e,t){Object(p.e)(this.id,e,t)}},{key:"unregisterWebSocketEventHandler",value:function(e){Object(p.j)(this.id,e)}},{key:"registerReconnectHandler",value:function(e){Object(p.d)(this.id,e)}},{key:"unregisterReconnectHandler",value:function(){Object(p.i)(this.id)}},{key:"registerMessageWillBePostedHook",value:function(e){var t=Object(m.r)();return o.a.dispatch({type:a.e.RECEIVED_PLUGIN_COMPONENT,name:"MessageWillBePosted",data:{id:t,pluginId:this.id,hook:e}}),t}},{key:"registerSlashCommandWillBePostedHook",value:function(e){var t=Object(m.r)();return o.a.dispatch({type:a.e.RECEIVED_PLUGIN_COMPONENT,name:"SlashCommandWillBePosted",data:{id:t,pluginId:this.id,hook:e}}),t}},{key:"registerMessageWillFormatHook",value:function(e){var t=Object(m.r)();return o.a.dispatch({type:a.e.RECEIVED_PLUGIN_COMPONENT,name:"MessageWillFormat",data:{id:t,pluginId:this.id,hook:e}}),t}},{key:"registerFilePreviewComponent",value:function(e,t){var n=Object(m.r)();return o.a.dispatch({type:a.e.RECEIVED_PLUGIN_COMPONENT,name:"FilePreview",data:{id:n,pluginId:this.id,override:e,component:t}}),n}},{key:"registerTranslations",value:function(e){Object(d.d)(this.id,e)}},{key:"registerRightHandSidebarComponent",value:function(e,t){var n=Object(m.r)();return o.a.dispatch({type:a.e.RECEIVED_PLUGIN_COMPONENT,name:"RightHandSidebarComponent",data:{id:n,pluginId:this.id,component:e,title:t}}),{id:n,showRHSPlugin:Object(f.m)(n)}}}])&&h(t.prototype,n),r&&h(t,r),e}();function v(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function E(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){v(a,r,o,i,s,"next",e)}function s(e){v(a,r,o,i,s,"throw",e)}i(void 0)})}}function _(){return O.apply(this,arguments)}function O(){return(O=E(regeneratorRuntime.mark(function e(){var t,n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("true"===o.a.getState().entities.general.config.PluginsEnabled){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,w()(o.a.dispatch);case 4:if(t=e.sent,n=t.data,!(r=t.error)){e.next=10;break}return console.error(r),e.abrupt("return");case 10:if(null!=n&&0!==n.length){e.next=12;break}return e.abrupt("return");case 12:return e.next=14,Promise.all(n.map(function(e){return S(e).catch(function(e){console.error(e.message)})}));case 14:case"end":return e.stop()}},e)}))).apply(this,arguments)}function w(){return function(){var e=E(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.Client4.getWebappPlugins();case 3:n=e.sent,e.next=9;break;case 6:return e.prev=6,e.t0=e.catch(0),e.abrupt("return",{error:e.t0});case 9:return t({type:a.e.RECEIVED_WEBAPP_PLUGINS,data:n}),e.abrupt("return",{data:n});case 11:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t){return e.apply(this,arguments)}}()}n.d(t,"a",function(){return _}),n.d(t,"b",function(){return S}),n.d(t,"d",function(){return P}),n.d(t,"c",function(){return j}),window.plugins={},window.registerPlugin=function(e,t){window.plugins[e]=t};var C={};function S(e){return new Promise(function(t,n){if(C[e.id])t();else{var r=e.webapp.bundle_path;r.includes("/static/")&&!r.includes("/static/plugins/")&&(r=r.replace("/static/","/static/plugins/")),console.log("Loading "+e.id+" plugin");var a=document.createElement("script");a.id="plugin_"+e.id,a.type="text/javascript",a.src=Object(i.e)()+r,a.onload=function(){!function(e){var t=window.plugins[e.id],n=new g(e.id);t&&t.initialize&&t.initialize(n,o.a)}(e),console.log("Loaded "+e.id+" plugin"),t()},a.onerror=function(){n(new Error("Unable to load bundle for plugin "+e.id))},document.getElementsByTagName("head")[0].appendChild(a),C[e.id]=!0}})}function P(e){console.log("Removing "+e.id+" plugin"),C[e.id]=!1;var t=window.plugins[e.id];t&&t.uninitialize?t.uninitialize():t&&t.deinitialize&&t.deinitialize(),Object(p.h)(e.id),Object(p.i)(e.id);var n=document.getElementById("plugin_"+e.id);n&&(n.parentNode.removeChild(n),console.log("Removed "+e.id+" plugin"))}function j(){return T.apply(this,arguments)}function T(){return(T=E(regeneratorRuntime.mark(function e(){var t,n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("true"===o.a.getState().entities.general.config.PluginsEnabled){e.next=2;break}return e.abrupt("return");case 2:return t=o.a.getState().plugins.plugins,e.next=5,w()(o.a.dispatch);case 5:if(n=e.sent,!(r=n.error)){e.next=10;break}return console.error(r),e.abrupt("return");case 10:i=o.a.getState().plugins.plugins,Object.values(i).forEach(function(e){var n=t[e.id];n&&n.version===e.version||S(e).catch(function(e){console.error(e.message)})}),Object.keys(t).forEach(function(e){if(!i.hasOwnProperty(e)){var n=t[e];o.a.dispatch({type:a.e.REMOVED_WEBAPP_PLUGIN,data:n}),P(n)}});case 13:case"end":return e.stop()}},e)}))).apply(this,arguments)}},1875:function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return Ve});n(88),n(43),n(32),n(33),n(24),n(44),n(299),n(185),n(209);var r=n(183),o=n.n(r),a=n(30),i=n.n(a),s=n(7),c=n.n(s),l=n(1892),u=n.n(l),p=n(436),f=n(251),d=n(213),m=n(25),h=n(39),b=n(105),y=n(421),g=n(1492),v=n(1620),E=n(403),_=n(428),O=n(1871),w=(n(2378),n(0)),C=n(1984),S=n(2377),P=n(2349),j=n(427),T=n(2079),k=n.n(T),N=n(2080),R=n.n(N),M=n(2081),I=n.n(M),x=n(1775),A=n.n(x),L=n(2082),D=n.n(L),U=n(2083),q=n.n(U),H=n(2084),F=n.n(H),B=n(2085),G=n.n(B),V=n(2086),W=n.n(V),K=n(2087),z=n.n(K),Y=n(2088),Q=n.n(Y),Z=n(2089),J=n.n(Z),X=n(2090),$=n.n(X),ee=n(2091),te=n.n(ee),ne=n(2092),re=n.n(ne),oe=n(2093),ae=n.n(oe),ie=n(2094),se=n.n(ie),ce=n(2095),le=n.n(ce),ue=n(2096),pe=n.n(ue),fe=n(13),de=n(302),me=n(23),he=n(2097);function be(e){return(be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ye(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){Oe(e,t,n[t])})}return e}function ge(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ve(e){return(ve=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ee(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _e(e,t){return(_e=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Oe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function we(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}n(1876)(o.a);var Ce=Object(j.b)(le.a),Se=Object(j.b)(k.a),Pe=Object(j.b)(W.a),je=Object(j.b)(R.a),Te=Object(j.b)(I.a),ke=Object(j.b)(A.a),Ne=Object(j.b)(D.a),Re=Object(j.b)(q.a),Me=Object(j.b)(F.a),Ie=Object(j.b)(G.a),xe=Object(j.b)(z.a),Ae=Object(j.b)(Q.a),Le=Object(j.b)(J.a),De=Object(j.b)($.a),Ue=Object(j.b)(te.a),qe=Object(j.b)(re.a),He=Object(j.b)(ae.a),Fe=Object(j.b)(se.a),Be=Object(j.b)(pe.a),Ge=function(e){var t=e.component,n=we(e,["component"]);return c.a.createElement(p.b,Object.assign({},n,{render:function(e){return c.a.createElement(ke,e,c.a.createElement(t,e))}}))},Ve=function(t){function n(t){var r,a,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),a=this,i=ve(n).call(this,t),r=!i||"object"!==be(i)&&"function"!=typeof i?Ee(a):i,Oe(Ee(r),"onConfigLoaded",function(){Object(me.N)()&&Object(me.o)();var t=w.Q.DIAGNOSTICS_SEGMENT_KEY,n=r.props.diagnosticId;null!=t&&""!==t&&!t.startsWith("placeholder")&&r.props.diagnosticsEnabled&&function(){var r=e.window.analytics=e.window.analytics||[];if(!r.initialize)if(r.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{r.invoked=!0,r.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","group","track","ready","alias","page","once","off","on"],r.factory=function(e){return function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];var a=Array.prototype.slice.call(n);return a.unshift(e),r.push(a),r}};for(var o=0;o<r.methods.length;o++){var a=r.methods[o];r[a]=r.factory(a)}r.load=function(e){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+e+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n)},r.SNIPPET_VERSION="3.0.1",r.load(t),r.identify(n,{},{context:{ip:"0.0.0.0"},page:{path:"",referrer:"",search:"",title:"",url:""},anonymousId:"00000000000000000000000000"}),r.page("ApplicationLoaded",{path:"",referrer:"",search:"",title:"",url:""},{context:{ip:"0.0.0.0"},anonymousId:"00000000000000000000000000"})}}();var o=function(){"/"===r.props.location.pathname&&r.props.noAccounts&&r.props.history.push("/signup_user_complete"),Object(O.a)().then(function(){r.setState({configLoaded:!0})})};e.Intl?o():_.f(o),Object(E.c)()(fe.a.dispatch,fe.a.getState);var a=Object(m.getConfig)(fe.a.getState()).IosAppDownloadLink,i=Object(m.getConfig)(fe.a.getState()).AndroidAppDownloadLink,s="/reset_password_complete"===r.props.location.pathname;a&&h.k()&&!v.a.hasSeenLandingPage()&&!s?(r.props.history.push("/get_ios_app?redirect_to="+encodeURIComponent(r.props.location.pathname)+encodeURIComponent(r.props.location.search)),v.a.setLandingPageSeen(!0)):i&&h.b()&&!v.a.hasSeenLandingPage()&&!s&&(r.props.history.push("/get_android_app?redirect_to="+encodeURIComponent(r.props.location.pathname)+encodeURIComponent(r.props.location.search)),v.a.setLandingPageSeen(!0))}),Oe(Ee(r),"redirectIfNecessary",function(e){"/"===e.location.pathname&&(r.props.noAccounts?r.props.history.push("/signup_user_complete"):e.showTermsOfService&&r.props.history.push("/terms_of_service"))}),r.currentCategoryFocus=0,r.currentSidebarFocus=0,Object(f.setUrl)(Object(de.e)()),Object(d.setSystemEmojis)(b.a),o()(window).bind("storage",function(e){if(e.originalEvent.key===w.G.LOGOUT&&e.originalEvent.storageArea===localStorage&&e.originalEvent.newValue){if(v.a.isSignallingLogout(e.originalEvent.newValue))return;console.log("detected logout from a different tab"),g.e("/",!1,!1)}if(e.originalEvent.key===w.G.LOGIN&&e.originalEvent.storageArea===localStorage&&e.originalEvent.newValue){if(v.a.isSignallingLogin(e.originalEvent.newValue))return;console.log("detected login from a different tab"),location.reload()}}),document.addEventListener("drop",function(e){e.preventDefault(),e.stopPropagation()}),document.addEventListener("dragover",function(e){e.preventDefault(),e.stopPropagation()}),u.a.attach(document.body),r.state={configLoaded:!1},h.f()||(r.a11yController=new he.a),r}var r,a,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_e(e,t)}(n,c.a.Component),r=n,(a=[{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.redirectIfNecessary(e)}},{key:"componentDidMount",value:function(){var e=this;this.props.actions.loadMeAndConfig().then(function(t){"/"===e.props.location.pathname&&t[2]&&t[2].data&&g.f(),e.onConfigLoaded()}),Object(y.e)()}},{key:"componentWillUnmount",value:function(){o()(window).unbind("storage")}},{key:"render",value:function(){return this.state.configLoaded?c.a.createElement(S.a,null,c.a.createElement(p.d,null,c.a.createElement(p.b,{path:"/error",component:Se}),c.a.createElement(C.a,{path:"/login",component:je}),c.a.createElement(C.a,{path:"/reset_password",component:Ne}),c.a.createElement(C.a,{path:"/reset_password_complete",component:Re}),c.a.createElement(C.a,{path:"/signup_user_complete",component:Me}),c.a.createElement(C.a,{path:"/signup_email",component:Ie}),c.a.createElement(C.a,{path:"/should_verify_email",component:xe}),c.a.createElement(C.a,{path:"/do_verify_email",component:Ae}),c.a.createElement(C.a,{path:"/claim",component:Le}),c.a.createElement(C.a,{path:"/help",component:De}),c.a.createElement(Ge,{path:"/terms_of_service",component:Pe}),c.a.createElement(p.b,{path:"/get_ios_app",component:Ue}),c.a.createElement(p.b,{path:"/get_android_app",component:qe}),c.a.createElement(Ge,{path:"/admin_console",component:Te}),c.a.createElement(C.b,{path:"/select_team",component:He}),c.a.createElement(C.b,{path:"/oauth/authorize",component:Fe}),c.a.createElement(C.b,{path:"/create_team",component:Ce}),c.a.createElement(Ge,{path:"/mfa",component:Be}),c.a.createElement(Ge,{path:"/:team",component:P.a}),c.a.createElement(p.a,{to:ye({},this.props.location,{pathname:"/login"})}))):c.a.createElement("div",null)}}])&&ge(r.prototype,a),i&&ge(r,i),n}();Oe(Ve,"propTypes",{diagnosticsEnabled:i.a.bool,diagnosticId:i.a.string,noAccounts:i.a.bool,showTermsOfService:i.a.bool,actions:i.a.shape({loadMeAndConfig:i.a.func.isRequired}).isRequired})}).call(this,n(41))},1893:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return s});n(106),n(24),n(107);var r=n(0);function o(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function a(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var i=e.apply(t,n);function s(e){o(i,r,a,s,c,"next",e)}function c(e){o(i,r,a,s,c,"throw",e)}s(void 0)})}}function i(){return function(){var e=a(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t({type:r.e.INCREMENT_WS_ERROR_COUNT});case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}function s(){return function(){var e=a(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t({type:r.e.RESET_WS_ERROR_COUNT});case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}},1921:function(e,t,n){},1964:function(e,t,n){e.exports=function(e){Promise.all([n.e(1),n.e(22),n.e(16)]).then(function(t){e(n(2352))}.bind(null,n)).catch(n.oe)}},1970:function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return v});n(88),n(43);var r=n(30),o=n.n(r),a=n(7),i=n.n(a),s=n(1768),c=n(418),l=n.n(c),u=n(0),p=n(1548);function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var g={display:"flex",flexDirection:"column",alignItems:"center",zIndex:"10"},v=function(t){function n(t){var r,o,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),o=this,a=m(n).call(this,t),r=!a||"object"!==f(a)&&"function"!=typeof a?h(o):a,y(h(r),"showTooltip",function(t){if(clearTimeout(r.hideTimeout),!r.show){var n=e(t.target),o=e(r.tooltipContainerRef.current);clearTimeout(r.showTimeout),r.showTimeout=setTimeout(function(){r.show=!0,o.show(),o.children().on("mouseover",function(){return clearTimeout(r.hideTimeout)}),o.children().on("mouseleave",function(e){null!==e.toElement&&r.hideTooltip()}),r.popper=new s.a(n,o,{placement:"bottom",modifiers:{preventOverflow:{enabled:!1},hide:{enabled:!1}}})},u.i.OVERLAY_TIME_DELAY)}}),y(h(r),"hideTooltip",function(){clearTimeout(r.hideTimeout),r.hideTimeout=setTimeout(function(){r.show=!1,clearTimeout(r.showTimeout),e(r.tooltipContainerRef.current).hide()},u.i.OVERLAY_TIME_DELAY_SMALL)}),r.tooltipContainerRef=i.a.createRef(),r.show=!1,r}var r,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}(n,i.a.PureComponent),r=n,(o=[{key:"render",value:function(){var e=this.props,t=e.href,n=e.title;return i.a.createElement(i.a.Fragment,null,l.a.createPortal(i.a.createElement("div",{style:g,ref:this.tooltipContainerRef},i.a.createElement(p.a,{href:t,pluggableName:"LinkTooltip"})),document.getElementById("root")),i.a.createElement("span",{onMouseOver:this.showTooltip,onMouseLeave:this.hideTooltip},n))}}])&&d(r.prototype,o),a&&d(r,a),n}();y(v,"propTypes",{href:o.a.string.isRequired,title:o.a.string.isRequired})}).call(this,n(183))},1984:function(e,t,n){"use strict";n.d(t,"a",function(){return f}),n.d(t,"b",function(){return d});n(43),n(32),n(33),n(24),n(44),n(209);var r=n(7),o=n.n(r),a=n(436),i=n(1985),s=n.n(i),c=n(1775),l=n.n(c),u=n(427);function p(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var f=function(e){var t=e.component,n=p(e,["component"]);return o.a.createElement(a.b,Object.assign({},n,{render:function(e){return o.a.createElement(u.a,Object.assign({doLoad:s.a},e),o.a.createElement(t,e))}}))},d=function(e){var t=e.component,n=p(e,["component"]);return o.a.createElement(a.b,Object.assign({},n,{render:function(e){return o.a.createElement(u.a,Object.assign({doLoad:l.a},e),o.a.createElement(u.a,Object.assign({doLoad:s.a},e),o.a.createElement(t,e)))}}))}},1985:function(e,t,n){e.exports=function(e){n.e(28).then(function(t){e(n(2372))}.bind(null,n)).catch(n.oe)}},1987:function(e,t,n){e.exports=function(e){n.e(9).then(function(t){e(n(2351))}.bind(null,n)).catch(n.oe)}},1993:function(e,t,n){},1994:function(e,t,n){},1995:function(e,t,n){},1998:function(e,t,n){},1999:function(e,t,n){},2007:function(e,t,n){e.exports=n.p+"files/86911ca1b4bd5d37b1681ad52dfcf232.png"},2008:function(e,t,n){e.exports=n.p+"files/ea640a6646c0b59f88f3e0728be11ee1.png"},2029:function(e,t,n){(function(e){var t;(t=e).fn.dragster=function(e){var n=t.extend({enter:t.noop,leave:t.noop,over:t.noop,drop:t.noop},e);return this.each(function(){var e=!1,r=!1,o=t(this);o.on({dragenter:function(t){e?r=!0:(e=!0,o.trigger("dragster:enter",t),t.preventDefault())},dragleave:function(t){r?r=!1:e&&(e=!1),e||r||o.trigger("dragster:leave",t),t.preventDefault()},dragover:function(e){o.trigger("dragster:over",e),e.preventDefault()},drop:function(t){r?r=!1:e&&(e=!1),e||r||o.trigger("dragster:drop",t),t.preventDefault()},"dragster:enter":n.enter,"dragster:leave":n.leave,"dragster:over":n.over,"dragster:drop":n.drop})})}}).call(this,n(183))},2031:function(e,t,n){e.exports=function(e){n.e(31).then(function(t){e(n(2262))}.bind(null,n)).catch(n.oe)}},2041:function(e,t,n){e.exports=n.p+"files/bd956aafccffed574da236f21af209ef.gif"},2042:function(e,t,n){e.exports=n.p+"files/8b03642d36741ba3030a9004a1d56bb0.gif"},2051:function(e,t,n){e.exports=n.p+"files/08e71e3e79544893825f62b7398a18e3.png"},2052:function(e,t,n){e.exports=n.p+"files/f17f34e72125711d05850934588a743b.png"},2078:function(e,t,n){e.exports=n.p+"files/c86ea01a44f1291289b4af3eeb01f261.png"},2079:function(e,t,n){e.exports=function(e){Promise.all([n.e(2),n.e(19)]).then(function(t){e(n(2360))}.bind(null,n)).catch(n.oe)}},2080:function(e,t,n){e.exports=function(e){n.e(10).then(function(t){e(n(2371))}.bind(null,n)).catch(n.oe)}},2081:function(e,t,n){e.exports=function(e){Promise.all([n.e(2),n.e(1),n.e(8),n.e(0),n.e(7)]).then(function(t){e(n(2350))}.bind(null,n)).catch(n.oe)}},2082:function(e,t,n){e.exports=function(e){n.e(23).then(function(t){e(n(2364))}.bind(null,n)).catch(n.oe)}},2083:function(e,t,n){e.exports=function(e){n.e(30).then(function(t){e(n(2367))}.bind(null,n)).catch(n.oe)}},2084:function(e,t,n){e.exports=function(e){n.e(18).then(function(t){e(n(2368))}.bind(null,n)).catch(n.oe)}},2085:function(e,t,n){e.exports=function(e){n.e(11).then(function(t){e(n(2370))}.bind(null,n)).catch(n.oe)}},2086:function(e,t,n){e.exports=function(e){n.e(25).then(function(t){e(n(2374))}.bind(null,n)).catch(n.oe)}},2087:function(e,t,n){e.exports=function(e){n.e(24).then(function(t){e(n(2375))}.bind(null,n)).catch(n.oe)}},2088:function(e,t,n){e.exports=function(e){n.e(17).then(function(t){e(n(2376))}.bind(null,n)).catch(n.oe)}},2089:function(e,t,n){e.exports=function(e){Promise.all([n.e(0),n.e(15)]).then(function(t){e(n(2357))}.bind(null,n)).catch(n.oe)}},2090:function(e,t,n){e.exports=function(e){n.e(29).then(function(t){e(n(2356))}.bind(null,n)).catch(n.oe)}},2091:function(e,t,n){e.exports=function(e){n.e(21).then(function(t){e(n(2366))}.bind(null,n)).catch(n.oe)}},2092:function(e,t,n){e.exports=function(e){n.e(20).then(function(t){e(n(2365))}.bind(null,n)).catch(n.oe)}},2093:function(e,t,n){e.exports=function(e){n.e(14).then(function(t){e(n(2362))}.bind(null,n)).catch(n.oe)}},2094:function(e,t,n){e.exports=function(e){Promise.all([n.e(0),n.e(27)]).then(function(t){e(n(2373))}.bind(null,n)).catch(n.oe)}},2095:function(e,t,n){e.exports=function(e){n.e(13).then(function(t){e(n(2359))}.bind(null,n)).catch(n.oe)}},2096:function(e,t,n){e.exports=function(e){n.e(12).then(function(t){e(n(2358))}.bind(null,n)).catch(n.oe)}},2097:function(e,t,n){"use strict";n.d(t,"a",function(){return l});n(300),n(301),n(108),n(210),n(422);var r=n(0),o=n(23),a=n(39);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c={capture:!0},l=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),s(this,"handleKeyDown",function(e){var n=e.ctrlKey,i=e.altKey,s=e.shiftKey;switch(t.lastInputEventIsKeyboard=!0,!0){case Object(o.S)(e,r.Q.KeyCodes.TAB):if(!Object(o.T)()&&i||Object(o.e)(e))return;t.tabKeyIsPressed=!0;break;case Object(o.S)(e,r.Q.KeyCodes.TILDE):if(!t.regions||!t.regions.length)return;n&&(t.tildeKeyIsPressed=!0,e.preventDefault(),s?t.previousRegion():t.nextRegion());break;case Object(o.S)(e,r.Q.KeyCodes.F6):if(!Object(a.c)()&&!Object(o.e)(e))return;t.f6KeyIsPressed=!0,e.preventDefault(),s?t.previousRegion():t.nextRegion();break;case Object(o.S)(e,r.Q.KeyCodes.UP):if(!t.navigationInProgress||!t.sections||!t.sections.length)return;t.upArrowKeyIsPressed=!0,e.preventDefault(),t.shouldReverseSections?t.nextSection():t.previousSection();break;case Object(o.S)(e,r.Q.KeyCodes.DOWN):if(!t.navigationInProgress||!t.sections||!t.sections.length)return;t.downArrowKeyIsPressed=!0,e.preventDefault(),t.shouldReverseSections?t.previousSection():t.nextSection();break;case Object(o.S)(e,r.Q.KeyCodes.ESCAPE):if(!t.navigationInProgress)return;e.preventDefault(),t.cancelNavigation();break;case Object(o.S)(e,r.Q.KeyCodes.ENTER):t.enterKeyIsPressed=!0}}),s(this,"handleKeyUp",function(){t.resetInterractionStates()}),s(this,"handleMouseClick",function(e){t.enterKeyIsPressed||(t.lastInputEventIsKeyboard=!1),e.target!==t.activeElement&&t.cancelNavigation()}),s(this,"handleMouseDown",function(){t.mouseIsPressed=!0}),s(this,"handleMouseUp",function(){t.mouseIsPressed=!1}),s(this,"handleFocus",function(e){t.mouseIsPressed||t.nextElement(e.target,e.path||!0)}),s(this,"handleActiveRegionUpdate",function(){t.navigationInProgress&&(t.updateActiveRegion(),t.focusedElement===t.activeRegion&&t.udpateCurrentFocus(!0))}),s(this,"handleActiveSectionUpdate",function(){t.navigationInProgress&&(t.updateActiveSection(),t.focusedElement===t.activeSection&&t.udpateCurrentFocus(!0))}),s(this,"handleActiveElementUpdate",function(){t.navigationInProgress&&(t.updateActiveElement(),t.focusedElement===t.activeElement&&t.udpateCurrentFocus(!0))}),this.regionHTMLCollection=this.getAllRegions(),this.sectionHTMLCollection=null,this.modalHTMLCollection=this.getAllModals(),this.popupHTMLCollection=this.getAllPopups(),this.activeRegion=null,this.activeSection=null,this.activeElement=null,this.mouseIsPressed=!1,this.lastInputEventIsKeyboard=!1,this.enterKeyIsPressed=!1,this.f6KeyIsPressed=!1,this.upArrowKeyIsPressed=!1,this.downArrowKeyIsPressed=!1,this.tabKeyIsPressed=!1,this.tildeKeyIsPressed=!1,this.resetNavigation=!1,document.addEventListener(r.l.KEY_DOWN,this.handleKeyDown,c),document.addEventListener(r.l.KEY_UP,this.handleKeyUp,c),document.addEventListener(r.l.CLICK,this.handleMouseClick,c),document.addEventListener(r.l.MOUSE_DOWN,this.handleMouseDown,c),document.addEventListener(r.l.MOUSE_UP,this.handleMouseUp,c),document.addEventListener(r.l.FOCUS,this.handleFocus,c)}var t,n,l;return t=e,(n=[{key:"destroy",value:function(){this.clearActiveRegion(),this.clearCurrentFocus(),document.removeEventListener(r.l.KEY_DOWN,this.handleKeyDown,c),document.removeEventListener(r.l.KEY_UP,this.handleKeyUp,c),document.removeEventListener(r.l.CLICK,this.handleMouseClick,c),document.removeEventListener(r.l.MOUSE_DOWN,this.handleMouseDown,c),document.removeEventListener(r.l.MOUSE_UP,this.handleMouseUp,c),document.removeEventListener(r.l.FOCUS,this.handleFocus,c)}},{key:"nextRegion",value:function(){var e,t=this.regions;t&&t.length&&!this.modalIsOpen&&!this.popupIsOpen&&(e=!this.activeRegion||this.activeRegionIndex===t.length-1||this.resetNavigation?t[0]:t[this.activeRegionIndex+1],this.setActiveRegion(e),this.setCurrentFocus(),this.resetNavigation=!1)}},{key:"previousRegion",value:function(){var e,t=this.regions;t&&t.length&&!this.modalIsOpen&&!this.popupIsOpen&&(e=!this.activeRegion||0!==this.activeRegionIndex&&this.resetNavigation?t[0]:0===this.activeRegionIndex?t[t.length-1]:t[this.activeRegionIndex-1],this.setActiveRegion(e),this.setCurrentFocus(),this.resetNavigation=!1)}},{key:"nextSection",value:function(){var e,t=this.sections,n=this.getLoopNavigationAttribute(this.activeRegion);this.modalIsOpen||this.popupIsOpen||!t||!t.length||!n&&this.activeSectionIndex===t.length-1||(e=this.activeSection&&this.activeSectionIndex<t.length-1?t[this.activeSectionIndex+1]:t[0],this.setActiveSection(e),this.setCurrentFocus(),this.resetNavigation=!0)}},{key:"previousSection",value:function(){var e,t=this.sections,n=this.getLoopNavigationAttribute(this.activeRegion);this.modalIsOpen||this.popupIsOpen||!t||!t.length||!n&&0===this.activeSectionIndex||(e=this.activeSection&&this.activeSectionIndex>0?t[this.activeSectionIndex-1]:this.activeSection&&0===this.activeSectionIndex?t[t.length-1]:t[0],this.setActiveSection(e),this.setCurrentFocus(),this.resetNavigation=!0)}},{key:"nextElement",value:function(e){var t,n,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];o&&o.length?(o.indexOf(this.activeRegion)<0&&(t=o.find(function(e){return!!e.classList&&e.classList.contains(r.b.REGION)})),o.indexOf(this.activeSection)<0&&(n=o.find(function(e){return!!e.classList&&e.classList.contains(r.b.SECTION)}))):o&&"function"==typeof e.closest&&(t=e.closest(".".concat(r.b.REGION)),n=e.closest(".".concat(r.b.SECTION))),t&&this.activeRegion!==t&&this.setActiveRegion(t,!1),n&&this.activeSection!==n&&this.setActiveSection(n),this.setActiveElement(e),this.setCurrentFocus(),this.resetNavigation=!0}},{key:"cancelNavigation",value:function(){this.clearActiveRegion(),this.setCurrentFocus(),this.resetInterractionStates()}},{key:"setActiveRegion",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];(this.isElementValid(e,[this.activeRegion])||this.resetNavigation)&&(this.clearActiveRegion(),this.activeRegion=e,this.activeRegion.addEventListener(r.c.UPDATE,this.handleActiveRegionUpdate),this.activeRegion.dispatchEvent(new Event(r.c.ACTIVATE)),this.updateActiveRegion(),this.sectionHTMLCollection=this.getAllSectionsForRegion(this.activeRegion),t&&this.getFocusChildAttribute(this.activeRegion)&&this.sections&&this.sections.length&&this.setActiveSection(this.sections[0]))}},{key:"setActiveSection",value:function(e){this.isElementValid(e,[this.activeSection])&&(this.clearActiveSection(),this.activeSection=e,this.activeSection.addEventListener(r.c.UPDATE,this.handleActiveSectionUpdate),this.activeSection.dispatchEvent(new Event(r.c.ACTIVATE)),this.updateActiveSection())}},{key:"setActiveElement",value:function(e){this.isElementValid(e,[this.activeElement])&&(this.clearActiveElement(),this.activeElement=e,this.activeElement.addEventListener(r.c.UPDATE,this.handleActiveElementUpdate),this.activeElement.dispatchEvent(new Event(r.c.ACTIVATE)),this.updateActiveElement())}},{key:"setCurrentFocus",value:function(){this.clearCurrentFocus(),this.focusedElement&&(document.activeElement!==this.focusedElement&&this.focusedElement.focus(),this.udpateCurrentFocus())}},{key:"updateActiveRegion",value:function(){this.activeRegion&&(this.activeRegion.classList.add(r.b.ACTIVE),this.activeRegion.getAttribute("tabindex")||this.activeRegion.setAttribute("tabindex",-1))}},{key:"updateActiveSection",value:function(){this.activeSection&&(this.activeSection.classList.add(r.b.ACTIVE),this.activeSection.getAttribute("tabindex")||this.activeSection.setAttribute("tabindex",-1))}},{key:"updateActiveElement",value:function(){this.activeElement&&this.activeElement.classList.add(r.b.ACTIVE)}},{key:"udpateCurrentFocus",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];(this.focusedElement&&this.a11yKeyIsPressed||e)&&this.focusedElement.classList.add(r.b.FOCUSED)}},{key:"clearActiveRegion",value:function(){this.activeRegion&&(this.activeRegion.classList.remove(r.b.ACTIVE),this.activeRegion.dispatchEvent(new Event(r.c.DEACTIVATE)),this.activeRegion.removeEventListener(r.c.UPDATE,this.handleActiveRegionUpdate),this.activeRegion=null),this.clearActiveSection()}},{key:"clearActiveSection",value:function(){this.activeSection&&(this.activeSection.classList.remove(r.b.ACTIVE),this.activeSection.dispatchEvent(new Event(r.c.DEACTIVATE)),this.activeSection.removeEventListener(r.c.UPDATE,this.handleActiveSectionUpdate),this.activeSection=null),this.clearActiveElement()}},{key:"clearActiveElement",value:function(){this.activeElement&&(this.activeElement!==this.activeRegion&&this.activeElement!==this.activeSection&&(this.activeElement.classList.remove(r.b.ACTIVE),this.activeElement.dispatchEvent(new Event(r.c.DEACTIVATE))),this.activeElement.removeEventListener(r.c.UPDATE,this.handleActiveElementUpdate),this.activeElement=null)}},{key:"clearCurrentFocus",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Array.from(document.getElementsByClassName(r.b.FOCUSED)).forEach(function(e){e.classList.remove(r.b.FOCUSED)}),e&&document.activeElement.blur()}},{key:"resetInterractionStates",value:function(){this.mouseIsPressed=!1,this.f6KeyIsPressed=!1,this.upArrowKeyIsPressed=!1,this.downArrowKeyIsPressed=!1,this.tabKeyIsPressed=!1,this.tildeKeyIsPressed=!1,this.enterKeyIsPressed=!1}},{key:"getAllRegions",value:function(){return document.getElementsByClassName(r.b.REGION)}},{key:"getAllSectionsForRegion",value:function(e){return e?e.getElementsByClassName(r.b.SECTION):null}},{key:"sortElementsByAttributeOrder",value:function(e){return e&&e.length?Array.from(e).sort(function(e,t){return e.getAttribute(r.a.SORT_ORDER)-t.getAttribute(r.a.SORT_ORDER)}):[]}},{key:"elementIsVisible",value:function(e){return e&&e.offsetParent}},{key:"getAllModals",value:function(){return document.getElementsByClassName(r.b.MODAL)}},{key:"getAllPopups",value:function(){return document.getElementsByClassName(r.b.POPUP)}},{key:"getLoopNavigationAttribute",value:function(e){var t=e.getAttribute(r.a.LOOP_NAVIGATION);return!t||"false"!==t.toLowerCase()}},{key:"getOrderReverseAttribute",value:function(e){var t=e.getAttribute(r.a.ORDER_REVERSE);return!(!t||"true"!==t.toLowerCase())}},{key:"getFocusChildAttribute",value:function(e){var t=e.getAttribute(r.a.FOCUS_CHILD);return!(!t||"true"!==t.toLowerCase())}},{key:"isElementValid",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return!(!e||!e.classList||t.includes(e))}},{key:"navigationInProgress",get:function(){return!!(this.regions&&this.regions.length&&this.isElementValid(this.activeRegion))&&(!!this.lastInputEventIsKeyboard&&(!this.modalIsOpen&&!this.popupIsOpen&&!!this.isElementValid(this.activeElement)))}},{key:"regions",get:function(){var e=this,t=this.sortElementsByAttributeOrder(this.regionHTMLCollection);return t=t.filter(function(t){return e.elementIsVisible(t)})}},{key:"sections",get:function(){var e=this,t=this.sortElementsByAttributeOrder(this.sectionHTMLCollection);return t=t.filter(function(t){return e.elementIsVisible(t)}),this.shouldReverseSections&&t.reverse(),t}},{key:"activeRegionIndex",get:function(){return this.activeRegion?this.regions.indexOf(this.activeRegion):null}},{key:"activeSectionIndex",get:function(){return this.activeSection?this.sections.indexOf(this.activeSection):null}},{key:"shouldReverseSections",get:function(){return!!this.activeRegion&&this.getOrderReverseAttribute(this.activeRegion)}},{key:"focusedElement",get:function(){var e;return this.activeElement?e=this.activeElement:this.activeSection?e=this.activeSection:this.activeRegion&&(e=this.activeRegion),e}},{key:"a11yKeyIsPressed",get:function(){return this.f6KeyIsPressed||this.upArrowKeyIsPressed||this.downArrowKeyIsPressed||this.tabKeyIsPressed||this.tildeKeyIsPressed}},{key:"modalIsOpen",get:function(){return this.modalHTMLCollection.length>0}},{key:"popupIsOpen",get:function(){return this.popupHTMLCollection.length>0}}])&&i(t.prototype,n),l&&i(t,l),e}()},2349:function(e,t,n){"use strict";n(245);var r=n(417),o=n(20),a=n(436),i=n(35),s=n(75),c=n(303),l=n(36),u=n(25),p=n(12),f=n(34),d=n(16),m=n(215),h=n(690),b=n(1564),y=n(1776),g=(n(88),n(43),n(106),n(24),n(74),n(422),n(107),n(30)),v=n.n(g),E=n(7),_=n.n(E),O=n(1986),w=n.n(O),C=n(1590),S=n(1492),P=n(0),j=n(39),T=n(23),k=n(427),N=n(1987),R=n.n(N),M=n(1557),I=n(1548),x=n(1732),A=n(65),L=n(14),D=n(96),U=n(1501),q=n(423),H=n(109);function F(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function B(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function G(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){B(a,r,o,i,s,"next",e)}function s(e){B(a,r,o,i,s,"throw",e)}i(void 0)})}}function V(e){return function(){var t=G(regeneratorRuntime.mark(function t(n,r){var o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,A.editPost(e)(n,r);case 2:return(o=t.sent).error&&"api.post.update_post.permissions_time_limit.app_error"===o.error.server_error_id&&n(Object(H.logError)({type:P.h.ANNOUNCEMENT,message:o.error.message},!0)),t.abrupt("return",o);case 5:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()}function W(e,t,n,r,o,a){return function(){var r=G(regeneratorRuntime.mark(function r(i){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:i({type:P.e.SELECT_ATTACHMENT_MENU_ACTION,postId:e,data:F({},t,{text:o,value:a})}),i(A.doPostActionWithCookie(e,t,n,a));case 2:case"end":return r.stop()}},r)}));return function(e){return r.apply(this,arguments)}}()}var K=n(426),z=n(1738),Y=n(55),Q=n(119);function Z(e){return(Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function J(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function X(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){J(a,r,o,i,s,"next",e)}function s(e){J(a,r,o,i,s,"throw",e)}i(void 0)})}}function $(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ee(e){return(ee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function te(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ne(e,t){return(ne=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function re(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var oe=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=ee(t).call(this,e),n=!o||"object"!==Z(o)&&"function"!=typeof o?te(r):o,re(te(n),"handleDelete",X(regeneratorRuntime.mark(function e(){var t,r,o,a,i,s,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.props,r=t.actions,o=t.channelName,a=t.focusedPostId,i=t.post,s=t.teamName,e.next=3,r.deleteAndRemovePost(i);case 3:c=e.sent,i.id===a&&o&&Q.a.push("/"+s+"/channels/"+o),c.data&&n.onHide();case 6:case"end":return e.stop()}},e)}))),re(te(n),"handleEntered",function(){n.deletePostBtn&&n.deletePostBtn.focus()}),re(te(n),"onHide",function(){var e;(n.setState({show:!1}),j.m())||(e=n.props.isRHS?document.getElementById("reply_textbox"):document.getElementById("post_textbox"))&&e.focus()}),n.state={show:!0},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ne(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e=this,t="";this.props.commentCount>0&&""===this.props.post.root_id&&(t=_.a.createElement(Y.c,{id:"delete_post.warning",defaultMessage:"This post has {count, number} {count, plural, one {comment} other {comments}} on it.",values:{count:this.props.commentCount}}));var n=this.props.post.root_id?_.a.createElement(Y.c,{id:"delete_post.comment",defaultMessage:"Comment"}):_.a.createElement(Y.c,{id:"delete_post.post",defaultMessage:"Post"});return _.a.createElement(z.a,{dialogClassName:"a11y__modal",show:this.state.show,onEntered:this.handleEntered,onHide:this.onHide,onExited:this.props.onHide,enforceFocus:!1,id:"deletePostModal",role:"dialog","aria-labelledby":"deletePostModalLabel"},_.a.createElement(z.a.Header,{closeButton:!0},_.a.createElement(z.a.Title,{componentClass:"h1",id:"deletePostModalLabel"},_.a.createElement(Y.c,{id:"delete_post.confirm",defaultMessage:"Confirm {term} Delete",values:{term:n}}))),_.a.createElement(z.a.Body,null,_.a.createElement(Y.c,{id:"delete_post.question",defaultMessage:"Are you sure you want to delete this {term}?",values:{term:n}}),_.a.createElement("br",null),_.a.createElement("br",null),t),_.a.createElement(z.a.Footer,null,_.a.createElement("button",{type:"button",className:"btn btn-link",onClick:this.onHide},_.a.createElement(Y.c,{id:"delete_post.cancel",defaultMessage:"Cancel"})),_.a.createElement("button",{ref:function(t){e.deletePostBtn=t},type:"button",autoFocus:!0,className:"btn btn-danger",onClick:this.handleDelete,id:"deletePostModalButton"},_.a.createElement(Y.c,{id:"delete_post.del",defaultMessage:"Delete"}))))}}])&&$(n.prototype,r),o&&$(n,o),t}();re(oe,"propTypes",{channelName:v.a.string,focusedPostId:v.a.string,teamName:v.a.string,post:v.a.object.isRequired,commentCount:v.a.number.isRequired,isRHS:v.a.bool.isRequired,onHide:v.a.func.isRequired,actions:v.a.shape({deleteAndRemovePost:v.a.func.isRequired})});var ae=Object(r.connect)(function(e,t){var n=Object(d.getChannel)(e,t.post.channel_id),r="";return n&&(r=n.name),{channelName:r,focusedPostId:e.views.channel.focusedPostId,teamName:Object(f.getCurrentTeam)(e).name}},function(e){return{actions:Object(o.bindActionCreators)({deleteAndRemovePost:q.c},e)}})(oe),ie=n(1684),se=n(1767),ce=(n(32),n(33),n(44),n(1774)),le=n(1773),ue=n(1989),pe=n.n(ue),fe=n(1554),de=n(1),me={OPEN_EMBED_PAGE:1,SHARE:2},he={TRENDING:0,REACTIONS:1},be={mattermost:"mattermost"};n(211),n(299);function ye(e){return(ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ge(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ve(e,t){return!t||"object"!==ye(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ee(e){return(Ee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _e(e,t){return(_e=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Oe=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ve(this,Ee(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_e(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){return _.a.createElement("span",this.props,_.a.createElement("svg",{width:"100%",height:"100%",viewBox:"-10 -10 40 40",version:"1.1"},_.a.createElement("g",{id:"ic_search",transform:"matrix(0.959095,-9.6091e-18,-1.00189e-17,0.959095,-0.0633002,-0.777826)"},_.a.createElement("path",{d:"M2.648,15.872C3.433,16.658 4.376,17.287 5.454,17.758C6.553,18.229 7.698,18.454 8.888,18.454C10.728,18.454 12.389,17.938 13.893,16.905L18.18,21.192C18.494,21.506 18.854,21.664 19.302,21.664C19.751,21.664 20.111,21.506 20.447,21.192C20.761,20.855 20.919,20.496 20.919,20.047C20.919,19.621 20.761,19.239 20.447,18.925L16.16,14.638C17.193,13.134 17.709,11.473 17.709,9.633C17.709,8.443 17.484,7.298 17.013,6.198C16.542,5.121 15.913,4.178 15.128,3.393C14.342,2.607 13.399,1.979 12.322,1.507C11.222,1.036 10.077,0.811 8.888,0.811C7.698,0.811 6.553,1.036 5.454,1.507C4.376,1.979 3.433,2.607 2.648,3.393C1.862,4.178 1.234,5.121 0.762,6.198C0.291,7.298 0.066,8.443 0.066,9.633C0.066,10.822 0.291,11.967 0.762,13.067C1.234,14.144 1.862,15.087 2.648,15.872ZM8.888,4.021C10.436,4.021 11.761,4.56 12.861,5.66C13.96,6.76 14.499,8.084 14.499,9.633C14.499,11.181 13.96,12.506 12.861,13.606C11.761,14.705 10.436,15.244 8.888,15.244C7.339,15.244 6.015,14.705 4.915,13.606C3.815,12.506 3.276,11.181 3.276,9.633C3.276,8.084 3.815,6.76 4.915,5.66C6.015,4.56 7.339,4.021 8.888,4.021Z",style:{fill:"inherit"}}))))}}])&&ge(n.prototype,r),o&&ge(n,o),t}();function we(e){return(we="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ce(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Se(e,t){return!t||"object"!==we(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Pe(e){return(Pe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function je(e,t){return(je=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Te=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Se(this,Pe(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&je(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){return _.a.createElement("span",this.props,_.a.createElement("svg",{width:"100%",height:"100%",viewBox:"-10 -10 40 40",enableBackground:"new 0 0 20 20",version:"1.1"},_.a.createElement("g",{transform:"matrix(0.952381,0,0,1,0,0)"},_.a.createElement("path",{fill:"inherit",d:"M10.5 11.7L2.2 19.8C2 19.9 1.9 20 1.7 20 1.6 20 1.4 19.9 1.3 19.8L0.2 18.8C0.1 18.7 0 18.5 0 18.3 0 18.2 0.1 18 0.2 17.9L8.3 10 0.2 2.1C0.1 2 0 1.8 0 1.7 0 1.5 0.1 1.3 0.2 1.2L1.3 0.2C1.4 0.1 1.6 0 1.7 0 1.9 0 2 0.1 2.2 0.2L10.5 8.3 18.8 0.2C19 0.1 19.1 0 19.3 0 19.4 0 19.6 0.1 19.7 0.2L20.8 1.2C20.9 1.3 21 1.5 21 1.7 21 1.8 20.9 2 20.8 2.1L12.7 10 20.8 17.9C20.9 18 21 18.2 21 18.3 21 18.5 20.9 18.7 20.8 18.8L19.7 19.8C19.6 19.9 19.4 20 19.3 20 19.1 20 19 19.9 18.8 19.8L10.5 11.7Z"}))))}}])&&Ce(n.prototype,r),o&&Ce(n,o),t}(),ke=n(1498),Ne=n(56);n(1993);function Re(e){return(Re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Me(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ie(e){return(Ie=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ae(e,t){return(Ae=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Le(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var De={saveSearchBarText:fe.saveSearchBarText,saveSearchScrollPosition:fe.saveSearchScrollPosition,searchTextUpdate:fe.searchTextUpdate},Ue=Object(de.makeStyleFromTheme)(function(e){return{background:{backgroundColor:e.centerChannelBg},icon:{fill:Object(de.changeOpacity)(e.centerChannelColor,.4)},inputBackground:{backgroundColor:e.centerChannelBg},input:{borderColor:Object(de.changeOpacity)(e.centerChannelColor,.12)}}}),qe=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=Ie(t).call(this,e),n=!o||"object"!==Re(o)&&"function"!=typeof o?xe(r):o,Le(xe(n),"parseSearchText",function(e){return e.trim().split(/ +/).join("-")}),Le(xe(n),"removeExtraSpaces",function(e){return e.trim().split(/ +/).join(" ")}),Le(xe(n),"updateSearchInputValue",function(e){n.searchInput.value=e,n.props.saveSearchBarText(e)}),Le(xe(n),"handleSubmit",function(e){e.preventDefault(),n.triggerSearch(n.searchInput.value),n.searchInput.blur()}),Le(xe(n),"triggerSearch",function(e){var t=n.props.onSearch;n.props.searchTextUpdate(n.parseSearchText(e)),t(),n.props.saveSearchScrollPosition(0)}),Le(xe(n),"handleChange",function(e){clearTimeout(n.searchTimeout);var t=e.target.value,r=n.props,o=r.onCategories,a=r.action;n.props.saveSearchBarText(t),""===t?o():"reactions"===a&&n.isFilteredTags(t)||(n.searchTimeout=setTimeout(function(){n.triggerSearch(t)},500))}),Le(xe(n),"focusInput",function(){n.setState({inputFocused:!0})}),Le(xe(n),"blurInput",function(){n.setState({inputFocused:!1})}),Le(xe(n),"isFilteredTags",function(e){var t=n.removeExtraSpaces(e),r=n.props.tagsList,o=t.toLowerCase(),a=r&&r.length?r.filter(function(e){return t&&-1===e.tagName.indexOf(o)?"":e}):[];return Boolean(a.length)}),Le(xe(n),"clearSearchHandle",function(){var e=n.props,t=e.action,r=e.onTrending,o=e.onCategories;n.updateSearchInputValue(""),"reactions"===t?o():r()}),n.state={inputFocused:!1},n.searchTimeout=null,n.props.saveSearchBarText(""),n.props.searchTextUpdate(""),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ae(e,t)}(t,E["Component"]),n=t,(r=[{key:"componentDidUpdate",value:function(e){var t=this.props.searchBarText;t!==e.searchBarText&&("trending"===t?this.updateSearchInputValue(""):this.updateSearchInputValue(t))}},{key:"shouldComponentUpdate",value:function(e,t){return!e.searchBarText&&this.props.searchBarText||e.searchBarText&&!this.props.searchBarText||t.inputFocused!==this.state.inputFocused}},{key:"render",value:function(){var e=this,t=Ue(this.props.theme),n=this.props.searchBarText?_.a.createElement(Te,{className:"ic-clear-search",style:t.icon,onClick:this.clearSearchHandle}):null;return _.a.createElement("form",{className:"gfycat-search",method:"get",target:"_top",noValidate:"",onSubmit:this.handleSubmit},_.a.createElement("div",{className:"search-bar",style:t.background},_.a.createElement("div",{className:"search-input-bg",style:t.inputBackground}),_.a.createElement(ke.a,{className:"search-input",name:"searchText",autoFocus:!0,placeholder:{id:Object(Ne.b)("gif_picker.gfycat"),defaultMessage:"Search Gfycat"},onChange:this.handleChange,autoComplete:"off",autoCapitalize:"off",onFocus:this.focusInput,onBlur:this.blurInput,ref:function(t){return e.searchInput=t,t},style:t.input}),_.a.createElement(Oe,{className:"ic ic-search",style:t.icon}),n),_.a.createElement("button",{type:"submit",className:"submit-button"}))}}])&&Me(n.prototype,r),o&&Me(n,o),t}();Le(qe,"propTypes",{searchBarText:v.a.string,tagsList:v.a.array,theme:v.a.object.isRequired,onTrending:v.a.func,onSearch:v.a.func,onCategories:v.a.func,action:v.a.string,saveSearchScrollPosition:v.a.func,saveSearchBarText:v.a.func,searchTextUpdate:v.a.func});var He=Object(r.connect)(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){Le(e,t,n[t])})}return e}({},e.entities.gifs.categories,e.entities.gifs.search,{theme:Object(l.getTheme)(e),appProps:e.entities.gifs.app})},De)(qe);function Fe(e){return(Fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Be(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ge(e,t){return!t||"object"!==Fe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ve(e){return(Ve=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function We(e,t){return(We=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ke=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ge(this,Ve(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&We(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){return _.a.createElement("span",this.props,_.a.createElement("svg",{className:"ic-svg ic-trending-svg",width:"11px",height:"15px",viewBox:"0 0 11 15",version:"1.1"},_.a.createElement("g",{id:"Finalized-Design",stroke:"none",fill:"inherit"},_.a.createElement("g",{id:"GfyCat---Gycat-Tab",transform:"translate(-1212.000000, -619.000000)",fill:"inherit"},_.a.createElement("g",{id:"modal---emojis",transform:"translate(1147.000000, 542.000000)"},_.a.createElement("g",{id:"tabs---gfycat",transform:"translate(1.000000, 68.000000)"},_.a.createElement("g",{id:"tab---trending---selected"},_.a.createElement("path",{d:"M69.90625,10.4062776 C69.90625,10.9531513 70.0976562,11.4909106 70.4804688,12.019555 C70.6992188,12.32945 71.1276043,12.7760638 71.765625,13.3593956 C72.3489582,13.9062693 72.7773438,14.3346538 73.0507812,14.6445488 C73.5065106,15.1731932 73.8528644,15.7109525 74.0898438,16.2578262 C74.3632812,16.9505327 74.5,17.6979271 74.5,18.5000083 C74.5,19.4479229 74.2630207,20.3229208 73.7890625,21.1250021 C73.3151043,21.9270834 72.6770832,22.565103 71.875,23.03906 C71.0729168,23.5130171 70.1979168,23.7499958 69.25,23.7499958 C68.3020832,23.7499958 67.4270832,23.5130171 66.625,23.03906 C65.8229168,22.565103 65.1848957,21.9270834 64.7109375,21.1250021 C64.2369793,20.3229208 64,19.4479229 64,18.5000083 C64,17.6432397 64.2005207,16.8320436 64.6015625,16.0664204 C65.0026043,15.3007972 65.5494793,14.6718925 66.2421875,14.1797061 C66.4609375,14.0338733 66.6888019,14.0247585 66.9257812,14.1523625 C67.1627606,14.2799665 67.28125,14.4713723 67.28125,14.7265798 L67.28125,17.6250104 C67.28125,17.9349054 67.3860676,18.1946704 67.5957031,18.4043054 C67.8053387,18.6139405 68.0651043,18.7187578 68.375,18.7187578 C68.6848957,18.7187578 68.9446613,18.6139405 69.1542969,18.4043054 C69.3639324,18.1946704 69.46875,17.9349054 69.46875,17.6250104 C69.46875,17.4427191 69.4049481,17.2330844 69.2773438,16.9961057 C69.2044269,16.8320436 69.0677082,16.576836 68.8671875,16.2304825 C68.4661457,15.5742341 68.1835938,15.0547041 68.0195312,14.6718925 C67.7643231,13.9791859 67.6640625,13.2955938 67.71875,12.6211161 C67.8098957,11.7825763 68.1380207,10.9258077 68.703125,10.0508097 C68.8125,9.86851837 68.9628906,9.76825847 69.1542969,9.75002921 C69.3457031,9.73179994 69.5188801,9.78648731 69.6738281,9.91409132 C69.8287762,10.0416953 69.90625,10.2057574 69.90625,10.4062776 Z M69.2499875,22.437499 C69.9609233,22.437499 70.6171717,22.259765 71.2187328,21.9042971 C71.8202939,21.5488292 72.2988083,21.0703147 72.6542762,20.4687537 C73.0097441,19.8671926 73.1874781,19.2109441 73.1874781,18.5000083 C73.1874781,17.880218 73.0781034,17.3060006 72.8593539,16.7773562 C72.6588337,16.3398572 72.376282,15.9023583 72.0116996,15.4648593 C71.7929502,15.1914225 71.4329248,14.8131683 70.9316241,14.3300964 C70.4303233,13.8470245 70.070298,13.4687703 69.8515485,13.1953335 C69.4869662,12.7760638 69.2135294,12.3567937 69.031238,11.937524 C68.8671759,12.5573143 68.8945196,13.1953335 69.1132691,13.8515819 C69.2408731,14.2343935 69.5143099,14.7812672 69.9335796,15.492203 C70.2252457,15.9661601 70.4166515,16.321628 70.507797,16.5586067 C70.6900884,16.9414183 70.7812338,17.2968862 70.7812338,17.6250104 C70.7812338,18.2812589 70.5442551,18.8463618 70.070298,19.3203189 C69.596341,19.794276 69.031238,20.0312547 68.3749896,20.0312547 C67.7187411,20.0312547 67.1536382,19.794276 66.6796811,19.3203189 C66.205724,18.8463618 65.9687453,18.2812589 65.9687453,17.6250104 L65.9687453,16.0937641 C65.7682251,16.403659 65.60872,16.7819136 65.4902308,17.228527 C65.3717417,17.6751404 65.3124969,18.0989675 65.3124969,18.5000083 C65.3124969,19.2109441 65.4902308,19.8671926 65.8456987,20.4687537 C66.2011666,21.0703147 66.6796811,21.5488292 67.2812422,21.9042971 C67.8828032,22.259765 68.5390517,22.437499 69.2499875,22.437499 Z",id:"icon---trending"}))))))))}}])&&Be(n.prototype,r),o&&Be(n,o),t}();function ze(e){return(ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ye(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Qe(e,t){return!t||"object"!==ze(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ze(e){return(Ze=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Je(e,t){return(Je=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Xe=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Qe(this,Ze(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Je(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){return _.a.createElement("span",this.props,_.a.createElement("svg",{className:"ic-svg ic-reactions-svg",width:"14px",height:"14px",viewBox:"0 0 14 14",version:"1.1"},_.a.createElement("g",{id:"Finalized-Design",stroke:"none",fill:"inherit"},_.a.createElement("g",{id:"GfyCat---Gycat-Tab",transform:"translate(-1348.000000, -620.000000)",fill:"inherit"},_.a.createElement("g",{id:"modal---emojis",transform:"translate(1147.000000, 542.000000)"},_.a.createElement("g",{id:"tabs---gfycat",transform:"translate(1.000000, 68.000000)"},_.a.createElement("g",{id:"tab---category---deselected",transform:"translate(138.000000, 0.000000)"},_.a.createElement("path",{d:"M62,16 L62,10 L68,10 L68,16 L62,16 Z M64,12 L64,14 L66,14 L66,12 L64,12 Z M70,24 L70,18 L76,18 L76,24 L70,24 Z M72,20 L72,22 L74,22 L74,20 L72,20 Z M70,10 L76,10 L76,16 L70,16 L70,10 Z M74,14 L74,12 L72,12 L72,14 L74,14 Z M62,24 L62,18 L68,18 L68,24 L62,24 Z M64,20 L64,22 L66,22 L66,20 L64,20 Z",id:"icon---categories"}))))))))}}])&&Ye(n.prototype,r),o&&Ye(n,o),t}();n(1994);function $e(e){return($e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function et(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tt(e,t){return!t||"object"!==$e(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function nt(e){return(nt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rt(e,t){return(rt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ot,at,it,st={saveSearchBarText:fe.saveSearchBarText,searchTextUpdate:fe.searchTextUpdate},ct=Object(de.makeStyleFromTheme)(function(e){return{background:{backgroundColor:e.centerChannelBg},header:{borderBottomColor:Object(de.changeOpacity)(e.centerChannelColor,.2)},icon:{fill:Object(de.changeOpacity)(e.centerChannelColor,.3)},iconActive:{fill:e.centerChannelColor},iconHover:{fill:Object(de.changeOpacity)(e.centerChannelColor,.8)}}}),lt=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=tt(this,nt(t).call(this,e))).state={hovering:""},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rt(e,t)}(t,E["PureComponent"]),n=t,(r=[{key:"render",value:function(){var e=ct(this.props.theme);return _.a.createElement("header",{className:"header-container",style:e.background},_.a.createElement(He,this.props),_.a.createElement("nav",{className:"nav-bar",style:e.header},this.renderTabs(this.props,e)))}},{key:"renderTabs",value:function(e,t){var n=this,r=e.appProps,o=e.onTrending,a=e.onCategories;return r.header.tabs.map(function(e,r){var i;return e===he.TRENDING?i=n.renderTab("trending",o,Ke,r,t):e===he.REACTIONS&&(i=n.renderTab("reactions",a,Xe,r,t)),i})}},{key:"renderTab",value:function(e,t,n,r,o){var a=this,i=this.props,s=i.action;return _.a.createElement("a",{onClick:function(){i.searchTextUpdate(""),i.saveSearchBarText(""),t()},onMouseOver:function(){a.setState({hovering:e})},onMouseOut:function(){a.setState({hovering:""})},style:{cursor:"pointer"},key:r},_.a.createElement("div",{style:{paddingTop:"2px"}},_.a.createElement(n,{style:a.state.hovering===e?o.iconHover:s===e?o.iconActive:o.icon})))}}])&&et(n.prototype,r),o&&et(n,o),t}();ot=lt,at="propTypes",it={action:v.a.string,appProps:v.a.object,saveSearchBarText:v.a.func,searchTextUpdate:v.a.func,theme:v.a.object.isRequired},at in ot?Object.defineProperty(ot,at,{value:it,enumerable:!0,configurable:!0,writable:!0}):ot[at]=it;var ut=Object(r.connect)(function(e){return{theme:Object(l.getTheme)(e)}},st)(lt);function pt(e){return(pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ft(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function dt(e,t){return!t||"object"!==pt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function mt(e){return(mt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ht(e,t){return(ht=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var bt={saveAppProps:fe.saveAppProps},yt=function(e){function t(e){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=(n=dt(this,mt(t).call(this,e))).props.appProps;return n.props.saveAppProps(r),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ht(e,t)}(t,E["PureComponent"]),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.appProps,n=e.action,r=e.onCategories,o=e.onSearch,a=e.onTrending,i=e.children,s="main-container "+(t.appClassName||"");return _.a.createElement("div",{className:s},_.a.createElement(ut,{appProps:t,action:n,onCategories:r,onSearch:o,onTrending:a}),_.a.createElement("div",{className:"component-container"},i))}}])&&ft(n.prototype,r),o&&ft(n,o),t}();!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(yt,"propTypes",{appProps:v.a.object,action:v.a.string,onCategories:v.a.func,onSearch:v.a.func,onTrending:v.a.func,children:v.a.object,saveAppProps:v.a.func,authenticateSdk:v.a.func});var gt=Object(r.connect)(null,bt)(yt),vt=(n(120),n(421)),Et=n(420);n(429);function _t(e){return(_t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ot(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function wt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ct(e){return(Ct=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function St(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Pt(e,t){return(Pt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function jt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Tt=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=Ct(t).call(this,e))||"object"!==_t(o)&&"function"!=typeof o?St(r):o).scrollListener=n.scrollListener.bind(St(n)),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pt(e,t)}(t,E["PureComponent"]),n=t,(r=[{key:"componentDidMount",value:function(){this.pageLoaded=this.props.pageStart,this.attachScrollListener(),this.setScrollPosition()}},{key:"componentDidUpdate",value:function(){this.attachScrollListener()}},{key:"render",value:function(){var e=this,t=this.props,n=t.children,r=t.element,o=t.hasMore,a=(t.initialLoad,t.loader),i=(t.loadMore,t.pageStart,t.threshold,t.useWindow,t.isReverse,t.scrollPosition,t.containerHeight),s=Ot(t,["children","element","hasMore","initialLoad","loader","loadMore","pageStart","threshold","useWindow","isReverse","scrollPosition","containerHeight"]);s.ref=function(t){e.scrollComponent=t};var c=i?function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){jt(e,t,n[t])})}return e}({},s,{style:{height:i}}):s;return _.a.createElement(r,c,n,o&&(a||this.defaultLoader))}},{key:"calculateTopPosition",value:function(e){return e?e.offsetTop+this.calculateTopPosition(e.offsetParent):0}},{key:"setScrollPosition",value:function(){var e=this.props.scrollPosition;null!==e&&window.scrollTo(0,e)}},{key:"scrollListener",value:function(){var e,t=this.scrollComponent,n=window;if(this.props.useWindow){var r="pageYOffset"in n?n.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;e=this.props.isReverse?r:this.calculateTopPosition(t)+(t.offsetHeight-r-window.innerHeight)}else e=this.props.isReverse?t.parentNode.scrollTop:t.scrollHeight-t.parentNode.scrollTop-t.parentNode.clientHeight;e<Number(this.props.threshold)&&(this.detachScrollListener(),"function"==typeof this.props.loadMore&&this.props.loadMore(this.pageLoaded+=1))}},{key:"attachScrollListener",value:function(){if(this.props.hasMore){var e=window;!1===this.props.useWindow&&(e=this.scrollComponent.parentNode),e.addEventListener("scroll",this.scrollListener),e.addEventListener("resize",this.scrollListener),this.props.initialLoad&&this.scrollListener()}}},{key:"detachScrollListener",value:function(){var e=window;!1===this.props.useWindow&&(e=this.scrollComponent.parentNode),e.removeEventListener("scroll",this.scrollListener),e.removeEventListener("resize",this.scrollListener)}},{key:"componentWillUnmount",value:function(){this.detachScrollListener()}},{key:"setDefaultLoader",value:function(e){this.defaultLoader=e}}])&&wt(n.prototype,r),o&&wt(n,o),t}();jt(Tt,"propTypes",{children:v.a.array,element:v.a.string,hasMore:v.a.bool,initialLoad:v.a.bool,loader:v.a.object,loadMore:v.a.func.isRequired,pageStart:v.a.number,threshold:v.a.number,useWindow:v.a.bool,isReverse:v.a.bool,containerHeight:v.a.number,scrollPosition:v.a.number}),jt(Tt,"defaultProps",{element:"div",hasMore:!1,initialLoad:!0,pageStart:0,threshold:250,useWindow:!0,isReverse:!1,containerHeight:null,scrollPosition:null});n(1995);function kt(e){return(kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Nt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Rt(e){return(Rt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Mt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function It(e,t){return(It=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function xt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){At(e,t,n[t])})}return e}function At(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Lt={saveSearchBarText:fe.saveSearchBarText,saveSearchScrollPosition:fe.saveSearchScrollPosition,searchTextUpdate:fe.searchTextUpdate,requestCategoriesList:fe.requestCategoriesList,requestCategoriesListIfNeeded:fe.requestCategoriesListIfNeeded},Dt=Object(de.makeStyleFromTheme)(function(e){return{background:{backgroundColor:Object(de.changeOpacity)(e.centerChannelColor,.05)}}}),Ut=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=Rt(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==kt(o)&&"function"!=typeof o?Mt(r):o,At(Mt(n),"sendImpressions",function(){var e=n.props.tagsList.map(function(e){return{gfyId:e.gfyId}});e.length&&Object(vt.d)("gfycat","views",{context:"category_list",count:e.length})}),At(Mt(n),"filterTagsList",function(){var e=n.props,t=e.searchBarText,r=e.tagsList,o=t.toLowerCase().trim().split(/ +/).join(" ");return r&&r.length?r.filter(function(e){return t&&-1===e.tagName.indexOf(o)?"":e}):[]}),At(Mt(n),"loadMore",function(){n.props.requestCategoriesList()}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&It(e,t)}(t,E["PureComponent"]),n=t,(r=[{key:"componentDidMount",value:function(){window.scrollTo(0,0),this.props.requestCategoriesListIfNeeded(),this.sendImpressions()}},{key:"componentWillUnmount",value:function(){this.props.saveSearchScrollPosition(0)}},{key:"render",value:function(){var e=this,t=Dt(this.props.theme),n=this.props,r=n.hasMore,o=n.tagsList,a=n.gifs,i=n.onSearch,s=n.onTrending,c=n.hasImageProxy,l=o&&o.length?this.filterTagsList(o).map(function(t,n){var r=t.tagName,o=t.gfyId;if(!a[o])return null;var l=a[o],u=l.max1mbGif,p=l.avgColor,f=Et.f(u,"true"===c),d=r.replace(/\s/g,"-"),m={backgroundImage:"url(".concat(f)},h={backgroundColor:p},b=e.props;return _.a.createElement("a",{onClick:function(){b.searchTextUpdate(r),b.saveSearchBarText(r),"trending"===d?s():i()},key:n},_.a.createElement("div",{className:"category-container"},_.a.createElement("div",{className:"category",style:xt({},m,h)},_.a.createElement("div",{className:"category-name"},r))))}):[];return l&&l.length?_.a.createElement("div",{className:"categories-container",style:t.background},_.a.createElement(Tt,{hasMore:r,loadMore:this.loadMore,threshold:1},l)):_.a.createElement("div",{className:"categories-container",style:t.background})}}])&&Nt(n.prototype,r),o&&Nt(n,o),t}();At(Ut,"propTypes",{appProps:v.a.object,gifs:v.a.object,hasMore:v.a.bool,onSearch:v.a.func,onTrending:v.a.func,requestCategoriesList:v.a.func,requestCategoriesListIfNeeded:v.a.func,saveSearchBarText:v.a.func,saveSearchScrollPosition:v.a.func,searchTextUpdate:v.a.func,searchBarText:v.a.string,tagsList:v.a.array,hasImageProxy:v.a.string,theme:v.a.object.isRequired});var qt=Object(r.connect)(function(e){return xt({},e.entities.gifs.categories,e.entities.gifs.cache,{theme:Object(l.getTheme)(e),appProps:e.entities.gifs.app,searchText:e.entities.gifs.search.searchText,searchBarText:e.entities.gifs.search.searchBarText,hasImageProxy:e.entities.general.config.HasImageProxy})},Lt)(Ut);n(108),n(210),n(155),n(1996),n(1998);function Ht(e){return(Ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ft(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){Kt(e,t,n[t])})}return e}function Bt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Gt(e,t){return!t||"object"!==Ht(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Vt(e){return(Vt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Wt(e,t){return(Wt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Kt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var zt=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Gt(this,Vt(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wt(e,t)}(t,E["PureComponent"]),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.gfyItem,n=e.top,r=e.left,o=e.itemWidth,a=e.itemClickHandler,i=t.width,s=t.height,c=t.max1mbGif,l=t.avgColor,u=this.props.hasImageProxy,p=Et.f(c,"true"===u),f={backgroundImage:"url(".concat(p,")")},d={backgroundColor:l},m={paddingBottom:o/i*s+"px"};return _.a.createElement("div",{className:"search-item-wrapper",style:{top:n,left:r,width:o?"".concat(o,"px"):""}},_.a.createElement("div",{className:"search-item",style:Ft({},f,d,m),onClick:function(){return a(t)}}))}}])&&Bt(n.prototype,r),o&&Bt(n,o),t}();Kt(zt,"propTypes",{gfyItem:v.a.object,top:v.a.string,left:v.a.string,itemWidth:v.a.number,itemClickHandler:v.a.func,hasImageProxy:v.a.string});var Yt=Object(r.connect)(function(e){return{hasImageProxy:e.entities.general.config.HasImageProxy}})(zt);n(1999);function Qt(e){return(Qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Zt(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Jt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Xt(e){return(Xt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $t(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function en(e,t){return(en=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function tn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){nn(e,t,n[t])})}return e}function nn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var rn=8,on=2,an=2,sn=8;var cn={saveSearchScrollPosition:fe.saveSearchScrollPosition},ln=Object(de.makeStyleFromTheme)(function(e){return{background:{backgroundColor:Object(de.changeOpacity)(e.centerChannelColor,.05)}}}),un=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=Xt(t).call(this,e),n=!o||"object"!==Qt(o)&&"function"!=typeof o?$t(r):o,nn($t(n),"setNumberOfColumns",function(){window.matchMedia("(orientation: portrait)").matches?n.numberOfColumns=on:n.numberOfColumns=an}),nn($t(n),"itemClickHandler",function(e){var t=n.props,r=t.keyword,o=t.handleItemClick;n.props.saveSearchScrollPosition(n.scrollPosition),Object(vt.d)("gfycat","shares",{gfyid:e.gfyId,keyword:r}),o(e)}),nn($t(n),"minHeightColumnIndex",function(){return n.columnsHeights.indexOf(Math.min.apply(Math,Zt(n.columnsHeights)))}),nn($t(n),"maxHeightColumnIndex",function(){return n.columnsHeights.indexOf(Math.max.apply(Math,Zt(n.columnsHeights)))}),nn($t(n),"maxColumnHeight",function(){return Math.max.apply(Math,Zt(n.columnsHeights))}),nn($t(n),"resizeHandler",function(){n.state.containerWidth!==n.container.offsetWidth-sn&&(n.setNumberOfColumns(),n.setState(tn({},n.state,{containerWidth:n.container.offsetWidth-sn})),n.columnsHeights=Array(n.numberOfColumns).fill(0))}),nn($t(n),"scrollHandler",function(){n.scrollPosition=window.scrollY}),n.state={containerWidth:null},n.scrollPosition=n.props.scrollPosition,n.setNumberOfColumns(),n.columnsHeights=Array(n.numberOfColumns).fill(0),n.padding=rn,n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&en(e,t)}(t,E["PureComponent"]),n=t,(r=[{key:"componentDidMount",value:function(){this.container=document.getElementById("search-grid-container"),this.setState(tn({},this.state,{containerWidth:this.container.offsetWidth-sn})),window.addEventListener("resize",this.resizeHandler),window.addEventListener("scroll",this.scrollHandler)}},{key:"componentDidUpdate",value:function(e){e.keyword!==this.props.keyword&&window.scrollTo(0,0)}},{key:"componentWillUnmount",value:function(){"trending"!==this.props.keyword&&this.props.saveSearchScrollPosition(this.scrollPosition),window.removeEventListener("resize",this.resizeHandler),window.removeEventListener("scroll",this.scrollHandler)}},{key:"render",value:function(){var e=this,t=ln(this.props.theme),n=this.props,r=n.containerClassName,o=n.gifs,a=n.keyword,i=n.resultsByTerm,s=n.scrollPosition,c=n.loadMore,l=n.onCategories,u=this.state.containerWidth,p=i[a]?i[a]:{},f=p.moreRemaining,d=p.items,m=void 0===d?[]:d,h=p.isEmpty,b=parseInt(u/this.numberOfColumns,10),y=Array(this.numberOfColumns).fill(0).map(function(t,n){return e.padding+(n*b-n*(e.padding/2))});this.columnsHeights=Array(this.numberOfColumns).fill(this.padding);var g=u&&m.length?m.map(function(t,n){var r=o[t],a=r.gfyId,i=e.minHeightColumnIndex(),s=e.columnsHeights[i]+"px",c=y[i]+"px",l=140/r.width*r.height+e.padding;return e.columnsHeights[i]+=l,_.a.createElement(Yt,{gfyItem:r,top:s,left:c,itemWidth:140,itemClickHandler:e.itemClickHandler,key:"".concat(n,"-").concat(a)})}):null;this.containerHeight=this.maxColumnHeight();var v=g?_.a.createElement(Tt,{className:"search-grid-infinite-scroll",pageStart:0,loadMore:c,initialLoad:!1,hasMore:f,threshold:1,containerHeight:this.containerHeight,scrollPosition:s,useWindow:!1},g):null,E=h?_.a.createElement("div",{className:"empty-search"},_.a.createElement("div",{className:"empty-search-image"}),_.a.createElement("p",null,"0 Gifs found for ",_.a.createElement("strong",null,a)),_.a.createElement("a",{onClick:l},_.a.createElement("div",{className:"empty-search-button"},"Go to Reactions"))):null;return _.a.createElement("div",{id:"search-grid-container",className:"search-grid-container ".concat(r),style:t.background},v,E)}}])&&Jt(n.prototype,r),o&&Jt(n,o),t}();nn(un,"propTypes",{appProps:v.a.object,gifs:v.a.object,resultsByTerm:v.a.object,containerClassName:v.a.string,keyword:v.a.string,handleItemClick:v.a.func,onCategories:v.a.func,loadMore:v.a.func,numberOfColumns:v.a.number,scrollPosition:v.a.number,saveSearchScrollPosition:v.a.func,theme:v.a.object.isRequired});var pn=Object(r.connect)(function(e){return tn({},e.entities.gifs.cache,e.entities.gifs.search,{theme:Object(l.getTheme)(e),appProps:e.entities.gifs.app})},cn)(un);function fn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var dn=Object(r.connect)(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){fn(e,t,n[t])})}return e}({},e.entities.gifs.cache,e.entities.gifs.search,{appProps:e.entities.gifs.app})},function(){return{saveSearchScrollPosition:fe.saveSearchScrollPosition}})(pn);function mn(e){return(mn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function bn(e){return(bn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function yn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gn(e,t){return(gn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function vn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var En={searchGfycat:fe.searchGfycat,searchIfNeededInitial:fe.searchIfNeededInitial},_n=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=bn(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==mn(o)&&"function"!=typeof o?yn(r):o,vn(yn(n),"loadMore",function(){var e=n.props.searchText;n.props.searchGfycat({searchText:e})}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gn(e,t)}(t,E["PureComponent"]),n=t,(r=[{key:"componentDidMount",value:function(){var e=this.props.searchText;this.props.searchIfNeededInitial(e.split("-").join(" "))}},{key:"componentDidUpdate",value:function(e){var t=this.props.searchText;e.searchText!==t&&this.props.searchIfNeededInitial(t.split("-").join(" "))}},{key:"render",value:function(){var e=this.props,t=e.handleItemClick,n=e.searchText,r=e.onCategories;return _.a.createElement(dn,{keyword:n,handleItemClick:t,onCategories:r,loadMore:this.loadMore})}}])&&hn(n.prototype,r),o&&hn(n,o),t}();vn(_n,"propTypes",{handleItemClick:v.a.func,onCategories:v.a.func,searchText:v.a.string,searchIfNeededInitial:v.a.func,searchGfycat:v.a.func});var On=Object(r.connect)(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){vn(e,t,n[t])})}return e}({},e.entities.gifs.search)},En)(_n);function wn(e){return(wn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Cn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Sn(e){return(Sn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Pn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jn(e,t){return(jn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Tn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var kn={searchCategory:fe.searchCategory,searchIfNeededInitial:fe.searchIfNeededInitial,saveSearchScrollPosition:fe.saveSearchScrollPosition},Nn=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=Sn(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==wn(o)&&"function"!=typeof o?Pn(r):o,Tn(Pn(n),"loadMore",function(){n.props.searchCategory({tagName:"trending"})}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jn(e,t)}(t,E["PureComponent"]),n=t,(r=[{key:"componentDidMount",value:function(){this.props.searchIfNeededInitial("trending")}},{key:"componentWillUnmount",value:function(){this.props.saveSearchScrollPosition(0)}},{key:"render",value:function(){var e=this.props,t=e.handleItemClick,n=e.onCategories;return _.a.createElement(dn,{keyword:"trending",handleItemClick:t,onCategories:n,loadMore:this.loadMore})}}])&&Cn(n.prototype,r),o&&Cn(n,o),t}();Tn(Nn,"propTypes",{handleItemClick:v.a.func,onCategories:v.a.func,searchCategory:v.a.func,searchIfNeededInitial:v.a.func,saveSearchScrollPosition:v.a.func});var Rn=Object(r.connect)(null,kn)(Nn);function Mn(e){return(Mn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function In(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xn(e){return(xn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function An(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ln(e,t){return(Ln=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Dn={appName:be.mattermost,basePath:"/mattermost",itemTapType:me.SHARE,appClassName:"gfycat",shareEvent:"shareMattermost",appId:"mattermostwebviews",enableHistory:!0,header:{tabs:[he.TRENDING,he.REACTIONS],displayText:!1}},Un=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=xn(t).call(this,e))||"object"!==Mn(o)&&"function"!=typeof o?An(r):o).shouldComponentUpdate=pe.a.shouldComponentUpdate.bind(An(n)),n.handleTrending=n.handleTrending.bind(An(n)),n.handleCategories=n.handleCategories.bind(An(n)),n.handleSearch=n.handleSearch.bind(An(n)),n.handleItemClick=n.handleItemClick.bind(An(n)),n.state={action:"trending"},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ln(e,t)}(t,_.a.Component),n=t,(r=[{key:"handleTrending",value:function(){this.setState({action:"trending"})}},{key:"handleCategories",value:function(){this.setState({action:"reactions"})}},{key:"handleSearch",value:function(){this.setState({action:"search"})}},{key:"handleItemClick",value:function(e){this.props.onGifClick(e.max5mbGif)}},{key:"render",value:function(){var e,t=this.state.action;switch(t){case"reactions":e=_.a.createElement(qt,{appProps:Dn,onTrending:this.handleTrending,onSearch:this.handleSearch});break;case"search":e=_.a.createElement(On,{appProps:Dn,onCategories:this.handleCategories,handleItemClick:this.handleItemClick});break;case"trending":e=_.a.createElement(Rn,{appProps:Dn,onCategories:this.handleCategories,handleItemClick:this.handleItemClick})}return _.a.createElement("div",null,_.a.createElement(gt,{appProps:Dn,action:t,onTrending:this.handleTrending,onCategories:this.handleCategories,onSearch:this.handleSearch},e))}}])&&In(n.prototype,r),o&&In(n,o),t}();function qn(e){return(qn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Fn(e,t){return!t||"object"!==qn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Bn(e){return(Bn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Gn(e,t){return(Gn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Un,"propTypes",{onGifClick:v.a.func.isRequired});var Vn=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Fn(this,Bn(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gn(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){return _.a.createElement("span",this.props,_.a.createElement("svg",{width:"16px",height:"16px",viewBox:"0 0 15 15",role:"icon","aria-label":"Emoji icon"},_.a.createElement("g",{stroke:"none",strokeWidth:"1",fill:"inherit",fillRule:"evenodd"},_.a.createElement("g",{transform:"translate(-1071.000000, -954.000000)",fill:"inherit"},_.a.createElement("g",{transform:"translate(25.000000, 937.000000)"},_.a.createElement("g",{transform:"translate(1046.000000, 17.000000)"},_.a.createElement("path",{d:"M7.5,0.0852272727 C3.405,0.0852272727 0.0852272727,3.405 0.0852272727,7.5 C0.0852272727,11.595 3.405,14.9147727 7.5,14.9147727 C11.595,14.9147727 14.9147727,11.595 14.9147727,7.5 C14.9147727,3.405 11.595,0.0852272727 7.5,0.0852272727 Z M7.5,14.0663436 C3.87926951,14.0663436 0.933656417,11.1207305 0.933656417,7.5 C0.933656417,3.87926951 3.87926951,0.933656417 7.5,0.933656417 C11.1207305,0.933656417 14.0663436,3.87926951 14.0663436,7.5 C14.0663436,11.1207305 11.1207305,14.0663436 7.5,14.0663436 Z"}),_.a.createElement("path",{d:"M11.7732955,8.95397727 C12.0119318,8.90488636 12.2159659,9.11778409 12.1684091,9.35676136 C11.8063636,11.1790909 9.85346591,12.5710227 7.49846591,12.5710227 C5.15096591,12.5710227 3.20284091,11.1877841 2.83193182,9.37397727 C2.78181818,9.129375 2.99267045,8.911875 3.23744318,8.96198864 C4.85369318,9.29232955 10.1786932,9.28142045 11.7732955,8.95397727 Z"}),_.a.createElement("ellipse",{cx:"4.94318182",cy:"5.50431818",rx:"1",ry:"1.06534091"}),_.a.createElement("ellipse",{cx:"10.0568182",cy:"5.50431818",rx:"1",ry:"1.06534091"})))))))}}])&&Hn(n.prototype,r),o&&Hn(n,o),t}();function Wn(e){return(Wn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Kn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function zn(e,t){return!t||"object"!==Wn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Yn(e){return(Yn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Qn(e,t){return(Qn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Zn=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),zn(this,Yn(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qn(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){return _.a.createElement("span",this.props,_.a.createElement("svg",{width:"22px",height:"14px",viewBox:"0 0 22 14"},_.a.createElement("g",{stroke:"none",strokeWidth:"1",fill:"inherit",fillRule:"evenodd"},_.a.createElement("g",{transform:"translate(-1344.000000, -552.000000)",fill:"inherit"},_.a.createElement("g",{transform:"translate(1147.000000, 542.000000)"},_.a.createElement("g",{transform:"translate(1.000000, 1.000000)"},_.a.createElement("g",{transform:"translate(138.000000, 0.000000)"},_.a.createElement("path",{d:"M63.6748519,23 L62.2292481,23 C61.8176589,23 61.4619872,22.8510143 61.1631497,22.5539741 C60.8633954,22.2569338 60.71306,21.8993681 60.71306,21.4831393 C60.71306,21.0678417 60.8597287,20.710276 61.1539829,20.4132358 C61.4473204,20.1161955 61.800242,19.9672098 62.2118312,19.9672098 L63.6565183,19.9672098 C64.0681075,19.9672098 64.4182791,19.8219488 64.7061166,19.5304955 C64.993954,19.2390422 65.1378727,18.8917193 65.1378727,18.4866644 L65.1378727,15.4371134 C65.1378727,15.0208846 64.993954,14.6670436 64.7061166,14.3755903 C64.4182791,14.084137 64.0745243,13.938876 63.6748519,13.938876 C63.2632628,13.938876 62.9103411,14.0869305 62.6170036,14.3849019 C62.3227494,14.6819421 62.1760807,15.0329897 62.1760807,15.4371134 C62.1760807,15.7294978 62.3016658,16.0563352 62.5519193,16.4185567 L62.575753,16.4530096 C62.8269232,16.8143 62.9515917,17.1420685 62.9515917,17.4344529 C62.9515917,17.8506817 62.8049229,18.2073163 62.5115854,18.5043565 C62.2173313,18.8023279 61.8653263,18.9503824 61.4537371,18.9503824 C60.7836443,18.9503824 60.2198863,18.5164616 59.7615465,17.6486199 C59.373791,16.9232458 59.1794549,16.1857665 59.1794549,15.4371134 C59.1794549,14.188427 59.6176278,13.1213169 60.4930568,12.234852 C61.3684859,11.3493183 62.4226675,10.9060858 63.6565183,10.9060858 C64.8912858,10.9060858 65.9482175,11.3493183 66.8300633,12.234852 C67.7109925,13.1213169 68.1519154,14.188427 68.1519154,15.4371134 L68.1519154,18.4866644 C68.1519154,19.7353508 67.7137425,20.7996674 66.8383134,21.6796142 C65.9628844,22.559561 64.9087028,23 63.6748519,23 Z M80,15.9269039 C80,16.3068174 79.8689148,16.6317925 79.6076611,16.9027602 C79.3454907,17.173728 79.0319863,17.3096774 78.6653144,17.3096774 L76.8438719,17.3096774 L76.8438719,18.6589292 C76.8438719,19.0388427 76.7127867,19.3638178 76.4506164,19.6347855 C76.1893627,19.9057532 75.8749415,20.0417027 75.5082697,20.0417027 C75.1315143,20.0417027 74.8125098,19.9057532 74.5503394,19.6347855 C74.2890857,19.3638178 74.1580005,19.0388427 74.1580005,18.6589292 L74.1580005,13.1464583 C74.1580005,12.00858 74.5485061,11.0355171 75.3276838,10.2272697 C76.1077782,9.41995344 77.0473748,9.01582973 78.1473904,9.01582973 L78.6653144,9.01582973 C79.0319863,9.01582973 79.3454907,9.15177918 79.6076611,9.42274692 C79.8689148,9.69371467 80,10.0186897 80,10.3986033 C80,10.7775856 79.8689148,11.1034919 79.6076611,11.3744596 C79.3454907,11.6454273 79.0319863,11.7804456 78.6653144,11.7804456 L78.162974,11.7804456 C77.7963021,11.7804456 77.481881,11.9163951 77.2206273,12.1873628 C76.9584569,12.4583306 76.8282884,12.7777187 76.8282884,13.1464583 L76.8282884,14.5450615 L78.6653144,14.5450615 C79.0319863,14.5450615 79.3454907,14.681011 79.6076611,14.9519787 C79.8689148,15.2229465 80,15.5479215 80,15.9269039 Z M72.6344789,18.6589292 C72.6344789,19.0388427 72.5043104,19.3638178 72.24214,19.6347855 C71.9808863,19.9057532 71.6664652,20.0417027 71.2997933,20.0417027 C70.9340382,20.0417027 70.616867,19.9057532 70.3501132,19.6347855 C70.0833594,19.3638178 69.9495242,19.0388427 69.9495242,18.6589292 L69.9495242,14.170735 C69.9495242,13.7917526 70.0806094,13.4667775 70.3418631,13.1958098 C70.6040335,12.9239109 70.9175379,12.7888926 71.2842098,12.7888926 C71.6508817,12.7888926 71.9671361,12.9239109 72.2348066,13.1958098 C72.5015604,13.4667775 72.6344789,13.7917526 72.6344789,14.170735 L72.6344789,18.6589292 Z M58.3370263,12.5356169 C58.1023563,11.7441304 58.0042716,10.9163286 58.0042716,10.9163286 C57.9721878,10.6937812 58.1243566,10.547589 58.3425264,10.5904223 C58.3425264,10.5904223 58.5350291,10.6267376 58.8017829,10.6807449 C59.0767868,10.7375457 59.4324585,10.8139009 59.7404628,10.8921184 C60.3473048,11.0448287 60.95323,11.2720319 60.95323,11.2720319 C60.95323,11.2720319 60.2904706,11.6621882 59.7239626,12.3018956 C59.1565379,12.9406718 58.8650338,13.8420353 58.8650338,13.8420353 C58.8650338,13.8420353 58.5716963,13.3280346 58.3370263,12.5356169 Z M69.088762,12.5356169 C69.323432,11.7441304 69.4224334,10.9163286 69.4224334,10.9163286 C69.4536005,10.6937812 69.3014317,10.547589 69.0832619,10.5904223 C69.0832619,10.5904223 68.2921674,10.7384769 67.6853254,10.8921184 C67.0794002,11.0448287 66.4725583,11.2720319 66.4725583,11.2720319 C66.4725583,11.2720319 67.1353177,11.6621882 67.7027424,12.3018956 C68.2692504,12.9406718 68.5616712,13.8420353 68.5616712,13.8420353 C68.5616712,13.8420353 68.8550087,13.3280346 69.088762,12.5356169 Z M72.6344789,10.3818424 C72.6344789,10.7617559 72.5043104,11.086731 72.24214,11.3576987 C71.9808863,11.6286664 71.6664652,11.7646159 71.2997933,11.7646159 C70.9340382,11.7646159 70.616867,11.6286664 70.3501132,11.3576987 C70.0833594,11.086731 69.9495242,10.7617559 69.9495242,10.3818424 C69.9495242,10.00286 70.0806094,9.67788494 70.3418631,9.40691719 C70.6040335,9.13594945 70.9175379,9 71.2842098,9 C71.6508817,9 71.9671361,9.13594945 72.2348066,9.40691719 C72.5015604,9.67788494 72.6344789,10.00286 72.6344789,10.3818424 Z"}))))))))}}])&&Kn(n.prototype,r),o&&Kn(n,o),t}();function Jn(e){return(Jn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $n(e,t){return!t||"object"!==Jn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function er(e){return(er=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function tr(e,t){return(tr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var nr=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),$n(this,er(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tr(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){return _.a.createElement("div",{className:"emoji-picker__header modal-header"},_.a.createElement("button",{type:"button",className:"close emoji-picker__header-close-button",onClick:this.props.handleEmojiPickerClose},_.a.createElement("span",{"aria-hidden":"true"},"×"),_.a.createElement("span",{className:"sr-only"},_.a.createElement(Y.c,{id:"emoji_picker.close",defaultMessage:"Close"}))),_.a.createElement("h4",{className:"modal-title emoji-picker__header-title"},_.a.createElement(Y.c,{id:"emoji_picker.header",defaultMessage:"Emoji Picker"})))}}])&&Xn(n.prototype,r),o&&Xn(n,o),t}();!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(nr,"propTypes",{handleEmojiPickerClose:v.a.func.isRequired});var rr=n(213),or=n(403),ar=n(128),ir=(n(300),n(301),n(419),n(1778)),sr=n.n(ir),cr=n(105);n(185);function lr(e,t,n){var r=e.name||e.aliases[0],o=t.name||t.aliases[0],a=r.startsWith(n);return a===o.startsWith(n)?r.localeCompare(o):a?-1:1}var ur=n(1693),pr=n.n(ur);function fr(e){return(fr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function mr(e){return(mr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function hr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function br(e,t){return(br=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var yr=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=mr(t).call(this,e))||"object"!==fr(o)&&"function"!=typeof o?hr(r):o).handleClick=n.handleClick.bind(hr(n)),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&br(e,t)}(t,_.a.Component),n=t,(r=[{key:"shouldComponentUpdate",value:function(e){return e.selected!==this.props.selected||e.enable!==this.props.enable}},{key:"handleClick",value:function(e){e.preventDefault(),this.props.onCategoryClick(this.props.category)}},{key:"render",value:function(){var e="emoji-picker__category";return this.props.selected&&(e+=" emoji-picker__category--selected"),this.props.enable||(e+=" disable"),_.a.createElement("a",{className:e,href:"#",onClick:this.handleClick,"aria-label":this.props.category},this.props.icon)}}])&&dr(n.prototype,r),o&&dr(n,o),t}();!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(yr,"propTypes",{category:v.a.string.isRequired,icon:v.a.node.isRequired,onCategoryClick:v.a.func.isRequired,selected:v.a.bool.isRequired,enable:v.a.bool.isRequired});var gr=n(1629),vr=n.n(gr),Er=n(247);function _r(e){return(_r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Or(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function wr(e){return(wr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Cr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Sr(e,t){return(Sr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Pr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var jr=150,Tr=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=wr(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==_r(o)&&"function"!=typeof o?Cr(r):o,Pr(Cr(n),"emojiItemRef",function(e){n.emojiItem=e}),Pr(Cr(n),"emojiName",function(){return(0,n.context.intl.formatMessage)({id:"emoji_picker_item.emoji_aria_label",defaultMessage:"{emojiName} emoji"},{emojiName:n.props.emoji.aliases[0].replace(/_/g," ")})}),Pr(Cr(n),"handleMouseOver",function(){n.props.isSelected||n.props.onItemOver(n.props.categoryIndex,n.props.emojiIndex)}),Pr(Cr(n),"handleMouseOverThrottle",vr()(n.handleMouseOver,jr,{leading:!0,trailing:!0})),Pr(Cr(n),"handleClick",function(){n.props.onItemClick(n.props.emoji)}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Sr(e,t)}(t,_.a.Component),n=t,(r=[{key:"shouldComponentUpdate",value:function(e){return e.isSelected!==this.props.isSelected}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){if(!this.props.isSelected&&e.isSelected){var t=this.emojiItem.offsetTop,n=t+this.emojiItem.offsetHeight,r=e.containerRef,o=e.containerTop,a=e.containerBottom;t<o?r.scrollTop=t-10:n>a&&(r.scrollTop=n-r.offsetHeight+10)}}},{key:"render",value:function(){var e=this.props.emoji,t="emoji-picker__item";this.props.isSelected&&(t+=" selected");var n,r="emojisprite";return r+=" emoji-category-"+e.category+"-"+e.batch,r+=" emoji-"+e.filename,n=e.category&&e.batch?_.a.createElement("img",{alt:"emoji image",onMouseOver:this.handleMouseOverThrottle,src:pr.a,className:r,onClick:this.handleClick,id:"emoji-"+e.filename,"aria-label":this.emojiName(),role:"button"}):_.a.createElement("img",{alt:"custom emoji image",onMouseOver:this.handleMouseOver,src:Object(Er.getEmojiImageUrl)(e),className:"emoji-category--custom",onClick:this.handleClick}),_.a.createElement("div",{className:t,ref:this.emojiItemRef},_.a.createElement("div",null,n))}}])&&Or(n.prototype,r),o&&Or(n,o),t}();function kr(e){return(kr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Nr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Rr(e){return(Rr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Mr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ir(e,t){return(Ir=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function xr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Pr(Tr,"propTypes",{emoji:v.a.object.isRequired,onItemOver:v.a.func.isRequired,onItemClick:v.a.func.isRequired,category:v.a.string.isRequired,isSelected:v.a.bool,categoryIndex:v.a.number.isRequired,emojiIndex:v.a.number.isRequired,containerRef:v.a.any,containerTop:v.a.number.isRequired,containerBottom:v.a.number.isRequired}),Pr(Tr,"contextTypes",{intl:Y.i.isRequired});var Ar=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=Rr(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==kr(o)&&"function"!=typeof o?Mr(r):o,xr(Mr(n),"divRef",function(e){n.div=e}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ir(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"componentDidMount",value:function(){this.props.updateCategoryOffset(this.props.categoryName,this.div.offsetTop)}},{key:"render",value:function(){return _.a.createElement("div",{ref:this.divRef},_.a.createElement("div",{className:"emoji-picker-items__container"},_.a.createElement("div",{className:"emoji-picker__category-header",id:"emojipickercat-".concat(this.props.categoryName)},_.a.createElement(Y.c,{id:"emoji_picker."+this.props.categoryName}))),_.a.createElement("div",{className:"emoji-picker-items__container"},this.props.children))}}])&&Nr(n.prototype,r),o&&Nr(n,o),t}();function Lr(e){return(Lr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Dr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ur(e,t){return!t||"object"!==Lr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qr(e){return(qr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Hr(e,t){return(Hr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}xr(Ar,"propTypes",{categoryName:v.a.string.isRequired,children:v.a.any,updateCategoryOffset:v.a.func.isRequired});var Fr=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ur(this,qr(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Hr(e,t)}(t,_.a.Component),n=t,(r=[{key:"render",value:function(){var e,t,n,r=this.props.emoji;return r?(r.aliases&&r.category&&r.batch?(e=r.aliases[0],t=r.aliases,n=_.a.createElement("span",{className:"sprite-preview"},_.a.createElement("img",{alt:"emoji category image",src:pr.a,className:"emojisprite-preview emoji-category-"+r.category+"-"+r.batch+" emoji-"+r.filename}))):(e=r.name,t=[r.name],n=_.a.createElement("img",{alt:"emoji preview image",className:"emoji-picker__preview-image",src:Object(Er.getEmojiImageUrl)(r)})),_.a.createElement("div",{className:"emoji-picker__preview"},_.a.createElement("div",{className:"emoji-picker__preview-image-box"},n),_.a.createElement("div",{className:"emoji-picker__preview-image-label-box"},_.a.createElement("span",{className:"emoji-picker__preview-name"},e),_.a.createElement("span",{className:"emoji-picker__preview-aliases"},":"+t[0]+":")))):_.a.createElement("div",{className:"emoji-picker__preview emoji-picker__preview-placeholder"},_.a.createElement(Y.c,{id:"emoji_picker.emojiPicker",defaultMessage:"Emoji Picker"}))}}])&&Dr(n.prototype,r),o&&Dr(n,o),t}();function Br(e){return(Br="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Gr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){Jr(e,t,n[t])})}return e}function Vr(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Wr(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function Kr(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){Wr(a,r,o,i,s,"next",e)}function s(e){Wr(a,r,o,i,s,"throw",e)}i(void 0)})}}function zr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Yr(e){return(Yr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Qr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zr(e,t){return(Zr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Jr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Fr,"propTypes",{emoji:v.a.object});Object(Ne.b)("emoji_picker.searchResults");var Xr={height:290},$r=1476,eo=100,to={recent:{name:"recent",className:"fa fa-clock-o",id:Object(Ne.b)("emoji_picker.recent"),message:"Recently Used",offset:0},people:{name:"people",className:"fa fa-smile-o",id:Object(Ne.b)("emoji_picker.people"),message:"People",offset:0},nature:{name:"nature",className:"fa fa-leaf",id:Object(Ne.b)("emoji_picker.nature"),message:"Nature",offset:0},foods:{name:"foods",className:"fa fa-cutlery",id:Object(Ne.b)("emoji_picker.foods"),message:"Foods",offset:0},activity:{name:"activity",className:"fa fa-futbol-o",id:Object(Ne.b)("emoji_picker.activity"),message:"Activity",offset:0},places:{name:"places",className:"fa fa-plane",id:Object(Ne.b)("emoji_picker.places"),message:"Places",offset:0},objects:{name:"objects",className:"fa fa-lightbulb-o",id:Object(Ne.b)("emoji_picker.objects"),message:"Objects",offset:0},symbols:{name:"symbols",className:"fa fa-heart-o",id:Object(Ne.b)("emoji_picker.symbols"),message:"Symbols",offset:0},flags:{name:"flags",className:"fa fa-flag-o",id:Object(Ne.b)("emoji_picker.flags"),message:"Flags",offset:0},custom:{name:"custom",className:"fa fa-at",id:Object(Ne.b)("emoji_picker.custom"),message:"Custom",offset:0}};function no(e){return e.filename||e.id}var ro=200,oo=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=Yr(t).call(this,e),n=!o||"object"!==Br(o)&&"function"!=typeof o?Qr(r):o,Jr(Qr(n),"loadMoreCustomEmojis",Kr(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.props.customEmojisEnabled&&!n.loadingMoreEmojis){e.next=2;break}return e.abrupt("return");case 2:return n.loadingMoreEmojis=!0,e.next=5,n.props.actions.getCustomEmojis(n.props.customEmojiPage,ro);case 5:if(t=e.sent,r=t.data){e.next=10;break}return n.loadingMoreEmojis=!1,e.abrupt("return");case 10:if(!(r.length<ro)){e.next=14;break}return n.missingPages=!1,n.loadingMoreEmojis=!1,e.abrupt("return");case 14:return e.next=16,n.props.actions.incrementEmojiPickerPage();case 16:n.loadingMoreEmojis=!1;case 17:case"end":return e.stop()}},e)}))),Jr(Qr(n),"lastVisibleEmojiRef",function(e){n.lastVisibleEmoji=e}),Jr(Qr(n),"emojiPickerContainerRef",function(e){n.emojiPickerContainer=e}),Jr(Qr(n),"emojiSearchInput",function(e){n.searchInput=e}),Jr(Qr(n),"emojiCurrentResultsItems",function(e,t,r){var o=n.state,a=o.cursor,i=o.emojisToShow,s=r;return t.map(function(t,r){var o;return++s===i&&(o=n.lastVisibleEmojiRef),s>=i?_.a.createElement("div",{key:s,className:"emoji-picker__item",ref:o},_.a.createElement("img",{alt:"emoji image",src:pr.a,className:"emojisprite"})):_.a.createElement(Tr,{key:t.filename+":"+r,emoji:t,onItemOver:n.handleItemOver,onItemClick:n.handleItemClick,onItemUnmount:t,category:t.category,isSelected:a[0]===e&&a[1]===r,categoryIndex:e,emojiIndex:r,containerRef:n.emojiPickerContainer,containerTop:n.state.divTopOffset,containerBottom:n.state.divTopOffset+n.divHeight})})}),n.handleCategoryClick=n.handleCategoryClick.bind(Qr(n)),n.handleFilterChange=n.handleFilterChange.bind(Qr(n)),n.handleItemOver=n.handleItemOver.bind(Qr(n)),n.handleItemClick=n.handleItemClick.bind(Qr(n)),n.handleKeyDown=n.handleKeyDown.bind(Qr(n)),n.handleCategoryKeyDown=n.handleCategoryKeyDown.bind(Qr(n)),n.handleScroll=n.handleScroll.bind(Qr(n)),n.handleScrollThrottle=sr()(n.handleScroll,eo,{leading:!1,trailing:!0}),n.updateCategoryOffset=n.updateCategoryOffset.bind(Qr(n)),n.divHeight=0,n.missingPages=!0,n.loadingMoreEmojis=!1,n.state={allEmojis:{},categories:to,filter:"",cursor:[0,0],divTopOffset:0,emojisToShow:$r},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Zr(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"UNSAFE_componentWillMount",value:function(){0===this.props.customEmojiPage&&this.loadMoreCustomEmojis(),this.getEmojis()}},{key:"componentDidMount",value:function(){var e=this;requestAnimationFrame(function(){e.searchInput&&e.searchInput.focus()}),this.divHeight=this.emojiPickerContainer.offsetHeight}},{key:"UNSAFE_componentWillUpdate",value:function(e,t){if(this.state.divTopOffset!==t.divTopOffset){if(this.lastVisibleEmoji){var n=this.lastVisibleEmoji.offsetTop-(t.divTopOffset+290+75);if(n<=0){var r=135+Math.ceil(n/27*9*-1);this.setState(function(e){return{emojisToShow:e.emojisToShow+r}})}}if(this.missingPages&&this.emojiPickerContainer)this.emojiPickerContainer.scrollHeight-t.divTopOffset-this.emojiPickerContainer.clientHeight<=500&&this.loadMoreCustomEmojis()}}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.props.emojiMap!==e.emojiMap&&this.getEmojis(e)}},{key:"componentDidUpdate",value:function(e){this.props.visible&&!e.visible&&this.searchInput.focus()}},{key:"handleCategoryClick",value:function(e){this.setState({cursor:[Object.keys(this.state.categories).indexOf(e),0],divTopOffset:this.state.categories[e].offset}),this.emojiPickerContainer.scrollTop=this.state.categories[e].offset,this.searchInput.focus()}},{key:"handleFilterChange",value:function(e){e.preventDefault();var t=e.target.value.toLowerCase().replace(/^:|:$/g,"");this.props.customEmojisEnabled&&t&&""!==t.trim()&&this.props.actions.searchCustomEmojis(t),this.setState(function(){return{filter:t,cursor:[0,0]}})}},{key:"handleItemOver",value:function(e,t){this.setState({cursor:[e,t]})}},{key:"handleItemClick",value:function(e){this.props.onEmojiClick(e)}},{key:"handleCategoryKeyDown",value:function(e){switch(e.key){case"ArrowRight":e.preventDefault(),this.selectNextEmoji(),this.searchInput.focus();break;case"ArrowLeft":e.preventDefault(),this.selectPrevEmoji(),this.searchInput.focus();break;case"ArrowUp":e.preventDefault(),this.selectPrevEmoji(9),this.searchInput.focus();break;case"ArrowDown":e.preventDefault(),this.selectNextEmoji(9),this.searchInput.focus()}}},{key:"handleKeyDown",value:function(e){switch(e.key){case"ArrowRight":e.preventDefault(),this.selectNextEmoji();break;case"ArrowLeft":e.preventDefault(),this.selectPrevEmoji();break;case"ArrowUp":e.preventDefault(),this.selectPrevEmoji(9);break;case"ArrowDown":e.preventDefault(),this.selectNextEmoji(9);break;case"Enter":e.preventDefault(),this.getCurrentEmojiByCursor(this.state.cursor)&&this.props.onEmojiClick(this.getCurrentEmojiByCursor(this.state.cursor))}}},{key:"handleScroll",value:function(){this.emojiPickerContainer&&this.setState({divTopOffset:this.emojiPickerContainer.scrollTop})}},{key:"selectNextEmoji",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this.state.cursor,n=[t[0],t[1]+e];this.getCurrentEmojiByCursor(n)?this.setState({cursor:n}):(n=[t[0]+1,0],this.getCurrentEmojiByCursor(n)&&this.setState({cursor:n}))}},{key:"selectPrevEmoji",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this.state.cursor,n=[t[0],t[1]-e];if(this.getCurrentEmojiByCursor(n))this.setState({cursor:n});else if(0!==t[0]){var r=this.getCategoryByIndex(t[0]-1),o=this.state.categories[r.name].emojiIds.length-1;n=[t[0]-1,o],this.getCurrentEmojiByCursor(n)&&this.setState({cursor:n})}}},{key:"getCategoryByIndex",value:function(e){return this.state.filter&&0!==e?null:this.getCategoriesByKey(Object.keys(this.state.categories)[e])}},{key:"getCurrentEmojiByCursor",value:function(e){var t=this.getCategoryByIndex(e[0]);return t?this.getEmojisByCategory(t)[e[1]]:null}},{key:"getCategoriesByKey",value:function(e){return this.state.filter?{id:"searchResults",name:"searchResults"}:this.state.categories[e]}},{key:"sortEmojis",value:function(e){var t=this,n=this.props.recentEmojis,r=[],o=[];Object.values(e).forEach(function(e){for(var t=o,a=0;a<e.aliases.length;a++)n.includes(e.aliases[a].toLowerCase())&&(t=r);t.push(e)});var a=function(e,n){return lr(e,n,t.state.filter)};return r.sort(a),o.sort(a),[].concat(r,o)}},{key:"getEmojisByCategory",value:function(e){var t=this;if(this.state.filter){var n=Object.values(this.state.allEmojis).filter(function(e){for(var n=0;n<e.aliases.length;n++)if(e.aliases[n].toLowerCase().includes(t.state.filter))return!0;return!1});return this.sortEmojis(n)}return this.state.categories[e.name].emojiIds.map(function(e){return t.state.allEmojis[e]})}},{key:"getCurrentEmojiName",value:function(){var e=this.getCurrentEmojiByCursor(this.state.cursor);return e?e.aliases[0].replace(/_/g," "):""}},{key:"getEmojis",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props,t=this.state,n=t.categories,r=t.allEmojis,o=e.emojiMap,a=o.customEmojis,i=0,s=Object.keys(n);i<s.length;i++){var c=s[i],l=[];if("recent"===c)l=Vr(this.props.recentEmojis).reverse().filter(function(e){return o.has(e)}).map(function(e){return o.get(e)});else l=(cr.b.get(c)||[]).map(function(e){return cr.d[e]}),"custom"===c&&(l=l.concat(Vr(a.values())));n[c].emojiIds=l.map(function(e){return no(e)});for(var u=0;u<l.length;u++){var p=l[u],f=no(p);r[f]=Gr({},p,{visible:!1,offset:null}),p.filename||(r[f]=Gr({},r[f],{aliases:[p.name],category:"custom",filename:f}))}}this.setState({categories:n,allEmojis:r})}},{key:"getCurrentEmojiCategoryName",value:function(){for(var e=Object.keys(this.state.categories),t="",n=e.length-1;n>=0;n--){var r=this.state.categories[e[n]];if(this.state.divTopOffset>r.offset-20){t=e[n];break}}return t}},{key:"emojiCategories",value:function(){var e=this,t=this.state.categories,n=Object.keys(t),r=this.state.filter?n[0]:this.getCurrentEmojiCategoryName(),o=n.map(function(n){var o=t[n];return _.a.createElement(yr,{key:"header-"+o.name,category:o.name,icon:_.a.createElement(Y.c,{id:o.id,defaultMessage:o.message},function(e){return _.a.createElement("i",{className:o.className,title:e})}),onCategoryClick:e.handleCategoryClick,selected:r===o.name,enable:!e.state.filter})});return _.a.createElement("div",{className:"emoji-picker__categories",onKeyDown:this.handleCategoryKeyDown},o)}},{key:"emojiSearch",value:function(){var e=this;return _.a.createElement("div",{className:"emoji-picker__search-container"},_.a.createElement("span",{className:"fa fa-search emoji-picker__search-icon"}),_.a.createElement(Y.c,{id:"emoji_picker.search_emoji",defaultMessage:"Search for an emoji"},function(t){return _.a.createElement(ke.a,{"aria-label":t,ref:e.emojiSearchInput,className:"emoji-picker__search",type:"text",onChange:e.handleFilterChange,onKeyDown:e.handleKeyDown,placeholder:{id:Object(Ne.b)("emoji_picker.search"),defaultMessage:"Search Emoji"}})}))}},{key:"emojiCurrentResults",value:function(){for(var e=this.state.filter?["searchResults"]:Object.keys(this.state.categories),t=0,n=[],r=0;r<e.length;r++){var o=this.getCategoriesByKey(e[r]),a=this.getEmojisByCategory(o),i=this.emojiCurrentResultsItems(r,a,t);t+=i.length,n=[].concat(Vr(n),[_.a.createElement(Ar,{key:o.id,categoryName:o.name,updateCategoryOffset:this.updateCategoryOffset,role:"application"},i)])}return _.a.createElement("div",{ref:this.emojiPickerContainerRef,onScroll:this.handleScrollThrottle,className:"emoji-picker__items",style:Xr},_.a.createElement("div",{className:"emoji-picker__container"},n))}},{key:"updateCategoryOffset",value:function(e,t){"searchResults"!==e&&this.setState(function(n){return{categories:Gr({},n.categories,Jr({},e,Gr({},n.categories[e],{offset:t})))}})}},{key:"render",value:function(){return _.a.createElement("div",{className:"emoji-picker__inner",role:"application"},_.a.createElement("div",{"aria-live":"assertive",className:"sr-only"},_.a.createElement(Y.c,{id:"emoji_picker_item.emoji_aria_label",defaultMessage:"{emojiName} emoji",values:{emojiName:this.getCurrentEmojiName()}})),this.emojiSearch(),this.emojiCategories(),this.emojiCurrentResults(),_.a.createElement(Fr,{emoji:this.getCurrentEmojiByCursor(this.state.cursor)}))}}])&&zr(n.prototype,r),o&&zr(n,o),t}();Jr(oo,"propTypes",{listHeight:v.a.number,onEmojiClose:v.a.func.isRequired,onEmojiClick:v.a.func.isRequired,customEmojisEnabled:v.a.bool,emojiMap:v.a.object.isRequired,recentEmojis:v.a.array.isRequired,customEmojiPage:v.a.number.isRequired,visible:v.a.bool,actions:v.a.shape({getCustomEmojis:v.a.func.isRequired,searchCustomEmojis:v.a.func.isRequired,incrementEmojiPickerPage:v.a.func.isRequired}).isRequired}),Jr(oo,"defaultProps",{listHeight:245,customEmojiPage:0,customEmojisEnabled:!1});var ao=Object(r.connect)(function(e){return{customEmojisEnabled:"true"===e.entities.general.config.EnableCustomEmoji,customEmojiPage:e.views.emoji.emojiPickerCustomPage,emojiMap:Object(ar.a)(e),recentEmojis:Object(ar.b)(e)}},function(e){return{actions:Object(o.bindActionCreators)({getCustomEmojis:rr.getCustomEmojis,searchCustomEmojis:rr.searchCustomEmojis,incrementEmojiPickerPage:or.b},e)}})(oo);function io(e){return(io="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function so(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function co(e){return(co=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function lo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uo(e,t){return(uo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function po(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var fo=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=co(t).call(this,e),n=!o||"object"!==io(o)&&"function"!=typeof o?lo(r):o,po(lo(n),"handleEnterEmojiTab",function(){n.setState({emojiTabVisible:!0})}),po(lo(n),"handleExitEmojiTab",function(){n.setState({emojiTabVisible:!1})}),po(lo(n),"handleEmojiPickerClose",function(){n.props.onEmojiClose()}),n.state={emojiTabVisible:!0},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&uo(e,t)}(t,E["PureComponent"]),n=t,(r=[{key:"render",value:function(){var e;!this.props.style||0===this.props.style.left&&0===this.props.style.top||(e="top"===this.props.placement||"bottom"===this.props.placement?{top:this.props.style.top,bottom:this.props.style.bottom,right:this.props.rightOffset}:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){po(e,t,n[t])})}return e}({},this.props.style)).top&&(e.top+=this.props.topOffset);var t="emoji-picker";return"bottom"===this.props.placement&&(t+=" bottom"),this.props.enableGifPicker&&void 0!==this.props.onGifClick?_.a.createElement(ce.a,{defaultActiveKey:1,id:"emoji-picker-tabs",style:e,className:t,justified:!0},_.a.createElement(nr,{handleEmojiPickerClose:this.handleEmojiPickerClose}),_.a.createElement(le.a,{eventKey:1,onEnter:this.handleEnterEmojiTab,onExit:this.handleExitEmojiTab,title:_.a.createElement(Vn,null)},_.a.createElement(ao,{style:this.props.style,onEmojiClose:this.props.onEmojiClose,onEmojiClick:this.props.onEmojiClick,customEmojis:this.props.customEmojis,visible:this.state.emojiTabVisible})),_.a.createElement(le.a,{eventKey:2,title:_.a.createElement(Zn,null),mountOnEnter:!0,unmountOnExit:!0},_.a.createElement(Un,{onGifClick:this.props.onGifClick}))):_.a.createElement("div",{id:"emojiPicker",style:e,className:"a11y__popup ".concat(t," emoji-picker--single")},_.a.createElement(nr,{handleEmojiPickerClose:this.handleEmojiPickerClose}),_.a.createElement(ao,{style:this.props.style,onEmojiClose:this.props.onEmojiClose,onEmojiClick:this.props.onEmojiClick,customEmojis:this.props.customEmojis}))}}])&&so(n.prototype,r),o&&so(n,o),t}();function mo(e){return(mo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ho(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function bo(e,t){return!t||"object"!==mo(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function yo(e){return(yo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function go(e,t){return(go=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function vo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}po(fo,"propTypes",{style:v.a.object,rightOffset:v.a.number,topOffset:v.a.number,placement:v.a.oneOf(["top","bottom","left"]),customEmojis:v.a.object,onEmojiClose:v.a.func.isRequired,onEmojiClick:v.a.func.isRequired,onGifClick:v.a.func,enableGifPicker:v.a.bool}),po(fo,"defaultProps",{rightOffset:0,topOffset:0});var Eo=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=bo(this,yo(t).call(this,e))).state={placement:"top",rightOffset:P.i.DEFAULT_EMOJI_PICKER_RIGHT_OFFSET},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&go(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"UNSAFE_componentWillUpdate",value:function(e){if(e.show&&!this.props.show){var t=e.target().getBoundingClientRect(),n=Object(se.a)(t,window.innerHeight,{above:e.spaceRequiredAbove,below:e.spaceRequiredBelow});this.setState({placement:n,rightOffset:this.emojiPickerPosition()})}}},{key:"emojiPickerPosition",value:function(){var e=this.props.target(),t=P.i.DEFAULT_EMOJI_PICKER_RIGHT_OFFSET;return e&&(t=window.innerWidth-e.getBoundingClientRect().left-P.i.DEFAULT_EMOJI_PICKER_LEFT_OFFSET)<P.i.DEFAULT_EMOJI_PICKER_RIGHT_OFFSET&&(t=P.i.DEFAULT_EMOJI_PICKER_RIGHT_OFFSET),t}},{key:"render",value:function(){return _.a.createElement(ie.a,{show:this.props.show,placement:this.state.placement,rootClose:!0,container:this.props.container,onHide:this.props.onHide,target:this.props.target,animation:!1},_.a.createElement(fo,{enableGifPicker:this.props.enableGifPicker,onEmojiClose:this.props.onHide,onEmojiClick:this.props.onEmojiClick,onGifClick:this.props.onGifClick,rightOffset:this.state.rightOffset,topOffset:this.props.topOffset}))}}])&&ho(n.prototype,r),o&&ho(n,o),t}();vo(Eo,"CENTER_SPACE_REQUIRED_ABOVE",476),vo(Eo,"CENTER_SPACE_REQUIRED_BELOW",497),vo(Eo,"RHS_SPACE_REQUIRED_ABOVE",420),vo(Eo,"RHS_SPACE_REQUIRED_BELOW",420),vo(Eo,"propTypes",{show:v.a.bool.isRequired,container:v.a.func,target:v.a.func.isRequired,onEmojiClick:v.a.func.isRequired,onGifClick:v.a.func,onHide:v.a.func.isRequired,topOffset:v.a.number,spaceRequiredAbove:v.a.number,spaceRequiredBelow:v.a.number,enableGifPicker:v.a.bool}),vo(Eo,"defaultProps",{spaceRequiredAbove:Eo.CENTER_SPACE_REQUIRED_ABOVE,spaceRequiredBelow:Eo.CENTER_SPACE_REQUIRED_BELOW,enableGifPicker:!1});var _o,Oo=n(1510),wo=n(1780),Co=n(1530),So=n(314);function Po(e){return(Po="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function To(e){return(To=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ko(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function No(e,t){return(No=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ro(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Mo,Io=(Ro(_o={},L.Posts.POST_TYPES.ADD_TO_CHANNEL,{id:Object(Ne.b)("last_users_message.added_to_channel.type"),defaultMessage:"were **added to the channel** by {actor}."}),Ro(_o,L.Posts.POST_TYPES.JOIN_CHANNEL,{id:Object(Ne.b)("last_users_message.joined_channel.type"),defaultMessage:"**joined the channel**."}),Ro(_o,L.Posts.POST_TYPES.LEAVE_CHANNEL,{id:Object(Ne.b)("last_users_message.left_channel.type"),defaultMessage:"**left the channel**."}),Ro(_o,L.Posts.POST_TYPES.REMOVE_FROM_CHANNEL,{id:Object(Ne.b)("last_users_message.removed_from_channel.type"),defaultMessage:"were **removed from the channel**."}),Ro(_o,L.Posts.POST_TYPES.ADD_TO_TEAM,{id:Object(Ne.b)("last_users_message.added_to_team.type"),defaultMessage:"were **added to the team** by {actor}."}),Ro(_o,L.Posts.POST_TYPES.JOIN_TEAM,{id:Object(Ne.b)("last_users_message.joined_team.type"),defaultMessage:"**joined the team**."}),Ro(_o,L.Posts.POST_TYPES.LEAVE_TEAM,{id:Object(Ne.b)("last_users_message.left_team.type"),defaultMessage:"**left the team**."}),Ro(_o,L.Posts.POST_TYPES.REMOVE_FROM_TEAM,{id:Object(Ne.b)("last_users_message.removed_from_team.type"),defaultMessage:"were **removed from the team**."}),_o),xo=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=To(t).call(this,e),n=!o||"object"!==Po(o)&&"function"!=typeof o?ko(r):o,Ro(ko(n),"handleOnClick",function(e){e.preventDefault(),n.setState({expand:!0})}),Ro(ko(n),"renderMessage",function(e){return _.a.createElement(Co.a,{message:e,options:n.props.formatOptions})}),n.state={expand:!1},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&No(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e=this.context.intl.formatMessage,t=this.state.expand,n=this.props,r=n.actor,o=n.expandedLocale,a=n.postType,i=n.usernames,s=i[0],c=i.length-1,l=i[c];if(t){var u=e(o,{users:i.slice(0,c).join(", "),lastUser:l,actor:r});return this.renderMessage(u)}var p=e({id:"last_users_message.first",defaultMessage:"{firstUser} and "},{firstUser:s}),f=e({id:"last_users_message.others",defaultMessage:"{numOthers} others "},{numOthers:c}),d=e({id:Io[a].id,defaultMessage:Io[a].defaultMessage},{actor:r});return _.a.createElement("span",null,this.renderMessage(p),_.a.createElement("a",{onClick:this.handleOnClick},f),this.renderMessage(d))}}])&&jo(n.prototype,r),o&&jo(n,o),t}();function Ao(e){return(Ao="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Lo(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Do(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Uo(e){return(Uo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ho(e,t){return(Ho=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Fo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Ro(xo,"propTypes",{actor:v.a.string,expandedLocale:v.a.object.isRequired,formatOptions:v.a.object.isRequired,postType:v.a.string.isRequired,usernames:v.a.array.isRequired}),Ro(xo,"contextTypes",{intl:Y.i});var Bo=L.Posts.POST_TYPES,Go=Bo.JOIN_CHANNEL,Vo=Bo.ADD_TO_CHANNEL,Wo=Bo.REMOVE_FROM_CHANNEL,Ko=Bo.LEAVE_CHANNEL,zo=Bo.JOIN_TEAM,Yo=Bo.ADD_TO_TEAM,Qo=Bo.REMOVE_FROM_TEAM,Zo=Bo.LEAVE_TEAM,Jo=(Fo(Mo={},Go,{one:{id:Object(Ne.b)("combined_system_message.joined_channel.one"),defaultMessage:"{firstUser} **joined the channel**."},one_you:{id:Object(Ne.b)("combined_system_message.joined_channel.one_you"),defaultMessage:"You **joined the channel**."},two:{id:Object(Ne.b)("combined_system_message.joined_channel.two"),defaultMessage:"{firstUser} and {secondUser} **joined the channel**."},many_expanded:{id:Object(Ne.b)("combined_system_message.joined_channel.many_expanded"),defaultMessage:"{users} and {lastUser} **joined the channel**."}}),Fo(Mo,Vo,{one:{id:Object(Ne.b)("combined_system_message.added_to_channel.one"),defaultMessage:"{firstUser} **added to the channel** by {actor}."},one_you:{id:Object(Ne.b)("combined_system_message.added_to_channel.one_you"),defaultMessage:"You were **added to the channel** by {actor}."},two:{id:Object(Ne.b)("combined_system_message.added_to_channel.two"),defaultMessage:"{firstUser} and {secondUser} **added to the channel** by {actor}."},many_expanded:{id:Object(Ne.b)("combined_system_message.added_to_channel.many_expanded"),defaultMessage:"{users} and {lastUser} were **added to the channel** by {actor}."}}),Fo(Mo,Wo,{one:{id:Object(Ne.b)("combined_system_message.removed_from_channel.one"),defaultMessage:"{firstUser} was **removed from the channel**."},one_you:{id:Object(Ne.b)("combined_system_message.removed_from_channel.one_you"),defaultMessage:"You were **removed from the channel**."},two:{id:Object(Ne.b)("combined_system_message.removed_from_channel.two"),defaultMessage:"{firstUser} and {secondUser} were **removed from the channel**."},many_expanded:{id:Object(Ne.b)("combined_system_message.removed_from_channel.many_expanded"),defaultMessage:"{users} and {lastUser} were **removed from the channel**."}}),Fo(Mo,Ko,{one:{id:Object(Ne.b)("combined_system_message.left_channel.one"),defaultMessage:"{firstUser} **left the channel**."},one_you:{id:Object(Ne.b)("combined_system_message.left_channel.one_you"),defaultMessage:"You **left the channel**."},two:{id:Object(Ne.b)("combined_system_message.left_channel.two"),defaultMessage:"{firstUser} and {secondUser} **left the channel**."},many_expanded:{id:Object(Ne.b)("combined_system_message.left_channel.many_expanded"),defaultMessage:"{users} and {lastUser} **left the channel**."}}),Fo(Mo,zo,{one:{id:Object(Ne.b)("combined_system_message.joined_team.one"),defaultMessage:"{firstUser} **joined the team**."},one_you:{id:Object(Ne.b)("combined_system_message.joined_team.one_you"),defaultMessage:"You **joined the team**."},two:{id:Object(Ne.b)("combined_system_message.joined_team.two"),defaultMessage:"{firstUser} and {secondUser} **joined the team**."},many_expanded:{id:Object(Ne.b)("combined_system_message.joined_team.many_expanded"),defaultMessage:"{users} and {lastUser} **joined the team**."}}),Fo(Mo,Yo,{one:{id:Object(Ne.b)("combined_system_message.added_to_team.one"),defaultMessage:"{firstUser} **added to the team** by {actor}."},one_you:{id:Object(Ne.b)("combined_system_message.added_to_team.one_you"),defaultMessage:"You were **added to the team** by {actor}."},two:{id:Object(Ne.b)("combined_system_message.added_to_team.two"),defaultMessage:"{firstUser} and {secondUser} **added to the team** by {actor}."},many_expanded:{id:Object(Ne.b)("combined_system_message.added_to_team.many_expanded"),defaultMessage:"{users} and {lastUser} were **added to the team** by {actor}."}}),Fo(Mo,Qo,{one:{id:Object(Ne.b)("combined_system_message.removed_from_team.one"),defaultMessage:"{firstUser} was **removed from the team**."},one_you:{id:Object(Ne.b)("combined_system_message.removed_from_team.one_you"),defaultMessage:"You were **removed from the team**."},two:{id:Object(Ne.b)("combined_system_message.removed_from_team.two"),defaultMessage:"{firstUser} and {secondUser} were **removed from the team**."},many_expanded:{id:Object(Ne.b)("combined_system_message.removed_from_team.many_expanded"),defaultMessage:"{users} and {lastUser} were **removed from the team**."}}),Fo(Mo,Zo,{one:{id:Object(Ne.b)("combined_system_message.left_team.one"),defaultMessage:"{firstUser} **left the team**."},one_you:{id:Object(Ne.b)("combined_system_message.left_team.one_you"),defaultMessage:"You **left the team**."},two:{id:Object(Ne.b)("combined_system_message.left_team.two"),defaultMessage:"{firstUser} and {secondUser} **left the team**."},many_expanded:{id:Object(Ne.b)("combined_system_message.left_team.many_expanded"),defaultMessage:"{users} and {lastUser} **left the team**."}}),Mo),Xo=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=Uo(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==Ao(o)&&"function"!=typeof o?qo(r):o,Fo(qo(n),"loadUserProfiles",function(e,t){e.length>0&&n.props.actions.getMissingProfilesByIds(e),t.length>0&&n.props.actions.getMissingProfilesByUsernames(t)}),Fo(qo(n),"getAllUsernames",function(){var e=n.props,t=e.allUserIds,r=e.allUsernames,o=e.currentUserId,a=e.currentUsername,i=e.userProfiles,s=n.context.intl.formatMessage,c=i.reduce(function(e,t){return e[t.id]=t.username,e[t.username]=t.username,e},{}),l=s({id:Object(Ne.b)("combined_system_message.you"),defaultMessage:"You"});return t.includes(o)?c[o]=l:r.includes(a)&&(c[a]=l),c}),Fo(qo(n),"getUsernamesByIds",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=n.props,r=t.currentUserId,o=t.currentUsername,a=n.getAllUsernames(),i=(0,n.context.intl.formatMessage)({id:Object(Ne.b)("channel_loader.someone"),defaultMessage:"Someone"}),s=e.filter(function(e){return e!==r&&e!==o}).map(function(e){return a[e]?"@".concat(a[e]):i}).filter(function(e){return e&&""!==e});return e.includes(r)?s.unshift(a[r]):e.includes(o)&&s.unshift(a[o]),s}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ho(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"componentDidMount",value:function(){this.loadUserProfiles(this.props.allUserIds,this.props.allUsernames)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.allUserIds,r=t.allUsernames;n===e.allUserIds&&r===e.allUsernames||this.loadUserProfiles(n,r)}},{key:"renderFormattedMessage",value:function(e,t,n){var r=this.context.intl.formatMessage,o=this.props,a=o.currentUserId,i=o.currentUsername,s=this.getUsernamesByIds(t),c=n?this.getUsernamesByIds([n])[0]:"";!c||n!==a&&n!==i||(c=c.toLowerCase());var l,u=s[0],p=s[1],f=s.length-1,d={atMentions:!0,mentionKeys:[{key:u},{key:p},{key:c}],mentionHighlight:!1,singleline:!0};if(f>1)return _.a.createElement(xo,{actor:c,expandedLocale:Jo[e].many_expanded,formatOptions:d,postType:e,usernames:s});0===f?(l=Jo[e].one,t[0]!==this.props.currentUserId&&t[0]!==this.props.currentUsername||!Jo[e].one_you||(l=Jo[e].one_you)):1===f&&(l=Jo[e].two);var m=r(l,{firstUser:u,secondUser:p,actor:c});return _.a.createElement(Co.a,{message:m,options:d})}},{key:"renderMessage",value:function(e,t,n){return _.a.createElement(_.a.Fragment,{key:e+n},this.renderFormattedMessage(e,t,n),_.a.createElement("br",null))}},{key:"render",value:function(){var e=this.props,t=e.currentUserId,n=e.messageData,r=[],o=[],a=!0,i=!1,s=void 0;try{for(var c,l=n[Symbol.iterator]();!(a=(c=l.next()).done);a=!0){var u=c.value,p=u.postType,f=u.actorId,d=u.userIds;if(!this.props.showJoinLeave&&f!==t){if(!(-1!==d.indexOf(t)))continue;d=[t]}p!==Wo?r.push(this.renderMessage(p,d,f)):o.push.apply(o,Lo(d))}}catch(e){i=!0,s=e}finally{try{a||null==l.return||l.return()}finally{if(i)throw s}}if(o.length>0){var m=o.filter(function(e,t,n){return n.indexOf(e)===t});r.push(this.renderMessage(Wo,m,t))}return _.a.createElement(_.a.Fragment,null,r)}}])&&Do(n.prototype,r),o&&Do(n,o),t}();Fo(Xo,"propTypes",{allUserIds:v.a.array.isRequired,allUsernames:v.a.array.isRequired,currentUserId:v.a.string.isRequired,currentUsername:v.a.string.isRequired,messageData:v.a.array.isRequired,showJoinLeave:v.a.bool.isRequired,userProfiles:v.a.array.isRequired,actions:v.a.shape({getMissingProfilesByIds:v.a.func.isRequired,getMissingProfilesByUsernames:v.a.func.isRequired}).isRequired}),Fo(Xo,"defaultProps",{allUserIds:[],allUsernames:[]}),Fo(Xo,"contextTypes",{intl:Y.i});var $o=Object(r.connect)(function(){var e=Object(p.makeGetProfilesByIdsAndUsernames)();return function(t,n){var r=Object(p.getCurrentUser)(t),o=n.allUserIds,a=n.allUsernames;return{currentUserId:r.id,currentUsername:r.username,showJoinLeave:Object(l.getBool)(t,L.Preferences.CATEGORY_ADVANCED_SETTINGS,L.Preferences.ADVANCED_FILTER_JOIN_LEAVE,!0),userProfiles:e(t,{allUserIds:o,allUsernames:a})}}},function(e){return{actions:Object(o.bindActionCreators)({getMissingProfilesByIds:i.getMissingProfilesByIds,getMissingProfilesByUsernames:i.getMissingProfilesByUsernames},e)}})(Xo),ea=n(62),ta=n(1866);function na(e){return(na="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ra(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function oa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function aa(e){return(aa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ia(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sa(e,t){return(sa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ca(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var la=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=aa(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==na(o)&&"function"!=typeof o?ia(r):o,ca(ia(n),"handleAddChannelMember",function(){var e=n.props,t=e.currentUser,r=e.post,o=e.userIds,a=e.usernames;if(r&&r.channel_id){var i=r.create_at;o.forEach(function(e,o){i++,n.props.actions.addChannelMember(r.channel_id,e),Object(S.g)(t,a[o],e,r.channel_id,r.root_id,i)}),n.props.actions.removePost(r)}}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&sa(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"generateAtMentions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(1===e.length)return _.a.createElement(ta.a,{mentionName:e[0]});if(e.length>1){function t(e){return _.a.createElement(Y.c,{key:e,id:"post_body.check_for_out_of_channel_mentions.link.and",defaultMessage:" and "})}function n(e){return _.a.createElement("span",{key:e},", ")}return _.a.createElement("span",null,e.map(function(e){return _.a.createElement(ta.a,{key:e,mentionName:e})}).reduce(function(e,r,o,a){return 0===o?[r]:o===a.length-1?[].concat(ra(e),[t(o),r]):[].concat(ra(e),[n(o),r])},[]))}return""}},{key:"render",value:function(){var e,t,n,r,o=this.props,a=o.channelType,i=o.postId,s=o.usernames,c=o.noGroupsUsernames;if(!i||!a)return null;a===P.i.PRIVATE_CHANNEL?(e=Object(Ne.b)("post_body.check_for_out_of_channel_mentions.link.private"),t="add them to this private channel"):a===P.i.OPEN_CHANNEL&&(e=Object(Ne.b)("post_body.check_for_out_of_channel_mentions.link.public"),t="add them to the channel");var l,u,p=this.generateAtMentions(s);1===s.length?(n=Object(Ne.b)("post_body.check_for_out_of_channel_mentions.message.one"),r="did not get notified by this mention because they are not in the channel. Would you like to "):s.length>1&&(n=Object(Ne.b)("post_body.check_for_out_of_channel_mentions.message.multiple"),r="did not get notified by this mention because they are not in the channel. Would you like to ");var f=this.generateAtMentions(c);c.length&&(l=Object(Ne.b)("post_body.check_for_out_of_channel_groups_mentions.message"),u="did not get notified by this mention because they are not in the channel. They cannot be added to the channel because they are not a member of the linked groups. To add them to this channel, they must be added to the linked groups.");var d=null,m=null;return s.length&&(d=_.a.createElement("p",null,p," ",_.a.createElement(Y.c,{id:n,defaultMessage:r}),_.a.createElement("a",{id:"add_channel_member_link",onClick:this.handleAddChannelMember},_.a.createElement(Y.c,{id:e,defaultMessage:t})),_.a.createElement(Y.c,{id:"post_body.check_for_out_of_channel_mentions.message_last",defaultMessage:"? They will have access to all message history."}))),c.length&&(m=_.a.createElement("p",null,f," ",_.a.createElement(Y.c,{id:l,defaultMessage:u}))),_.a.createElement(_.a.Fragment,null,d,m)}}])&&oa(n.prototype,r),o&&oa(n,o),t}();ca(la,"propTypes",{currentUser:v.a.object.isRequired,channelType:v.a.string.isRequired,postId:v.a.string.isRequired,post:v.a.object.isRequired,userIds:v.a.array.isRequired,usernames:v.a.array.isRequired,noGroupsUsernames:v.a.array.isRequired,actions:v.a.shape({addChannelMember:v.a.func.isRequired,removePost:v.a.func.isRequired}).isRequired});var ua,pa=Object(r.connect)(function(e,t){var n=Object(ea.getPost)(e,t.postId)||{},r="";if(n&&n.channel_id){var o=Object(d.getChannel)(e,n.channel_id);o&&o.type&&(r=o.type)}return{channelType:r,currentUser:Object(p.getCurrentUser)(e),post:n}},function(e){return{actions:Object(o.bindActionCreators)({addChannelMember:s.addChannelMember,removePost:A.removePost},e)}})(la);function fa(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function da(e){return ma("@"===e[0]?e:"@".concat(e),{markdown:!1})}function ma(e,t){return _.a.createElement(Co.a,{message:e,options:t})}function ha(e){var t=da(e.props.username),n=da(e.props.addedUsername);return _.a.createElement(Y.c,{id:"api.channel.add_member.added",defaultMessage:"{addedUsername} added to the channel by {username}.",values:{username:t,addedUsername:n}})}var ba=(fa(ua={},L.Posts.POST_TYPES.JOIN_CHANNEL,function(e){var t=da(e.props.username);return _.a.createElement(Y.c,{id:"api.channel.join_channel.post_and_forget",defaultMessage:"{username} joined the channel.",values:{username:t}})}),fa(ua,L.Posts.POST_TYPES.LEAVE_CHANNEL,function(e){var t=da(e.props.username);return _.a.createElement(Y.c,{id:"api.channel.leave.left",defaultMessage:"{username} has left the channel.",values:{username:t}})}),fa(ua,L.Posts.POST_TYPES.ADD_TO_CHANNEL,ha),fa(ua,L.Posts.POST_TYPES.REMOVE_FROM_CHANNEL,function(e){var t=da(e.props.removedUsername);return _.a.createElement(Y.c,{id:"api.channel.remove_member.removed",defaultMessage:"{removedUsername} was removed from the channel",values:{removedUsername:t}})}),fa(ua,L.Posts.POST_TYPES.JOIN_TEAM,function(e){var t=da(e.props.username);return _.a.createElement(Y.c,{id:"api.team.join_team.post_and_forget",defaultMessage:"{username} joined the team.",values:{username:t}})}),fa(ua,L.Posts.POST_TYPES.LEAVE_TEAM,function(e){var t=da(e.props.username);return _.a.createElement(Y.c,{id:"api.team.leave.left",defaultMessage:"{username} left the team.",values:{username:t}})}),fa(ua,L.Posts.POST_TYPES.ADD_TO_TEAM,function(e){var t=da(e.props.username),n=da(e.props.addedUsername);return _.a.createElement(Y.c,{id:"api.team.add_member.added",defaultMessage:"{addedUsername} added to the team by {username}.",values:{username:t,addedUsername:n}})}),fa(ua,L.Posts.POST_TYPES.REMOVE_FROM_TEAM,function(e){var t=da(e.props.username);return _.a.createElement(Y.c,{id:"api.team.remove_user_from_team.removed",defaultMessage:"{removedUsername} was removed from the team.",values:{removedUsername:t}})}),fa(ua,L.Posts.POST_TYPES.HEADER_CHANGE,function(e){if(!e.props.username)return null;var t={singleline:!0,channelNamesMap:e.props&&e.props.channel_mentions},n=da(e.props.username),r=e.props.old_header?ma(e.props.old_header,t):null,o=e.props.new_header?ma(e.props.new_header,t):null;return e.props.new_header?e.props.old_header?_.a.createElement(Y.c,{id:"api.channel.post_update_channel_header_message_and_forget.updated_from",defaultMessage:"{username} updated the channel header from: {old} to: {new}",values:{username:n,old:r,new:o}}):_.a.createElement(Y.c,{id:"api.channel.post_update_channel_header_message_and_forget.updated_to",defaultMessage:"{username} updated the channel header to: {new}",values:{username:n,new:o}}):e.props.old_header?_.a.createElement(Y.c,{id:"api.channel.post_update_channel_header_message_and_forget.removed",defaultMessage:"{username} removed the channel header (was: {old})",values:{username:n,old:r}}):null}),fa(ua,L.Posts.POST_TYPES.DISPLAYNAME_CHANGE,function(e){if(!(e.props.username&&e.props.old_displayname&&e.props.new_displayname))return null;var t=da(e.props.username),n=e.props.old_displayname,r=e.props.new_displayname;return _.a.createElement(Y.c,{id:"api.channel.post_update_channel_displayname_message_and_forget.updated_from",defaultMessage:"{username} updated the channel display name from: {old} to: {new}",values:{username:t,old:n,new:r}})}),fa(ua,L.Posts.POST_TYPES.CONVERT_CHANNEL,function(e){if(!e.props.username)return null;var t=da(e.props.username);return _.a.createElement(Y.c,{id:"api.channel.post_convert_channel_to_private.updated_from",defaultMessage:"{username} converted the channel from public to private",values:{username:t}})}),fa(ua,L.Posts.POST_TYPES.PURPOSE_CHANGE,function(e){if(!e.props.username)return null;var t=da(e.props.username),n=e.props.old_purpose,r=e.props.new_purpose;return e.props.new_purpose?e.props.old_purpose?_.a.createElement(Y.c,{id:"app.channel.post_update_channel_purpose_message.updated_from",defaultMessage:"{username} updated the channel purpose from: {old} to: {new}",values:{username:t,old:n,new:r}}):_.a.createElement(Y.c,{id:"app.channel.post_update_channel_purpose_message.updated_to",defaultMessage:"{username} updated the channel purpose to: {new}",values:{username:t,new:r}}):e.props.old_purpose?_.a.createElement(Y.c,{id:"app.channel.post_update_channel_purpose_message.removed",defaultMessage:"{username} removed the channel purpose (was: {old})",values:{username:t,old:n}}):null}),fa(ua,L.Posts.POST_TYPES.CHANNEL_DELETED,function(e){if(!e.props.username)return null;var t=da(e.props.username);return _.a.createElement(Y.c,{id:"api.channel.delete_channel.archived",defaultMessage:"{username} has archived the channel.",values:{username:t}})}),fa(ua,L.Posts.POST_TYPES.ME,function(e){return ma(e.props&&e.props.message?e.props.message:e.message)}),ua);function ya(e){return(ya="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ga(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function va(e,t){return!t||"object"!==ya(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ea(e){return(Ea=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _a(e,t){return(_a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Oa(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var wa=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),va(this,Ea(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_a(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){if(this.props.post){var e=function(e,t){if(e.props&&e.props.add_channel_member){var n=Object(So.a)(t),r=T.V(e);if((t.type===L.General.PRIVATE_CHANNEL||t.type===L.General.OPEN_CHANNEL)&&n&&r){var o=e.props.add_channel_member;return _.a.createElement(pa,{postId:o.post_id,userIds:o.not_in_channel_user_ids,noGroupsUsernames:o.not_in_groups_usernames,usernames:o.not_in_channel_usernames})}return null}if(ba[e.type])return ba[e.type](e);if(e.type===L.Posts.POST_TYPES.EPHEMERAL_ADD_TO_CHANNEL)return ha(e);if(e.type===L.Posts.POST_TYPES.COMBINED_USER_ACTIVITY){var a=e.props.user_activity,i=a.allUserIds,s=a.allUsernames,c=a.messageData;return _.a.createElement($o,{allUserIds:i,allUsernames:s,messageData:c})}return null}(this.props.post,this.props.channel);if(e)return _.a.createElement("div",null,e)}var t=!this.props.post||!this.props.post.message_source||this.props.post.message===this.props.post.message_source,n=this.props.post&&this.props.post.props&&this.props.post.props.channel_mentions,r=this.props.message,o=this.props.post;return this.props.pluginHooks.forEach(function(e){e&&e.hook&&o&&(r=e.hook(o,r))}),_.a.createElement(Co.a,{imageProps:this.props.imageProps,isRHS:this.props.isRHS,message:r,proxyImages:t,options:this.props.options,channelNamesMap:n,hasPluginTooltips:this.props.hasPluginTooltips,imagesMetadata:this.props.post&&this.props.post.metadata&&this.props.post.metadata.images})}}])&&ga(n.prototype,r),o&&ga(n,o),t}();Oa(wa,"propTypes",{imageProps:v.a.object,isRHS:v.a.bool,message:v.a.string.isRequired,post:v.a.object,channel:v.a.object,options:v.a.object,pluginHooks:v.a.arrayOf(v.a.object),hasPluginTooltips:v.a.bool}),Oa(wa,"defaultProps",{isRHS:!1,pluginHooks:[]});var Ca=Object(r.connect)(function(e,t){return{channel:Object(d.getChannel)(e,t.channelId),pluginHooks:e.plugins.components.MessageWillFormat,hasPluginTooltips:Boolean(e.plugins.components.LinkTooltip)}})(wa),Sa=n(150),Pa=n.n(Sa),ja=n(110),Ta=n(1514),ka=(n(209),n(1505)),Na=n(1515);function Ra(e){return(Ra="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ma(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ia(e,t){return!t||"object"!==Ra(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xa(e){return(xa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Aa(e,t){return(Aa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var La=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ia(this,xa(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Aa(e,t)}(t,Na["a"]),n=t,(r=[{key:"render",value:function(){var e,t,n,r=this.props.isSelection,o=this.props.item;"all"===o.username?(e="all",t=_.a.createElement(Y.c,{id:"suggestion.mention.all",defaultMessage:"Notifies everyone in this channel"}),n=_.a.createElement(Y.c,{id:"generic_icons.member",defaultMessage:"Member Icon"},function(e){return _.a.createElement("i",{className:"mention__image fa fa-users fa-2x",title:e})})):"channel"===o.username?(e="channel",t=_.a.createElement(Y.c,{id:"suggestion.mention.channel",defaultMessage:"Notifies everyone in this channel"}),n=_.a.createElement(Y.c,{id:"generic_icons.member",defaultMessage:"Member Icon"},function(e){return _.a.createElement("i",{className:"mention__image fa fa-users fa-2x",title:e})})):"here"===o.username?(e="here",t=_.a.createElement(Y.c,{id:"suggestion.mention.here",defaultMessage:"Notifies everyone online in this channel"}),n=_.a.createElement(Y.c,{id:"generic_icons.member",defaultMessage:"Member Icon"},function(e){return _.a.createElement("i",{className:"mention__image fa fa-users fa-2x",title:e})})):(e=o.username,(o.first_name||o.last_name)&&o.nickname?t="- ".concat(T.z(o)," (").concat(o.nickname,")"):o.nickname?t="- (".concat(o.nickname,")"):(o.first_name||o.last_name)&&(t="- ".concat(T.z(o))),n=_.a.createElement("img",{alt:"mention image",className:"mention__image",src:T.J(o)}));var a="mentions__name";return r&&(a+=" suggestion--selected"),_.a.createElement("div",Object.assign({className:a,onClick:this.handleClick},Na.a.baseProps),n,_.a.createElement("span",{className:"mention--align"},"@"+e),_.a.createElement(ka.a,{show:Boolean(o.is_bot),className:"badge-autocomplete"}),_.a.createElement("span",{className:"mention__fullname"}," ",t))}}])&&Ma(n.prototype,r),o&&Ma(n,o),t}();function Da(e){return(Da="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ua(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){qa(e,t,n[t])})}return e}function qa(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ha(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Fa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ba(e,t){return!t||"object"!==Da(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ga(e){return(Ga=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Va(e,t){return(Va=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Wa=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Ba(this,Ga(t).call(this))).setProps(e),n.data=null,n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Va(e,t)}(t,Ta["a"]),n=t,(r=[{key:"setProps",value:function(e){var t=e.currentUserId,n=e.profilesInChannel,r=e.profilesNotInChannel,o=e.autocompleteUsersInChannel;this.currentUserId=t,this.profilesInChannel=n,this.profilesNotInChannel=r,this.autocompleteUsersInChannel=o}},{key:"specialMentions",value:function(){var e=this;return this.latestPrefix.startsWith("/msg")?[]:["here","channel","all"].filter(function(t){return t.startsWith(e.latestPrefix)}).map(function(e){return{username:e,type:P.i.MENTION_SPECIAL}})}},{key:"getProfileSuggestions",value:function(e){var t=[];if(!e)return t;if(e.username){var n=Object(ja.getSuggestionsSplitByMultiple)(e.username.toLowerCase(),P.i.AUTOCOMPLETE_SPLIT_CHARACTERS);t.push.apply(t,Ha(n))}return[e.first_name,e.last_name,e.nickname].forEach(function(e){var n=Object(ja.getSuggestionsSplitBy)(e.toLowerCase()," ");t.push.apply(t,Ha(n))}),t}},{key:"filterProfile",value:function(e){if(!e)return!1;if(e.id===this.currentUserId)return!1;var t=this.latestPrefix.toLowerCase();return this.getProfileSuggestions(e).some(function(e){return e.startsWith(t)})}},{key:"localMembers",value:function(){var e=this,t=this.profilesInChannel.filter(function(t){return e.filterProfile(t)}).map(function(e){return Ua({type:P.i.MENTION_MEMBERS},e)}).sort(function(e,t){return e.username.localeCompare(t.username)}).splice(0,25);return t}},{key:"remoteMembers",value:function(){var e=this;return this.data?(this.data.users||[]).filter(function(t){return e.filterProfile(t)}).map(function(e){return Ua({type:P.i.MENTION_MEMBERS},e)}):[]}},{key:"remoteNonMembers",value:function(){var e=this;return this.data?(this.data.out_of_channel||[]).filter(function(t){return e.filterProfile(t)}).map(function(e){return Ua({type:P.i.MENTION_NONMEMBERS},e)}):[]}},{key:"users",value:function(){var e=this.specialMentions(),t=this.localMembers(),n={};t.forEach(function(e){n[e.id]=!0});var r=this.remoteMembers().filter(function(e){return!n[e.id]}),o=t.concat(r).sort(function(e,t){return e.username.localeCompare(t.username)}),a=this.remoteNonMembers().filter(function(e){return!n[e.id]});return o.concat(e).concat(a)}},{key:"updateMatches",value:function(e,t){var n=t.map(function(e){return e.username?"@"+e.username:""});e({matchedPretext:"@".concat(this.latestPrefix),terms:n,items:t,component:La})}},{key:"handlePretextChanged",value:function(e,t){var n=this,r=Pa.a.cache("(?:^|\\W)@([\\pL\\d\\-_.]*)$","i").exec(e.toLowerCase());if(!r)return!1;var o=r[1];this.startNewRequest(o),this.updateMatches(t,this.users());var a=setTimeout(function(){n.shouldCancelDispatch(o)||(n.updateMatches(t,n.users().concat([{type:P.i.MENTION_MORE_MEMBERS,loading:!0}])),a=null)},500);return this.autocompleteUsersInChannel(o).then(function(e){var r=e.data;a&&clearTimeout(a),n.shouldCancelDispatch(o)||(n.data=r,n.updateMatches(t,n.users()))}),!0}}])&&Fa(n.prototype,r),o&&Fa(n,o),t}(),Ka=n(186),za=n(6),Ya=n(1523),Qa=n(13);function Za(e){return(Za="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ja(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Xa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $a(e,t,n){return t&&Xa(e.prototype,t),n&&Xa(e,n),e}function ei(e,t){return!t||"object"!==Za(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ti(e){return(ti=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ni(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ri(e,t)}function ri(e,t){return(ri=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var oi=function(e){function t(){return Ja(this,t),ei(this,ti(t).apply(this,arguments))}return ni(t,Na["a"]),$a(t,[{key:"render",value:function(){var e=this.props.isSelection,t=this.props.item,n=t.channel.display_name,r=t.channel.purpose,o="mentions__name no-flex";e&&(o+=" suggestion--selected");var a="(~"+t.channel.name+")";return _.a.createElement("div",Object.assign({className:o,onClick:this.handleClick},Na.a.baseProps),_.a.createElement("div",{className:"mention__align"},_.a.createElement("span",null,n),_.a.createElement("span",{className:"mention__channelname"}," ",a)),_.a.createElement("div",{className:"mention__purpose"},r))}}]),t}(),ai=function(e){function t(){var e;return Ja(this,t),(e=ei(this,ti(t).call(this))).lastPrefixTrimmed="",e.lastPrefixWithNoResults="",e.lastCompletedWord="",e}return ni(t,Ta["a"]),$a(t,[{key:"handlePretextChanged",value:function(e,t){var n=this;this.resetRequest();var r=/\B(~([^~\r\n]*))$/i.exec(e.toLowerCase());if(!r)return!1;if(r.index>0&&"~"===e[r.index-1])return!1;var o=r[2];if(this.lastPrefixTrimmed&&o.trim()===this.lastPrefixTrimmed)return!0;if(this.lastPrefixTrimmed=o.trim(),this.lastPrefixWithNoResults&&o.startsWith(this.lastPrefixWithNoResults))return!1;if(this.lastCompletedWord&&r[0].startsWith(this.lastCompletedWord))return!1;this.lastCompletedWord="",this.startNewRequest(o);var a=o.toLowerCase().split(/\s+/),i={},s=[];Object(d.getMyChannels)(Qa.a.getState()).forEach(function(e){if(!("O"!==e.type||e.delete_at>0)){for(var t=e.name.toLowerCase().split(/\s+/).concat(e.display_name.toLowerCase().split(/\s+/)),n=!0,r=0;n&&r<a.length;r++)if(a[r]){for(var o=!1,c=0;c<t.length;c++)if(t[c].startsWith(a[r])){o=!0;break}if(!o){n=!1;break}}n&&(i[e.id]=!0,s.push({type:P.i.MENTION_CHANNELS,channel:e}))}});var c=(s=s.sort(function(e,t){return Object(Ka.sortChannelsByTypeAndDisplayName)("en",e.channel,t.channel)})).map(function(e){return"~"+e.channel.name});return t({terms:c.concat([" "]),items:s.concat([{type:P.i.MENTION_MORE_CHANNELS,loading:!0}]),component:oi,matchedPretext:r[1]}),Object(Ya.b)(o,function(e){var a=Object(d.getMyChannelMemberships)(Qa.a.getState());if(!n.shouldCancelDispatch(o)){0===e.length&&(n.lastPrefixWithNoResults=o);var c=[],l=[];e.forEach(function(e){e.delete_at>0&&!a[e.id]||(Object(d.getChannel)(Qa.a.getState(),e.id)?i[e.id]||(i[e.id]=!0,s.push({type:P.i.MENTION_CHANNELS,channel:e})):(c.push({type:P.i.MENTION_MORE_CHANNELS,channel:e}),l.push(e)))});var u=(s=s.sort(function(e,t){return Object(Ka.sortChannelsByTypeAndDisplayName)("en",e.channel,t.channel)})).concat(c),p=u.map(function(e){return"~"+e.channel.name});Qa.a.dispatch({type:za.ChannelTypes.RECEIVED_CHANNELS,data:l}),t({matchedPretext:r[1],terms:p,items:u,component:oi})}}),!0}},{key:"handleCompleteWord",value:function(e){this.lastCompletedWord=e,this.lastPrefixWithNoResults=""}}]),t}(),ii=n(31);function si(e){return(si="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ci(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function li(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ui(e,t,n){return t&&li(e.prototype,t),n&&li(e,n),e}function pi(e,t){return!t||"object"!==si(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function fi(e){return(fi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function di(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mi(e,t)}function mi(e,t){return(mi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var hi=function(e){function t(){return ci(this,t),pi(this,fi(t).apply(this,arguments))}return di(t,Na["a"]),ui(t,[{key:"render",value:function(){var e=this.props,t=e.item,n="command";return e.isSelection&&(n+=" suggestion--selected"),_.a.createElement("div",Object.assign({className:n,onClick:this.handleClick},Na.a.baseProps),_.a.createElement("div",{className:"command__title"},t.suggestion+" "+t.hint),_.a.createElement("div",{className:"command__desc"},t.description))}}]),t}(),bi=function(e){function t(){return ci(this,t),pi(this,fi(t).apply(this,arguments))}return di(t,Ta["a"]),ui(t,[{key:"handlePretextChanged",value:function(e,t){if(e.startsWith("/")){var n=e.toLowerCase();return ii.Client4.getCommandsList(Object(f.getCurrentTeamId)(Qa.a.getState())).then(function(e){var r=[];e.forEach(function(e){if(e.auto_complete&&("shortcuts"!==e.trigger||!j.m())&&0===("/"+e.trigger).indexOf(n)){var t="/"+e.trigger,o="";e.auto_complete_hint&&0!==e.auto_complete_hint.length&&(o=e.auto_complete_hint),r.push({suggestion:t,hint:o,description:e.auto_complete_desc})}});var o=(r=r.sort(function(e,t){return e.suggestion.localeCompare(t.suggestion)})).map(function(e){return e.suggestion});t({matchedPretext:n,terms:o,items:r,component:hi})}).catch(function(){}),!0}return!1}}]),t}(),yi=n(149);function gi(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function vi(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Ei(e){return(Ei="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Oi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function wi(e,t,n){return t&&Oi(e.prototype,t),n&&Oi(e,n),e}function Ci(e,t){return!t||"object"!==Ei(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Si(e){return(Si=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Pi(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ji(e,t)}function ji(e,t){return(ji=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ti=["skintone"],ki=function(e){function t(){return _i(this,t),Ci(this,Si(t).apply(this,arguments))}return Pi(t,Na["a"]),wi(t,[{key:"render",value:function(){var e=this.props.term,t=this.props.item.emoji,n="emoticon-suggestion";return this.props.isSelection&&(n+=" suggestion--selected"),_.a.createElement("div",Object.assign({className:n,onClick:this.handleClick},Na.a.baseProps),_.a.createElement("div",{className:"pull-left"},_.a.createElement("img",{alt:e,className:"emoticon-suggestion__image",src:Object(Er.getEmojiImageUrl)(t),title:e})),_.a.createElement("div",{className:"pull-left"},e))}}]),t}(),Ni=function(e){function t(){return _i(this,t),Ci(this,Si(t).apply(this,arguments))}return Pi(t,Ta["a"]),wi(t,[{key:"handlePretextChanged",value:function(e,t){var n=this,r=/(^|\s|^\+|^-)(:([^:\s]*))$/g.exec(e);if(!r)return!1;var o=r[1],a=r[2],i=r[3];if(i.length<2)return!1;if("-"!==o&&"+"!==o)for(var s=0,c=Object.keys(yi.b);s<c.length;s++){var l=c[s];if(yi.b[l].test(a))return!1}return"true"===Qa.a.getState().entities.general.config.EnableCustomEmoji?Qa.a.dispatch(Object(rr.autocompleteCustomEmojis)(i)).then(function(){return n.findAndSuggestEmojis(a,i,t)}):this.findAndSuggestEmojis(a,i,t),!0}},{key:"formatEmojis",value:function(e){return e.map(function(e){return":"+e.name+":"})}},{key:"findAndSuggestEmojis",value:function(e,t,n){var r=[],o=[],a=Object(ar.a)(Qa.a.getState()),i=Object(ar.b)(Qa.a.getState()),s=!0,c=!1,l=void 0;try{for(var u,p=a[Symbol.iterator]();!(s=(u=p.next()).done);s=!0){var f=gi(u.value,2),d=f[0],m=f[1];if(!Ti.includes(m.category))if(m.aliases){var h=!0,b=!1,y=void 0;try{for(var g,v=m.aliases[Symbol.iterator]();!(h=(g=v.next()).done);h=!0){var E=g.value;if(-1!==E.indexOf(t)){(i.includes(E)||i.includes(d)?r:o).push({name:E,emoji:m});break}}}catch(e){b=!0,y=e}finally{try{h||null==v.return||v.return()}finally{if(b)throw y}}}else if(-1!==d.indexOf(t)){if(a.hasSystemEmoji(d))continue;(i.includes(d)?r:o).push({name:d,emoji:m})}}}catch(e){c=!0,l=e}finally{try{s||null==p.return||p.return()}finally{if(c)throw l}}var _=function(e,n){return lr(e,n,t)};r.sort(_),o.sort(_),n({matchedPretext:e,terms:[].concat(vi(this.formatEmojis(r)),vi(this.formatEmojis(o))),items:[].concat(r,o),component:ki})}}]),t}(),Ri=n(1560),Mi=n(1561);function Ii(e){return(Ii="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ai(e){return(Ai=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Li(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Di(e,t){return(Di=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ui(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var qi=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=Ai(t).call(this,e),n=!o||"object"!==Ii(o)&&"function"!=typeof o?Li(r):o,Ui(Li(n),"handleChange",function(e){n.props.onChange(e)}),Ui(Li(n),"checkMessageLength",function(e){if(n.props.handlePostError)if(e.length>n.props.characterLimit){var t=_.a.createElement(Y.c,{id:"create_post.error_message",defaultMessage:"Your message is too long. Character count: {length}/{limit}",values:{length:e.length,limit:n.props.characterLimit}});n.props.handlePostError(t)}else n.props.handlePostError(null)}),Ui(Li(n),"handleKeyDown",function(e){n.props.onKeyDown&&n.props.onKeyDown(e)}),Ui(Li(n),"handleBlur",function(e){n.props.onBlur&&n.props.onBlur(e)}),Ui(Li(n),"handleHeightChange",function(e,t){n.props.onHeightChange&&n.props.onHeightChange(e,t),T.k()&&n.props.actions.scrollPostList()}),Ui(Li(n),"focus",function(){var e=n.refs.message.getTextbox();e.focus(),T.eb(e),n.checkMessageLength(e.value)}),Ui(Li(n),"blur",function(){n.refs.message.getTextbox().blur()}),Ui(Li(n),"recalculateSize",function(){n.refs.message.recalculateSize()}),n.suggestionProviders=[new Wa({currentUserId:n.props.currentUserId,profilesInChannel:n.props.profilesInChannel,profilesNotInChannel:n.props.profilesNotInChannel,autocompleteUsersInChannel:function(t){return n.props.actions.autocompleteUsersInChannel(t,e.channelId)}}),new ai,new Ni],e.supportsCommands&&n.suggestionProviders.push(new bi),n.checkMessageLength(e.value),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Di(e,t)}(t,_.a.Component),n=t,(r=[{key:"componentDidUpdate",value:function(e){!e.preview&&this.props.preview&&this.refs.preview.focus()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){if(e.channelId!==this.props.channelId||e.currentUserId!==this.props.currentUserId||e.profilesInChannel!==this.props.profilesInChannel||e.profilesNotInChannel!==this.props.profilesNotInChannel)for(var t=this.suggestionProviders,n=0;n<t.length;n++)t[n]instanceof Wa&&t[n].setProps({currentUserId:e.currentUserId,profilesInChannel:e.profilesInChannel,profilesNotInChannel:e.profilesNotInChannel,autocompleteUsersInChannel:function(t){return e.actions.autocompleteUsersInChannel(t,e.channelId)}});this.props.value!==e.value&&this.checkMessageLength(e.value)}},{key:"render",value:function(){var e=null,t="form-control custom-textarea",n="textarea-wrapper";return this.props.emojiEnabled&&(t+=" custom-textarea--emoji-picker"),this.props.badConnection&&(t+=" bad-connection"),this.props.preview&&(t+=" custom-textarea--preview",n+=" textarea-wrapper--preview",e=_.a.createElement("div",{tabIndex:"0",ref:"preview",className:"form-control custom-textarea textbox-preview-area",onKeyPress:this.props.onKeyPress,onKeyDown:this.handleKeyDown,onBlur:this.handleBlur},_.a.createElement(Ca,{isRHS:this.props.isRHS,message:this.props.value}))),_.a.createElement("div",{ref:"wrapper",className:n},_.a.createElement(Ri.a,{id:this.props.id,ref:"message",className:t,spellCheck:"true",placeholder:this.props.createMessage,onChange:this.handleChange,onKeyPress:this.props.onKeyPress,onKeyDown:this.handleKeyDown,onComposition:this.props.onComposition,onBlur:this.handleBlur,onHeightChange:this.handleHeightChange,style:{visibility:this.props.preview?"hidden":"visible"},inputComponent:wo.a,listComponent:Mi.a,listStyle:this.props.suggestionListStyle,providers:this.suggestionProviders,channelId:this.props.channelId,value:this.props.value,renderDividers:!0,isRHS:this.props.isRHS,disabled:this.props.disabled,contextId:this.props.channelId,listenForMentionKeyClick:this.props.listenForMentionKeyClick}),e)}}])&&xi(n.prototype,r),o&&xi(n,o),t}();Ui(qi,"propTypes",{id:v.a.string.isRequired,channelId:v.a.string,value:v.a.string.isRequired,onChange:v.a.func.isRequired,onKeyPress:v.a.func.isRequired,onComposition:v.a.func,onHeightChange:v.a.func,createMessage:v.a.string.isRequired,onKeyDown:v.a.func,onBlur:v.a.func,supportsCommands:v.a.bool.isRequired,handlePostError:v.a.func,suggestionListStyle:v.a.string,emojiEnabled:v.a.bool,isRHS:v.a.bool,characterLimit:v.a.number.isRequired,disabled:v.a.bool,badConnection:v.a.bool,listenForMentionKeyClick:v.a.bool,currentUserId:v.a.string.isRequired,preview:v.a.bool,profilesInChannel:v.a.arrayOf(v.a.object).isRequired,profilesNotInChannel:v.a.arrayOf(v.a.object).isRequired,actions:v.a.shape({autocompleteUsersInChannel:v.a.func.isRequired,scrollPostList:v.a.func.isRequired})}),Ui(qi,"defaultProps",{supportsCommands:!0,isRHS:!1,listenForMentionKeyClick:!1});var Hi=Object(r.connect)(function(){var e=Object(p.makeGetProfilesInChannel)(),t=Object(p.makeGetProfilesNotInChannel)();return function(n,r){return{currentUserId:Object(p.getCurrentUserId)(n),profilesInChannel:e(n,r.channelId,!0),profilesNotInChannel:t(n,r.channelId,!0)}}},function(e){return{actions:Object(o.bindActionCreators)({autocompleteUsersInChannel:Oo.a,scrollPostList:Oo.j},e)}},null,{withRef:!0})(qi),Fi=n(1481);function Bi(e){return(Bi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Gi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Vi(e){return(Vi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Wi(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ki(e,t){return(Ki=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function zi(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Yi=P.Q.PRE_RELEASE_FEATURES,Qi=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=Vi(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==Bi(o)&&"function"!=typeof o?Wi(r):o,zi(Wi(n),"togglePreview",function(e){e.preventDefault(),n.props.updatePreview(!n.props.showPreview)}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ki(e,t)}(t,_.a.Component),n=t,(r=[{key:"render",value:function(){var e,t=this.props.message&&this.props.message.length>0,n="";this.props.message&&this.props.message.length>this.props.characterLimit&&(n="hidden"),e=this.props.previewMessageLink?_.a.createElement("span",null,this.props.previewMessageLink):_.a.createElement(Y.c,{id:"textbox.edit",defaultMessage:"Edit message"});var r=null;T.P(Yi.MARKDOWN_PREVIEW)&&(r=_.a.createElement("button",{id:"previewLink",onClick:this.togglePreview,className:"style--none textbox-preview-link color--link"},this.props.showPreview?e:_.a.createElement(Y.c,{id:"textbox.preview",defaultMessage:"Preview"})));var o=_.a.createElement("div",{id:"helpText",style:{visibility:t?"visible":"hidden",opacity:t?"0.45":"0"},className:"help__format-text"},_.a.createElement("b",null,_.a.createElement(Y.c,{id:"textbox.bold",defaultMessage:"**bold**"})),_.a.createElement("i",null,_.a.createElement(Y.c,{id:"textbox.italic",defaultMessage:"_italic_"})),_.a.createElement("span",null,"~~",_.a.createElement("strike",null,_.a.createElement(Y.c,{id:"textbox.strike",defaultMessage:"strike"})),"~~ "),_.a.createElement("span",null,_.a.createElement(Y.c,{id:"textbox.inlinecode",defaultMessage:"`inline code`"})),_.a.createElement("span",null,_.a.createElement(Y.c,{id:"textbox.preformatted",defaultMessage:"```preformatted```"})),_.a.createElement("span",null,_.a.createElement(Y.c,{id:"textbox.quote",defaultMessage:">quote"})));return _.a.createElement("div",{className:"help__text "+n},o,r,_.a.createElement(Fi.a,{id:"helpTextLink",target:"_blank",rel:"noopener noreferrer",to:"/help/messaging",className:"textbox-help-link"},_.a.createElement(Y.c,{id:"textbox.help",defaultMessage:"Help"})))}}])&&Gi(n.prototype,r),o&&Gi(n,o),t}();function Zi(e){return(Zi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ji(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function Xi(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){Ji(a,r,o,i,s,"next",e)}function s(e){Ji(a,r,o,i,s,"throw",e)}i(void 0)})}}function $i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function es(e){return(es=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ts(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ns(e,t){return(ns=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function rs(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}zi(Qi,"propTypes",{showPreview:v.a.bool,characterLimit:v.a.number.isRequired,previewMessageLink:v.a.string,updatePreview:v.a.func,message:v.a.string.isRequired}),zi(Qi,"defaultProps",{message:""});var os=P.i.KeyCodes,as=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=es(t).call(this,e),n=!o||"object"!==Zi(o)&&"function"!=typeof o?ts(r):o,rs(ts(n),"updatePreview",function(e){n.setState({preview:e})}),rs(ts(n),"getContainer",function(){return n.refs.editModalBody}),rs(ts(n),"toggleEmojiPicker",function(){n.setState({showEmojiPicker:!n.state.showEmojiPicker}),!n.state.showEmojiPicker&&n.editbox&&n.editbox.focus()}),rs(ts(n),"hideEmojiPicker",function(){n.setState({showEmojiPicker:!1}),n.editbox&&n.editbox.focus()}),rs(ts(n),"handleEmojiClick",function(e){var t=e&&(e.name||e.aliases&&e.aliases[0]);if(t){if(""===n.state.editText)n.setState({editText:":"+t+": "});else{var r=/\s+$/.test(n.state.editText)?n.state.editText+":"+t+": ":n.state.editText+" :"+t+": ";n.setState({editText:r})}n.setState({showEmojiPicker:!1}),n.editbox&&n.editbox.focus()}}),rs(ts(n),"handleGifClick",function(e){if(""===n.state.editText)n.setState({editText:e});else{var t=/\s+$/.test(n.state.editText)?n.state.editText+e:n.state.editText+" "+e;n.setState({editText:t})}n.setState({showEmojiPicker:!1}),n.editbox.focus()}),rs(ts(n),"getEditPostControls",function(){return n.refs.editPostEmoji}),rs(ts(n),"handlePostError",function(e){n.state.postError!==e&&n.setState({postError:e})}),rs(ts(n),"handleEdit",Xi(regeneratorRuntime.mark(function e(){var t,r,o,a,i,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.isSaveDisabled()){e.next=2;break}return e.abrupt("return");case 2:if(t=n.props,r=t.actions,o=t.editingPost,a={message:n.state.editText,id:o.postId,channel_id:o.post.channel_id},!n.state.postError){e.next=8;break}return n.setState({errorClass:"animation--highlight"}),setTimeout(function(){n.setState({errorClass:null})},P.i.ANIMATION_TIMEOUT),e.abrupt("return");case 8:if(a.message!==(o.post.message_source||o.post.message)){e.next=11;break}return n.handleHide(),e.abrupt("return");case 11:if(i=o.post.file_ids&&o.post.file_ids.length>0,0!==a.message.trim().length||i){e.next=17;break}return n.handleHide(!1),s={ModalId:P.r.DELETE_POST,dialogType:ae,dialogProps:{post:o.post,commentCount:o.commentCount,isRHS:o.isRHS}},n.props.actions.openModal(s),e.abrupt("return");case 17:return r.addMessageIntoHistory(a.message),e.next=20,r.editPost(a);case 20:e.sent&&window.scrollTo(0,0),n.handleHide();case 23:case"end":return e.stop()}},e)}))),rs(ts(n),"handleChange",function(e){var t=e.target.value;n.setState({editText:t})}),rs(ts(n),"handleEditKeyPress",function(e){j.m()||n.props.ctrlSend||!T.S(e,os.ENTER)||e.shiftKey||e.altKey?n.props.ctrlSend&&e.ctrlKey&&T.S(e,os.ENTER)&&(e.preventDefault(),n.editbox.blur(),n.handleEdit()):(e.preventDefault(),n.editbox.blur(),n.handleEdit())}),rs(ts(n),"handleKeyDown",function(e){n.props.ctrlSend&&T.S(e,os.ENTER)&&!0===e.ctrlKey?n.handleEdit():T.S(e,os.ESCAPE)&&!n.state.showEmojiPicker&&n.handleHide()}),rs(ts(n),"handleHide",function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];n.refocusId=e?n.props.editingPost.refocusId:null,n.props.actions.hideEditPostModal()}),rs(ts(n),"handleEntered",function(){n.editbox&&(n.editbox.focus(),n.editbox.recalculateSize())}),rs(ts(n),"handleExit",function(){n.setState({preview:!1})}),rs(ts(n),"handleExited",function(){var e=n.refocusId;e&&setTimeout(function(){var t=document.getElementById(e);t&&t.focus()}),n.refocusId=null,n.setState({editText:"",postError:"",errorClass:null,preview:!1,showEmojiPicker:!1})}),rs(ts(n),"setEditboxRef",function(e){e&&e.getWrappedInstance&&(n.editbox=e.getWrappedInstance()),n.editbox&&n.editbox.focus()}),rs(ts(n),"isSaveDisabled",function(){var e=n.props.editingPost.post;return e&&e.file_ids&&e.file_ids.length>0?!n.props.canEditPost:""!==n.state.editText?!n.props.canEditPost:!n.props.canDeletePost}),n.state={preview:!1,editText:"",postError:"",errorClass:null,showEmojiPicker:!1},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ns(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"UNSAFE_componentWillUpdate",value:function(e){!this.props.editingPost.show&&e.editingPost.show&&this.setState({editText:e.editingPost.post.message_source||e.editingPost.post.message})}},{key:"render",value:function(){var e=this.context.intl.formatMessage,t="edit-post-footer"+(this.state.postError?" has-error":""),n=null;if(this.state.postError){var r="post-error"+(this.state.errorClass?" "+this.state.errorClass:"");n=_.a.createElement("label",{className:r},this.state.postError)}var o=null,a=e({id:"emoji_picker.emojiPicker",defaultMessage:"Emoji Picker"}).toLowerCase();return"true"!==this.props.config.EnableEmojiPicker||this.state.preview||(o=_.a.createElement("div",null,_.a.createElement(Eo,{show:this.state.showEmojiPicker,container:this.getContainer,target:this.getEditPostControls,onHide:this.hideEmojiPicker,onEmojiClick:this.handleEmojiClick,onGifClick:this.handleGifClick,enableGifPicker:"true"===this.props.config.EnableGifPicker,topOffset:-20}),_.a.createElement("button",{"aria-label":a,id:"editPostEmoji",ref:"editPostEmoji",className:"style--none post-action",onClick:this.toggleEmojiPicker},_.a.createElement(Vn,{className:"icon icon--emoji"})))),_.a.createElement(z.a,{id:"editPostModal",dialogClassName:"a11y__modal edit-modal",show:this.props.editingPost.show,onKeyDown:this.handleKeyDown,onHide:this.handleHide,onEntered:this.handleEntered,onExit:this.handleExit,onExited:this.handleExited,keyboard:!1,role:"dialog","aria-labelledby":"editPostModalLabel"},_.a.createElement(z.a.Header,{closeButton:!0},_.a.createElement(z.a.Title,{componentClass:"h1",id:"editPostModalLabel"},_.a.createElement(Y.c,{id:"edit_post.edit",defaultMessage:"Edit {title}",values:{title:this.props.editingPost.title}}))),_.a.createElement(z.a.Body,{bsClass:"modal-body edit-modal-body".concat(this.state.showEmojiPicker?" edit-modal-body--add-reaction":""),ref:"editModalBody"},_.a.createElement("div",{className:"post-create__container"},_.a.createElement("div",{className:"textarea-wrapper"},_.a.createElement(Hi,{tabIndex:"0",onChange:this.handleChange,onKeyPress:this.handleEditKeyPress,onKeyDown:this.handleKeyDown,handlePostError:this.handlePostError,value:this.state.editText,channelId:this.props.editingPost.post&&this.props.editingPost.post.channel_id,emojiEnabled:"true"===this.props.config.EnableEmojiPicker,createMessage:T.ab("edit_post.editPost","Edit the post..."),supportsCommands:!1,suggestionListStyle:"bottom",id:"edit_textbox",ref:this.setEditboxRef,characterLimit:this.props.maxPostSize,preview:this.state.preview}),_.a.createElement("div",{className:"post-body__actions"},o)),_.a.createElement("div",{className:"post-create-footer"},_.a.createElement(Qi,{characterLimit:this.props.maxPostSize,showPreview:this.state.preview,ref:this.setTextboxLinksRef,updatePreview:this.updatePreview,message:this.state.editText}),_.a.createElement("div",{className:t},n)))),_.a.createElement(z.a.Footer,null,_.a.createElement("button",{type:"button",className:"btn btn-link",onClick:this.handleHide},_.a.createElement(Y.c,{id:"edit_post.cancel",defaultMessage:"Cancel"})),_.a.createElement("button",{id:"editButton",type:"button",className:"btn btn-primary",disabled:this.isSaveDisabled(),onClick:this.handleEdit},_.a.createElement(Y.c,{id:"edit_post.save",defaultMessage:"Save"}))))}}])&&$i(n.prototype,r),o&&$i(n,o),t}();rs(as,"propTypes",{canEditPost:v.a.bool,canDeletePost:v.a.bool,ctrlSend:v.a.bool,config:v.a.object.isRequired,maxPostSize:v.a.number.isRequired,editingPost:v.a.shape({post:v.a.object,postId:v.a.string,refocusId:v.a.string,show:v.a.bool.isRequired,title:v.a.string,isRHS:v.a.bool}).isRequired,actions:v.a.shape({addMessageIntoHistory:v.a.func.isRequired,editPost:v.a.func.isRequired,hideEditPostModal:v.a.func.isRequired,openModal:v.a.func.isRequired}).isRequired}),rs(as,"contextTypes",{intl:Y.i.isRequired});var is=Object(r.connect)(function(e){var t=Object(u.getConfig)(e),n=Object(K.a)(e),r=Object(p.getCurrentUserId)(e),o=!1,a=!1;return n&&n.post&&n.post.user_id===r?(o=Object(D.haveIChannelPermission)(e,{channel:Object(d.getCurrentChannelId)(e),team:Object(f.getCurrentTeamId)(e),permission:L.Permissions.DELETE_POST}),a=Object(D.haveIChannelPermission)(e,{channel:Object(d.getCurrentChannelId)(e),team:Object(f.getCurrentTeamId)(e),permission:L.Permissions.EDIT_POST})):(o=Object(D.haveIChannelPermission)(e,{channel:Object(d.getCurrentChannelId)(e),team:Object(f.getCurrentTeamId)(e),permission:L.Permissions.DELETE_OTHERS_POSTS}),a=Object(D.haveIChannelPermission)(e,{channel:Object(d.getCurrentChannelId)(e),team:Object(f.getCurrentTeamId)(e),permission:L.Permissions.EDIT_OTHERS_POSTS})),{canEditPost:a,canDeletePost:o,ctrlSend:Object(l.getBool)(e,L.Preferences.CATEGORY_ADVANCED_SETTINGS,"send_on_ctrl_enter"),config:t,editingPost:n,maxPostSize:parseInt(t.MaxPostSize,10)||P.Q.DEFAULT_CHARACTER_LIMIT}},function(e){return{actions:Object(o.bindActionCreators)({addMessageIntoHistory:A.addMessageIntoHistory,editPost:V,hideEditPostModal:q.f,openModal:U.b},e)}})(as),ss=n(302),cs=n(315),ls=n.n(cs),us=n(1678);function ps(e){return(ps="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fs(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function ds(e){return(ds=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ms(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hs(e,t){return(hs=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function bs(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ys=P.Q.ActionTypes,gs=new(function(e){function t(){var e,n,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,r=ds(t).call(this),e=!r||"object"!==ps(r)&&"function"!=typeof r?ms(n):r,bs(ms(e),"addModalListener",function(t,n){e.on(t,n)}),bs(ms(e),"removeModalListener",function(t,n){e.removeListener(t,n)}),bs(ms(e),"handleEventPayload",function(t){var n=t.action,r=n.type,o=n.value,a=fs(n,["type","value"]);switch(r){case ys.TOGGLE_SHORTCUTS_MODAL:case ys.TOGGLE_IMPORT_THEME_MODAL:case ys.TOGGLE_DELETE_POST_MODAL:case ys.TOGGLE_GET_POST_LINK_MODAL:case ys.TOGGLE_GET_TEAM_INVITE_LINK_MODAL:case ys.TOGGLE_GET_PUBLIC_LINK_MODAL:case ys.TOGGLE_QUICK_SWITCH_MODAL:case ys.TOGGLE_CHANNEL_PURPOSE_UPDATE_MODAL:case ys.TOGGLE_CHANNEL_NAME_UPDATE_MODAL:case ys.TOGGLE_LEAVE_PRIVATE_CHANNEL_MODAL:e.emit(r,o,a)}}),e.dispatchToken=us.a.register(e.handleEventPayload),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hs(e,t)}(t,ls.a),t}()),vs=(n(1508),n(1578));function Es(e){return(Es="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Os(e){return(Os=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ws(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Cs(e,t){return(Cs=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ss(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ps=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=Os(t).call(this,e),n=!o||"object"!==Es(o)&&"function"!=typeof o?ws(r):o,Ss(ws(n),"onHide",function(){n.setState({copiedLink:!1}),n.props.onHide()}),Ss(ws(n),"copyLink",function(){var e=n.refs.textarea;e.focus(),e.setSelectionRange(0,n.props.link.length);try{document.execCommand("copy")?n.setState({copiedLink:!0}):n.setState({copiedLink:!1})}catch(e){n.setState({copiedLink:!1})}}),n.state={copiedLink:!1},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Cs(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e=null;this.props.helpText&&(e=_.a.createElement("p",null,this.props.helpText,_.a.createElement("br",null),_.a.createElement("br",null)));var t=null;document.queryCommandSupported("copy")&&(t=_.a.createElement("button",{id:"linkModalCopyLink","data-copy-btn":"true",type:"button",className:"btn btn-primary pull-left",onClick:this.copyLink},_.a.createElement(Y.c,{id:"get_link.copy",defaultMessage:"Copy Link"})));var n=_.a.createElement("textarea",{id:"linkModalTextArea",className:"form-control no-resize min-height",ref:"textarea",value:this.props.link,onClick:this.copyLink,readOnly:!0}),r=null;return this.state.copiedLink&&(r=_.a.createElement("p",{className:"alert alert-success alert--confirm"},_.a.createElement(vs.a,null),_.a.createElement(Y.c,{id:"get_link.clipboard",defaultMessage:" Link copied"}))),_.a.createElement(z.a,{dialogClassName:"a11y__modal",show:this.props.show,onHide:this.onHide,role:"dialog","aria-labelledby":"getLinkModalLabel"},_.a.createElement(z.a.Header,{id:"getLinkModalLabel",closeButton:!0},_.a.createElement("h4",{className:"modal-title"},this.props.title)),_.a.createElement(z.a.Body,null,e,n),_.a.createElement(z.a.Footer,null,_.a.createElement("button",{id:"linkModalCloseButton",type:"button",className:"btn btn-link",onClick:this.onHide},_.a.createElement(Y.c,{id:"get_link.close",defaultMessage:"Close"})),t,r))}}])&&_s(n.prototype,r),o&&_s(n,o),t}();function js(e){return(js="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ts(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ks(e){return(ks=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ns(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Rs(e,t){return(Rs=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Ss(Ps,"propTypes",{show:v.a.bool.isRequired,onHide:v.a.func.isRequired,title:v.a.string.isRequired,helpText:v.a.string,link:v.a.string.isRequired}),Ss(Ps,"defaultProps",{helpText:null});var Ms=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=ks(t).call(this,e))||"object"!==js(o)&&"function"!=typeof o?Ns(r):o).handleToggle=n.handleToggle.bind(Ns(n)),n.hide=n.hide.bind(Ns(n)),n.state={show:!1,post:{}},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Rs(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"componentDidMount",value:function(){gs.addModalListener(P.Q.ActionTypes.TOGGLE_GET_POST_LINK_MODAL,this.handleToggle)}},{key:"componentWillUnmount",value:function(){gs.removeModalListener(P.Q.ActionTypes.TOGGLE_GET_POST_LINK_MODAL,this.handleToggle)}},{key:"handleToggle",value:function(e,t){this.setState({show:e,post:t.post})}},{key:"hide",value:function(){this.setState({show:!1})}},{key:"render",value:function(){var e=this.props.currentTeamUrl+"/pl/"+this.state.post.id;return _.a.createElement(Ps,{show:this.state.show,onHide:this.hide,title:T.ab("get_post_link_modal.title","Copy Permalink"),helpText:T.ab("get_post_link_modal.help","The link below allows authorized users to see your post."),link:e})}}])&&Ts(n.prototype,r),o&&Ts(n,o),t}();!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Ms,"propTypes",{currentTeamUrl:v.a.string.isRequired});var Is=Object(r.connect)(function(e){var t=Object(f.getCurrentTeam)(e)||{};return{currentTeamUrl:"".concat(Object(ss.e)(),"/").concat(t.name)}})(Ms);function xs(e){return(xs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function As(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ls(e){return(Ls=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ds(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Us(e,t){return(Us=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function qs(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Hs=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=Ls(t).call(this,e),n=!o||"object"!==xs(o)&&"function"!=typeof o?Ds(r):o,qs(Ds(n),"handleToggle",function(e){n.setState({show:e})}),qs(Ds(n),"onHide",function(){n.handleToggle(!1)}),n.state={show:!1},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Us(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"componentDidMount",value:function(){gs.addModalListener(P.Q.ActionTypes.TOGGLE_GET_TEAM_INVITE_LINK_MODAL,this.handleToggle)}},{key:"componentWillUnmount",value:function(){gs.removeModalListener(P.Q.ActionTypes.TOGGLE_GET_TEAM_INVITE_LINK_MODAL,this.handleToggle)}},{key:"render",value:function(){var e,t=Object(ss.e)()+"/signup_user_complete/?id="+this.props.currentTeam.invite_id;return e="true"===this.props.config.EnableUserCreation?T.ab("get_team_invite_link_modal.help","Send teammates the link below for them to sign-up to this team site. The Team Invite Link can be shared with multiple teammates as it does not change unless it's regenerated in Team Settings by a Team Admin."):T.ab("get_team_invite_link_modal.helpDisabled","User creation has been disabled for your team. Please ask your team administrator for details."),_.a.createElement(Ps,{show:this.state.show,onHide:this.onHide,title:T.ab("get_team_invite_link_modal.title","Team Invite Link"),helpText:e,link:t})}}])&&As(n.prototype,r),o&&As(n,o),t}();qs(Hs,"propTypes",{currentTeam:v.a.object.isRequired,config:v.a.object.isRequired}),qs(Hs,"defaultProps",{currentTeam:{}});var Fs=Object(r.connect)(function(e){return{currentTeam:Object(f.getCurrentTeam)(e),config:Object(u.getConfig)(e)}})(Hs),Bs=n(2004),Gs=n(1694);function Vs(e){return(Vs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ws(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ks(e){return(Ks=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function zs(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ys(e,t){return(Ys=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Qs(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Zs=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=Ks(t).call(this,e),n=!o||"object"!==Vs(o)&&"function"!=typeof o?zs(r):o,Qs(zs(n),"handleToggle",function(e,t){n.setState({show:e,fileId:t.fileId})}),Qs(zs(n),"onHide",function(){n.setState({show:!1})}),n.state={show:!1,fileId:""},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ys(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"componentWillUnmount",value:function(){gs.removeModalListener(P.Q.ActionTypes.TOGGLE_GET_PUBLIC_LINK_MODAL,this.handleToggle)}},{key:"componentDidMount",value:function(){gs.addModalListener(P.Q.ActionTypes.TOGGLE_GET_PUBLIC_LINK_MODAL,this.handleToggle)}},{key:"componentDidUpdate",value:function(e,t){this.state.show&&!t.show&&this.props.actions.getFilePublicLink(this.state.fileId)}},{key:"render",value:function(){return _.a.createElement(Ps,{show:this.state.show,onHide:this.onHide,title:T.ab("get_public_link_modal.title","Copy Public Link"),helpText:T.ab("get_public_link_modal.help","The link below allows anyone to see this file without being registered on this server."),link:this.props.link})}}])&&Ws(n.prototype,r),o&&Ws(n,o),t}();Qs(Zs,"propTypes",{link:v.a.string,actions:v.a.shape({getFilePublicLink:v.a.func.isRequired}).isRequired}),Qs(Zs,"defaultProps",{link:""});var Js=Object(r.connect)(function(e){return{link:Gs.getFilePublicLink(e).link}},function(e){return{actions:Object(o.bindActionCreators)({getFilePublicLink:Bs.getFilePublicLink},e)}})(Zs),Xs=n(1497);function $s(e){return($s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ec(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tc(e){return(tc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function nc(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rc(e,t){return(rc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function oc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ac=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=tc(t).call(this,e),n=!o||"object"!==$s(o)&&"function"!=typeof o?nc(r):o,oc(nc(n),"handleKeyPress",function(e){"Enter"===e.key&&n.state.show&&n.handleSubmit()}),oc(nc(n),"handleSubmit",function(){var e=n.props.actions,t=n.state.channel;if(t){var r=t.id;e.leaveChannel(r).then(function(e){e.data&&n.handleHide()})}}),oc(nc(n),"handleToggle",function(e){n.setState({channel:e,show:null!==e})}),oc(nc(n),"handleHide",function(){n.setState({show:!1,channel:null})}),n.state={show:!1,channel:null},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rc(e,t)}(t,_.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){gs.addModalListener(P.Q.ActionTypes.TOGGLE_LEAVE_PRIVATE_CHANNEL_MODAL,this.handleToggle)}},{key:"componentWillUnmount",value:function(){gs.removeModalListener(P.Q.ActionTypes.TOGGLE_LEAVE_PRIVATE_CHANNEL_MODAL,this.handleToggle)}},{key:"render",value:function(){var e="",t="";this.state.channel&&(e=_.a.createElement(Y.c,{id:"leave_private_channel_modal.title",defaultMessage:"Leave Private Channel {channel}",values:{channel:_.a.createElement("b",null,this.state.channel.display_name)}}),t=_.a.createElement(Y.c,{id:"leave_private_channel_modal.message",defaultMessage:"Are you sure you wish to leave the private channel {channel}? You must be re-invited in order to re-join this channel in the future.",values:{channel:_.a.createElement("b",null,this.state.channel.display_name)}}));var n=_.a.createElement(Y.c,{id:"leave_private_channel_modal.leave",defaultMessage:"Yes, leave channel"});return _.a.createElement(Xs.a,{show:this.state.show,title:e,message:t,confirmButtonClass:"btn btn-danger",confirmButtonText:n,onConfirm:this.handleSubmit,onCancel:this.handleHide})}}])&&ec(n.prototype,r),o&&ec(n,o),t}();oc(ac,"propTypes",{actions:v.a.shape({leaveChannel:v.a.func.isRequired}).isRequired,intl:Y.i.isRequired});var ic=Object(Y.h)(ac);var sc=Object(r.connect)(null,function(e){return{actions:Object(o.bindActionCreators)({leaveChannel:Oo.e},e)}})(ic),cc=n(132),lc=n(307);function uc(e){return(uc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){bc(e,t,n[t])})}return e}function fc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function dc(e){return(dc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function mc(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hc(e,t){return(hc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function bc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var yc=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=dc(t).call(this,e),n=!o||"object"!==uc(o)&&"function"!=typeof o?mc(r):o,bc(mc(n),"hideModal",function(){n.setState({show:!1})}),bc(mc(n),"onConfirm",function(e){n.hideModal();var t=pc({},n.state.currentUserStatus);if(t.status=n.state.newStatus,n.props.actions.setStatus(t),e){var r={category:L.Preferences.CATEGORY_AUTO_RESET_MANUAL_STATUS,user_id:t.user_id,name:t.user_id,value:"true"};n.props.actions.savePreferences(r.user_id,[r])}}),bc(mc(n),"onCancel",function(e){if(n.hideModal(),e){var t=pc({},n.state.currentUserStatus),r={category:L.Preferences.CATEGORY_AUTO_RESET_MANUAL_STATUS,user_id:t.user_id,name:t.user_id,value:"false"};n.props.actions.savePreferences(r.user_id,[r])}}),bc(mc(n),"renderModalMessage",function(){return n.props.currentUserStatus===P.O.OUT_OF_OFFICE?_.a.createElement(Y.c,{id:"modal.manual_status.auto_responder.message_".concat(n.state.newStatus),defaultMessage:'Would you like to switch your status to "{status}" and disable Automatic Replies?',values:{status:Object(T.kb)(n.state.newStatus)}}):_.a.createElement(Y.c,{id:"modal.manual_status.message_".concat(n.state.newStatus),defaultMessage:'Would you like to switch your status to "{status}"?',values:{status:Object(T.kb)(n.state.newStatus)}})}),n.state={show:!1,currentUserStatus:{},newStatus:e.newStatus||"online"},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hc(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"componentDidMount",value:function(){var e=this;this.props.actions.autoResetStatus().then(function(t){var n=t.manual,r=""===e.props.autoResetPref;e.setState({currentUserStatus:t,show:Boolean(t.status===P.O.OUT_OF_OFFICE||n&&r)})})}},{key:"render",value:function(){var e=this.state.currentUserStatus.status||"",t="modal.manual_status.title_"+e,n=_.a.createElement(Y.c,{id:t,defaultMessage:'Your status is set to "{status}"',values:{status:Object(T.kb)(e)}}),r=this.renderModalMessage(),o=_.a.createElement(Y.c,{id:"modal.manual_status.button_".concat(this.state.newStatus),defaultMessage:'Yes, set my status to "{status}"',values:{status:Object(T.kb)(this.state.newStatus)}}),a="modal.manual_status.cancel_"+e,i=_.a.createElement(Y.c,{id:a,defaultMessage:'No, keep it as "{status}"',values:{status:Object(T.kb)(e)}}),s=_.a.createElement(Y.c,{id:"modal.manual_status.ask",defaultMessage:"Do not ask me again"}),c=this.props.currentUserStatus!==P.O.OUT_OF_OFFICE;return _.a.createElement(Xs.a,{show:this.state.show,title:n,message:r,confirmButtonText:o,onConfirm:this.onConfirm,cancelButtonText:i,onCancel:this.onCancel,onExited:this.props.onHide,showCheckbox:c,checkboxText:s})}}])&&fc(n.prototype,r),o&&fc(n,o),t}();bc(yc,"propTypes",{autoResetPref:v.a.string,currentUserStatus:v.a.string,newStatus:v.a.string,onHide:v.a.func,actions:v.a.shape({autoResetStatus:v.a.func.isRequired,setStatus:v.a.func.isRequired,savePreferences:v.a.func.isRequired}).isRequired}),Object(Ne.b)("modal.manual_status.auto_responder.message_"),Object(Ne.b)("modal.manual_status.auto_responder.message_away"),Object(Ne.b)("modal.manual_status.auto_responder.message_dnd"),Object(Ne.b)("modal.manual_status.auto_responder.message_offline"),Object(Ne.b)("modal.manual_status.auto_responder.message_online"),Object(Ne.b)("modal.manual_status.button_"),Object(Ne.b)("modal.manual_status.button_away"),Object(Ne.b)("modal.manual_status.button_dnd"),Object(Ne.b)("modal.manual_status.button_offline"),Object(Ne.b)("modal.manual_status.button_online"),Object(Ne.b)("modal.manual_status.cancel_"),Object(Ne.b)("modal.manual_status.cancel_away"),Object(Ne.b)("modal.manual_status.cancel_dnd"),Object(Ne.b)("modal.manual_status.cancel_offline"),Object(Ne.b)("modal.manual_status.cancel_ooo"),Object(Ne.b)("modal.manual_status.message_"),Object(Ne.b)("modal.manual_status.message_away"),Object(Ne.b)("modal.manual_status.message_dnd"),Object(Ne.b)("modal.manual_status.message_offline"),Object(Ne.b)("modal.manual_status.message_online"),Object(Ne.b)("modal.manual_status.title_"),Object(Ne.b)("modal.manual_status.title_away"),Object(Ne.b)("modal.manual_status.title_dnd"),Object(Ne.b)("modal.manual_status.title_offline"),Object(Ne.b)("modal.manual_status.title_ooo");var gc=Object(r.connect)(function(e){var t=e.entities.users.currentUserId;return{autoResetPref:Object(l.get)(e,L.Preferences.CATEGORY_AUTO_RESET_MANUAL_STATUS,t,""),currentUserStatus:Object(p.getStatusForUserId)(e,t)}},function(e){return{actions:Object(o.bindActionCreators)({autoResetStatus:lc.a,setStatus:i.setStatus,savePreferences:cc.savePreferences},e)}})(yc);function vc(e){return(vc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ec(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _c(e){return(_c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Oc(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wc(e,t){return(wc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Cc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Sc=Object(Y.g)({mainHeader:{default:{id:Object(Ne.b)("shortcuts.header"),defaultMessage:"Keyboard Shortcuts\tCtrl|/"},mac:{id:Object(Ne.b)("shortcuts.header.mac"),defaultMessage:"Keyboard Shortcuts\t⌘|/"}},navHeader:{id:Object(Ne.b)("shortcuts.nav.header"),defaultMessage:"Navigation"},navPrev:{default:{id:Object(Ne.b)("shortcuts.nav.prev"),defaultMessage:"Previous channel:\tAlt|Up"},mac:{id:Object(Ne.b)("shortcuts.nav.prev.mac"),defaultMessage:"Previous channel:\t⌥|Up"}},navNext:{default:{id:Object(Ne.b)("shortcuts.nav.next"),defaultMessage:"Next channel:\tAlt|Down"},mac:{id:Object(Ne.b)("shortcuts.nav.next.mac"),defaultMessage:"Next channel:\t⌥|Down"}},navUnreadPrev:{default:{id:Object(Ne.b)("shortcuts.nav.unread_prev"),defaultMessage:"Previous unread channel:\tAlt|Shift|Up"},mac:{id:Object(Ne.b)("shortcuts.nav.unread_prev.mac"),defaultMessage:"Previous unread channel:\t⌥|Shift|Up"}},navUnreadNext:{default:{id:Object(Ne.b)("shortcuts.nav.unread_next"),defaultMessage:"Next unread channel:\tAlt|Shift|Down"},mac:{id:Object(Ne.b)("shortcuts.nav.unread_next.mac"),defaultMessage:"Next unread channel:\t⌥|Shift|Down"}},navSwitcher:{default:{id:Object(Ne.b)("shortcuts.nav.switcher"),defaultMessage:"Quick channel switcher:\tCtrl|K"},mac:{id:Object(Ne.b)("shortcuts.nav.switcher.mac"),defaultMessage:"Quick channel switcher:\t⌘|K"}},navDMMenu:{default:{id:Object(Ne.b)("shortcuts.nav.direct_messages_menu"),defaultMessage:"Direct messages menu:\tCtrl|Shift|K"},mac:{id:Object(Ne.b)("shortcuts.nav.direct_messages_menu.mac"),defaultMessage:"Direct messages menu:\t⌘|Shift|K"}},navSettings:{default:{id:Object(Ne.b)("shortcuts.nav.settings"),defaultMessage:"Account settings:\tCtrl|Shift|A"},mac:{id:Object(Ne.b)("shortcuts.nav.settings.mac"),defaultMessage:"Account settings:\t⌘|Shift|A"}},navMentions:{default:{id:Object(Ne.b)("shortcuts.nav.recent_mentions"),defaultMessage:"Recent mentions:\tCtrl|Shift|M"},mac:{id:Object(Ne.b)("shortcuts.nav.recent_mentions.mac"),defaultMessage:"Recent mentions:\t⌘|Shift|M"}},navFocusCenter:{default:{id:Object(Ne.b)("shortcuts.nav.focus_center"),defaultMessage:"Set focus to input field:\tCtrl|Shift|L"},mac:{id:Object(Ne.b)("shortcuts.nav.focus_center.mac"),defaultMessage:"Set focus to input field:\t⌘|Shift|L"}},msgHeader:{id:Object(Ne.b)("shortcuts.msgs.header"),defaultMessage:"Messages"},msgInputHeader:{id:Object(Ne.b)("shortcuts.msgs.input.header"),defaultMessage:"Works inside an empty input field"},msgEdit:{id:Object(Ne.b)("shortcuts.msgs.edit"),defaultMessage:"Edit last message in channel:\tUp"},msgReply:{id:Object(Ne.b)("shortcuts.msgs.reply"),defaultMessage:"Reply to last message in channel:\tShift|Up"},msgReprintPrev:{default:{id:Object(Ne.b)("shortcuts.msgs.reprint_prev"),defaultMessage:"Reprint previous message:\tCtrl|Up"},mac:{id:Object(Ne.b)("shortcuts.msgs.reprint_prev.mac"),defaultMessage:"Reprint previous message:\t⌘|Up"}},msgReprintNext:{default:{id:Object(Ne.b)("shortcuts.msgs.reprint_next"),defaultMessage:"Reprint next message:\tCtrl|Down"},mac:{id:Object(Ne.b)("shortcuts.msgs.reprint_next.mac"),defaultMessage:"Reprint next message:\t⌘|Down"}},msgCompHeader:{id:Object(Ne.b)("shortcuts.msgs.comp.header"),defaultMessage:"Autocomplete"},msgCompUsername:{id:Object(Ne.b)("shortcuts.msgs.comp.username"),defaultMessage:"Username:\t@|[a-z]|Tab"},msgCompChannel:{id:Object(Ne.b)("shortcuts.msgs.comp.channel"),defaultMessage:"Channel:\t~|[a-z]|Tab"},msgCompEmoji:{id:Object(Ne.b)("shortcuts.msgs.comp.emoji"),defaultMessage:"Emoji:\t:|[a-z]|Tab"},filesHeader:{id:Object(Ne.b)("shortcuts.files.header"),defaultMessage:"Files"},filesUpload:{default:{id:Object(Ne.b)("shortcuts.files.upload"),defaultMessage:"Upload files:\tCtrl|U"},mac:{id:Object(Ne.b)("shortcuts.files.upload.mac"),defaultMessage:"Upload files:\t⌘|U"}},browserHeader:{id:Object(Ne.b)("shortcuts.browser.header"),defaultMessage:"Built-in Browser Commands"},browserChannelPrev:{default:{id:Object(Ne.b)("shortcuts.browser.channel_prev"),defaultMessage:"Back in history:\tAlt|Left"},mac:{id:Object(Ne.b)("shortcuts.browser.channel_prev.mac"),defaultMessage:"Back in history:\t⌘|["}},browserChannelNext:{default:{id:Object(Ne.b)("shortcuts.browser.channel_next"),defaultMessage:"Forward in history:\tAlt|Right"},mac:{id:Object(Ne.b)("shortcuts.browser.channel_next.mac"),defaultMessage:"Forward in history:\t⌘|]"}},browserFontIncrease:{default:{id:Object(Ne.b)("shortcuts.browser.font_increase"),defaultMessage:"Zoom in:\tCtrl|+"},mac:{id:Object(Ne.b)("shortcuts.browser.font_increase.mac"),defaultMessage:"Zoom in:\t⌘|+"}},browserFontDecrease:{default:{id:Object(Ne.b)("shortcuts.browser.font_decrease"),defaultMessage:"Zoom out:\tCtrl|-"},mac:{id:Object(Ne.b)("shortcuts.browser.font_decrease.mac"),defaultMessage:"Zoom out:\t⌘|-"}},browserInputHeader:{id:Object(Ne.b)("shortcuts.browser.input.header"),defaultMessage:"Works inside an input field"},browserHighlightPrev:{id:Object(Ne.b)("shortcuts.browser.highlight_prev"),defaultMessage:"Highlight text to the previous line:\tShift|Up"},browserHighlightNext:{id:Object(Ne.b)("shortcuts.browser.highlight_next"),defaultMessage:"Highlight text to the next line:\tShift|Down"},browserNewline:{id:Object(Ne.b)("shortcuts.browser.newline"),defaultMessage:"Create a new line:\tShift|Enter"},info:{id:Object(Ne.b)("shortcuts.info"),defaultMessage:"Begin a message with / for a list of all the commands at your disposal."}}),Pc=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=_c(t).call(this,e),n=!o||"object"!==vc(o)&&"function"!=typeof o?Oc(r):o,Cc(Oc(n),"handleToggle",function(){n.setState({show:!n.state.show})}),Cc(Oc(n),"handleHide",function(){n.setState({show:!1})}),n.state={show:!1},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wc(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"componentDidMount",value:function(){gs.addModalListener(P.Q.ActionTypes.TOGGLE_SHORTCUTS_MODAL,this.handleToggle)}},{key:"componentWillUnmount",value:function(){gs.removeModalListener(P.Q.ActionTypes.TOGGLE_SHORTCUTS_MODAL,this.handleToggle)}},{key:"getShortcuts",value:function(){var e=this.props.isMac,t={};return Object.keys(Sc).forEach(function(n){e&&Sc[n].mac?t[n]=Sc[n].mac:!e&&Sc[n].default?t[n]=Sc[n].default:t[n]=Sc[n]}),t}},{key:"render",value:function(){var e=this.getShortcuts(),t=this.props.intl.formatMessage;return _.a.createElement(z.a,{dialogClassName:"a11y__modal shortcuts-modal",show:this.state.show,onHide:this.handleHide,onExited:this.handleHide,role:"dialog","aria-labelledby":"shortcutsModalLabel"},_.a.createElement("div",{className:"shortcuts-content"},_.a.createElement(z.a.Header,{closeButton:!0},_.a.createElement(z.a.Title,{componentClass:"h1",id:"shortcutsModalLabel"},_.a.createElement("strong",null,jc(t(e.mainHeader))))),_.a.createElement(z.a.Body,{ref:"modalBody"},_.a.createElement("div",{className:"row"},_.a.createElement("div",{className:"col-sm-4"},_.a.createElement("div",{className:"section"},_.a.createElement("div",null,_.a.createElement("h4",{className:"section-title"},_.a.createElement("strong",null,t(e.navHeader))),jc(t(e.navPrev)),jc(t(e.navNext)),jc(t(e.navUnreadPrev)),jc(t(e.navUnreadNext)),jc(t(e.navSwitcher)),jc(t(e.navDMMenu)),jc(t(e.navSettings)),jc(t(e.navMentions)),jc(t(e.navFocusCenter))))),_.a.createElement("div",{className:"col-sm-4"},_.a.createElement("div",{className:"section"},_.a.createElement("div",null,_.a.createElement("h4",{className:"section-title"},_.a.createElement("strong",null,t(e.msgHeader))),_.a.createElement("span",null,_.a.createElement("strong",null,t(e.msgInputHeader))),_.a.createElement("div",{className:"subsection"},jc(t(e.msgEdit)),jc(t(e.msgReply)),jc(t(e.msgReprintPrev)),jc(t(e.msgReprintNext))),_.a.createElement("span",null,_.a.createElement("strong",null,t(e.msgCompHeader))),_.a.createElement("div",{className:"subsection"},jc(t(e.msgCompUsername)),jc(t(e.msgCompChannel)),jc(t(e.msgCompEmoji)))))),_.a.createElement("div",{className:"col-sm-4"},_.a.createElement("div",{className:"section"},_.a.createElement("div",null,_.a.createElement("h4",{className:"section-title"},_.a.createElement("strong",null,t(e.filesHeader))),jc(t(e.filesUpload))),_.a.createElement("div",{className:"section--lower"},_.a.createElement("h4",{className:"section-title"},_.a.createElement("strong",null,t(e.browserHeader))),jc(t(e.browserChannelPrev)),jc(t(e.browserChannelNext)),jc(t(e.browserFontIncrease)),jc(t(e.browserFontDecrease)),_.a.createElement("span",null,_.a.createElement("strong",null,t(e.browserInputHeader))),_.a.createElement("div",{className:"subsection"},jc(t(e.browserHighlightPrev)),jc(t(e.browserHighlightNext)),jc(t(e.browserNewline))))))),_.a.createElement("div",{className:"info__label"},t(e.info)))))}}])&&Ec(n.prototype,r),o&&Ec(n,o),t}();function jc(e){if(!e)return null;var t=e.split("\t"),n=_.a.createElement("span",null,t[0]),r=null;return t.length>1&&(r=t[1].split("|").map(function(e){return _.a.createElement("span",{className:"shortcut-key",key:e},e)})),_.a.createElement("div",{className:"shortcut-line"},n,r)}Cc(Pc,"propTypes",{intl:Y.i.isRequired,isMac:v.a.bool.isRequired});var Tc=Object(Y.h)(Pc),kc=n(304),Nc=n(97),Rc=n(1487),Mc=n.n(Rc),Ic=n(2007),xc=n.n(Ic),Ac=n(2008),Lc=n.n(Ac);function Dc(e){var t="file-overlay hidden";return"right"===e.overlayType?t+=" right-file-overlay":"center"===e.overlayType&&(t+=" center-file-overlay"),_.a.createElement("div",{className:t},_.a.createElement("div",{className:"overlay__indent"},_.a.createElement("div",{className:"overlay__circle"},_.a.createElement("img",{className:"overlay__files",src:xc.a,alt:"Files"}),_.a.createElement("span",null,_.a.createElement(Y.c,{id:"generic_icons.upload",defaultMessage:"Upload Icon"},function(e){return _.a.createElement("i",{className:"fa fa-upload",title:e})}),_.a.createElement(Y.c,{id:"upload_overlay.info",defaultMessage:"Drop a file to upload it."})),_.a.createElement("img",{className:"overlay__logo",src:Lc.a,width:"100",alt:"Logo"}))))}Dc.propTypes={overlayType:v.a.string};var Uc=n(183),qc=n.n(Uc),Hc=n(1596),Fc=n.n(Hc);function Bc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Gc=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.action=t,this.timer=-1,this.fire=this.fire.bind(this)}var t,n,r;return t=e,(n=[{key:"fire",value:function(){this.action(),this.timer=-1}},{key:"fireAfter",value:function(e){this.timer>=0&&window.clearTimeout(this.timer),this.timer=window.setTimeout(this.fire,e)}},{key:"cancel",value:function(){window.clearTimeout(this.timer)}}])&&Bc(t.prototype,n),r&&Bc(t,r),e}();function Vc(e){return e.views.system.websocketConnectionErrorCount}var Wc=n(306),Kc=n(121),zc=n(249),Yc=n(63),Qc=n(1656);function Zc(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function Jc(e,t){return function(){var n,r=(n=regeneratorRuntime.mark(function n(r,o){var a,i,c,l,u,m,h,b,y,g,v,E,_;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:a=o(),(c=(i=e).indexOf(" "))<0&&(c=i.length),l=i.substring(0,c).toLowerCase(),i=l+" "+i.substring(c,i.length).trim(),n.t0=l,n.next="/search"===n.t0?9:"/shortcuts"===n.t0?11:"/leave"===n.t0?16:"/settings"===n.t0?35:"/collapse"===n.t0?37:"/expand"===n.t0?37:38;break;case 9:return r(q.i(i.substring(c+1,i.length))),n.abrupt("return",{data:!0});case 11:if(!j.m()){n.next=14;break}return u={message:Object(T.ab)("create_post.shortcutsNotSupported","Keyboard shortcuts are not supported on your device")},n.abrupt("return",{error:u});case 14:return S.n(),n.abrupt("return",{data:!0});case 16:if(!t.channel_id||!t.root_id&&!t.parent_id){n.next=19;break}return S.h("/leave is not supported in reply threads. Use it in the center channel instead.",t.channel_id,t.parent_id),n.abrupt("return",{data:!0});case 19:if((m=Object(d.getCurrentChannel)(a)).type!==P.i.PRIVATE_CHANNEL){n.next=25;break}return S.m(m),n.abrupt("return",{data:!0});case 25:if(m.type!==P.i.DM_CHANNEL&&m.type!==P.i.GM_CHANNEL){n.next=34;break}return m.type===P.i.DM_CHANNEL?(h=Object(T.F)(m),b=P.i.Preferences.CATEGORY_DIRECT_CHANNEL_SHOW):(h=m.id,b=P.i.Preferences.CATEGORY_GROUP_CHANNEL_SHOW),y=Object(p.getCurrentUserId)(a),r(Object(cc.savePreferences)(y,[{category:b,name:h,user_id:y,value:"false"}])),Object(So.isFavoriteChannel)(m)&&r(Object(s.unfavoriteChannel)(m.id)),g=Object(f.getCurrentTeamId)(a),v=Object(d.getRedirectChannelNameForTeam)(a,g),Q.a.push("".concat(Object(f.getCurrentRelativeTeamUrl)(a),"/channels/").concat(v)),n.abrupt("return",{data:!0});case 34:return n.abrupt("break",38);case 35:return r(Object(U.b)({ModalId:P.r.USER_SETTINGS,dialogType:Qc.a})),n.abrupt("return",{data:!0});case 37:r(q.h());case 38:return n.prev=38,n.next=41,ii.Client4.executeCommand(i,t);case 41:E=n.sent,n.next=47;break;case 44:return n.prev=44,n.t1=n.catch(38),n.abrupt("return",{error:n.t1});case 47:if(_=E.goto_location&&Object(ss.f)(E.goto_location),"/logout"!==i.trim()){n.next=51;break}return S.e(_?E.goto_location:"/"),n.abrupt("return",{data:!0});case 51:return E.trigger_id&&r({type:za.IntegrationTypes.RECEIVED_DIALOG_TRIGGER_ID,data:E.trigger_id}),_&&(E.goto_location.startsWith("/")?Q.a.push(E.goto_location):E.goto_location.startsWith(Object(ss.e)())?Q.a.push(E.goto_location.substr(Object(ss.e)().length)):window.open(E.goto_location)),n.abrupt("return",{data:!0});case 54:case"end":return n.stop()}},n,null,[[38,44]])}),function(){var e=this,t=arguments;return new Promise(function(r,o){var a=n.apply(e,t);function i(e){Zc(a,r,o,i,s,"next",e)}function s(e){Zc(a,r,o,i,s,"throw",e)}i(void 0)})});return function(e,t){return r.apply(this,arguments)}}()}function Xc(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function $c(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){Xc(a,r,o,i,s,"next",e)}function s(e){Xc(a,r,o,i,s,"throw",e)}i(void 0)})}}function el(e){return function(){var t=$c(regeneratorRuntime.mark(function t(n,r){var o,a,i,s,c,l,u,p,f;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if((o=r().plugins.components.MessageWillBePosted)&&0!==o.length){t.next=3;break}return t.abrupt("return",{data:e});case 3:a=e,i=!0,s=!1,c=void 0,t.prev=7,l=o[Symbol.iterator]();case 9:if(i=(u=l.next()).done){t.next=21;break}return p=u.value,t.next=13,p.hook(a);case 13:if(!(f=t.sent)){t.next=18;break}if(!f.error){t.next=17;break}return t.abrupt("return",{error:f.error});case 17:a=f.post;case 18:i=!0,t.next=9;break;case 21:t.next=27;break;case 23:t.prev=23,t.t0=t.catch(7),s=!0,c=t.t0;case 27:t.prev=27,t.prev=28,i||null==l.return||l.return();case 30:if(t.prev=30,!s){t.next=33;break}throw c;case 33:return t.finish(30);case 34:return t.finish(27);case 35:return t.abrupt("return",{data:a});case 36:case"end":return t.stop()}},t,null,[[7,23,27,35],[28,,30,34]])}));return function(e,n){return t.apply(this,arguments)}}()}function tl(e,t){return function(){var n=$c(regeneratorRuntime.mark(function n(r,o){var a,i,s,c,l,u,p,f,d,m;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if((a=o().plugins.components.SlashCommandWillBePosted)&&0!==a.length){n.next=3;break}return n.abrupt("return",{data:{message:e,args:t}});case 3:i=e,s=t,c=!0,l=!1,u=void 0,n.prev=8,p=a[Symbol.iterator]();case 10:if(c=(f=p.next()).done){n.next=23;break}return d=f.value,n.next=14,d.hook(i,s);case 14:if(!(m=n.sent)){n.next=20;break}if(!m.error){n.next=18;break}return n.abrupt("return",{error:m.error});case 18:i=m.message,s=m.args;case 20:c=!0,n.next=10;break;case 23:n.next=29;break;case 25:n.prev=25,n.t0=n.catch(8),l=!0,u=n.t0;case 29:n.prev=29,n.prev=30,c||null==p.return||p.return();case 32:if(n.prev=32,!l){n.next=35;break}throw u;case 35:return n.finish(32);case 36:return n.finish(29);case 37:return n.abrupt("return",{data:{message:i,args:s}});case 38:case"end":return n.stop()}},n,null,[[8,25,29,37],[30,,32,36]])}));return function(e,t){return n.apply(this,arguments)}}()}var nl=n(146),rl=n(691);function ol(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function al(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){ol(a,r,o,i,s,"next",e)}function s(e){ol(a,r,o,i,s,"throw",e)}i(void 0)})}}function il(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){sl(e,t,n[t])})}return e}function sl(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function cl(){return Object(nl.a)(P.G.COMMENT_DRAFT,function(e,t){return t?il({},t,{uploadsInProgress:[]}):t})}function ll(e,t){return Object(nl.e)("".concat(P.G.COMMENT_DRAFT).concat(e),t)}function ul(e,t){var n=Object(ea.makeGetMessageInHistoryItem)(L.Posts.MESSAGE_TYPES.COMMENT);return function(){return function(r,o){var a=Object(Nc.i)(o(),P.G.COMMENT_DRAFT,e);if(""===a.message||a.message===n(o())){-1===t?r(Object(A.moveHistoryIndexBack)(L.Posts.MESSAGE_TYPES.COMMENT)):1===t&&r(Object(A.moveHistoryIndexForward)(L.Posts.MESSAGE_TYPES.COMMENT));var i=n(o());r(ll(e,il({},a,{message:i})))}}}}function pl(e,t,n){return function(){var r=al(regeneratorRuntime.mark(function r(o,a){var i,s,c,l,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=a(),s=Object(p.getCurrentUserId)(i),c=T.D(),l={file_ids:[],message:n.message,channel_id:e,root_id:t,parent_id:t,pending_post_id:"".concat(s,":").concat(c),user_id:s,create_at:c,metadata:{},props:{}},r.next=6,o(el(l));case 6:if(!(u=r.sent).error){r.next=9;break}return r.abrupt("return",{error:u.error});case 9:return l=u.data,r.abrupt("return",o(q.b(l,n.fileInfos)));case 11:case"end":return r.stop()}},r)}));return function(e,t){return r.apply(this,arguments)}}()}function fl(e,t,n){return function(r){"+"===t?r(q.a(e,n)):"-"===t&&r(Object(A.removeReaction)(e,n))}}function dl(e,t,n){return function(){var r=al(regeneratorRuntime.mark(function r(o,a){var i,s,c,l,u,p,d;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=a(),s=Object(f.getCurrentTeamId)(i),c={channel_id:e,team_id:s,root_id:t,parent_id:t},l=n.message,r.next=6,o(tl(l,c));case 6:if(!(u=r.sent).error){r.next=11;break}return r.abrupt("return",{error:u.error});case 11:if(u.data.message||u.data.args){r.next=13;break}return r.abrupt("return",{});case 13:return l=u.data.message,c=u.data.args,r.next=17,o(Jc(l,c));case 17:if(p=r.sent,!(d=p.error)){r.next=23;break}if(!d.sendMessage){r.next=22;break}return r.abrupt("return",o(pl(e,t,n)));case 22:throw d;case 23:return r.abrupt("return",{});case 24:case"end":return r.stop()}},r)}));return function(e,t){return r.apply(this,arguments)}}()}function ml(e,t){var n=function(e,t){return Object(Kc.a)(p.getCurrentUserId,function(t){return Object(ea.getPostIdsInChannel)(t,e)},function(e){return function(t){return Object(ea.getPost)(e,t)}},function(e,n,r){var o=null;if(!n)return o;var a=!0,i=!1,s=void 0;try{for(var c,l=n[Symbol.iterator]();!(a=(c=l.next()).done);a=!0){var u=r(c.value)||{};if(!(u.user_id!==e||u.props&&u.props.from_webhook||u.state===P.i.POST_DELETED||u.type&&u.type.startsWith(P.i.SYSTEM_MESSAGE_PREFIX)||Object(Yc.isPostPendingOrFailed)(u))){if(!t){o=u;break}if(u.root_id===t||u.id===t){o=u;break}}}}catch(e){i=!0,s=e}finally{try{a||null==l.return||l.return()}finally{if(i)throw s}}return o})}(e,t),r=Object(ea.makeGetCommentCountForPost)();return function(){return function(e,t){var o=t(),a=n(o);return a?e(q.j(a.id,r(o,{post:a}),"reply_textbox",T.ab("create_comment.commentTitle","Comment"),!0)):{data:!1}}}}n(947);var hl=n(1534);function bl(e){if(-1===Array.from(e.types).indexOf("text/html"))return!1;var t=e.getData("text/html");if(!/<table/i.test(t))return!1;var n=function(e){var t=document.createElement("div");return t.innerHTML=e,t.querySelector("table")}(t);return n||!1}function yl(e){return e.textContent.trim().replace(/\|/g,"\\|").replace(/\n/g," ")||" "}function gl(e,t){var n,r=Array.from(e.querySelectorAll("tr")),o=(n=r.shift(),Array.from(n.querySelectorAll("td, th")).map(yl)),a=o.map(function(){return"---"}),i="|".concat(o.join(" | "),"|\n|").concat(a.join(" | "),"|\n"),s=r.map(function(e){return"|".concat(Array.from(e.querySelectorAll("td")).map(yl).join(" | "),"|")}).join("\n"),c="".concat(i).concat(s,"\n");return t?"".concat(t,"\n\n").concat(c):c}var vl=n(1762),El=n(1765);function _l(e){return(_l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ol(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function wl(e,t){return!t||"object"!==_l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Cl(e){return(Cl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Sl(e,t){return(Sl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Pl=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),wl(this,Cl(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Sl(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){return _.a.createElement("span",this.props,_.a.createElement(Y.c,{id:"generic_icons.attach",defaultMessage:"Attachment Icon"},function(e){return _.a.createElement("svg",{width:"18px",height:"18px",viewBox:"0 0 18 15",role:"icon","aria-label":e},_.a.createElement("g",{fill:"inherit",fillRule:"evenodd"},_.a.createElement("g",{transform:"translate(-1029.000000, -954.000000)",fillRule:"nonzero",fill:"inherit"},_.a.createElement("g",{transform:"translate(25.000000, 937.000000)"},_.a.createElement("g",{transform:"translate(1004.000000, 17.000000)"},_.a.createElement("path",{d:"M5.35,15.56 C3.98,15.56 2.61,15.039 1.567,13.997 C0.557,12.984 0,11.642 0,10.212 C0,8.783 0.557,7.44 1.566,6.429 L6.869,1.126 C8.371,-0.376 10.812,-0.375 12.314,1.125 C13.815,2.627 13.815,5.069 12.314,6.57 L7.011,11.873 C6.094,12.792 4.603,12.79 3.687,11.873 C2.771,10.958 2.771,9.467 3.687,8.551 L8.99,3.248 C9.323,2.916 9.861,2.916 10.193,3.248 C10.525,3.579 10.525,4.118 10.193,4.449 L4.89,9.752 C4.637,10.006 4.637,10.418 4.89,10.672 C5.143,10.923 5.555,10.925 5.809,10.672 L11.113,5.369 C11.952,4.53 11.952,3.166 11.113,2.327 C10.276,1.49 8.911,1.488 8.073,2.327 L2.769,7.631 C2.079,8.32 1.699,9.237 1.699,10.212 C1.699,11.188 2.079,12.104 2.768,12.794 C4.19,14.216 6.502,14.216 7.925,12.798 L7.929,12.794 C7.929,12.793 7.929,12.793 7.929,12.793 L15.355,5.369 C15.687,5.037 16.224,5.037 16.556,5.369 C16.888,5.7 16.888,6.239 16.556,6.57 L8.779,14.348 L8.761,14.332 C7.776,15.15 6.562,15.56 5.35,15.56 Z"}))))))}))}}])&&Ol(n.prototype,r),o&&Ol(n,o),t}(),jl=n(1541);function Tl(e){return(Tl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Nl(e,t){return!t||"object"!==Tl(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Rl(e){return(Rl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ml(e,t){return(Ml=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Il=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Nl(this,Rl(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ml(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.canDownload,n=e.children,r=e.compactDisplay,o=e.fileInfo,a=e.handleImageClick,i=e.iconClass,s=o.name,c=Object(jl.f)(s);return r?_.a.createElement(vl.a,{delayShow:1e3,placement:"top",overlay:_.a.createElement(El.a,{id:"file-name__tooltip"},s)},_.a.createElement("a",{href:"#",onClick:a,className:"post-image__name",rel:"noopener noreferrer"},_.a.createElement(Pl,{className:"icon"}),c)):t?_.a.createElement("div",{className:i||"post-image__name"},_.a.createElement("a",{href:Object(hl.getFileDownloadUrl)(o.id),"aria-label":Object(T.ab)("view_image_popover.download","Download").toLowerCase(),download:s,target:"_blank",rel:"noopener noreferrer"},_.a.createElement(vl.a,{delayShow:1e3,placement:"top",overlay:_.a.createElement(El.a,{id:"file-name__tooltip"},Object(T.ab)("view_image_popover.download","Download").toLowerCase())},n||c))):_.a.createElement("span",{className:"post-image__name"},c)}}])&&kl(n.prototype,r),o&&kl(n,o),t}();function xl(e){return(xl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Al(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ll(e,t){return!t||"object"!==xl(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Dl(e){return(Dl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ul(e,t){return(Ul=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Il,"propTypes",{fileInfo:v.a.object.isRequired,handleImageClick:v.a.func,compactDisplay:v.a.bool,canDownload:v.a.bool,children:v.a.element,iconClass:v.a.string});var ql=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ll(this,Dl(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ul(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){return _.a.createElement(Y.c,{id:"generic_icons.remove",defaultMessage:"Remove Icon"},function(e){return _.a.createElement("i",{className:"fa fa-remove",title:e})})}}])&&Al(n.prototype,r),o&&Al(n,o),t}(),Hl=n(1772);function Fl(e){return(Fl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Gl(e){return(Gl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Vl(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Wl(e,t){return(Wl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Kl(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var zl=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=Gl(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==Fl(o)&&"function"!=typeof o?Vl(r):o,Kl(Vl(n),"handleRemove",function(){n.props.handleRemove(n.props.clientId)}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wl(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e,t,n=0,r=this.props,o=r.fileInfo,a=r.clientId;if(o){var i=(n=o.percent)&&" (".concat(n.toFixed(0),"%)"),s=Object(jl.d)(o.type);t=_.a.createElement("div",{className:"file-icon "+T.A(s)}),e=_.a.createElement(_.a.Fragment,null,_.a.createElement(Il,{fileInfo:o,index:a,handleImageClick:null,compactDisplay:!1,canDownload:!1}),_.a.createElement("span",{className:"post-image__uploadingTxt"},100===n?_.a.createElement(Y.c,{id:"create_post.fileProcessing",defaultMessage:"Processing..."}):_.a.createElement(_.a.Fragment,null,_.a.createElement(Y.c,{id:"admin.plugin.uploading",defaultMessage:"Uploading..."}),_.a.createElement("span",null,i))),n&&_.a.createElement(Hl.a,{className:"post-image__progressBar",now:n,active:100===n}))}return _.a.createElement("div",{ref:a,key:a,className:"file-preview post-image__column","data-client-id":a},_.a.createElement("div",{className:"post-image__thumbnail"},t),_.a.createElement("div",{className:"post-image__details"},_.a.createElement("div",{className:"post-image__detail_wrapper"},_.a.createElement("div",{className:"post-image__detail"},e)),_.a.createElement("div",null,_.a.createElement("a",{className:"file-preview__remove",onClick:this.handleRemove},_.a.createElement(ql,null)))))}}])&&Bl(n.prototype,r),o&&Bl(n,o),t}();function Yl(e){return(Yl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ql(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Zl(e){return(Zl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Jl(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xl(e,t){return(Xl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function $l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Kl(zl,"propTypes",{handleRemove:v.a.func.isRequired,clientId:v.a.string.isRequired,fileInfo:v.a.object});var eu=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=Zl(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==Yl(o)&&"function"!=typeof o?Jl(r):o,$l(Jl(n),"handleRemove",function(e){n.props.onRemove(e)}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xl(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e=this,t=[];return this.props.fileInfos.forEach(function(n,r){var o,a=T.y(n.extension),i="file-preview post-image__column";if(a===P.m.SVG&&e.props.enableSVGs)o=_.a.createElement("img",{alt:"file preview",className:"post-image normal",src:Object(hl.getFileUrl)(n.id)});else if(a===P.m.IMAGE){var s="post-image";n.width<P.Q.THUMBNAIL_WIDTH&&n.height<P.Q.THUMBNAIL_HEIGHT?s+=" small":s+=" normal";var c=Object(hl.getFileThumbnailUrl)(n.id);T.R(n.extension)&&!n.has_preview_image&&(c=Object(hl.getFileUrl)(n.id)),o=_.a.createElement("div",{className:s,style:{backgroundImage:"url(".concat(c,")"),backgroundSize:"cover"}})}else i+=" custom-file",o=_.a.createElement("div",{className:"file-icon "+T.A(a)});t.push(_.a.createElement("div",{key:n.id,className:i},_.a.createElement("div",{className:"post-image__thumbnail"},o),_.a.createElement("div",{className:"post-image__details"},_.a.createElement("div",{className:"post-image__detail_wrapper"},_.a.createElement("div",{className:"post-image__detail"},_.a.createElement(Il,{fileInfo:n,index:r,handleImageClick:null,compactDisplay:!1,canDownload:!1}),_.a.createElement("span",{className:"post-image__type"},n.extension.toUpperCase()),_.a.createElement("span",{className:"post-image__size"},T.p(n.size)))),_.a.createElement("div",null,_.a.createElement("a",{className:"file-preview__remove",onClick:e.handleRemove.bind(e,n.id)},_.a.createElement(ql,null))))))}),this.props.uploadsInProgress.forEach(function(n){t.push(_.a.createElement(zl,{key:n,clientId:n,fileInfo:e.props.uploadsProgressPercent[n],handleRemove:e.handleRemove}))}),_.a.createElement("div",{className:"file-preview__container",ref:"container"},t)}}])&&Ql(n.prototype,r),o&&Ql(n,o),t}();$l(eu,"propTypes",{enableSVGs:v.a.bool.isRequired,onRemove:v.a.func.isRequired,fileInfos:v.a.arrayOf(v.a.object).isRequired,uploadsInProgress:v.a.array,uploadsProgressPercent:v.a.object}),$l(eu,"defaultProps",{fileInfos:[],uploadsInProgress:[],uploadsProgressPercent:{}});var tu=Object(r.connect)(function(e){return{enableSVGs:"true"===Object(u.getConfig)(e).EnableSVGs}})(eu),nu=n(147),ru=n(1784),ou=n.n(ru),au=n(122);function iu(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function su(e,t,n,r,o){return function(r){return r({type:za.FileTypes.UPLOAD_FILES_REQUEST}),ou.a.post(ii.Client4.getFilesRoute()).set(ii.Client4.getOptions({method:"post"}).headers).attach("files",e,t).field("channel_id",n).field("client_ids",o).accept("application/json")}}function cu(e,t,n,r,o,a){var i=a.err,s=a.res;return function(e,t){if(i){var a;a=s&&s.body&&s.body.id?s.body:0!==i.status&&i.status?{message:T.ab("channel_loader.unknown_error","We received an unexpected status code from the server.")+" ("+i.status+")"}:{message:T.ab("file_upload.generic_error","There was a problem uploading your files.")},Object(au.forceLogoutIfNecessary)(i,e,t);var c={type:za.FileTypes.UPLOAD_FILES_FAILURE,clientIds:[o],channelId:n,rootId:r,error:i};return e(Object(nu.batchActions)([c,Object(H.getLogErrorAction)(i)])),{error:a}}var l=s.body.file_infos.map(function(e,t){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){iu(e,t,n[t])})}return e}({},e,{clientId:s.body.client_ids[t]})});return e(Object(nu.batchActions)([{type:za.FileTypes.RECEIVED_UPLOAD_FILES,data:l,channelId:n,rootId:r},{type:za.FileTypes.UPLOAD_FILES_SUCCESS}])),{data:s.body}}}n(305);var lu=n(418),uu=n.n(lu),pu=(n(2029),n(1531)),fu=n(1528);function du(e){return(du="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){vu(e,t,n[t])})}return e}function hu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function bu(e){return(bu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function yu(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gu(e,t){return(gu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function vu(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Eu=Object(Y.g)({limited:{id:Object(Ne.b)("file_upload.limited"),defaultMessage:"Uploads limited to {count, number} files maximum. Please use additional posts for more files."},filesAbove:{id:Object(Ne.b)("file_upload.filesAbove"),defaultMessage:"Files above {max}MB could not be uploaded: {filenames}"},fileAbove:{id:Object(Ne.b)("file_upload.fileAbove"),defaultMessage:"File above {max}MB could not be uploaded: {filename}"},zeroBytesFiles:{id:Object(Ne.b)("file_upload.zeroBytesFiles"),defaultMessage:"You are uploading empty files: {filenames}"},zeroBytesFile:{id:Object(Ne.b)("file_upload.zeroBytesFile"),defaultMessage:"You are uploading an empty file: {filename}"},pasted:{id:Object(Ne.b)("file_upload.pasted"),defaultMessage:"Image Pasted at "},uploadFile:{id:Object(Ne.b)("file_upload.upload_files"),defaultMessage:"Upload files"}}),_u=500,Ou={left:"inherit",right:0,bottom:"100%",top:"auto"},wu=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=bu(t).call(this,e),n=!o||"object"!==du(o)&&"function"!=typeof o?yu(r):o,vu(yu(n),"fileUploadSuccess",function(e,t,r){if(e){n.props.onFileUpload(e.file_infos,e.client_ids,t,r);for(var o=Object.assign({},n.state.requests),a=0;a<e.client_ids.length;a++)Reflect.deleteProperty(o,e.client_ids[a]);n.setState({requests:o})}}),vu(yu(n),"fileUploadFail",function(e,t,r,o){n.props.onUploadError(e,t,r,o)}),vu(yu(n),"pluginUploadFiles",function(e){n.props.onUploadError(null),n.uploadFiles(e)}),vu(yu(n),"checkPluginHooksAndUploadFiles",function(e){n.props.onUploadError(null);var t=Array.from(e).sort(function(e,t){return e.name.localeCompare(t.name,n.props.locale,{numeric:!0})}),r=n.props.pluginFilesWillUploadHooks,o=!0,a=!1,i=void 0;try{for(var s,c=r[Symbol.iterator]();!(o=(s=c.next()).done);o=!0){var l=s.value.hook(t,n.pluginUploadFiles);l.message&&n.props.onUploadError(l.message),t=l.files}}catch(e){a=!0,i=e}finally{try{o||null==c.return||c.return()}finally{if(a)throw i}}t&&n.uploadFiles(t)}),vu(yu(n),"uploadFiles",function(e){for(var t=n.props,r=t.currentChannelId,o=t.rootId,a=P.Q.MAX_UPLOAD_FILES-n.props.fileCount,i=0,s=[],c=[],l=[],u=function(t){if(e[t].size>n.props.maxFileSize)return s.push(e[t]),"continue";0===e[t].size&&c.push(e[t]);var a=Object(T.r)(),u=n.props.actions.uploadFile(e[t],e[t].name,r,o,a);u.on("progress",function(r){n.props.onUploadProgress({clientId:a,name:e[t].name,percent:r.percent,type:e[t].type})}),u.end(function(i,s){var c=n.props.actions.handleFileUploadEnd(e[t],e[t].name,r,o,a,{err:i,res:s}),l=c.error,u=c.data;l?n.fileUploadFail(l,a,r,o):u&&n.fileUploadSuccess(u,r,o)}),n.setState({requests:mu({},n.state.requests,vu({},a,u))}),l.push(a),i+=1},p=0;p<e.length&&i<a;p++)u(p);n.props.onUploadStart(l,r);var f=n.context.intl.formatMessage,d=[];if(e.length>a&&d.push(f(Eu.limited,{count:P.Q.MAX_UPLOAD_FILES})),s.length>1){var m=s.map(function(e){return e.name}).join(", ");d.push(f(Eu.filesAbove,{max:n.props.maxFileSize/1048576,filenames:m}))}else s.length>0&&d.push(f(Eu.fileAbove,{max:n.props.maxFileSize/1048576,filename:s[0].name}));if(c.length>1){var h=c.map(function(e){return e.name}).join(", ");d.push(f(Eu.zeroBytesFiles,{filenames:h}))}else c.length>0&&d.push(f(Eu.zeroBytesFile,{filename:c[0].name}));d.length>0&&n.props.onUploadError(d.join(", "))}),vu(yu(n),"handleChange",function(e){e.target.files.length>0&&(n.checkPluginHooksAndUploadFiles(e.target.files),Object(T.d)(e.target)),n.props.onFileUploadChange()}),vu(yu(n),"handleDrop",function(e){if(n.props.canUploadFiles){n.props.onUploadError(null);var t=e.originalEvent.dataTransfer.items||[],r=e.originalEvent.dataTransfer.files,o=[];Array.from(r).forEach(function(e,n){var r=t[n];r&&r.webkitGetAsEntry&&r.webkitGetAsEntry().isDirectory||o.push(e)});var a=e.originalEvent.dataTransfer.types;if(a){if(a.includes&&!a.includes("Files"))return;if(a.contains&&!a.contains("Files"))return}0!==o.length?(o.length&&n.checkPluginHooksAndUploadFiles(o),n.props.onFileUploadChange()):n.props.onUploadError(Object(T.ab)("file_upload.drag_folder","Folders cannot be uploaded. Please drag all files separately."))}else n.props.onUploadError(Object(T.ab)("file_upload.disabled","File attachments are disabled."))}),vu(yu(n),"registerDragEvents",function(e,t){var r=yu(n),o=qc()(t),a=new Gc(function(){o.hasClass("hidden")||o.addClass("hidden")}),i={};i=n.props.canUploadFiles?{enter:function(e,n){var r=n.originalEvent.dataTransfer;Object(T.Q)(r)&&qc()(t).removeClass("hidden")},leave:function(e,t){var n=t.originalEvent.dataTransfer;Object(T.Q)(n)&&!o.hasClass("hidden")&&o.addClass("hidden"),a.cancel()},over:function(){a.fireAfter(_u)},drop:function(e,t){o.hasClass("hidden")||o.addClass("hidden"),a.cancel(),r.handleDrop(t)}}:{drop:function(e,t){r.handleDrop(t)}},qc()(e).dragster(i)}),vu(yu(n),"containsEventTarget",function(e,t){return e&&e.contains(t)}),vu(yu(n),"pasteUpload",function(e){var t=n.context.intl.formatMessage;if(e.clipboardData&&e.clipboardData.items&&!bl(e.clipboardData)){var r=n.props.getTarget(),o=uu.a.findDOMNode(r);if(n.containsEventTarget(o,e.target)){n.props.onUploadError(null);for(var a=[],i=0;i<e.clipboardData.items.length;i++){var s=e.clipboardData.items[i];"file"===s.kind&&a.push(s)}if(a&&a.length>0){if(!n.props.canUploadFiles)return void n.props.onUploadError(Object(T.ab)("file_upload.disabled","File attachments are disabled."));for(var c=[],l=0;l<a.length;l++){var u=a[l].getAsFile();if(u){var p=new Date,f=p.getHours();f=f<10?"0".concat(f):"".concat(f);var d=p.getMinutes();d=d<10?"0".concat(d):"".concat(d);var m="";u.name?u.name.includes(".")&&(m=u.name.substr(u.name.lastIndexOf("."))):a[l].type.includes("/")&&(m="."+a[l].type.split("/")[1].toLowerCase());var h=t(Eu.pasted)+p.getFullYear()+"-"+(p.getMonth()+1)+"-"+p.getDate()+" "+f+"-"+d+m,b=new Blob([u],{type:u.type});b.name=h,c.push(b)}}c.length>0&&(n.checkPluginHooksAndUploadFiles(c),n.props.onFileUploadChange())}}}}),vu(yu(n),"keyUpload",function(e){if(Object(T.e)(e)&&Object(T.S)(e,P.Q.KeyCodes.U)){if(e.preventDefault(),!n.props.canUploadFiles)return void n.props.onUploadError(Object(T.ab)("file_upload.disabled","File attachments are disabled."));var t="post"===n.props.postType&&"post_textbox"===document.activeElement.id,r="comment"===n.props.postType&&"reply_textbox"===document.activeElement.id;(t||r)&&(n.fileInput.current.focus(),n.fileInput.current.click())}}),vu(yu(n),"cancelUpload",function(e){var t=Object.assign({},n.state.requests),r=t[e];r&&(r.abort(),Reflect.deleteProperty(t,e),n.setState({requests:t}))}),vu(yu(n),"handleMaxUploadReached",function(e){e&&e.preventDefault(),(0,n.props.onUploadError)((0,n.context.intl.formatMessage)(Eu.limited,{count:P.Q.MAX_UPLOAD_FILES}))}),vu(yu(n),"toggleMenu",function(e){n.setState({menuOpen:e})}),vu(yu(n),"handleLocalFileUploaded",function(e){P.Q.MAX_UPLOAD_FILES-n.props.fileCount>0?n.props.onClick&&n.props.onClick():n.handleMaxUploadReached(e),n.setState({menuOpen:!1})}),vu(yu(n),"simulateInputClick",function(){n.fileInput.current.click()}),n.state={requests:{},menuOpen:!1},n.fileInput=_.a.createRef(),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gu(e,t)}(t,E["PureComponent"]),n=t,(r=[{key:"componentDidMount",value:function(){"post"===this.props.postType?this.registerDragEvents(".row.main",".center-file-overlay"):"comment"===this.props.postType&&this.registerDragEvents(".post-right__container",".right-file-overlay"),document.addEventListener("paste",this.pasteUpload),document.addEventListener("keydown",this.keyUpload)}},{key:"componentWillUnmount",value:function(){var e;e="post"===this.props.postType?qc()(".row.main"):qc()(".post-right__container"),document.removeEventListener("paste",this.pasteUpload),document.removeEventListener("keydown",this.keyUpload),e.off("dragenter dragleave dragover drop dragster:enter dragster:leave dragster:over dragster:drop")}},{key:"render",value:function(){var e=this,t=this.context.intl.formatMessage,n=!0;Object(j.n)()&&(n=!1);var r="";Object(j.h)()&&(r="image/*");var o,a=P.Q.MAX_UPLOAD_FILES-this.props.fileCount,i=t({id:"accessibility.button.attachment",defaultMessage:"attachment"});if(0===this.props.pluginFileUploadMethods.length)o=_.a.createElement("div",null,_.a.createElement("button",{type:"button",id:"fileUploadButton","aria-label":i,className:"style--none post-action icon icon--attachment",onClick:this.simulateInputClick},_.a.createElement(Pl,null)),_.a.createElement("input",{tabIndex:"-1","aria-label":t(Eu.uploadFile),ref:this.fileInput,type:"file",onChange:this.handleChange,onClick:this.handleLocalFileUploaded,multiple:n,accept:r}));else{var s=this.props.pluginFileUploadMethods.map(function(t){return _.a.createElement("li",{key:t.pluginId+"_fileuploadpluginmenuitem",onClick:function(){t.action&&t.action(e.checkPluginHooksAndUploadFiles),e.setState({menuOpen:!1})}},_.a.createElement("a",{href:"#"},_.a.createElement("span",{className:"margin-right"},t.icon),t.text))});o=_.a.createElement("div",null,_.a.createElement("input",{tabIndex:"-1","aria-label":t(Eu.uploadFile),ref:this.fileInput,type:"file",className:"file-attachment-menu-item-input",onChange:this.handleChange,onClick:this.handleLocalFileUploaded,multiple:n,accept:r}),_.a.createElement(pu.a,null,_.a.createElement("button",{type:"button","aria-label":i,className:"style--none post-action"},_.a.createElement("div",{id:"fileUploadButton",className:"icon icon--attachment"},_.a.createElement(Pl,null))),_.a.createElement(fu.a,{openLeft:!0,openUp:!0,ariaLabel:t({id:"file_upload.menuAriaLabel",defaultMessage:"Upload type selector"}),customStyles:Ou},_.a.createElement("li",null,_.a.createElement("a",{href:"#",onClick:this.simulateInputClick},_.a.createElement("span",{className:"margin-right"},_.a.createElement("i",{className:"fa fa-laptop"})),_.a.createElement(Y.c,{id:"yourcomputer",defaultMessage:"Your computer"}))),s)))}return this.props.canUploadFiles||(o=null),_.a.createElement("div",{className:a<=0?" style--none btn-file__disabled":"style--none"},o)}}])&&hu(n.prototype,r),o&&hu(n,o),t}();vu(wu,"propTypes",{currentChannelId:v.a.string.isRequired,rootId:v.a.string,fileCount:v.a.number.isRequired,getTarget:v.a.func.isRequired,locale:v.a.string.isRequired,onClick:v.a.func,onFileUpload:v.a.func,onFileUploadChange:v.a.func,onUploadError:v.a.func,onUploadStart:v.a.func,postType:v.a.string,maxFileSize:v.a.number,canUploadFiles:v.a.bool.isRequired,pluginFileUploadMethods:v.a.arrayOf(v.a.object),pluginFilesWillUploadHooks:v.a.arrayOf(v.a.object),onUploadProgress:v.a.func.isRequired,actions:v.a.shape({uploadFile:v.a.func.isRequired,handleFileUploadEnd:v.a.func.isRequired}).isRequired}),vu(wu,"contextTypes",{intl:Y.i}),vu(wu,"defaultProps",{pluginFileUploadMethods:[],pluginFilesWillUploadHooks:[]});var Cu=Object(r.connect)(function(e){var t=Object(u.getConfig)(e),n=parseInt(t.MaxFileSize,10);return{currentChannelId:Object(d.getCurrentChannelId)(e),maxFileSize:n,canUploadFiles:Object(jl.b)(t),locale:Object(Wc.a)(e),pluginFileUploadMethods:e.plugins.components.FileUploadMethod,pluginFilesWillUploadHooks:e.plugins.components.FilesWillUploadHook}},function(e){return{actions:Object(o.bindActionCreators)({uploadFile:su,handleFileUploadEnd:cu},e)}},null,{withRef:!0})(wu),Su=n(2030);function Pu(e){return(Pu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ju(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Tu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ku(e){return(ku=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Nu(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ru(e,t){return(Ru=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Mu(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Iu=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=ku(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==Pu(o)&&"function"!=typeof o?Nu(r):o,Mu(Nu(n),"getTypingText",function(){var e=[],t=0;if(n.props.typingUsers&&(t=(e=ju(n.props.typingUsers)).length),0===t)return"";if(1===t)return _.a.createElement(Y.c,{id:"msg_typing.isTyping",defaultMessage:"{user} is typing...",values:{user:e[0]}});var r=e.pop();return _.a.createElement(Y.c,{id:"msg_typing.areTyping",defaultMessage:"{users} and {last} are typing...",values:{users:e.join(", "),last:r}})}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ru(e,t)}(t,_.a.Component),n=t,(r=[{key:"render",value:function(){return _.a.createElement("span",{className:"msg-typing"},this.getTypingText())}}])&&Tu(n.prototype,r),o&&Tu(n,o),t}();Mu(Iu,"propTypes",{typingUsers:v.a.array.isRequired});var xu=Object(r.connect)(function(){var e=Object(Su.makeGetUsersTypingByChannelAndPost)();return function(t,n){return{typingUsers:e(t,{channelId:n.channelId,postId:n.postId})}}})(Iu);function Au(e){return(Au="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Lu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Du(e,t){return!t||"object"!==Au(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Uu(e){return(Uu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qu(e,t){return(qu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Hu=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Du(this,Uu(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qu(e,t)}(t,_.a.Component),n=t,(r=[{key:"shouldComponentUpdate",value:function(e){return e.show!==this.props.show}},{key:"render",value:function(){return _.a.createElement(z.a,{dialogClassName:"a11y__modal",show:this.props.show,onHide:this.props.onHide,role:"dialog","aria-labelledby":"postDeletedModalLabel"},_.a.createElement(z.a.Header,{closeButton:!0},_.a.createElement(z.a.Title,{componentClass:"h1",id:"postDeletedModalLabel"},_.a.createElement(Y.c,{id:"post_delete.notPosted",defaultMessage:"Comment could not be posted"}))),_.a.createElement(z.a.Body,null,_.a.createElement("p",null,_.a.createElement(Y.c,{id:"post_delete.someone",defaultMessage:"Someone deleted the message on which you tried to post a comment."}))),_.a.createElement(z.a.Footer,null,_.a.createElement("button",{type:"button",className:"btn btn-primary",autoFocus:!0,onClick:this.props.onHide},_.a.createElement(Y.c,{id:"post_delete.okay",defaultMessage:"Okay"}))))}}])&&Lu(n.prototype,r),o&&Lu(n,o),t}();!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Hu,"propTypes",{show:v.a.bool.isRequired,onHide:v.a.func.isRequired});var Fu=n(1490);function Bu(e){return(Bu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Gu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Vu(e){return(Vu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Wu(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ku(e,t){return(Ku=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function zu(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Yu=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=Vu(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==Bu(o)&&"function"!=typeof o?Wu(r):o,zu(Wu(n),"renderSlashCommandError",function(){if(!n.props.submittedMessage)return n.props.error.message;var e=n.props.submittedMessage.split(" ")[0];return _.a.createElement(_.a.Fragment,null,_.a.createElement(Y.c,{id:"message_submit_error.invalidCommand",defaultMessage:"Command with a trigger of '{command}' not found. ",values:{command:e}}),_.a.createElement("a",{href:"#",onClick:n.props.handleSubmit},_.a.createElement(Y.c,{id:"message_submit_error.sendAsMessageLink",defaultMessage:"Click here to send as a message."})))}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ku(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e=this.props.error;if(!e)return null;var t=e.message;return Object(Et.k)(e)&&(t=this.renderSlashCommandError()),_.a.createElement("div",{className:"has-error"},_.a.createElement("label",{className:"control-label"},t))}}])&&Gu(n.prototype,r),o&&Gu(n,o),t}();zu(Yu,"propTypes",{error:v.a.object.isRequired,handleSubmit:v.a.func.isRequired,submittedMessage:v.a.string});var Qu=Yu;function Zu(e){return(Zu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ju(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Xu(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function $u(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){Xu(a,r,o,i,s,"next",e)}function s(e){Xu(a,r,o,i,s,"throw",e)}i(void 0)})}}function ep(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){ap(e,t,n[t])})}return e}function tp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function np(e){return(np=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rp(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function op(e,t){return(op=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ap(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ip=P.Q.KeyCodes,sp=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=np(t).call(this,e),n=!o||"object"!==Zu(o)&&"function"!=typeof o?rp(r):o,ap(rp(n),"updatePreview",function(e){n.setState({showPreview:e})}),ap(rp(n),"focusTextboxIfNecessary",function(e){n.props.rhsExpanded&&(document.getElementsByClassName("channel-switch-modal").length||Object(Et.p)(e,document.activeElement)&&n.focusTextbox())}),ap(rp(n),"pasteHandler",function(e){if(e.clipboardData&&e.clipboardData.items&&"reply_textbox"===e.target.id){var t=bl(e.clipboardData);if(t){e.preventDefault();var r=n.state.draft,o=gl(t,r.message.trim()),a=ep({},r,{message:o});n.props.onUpdateCommentDraft(a),n.setState({draft:a})}}}),ap(rp(n),"handleNotifyAllConfirmation",function(e){n.hideNotifyAllModal(),n.doSubmit(e)}),ap(rp(n),"hideNotifyAllModal",function(){n.setState({showConfirmModal:!1})}),ap(rp(n),"showNotifyAllModal",function(){n.setState({showConfirmModal:!0})}),ap(rp(n),"toggleEmojiPicker",function(){n.setState({showEmojiPicker:!n.state.showEmojiPicker})}),ap(rp(n),"hideEmojiPicker",function(){n.setState({showEmojiPicker:!1})}),ap(rp(n),"handleEmojiClick",function(e){var t=e.name||e.aliases[0];if(t){var r=n.state.draft,o=ep({},r,{message:""===r.message?":".concat(t,": "):/\s+$/.test(r.message)?"".concat(r.message,":").concat(t,": "):"".concat(r.message," :").concat(t,": ")});n.props.onUpdateCommentDraft(o),n.draftsForPost[n.props.rootId]=o,n.setState({showEmojiPicker:!1,draft:o}),n.focusTextbox()}}),ap(rp(n),"handleGifClick",function(e){var t=n.state.draft,r=ep({},t,{message:""===t.message?e:/\s+$/.test(t.message)?"".concat(t.message).concat(e," "):"".concat(t.message," ").concat(e," ")});n.props.onUpdateCommentDraft(r),n.draftsForPost[n.props.rootId]=r,n.setState({showEmojiPicker:!1,draft:r}),n.focusTextbox()}),ap(rp(n),"handlePostError",function(e){n.setState({postError:e})}),ap(rp(n),"handleSubmit",function(){var e=$u(regeneratorRuntime.mark(function e(t){var r,o,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),r=n.props.channelMembersCount,!(n.props.enableConfirmNotificationsToChannel&&r>P.Q.NOTIFY_ALL_MEMBERS&&Object(Et.c)(n.state.draft.message))){e.next=12;break}if(!n.props.isTimezoneEnabled){e.next=10;break}return e.next=7,n.props.getChannelTimezones(n.props.channelId);case 7:o=e.sent,(a=o.data)?n.setState({channelTimezoneCount:a.length}):n.setState({channelTimezoneCount:0});case 10:return n.showNotifyAllModal(),e.abrupt("return");case 12:return e.next=14,n.doSubmit(t);case 14:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),ap(rp(n),"doSubmit",function(){var e=$u(regeneratorRuntime.mark(function e(t){var r,o,a,i,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.preventDefault(),r=n.state.draft,n.shouldEnableAddButton()){e.next=5;break}return e.abrupt("return");case 5:if(!(r.uploadsInProgress.length>0)){e.next=7;break}return e.abrupt("return");case 7:if(!n.state.postError){e.next=11;break}return n.setState({errorClass:"animation--highlight"}),setTimeout(function(){n.setState({errorClass:null})},P.Q.ANIMATION_TIMEOUT),e.abrupt("return");case 11:if(!n.props.rootDeleted){e.next=14;break}return n.showPostDeletedModal(),e.abrupt("return");case 14:return 150,o=Date.now()-n.lastBlurAt<150,n.focusTextbox(o),a=n.state.serverError,i=!1,Object(Et.k)(a)&&r.message===a.submittedMessage&&(i=!0),s={ignoreSlash:i},e.prev=21,e.next=24,n.props.onSubmit(s);case 24:n.setState({postError:null,serverError:null}),e.next=33;break;case 27:return e.prev=27,e.t0=e.catch(21),Object(Et.k)(e.t0)&&n.props.onUpdateCommentDraft(r),e.t0.submittedMessage=r.message,n.setState({serverError:e.t0}),e.abrupt("return");case 33:n.setState({draft:ep({},n.props.draft,{uploadsInProgress:[]})});case 34:case"end":return e.stop()}},e,null,[[21,27]])}));return function(t){return e.apply(this,arguments)}}()),ap(rp(n),"commentMsgKeyPress",function(e){var t=n.props,r=t.ctrlSend,o=t.codeBlockOnCtrlEnter,a=Object(Et.o)(e,n.state.draft.message,r,o),i=a.allowSending,s=a.withClosedCodeBlock,c=a.message;if(i){if(e.persist(),n.refs.textbox&&n.refs.textbox.getWrappedInstance().blur(),s&&c){var l=ep({},n.state.draft,{message:c});n.props.onUpdateCommentDraft(l),n.setState({draft:l},function(){return n.handleSubmit(e)}),n.draftsForPost[n.props.rootId]=l}else n.handleSubmit(e);n.updatePreview(!1),setTimeout(function(){n.focusTextbox()})}n.emitTypingEvent()}),ap(rp(n),"emitTypingEvent",function(){var e=n.props,t=e.channelId,r=e.rootId;S.d(t,r)}),ap(rp(n),"scrollToBottom",function(){var e=qc()(".post-right__scroll");e[0]&&e.parent().scrollTop(e[0].scrollHeight)}),ap(rp(n),"handleChange",function(e){var t=e.target.value,r=n.state.serverError;Object(Et.k)(r)&&(r=null);var o=ep({},n.state.draft,{message:t});n.props.onUpdateCommentDraft(o),n.setState({draft:o,serverError:r},function(){n.scrollToBottom()}),n.draftsForPost[n.props.rootId]=o}),ap(rp(n),"handleKeyDown",function(e){if((n.props.ctrlSend||n.props.codeBlockOnCtrlEnter)&&T.S(e,P.Q.KeyCodes.ENTER)&&(e.ctrlKey||e.metaKey))return n.updatePreview(!1),void n.commentMsgKeyPress(e);var t=n.state.draft.message;e.ctrlKey||e.metaKey||e.altKey||e.shiftKey||!T.S(e,P.Q.KeyCodes.UP)||""!==t||(e.preventDefault(),n.refs.textbox&&n.refs.textbox.getWrappedInstance().blur(),n.props.onEditLatestPost().data||n.focusTextbox(!0));!e.ctrlKey&&!e.metaKey||e.altKey||e.shiftKey||(T.S(e,P.Q.KeyCodes.UP)?(e.preventDefault(),n.props.onMoveHistoryIndexBack()):T.S(e,P.Q.KeyCodes.DOWN)&&(e.preventDefault(),n.props.onMoveHistoryIndexForward()))}),ap(rp(n),"handleKeyDownEmojiPicker",function(e){T.S(e,ip.ENTER)&&n.toggleEmojiPicker()}),ap(rp(n),"handleFileUploadChange",function(){n.focusTextbox()}),ap(rp(n),"handleUploadStart",function(e){var t=n.state.draft,r=ep({},t,{uploadsInProgress:[].concat(Ju(t.uploadsInProgress),Ju(e))});n.props.onUpdateCommentDraft(r),n.setState({draft:r}),n.draftsForPost[n.props.rootId]=r,n.focusTextbox()}),ap(rp(n),"handleUploadProgress",function(e){var t=e.clientId,r=e.name,o=e.percent,a=e.type,i=ep({},n.state.uploadsProgressPercent,ap({},t,{percent:o,name:r,type:a}));n.setState({uploadsProgressPercent:i})}),ap(rp(n),"handleFileUploadComplete",function(e,t,r,o){for(var a=n.draftsForPost[o],i=Ju(a.uploadsInProgress),s=Object(hl.sortFileInfos)([].concat(Ju(a.fileInfos),Ju(e)),n.props.locale),c=0;c<t.length;c++){var l=i.indexOf(t[c]);-1!==l&&i.splice(l,1)}var u=ep({},a,{fileInfos:s,uploadsInProgress:i});n.props.updateCommentDraftWithRootId(o,u),n.draftsForPost[o]=u,n.props.rootId===o&&n.setState({draft:u}),void 0!==n.refs.preview&&n.refs.preview&&n.refs.preview.refs.container.scrollIntoView()}),ap(rp(n),"handleUploadError",function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(-1!==t){var o=ep({},n.draftsForPost[r]),a=Ju(o.uploadsInProgress),i=a.indexOf(t);-1!==i&&a.splice(i,1);var s=ep({},o,{uploadsInProgress:a});n.props.updateCommentDraftWithRootId(r,s),n.draftsForPost[r]=s,n.props.rootId===r&&n.setState({draft:s})}var c=e;e&&"string"==typeof e&&(c=new Error(e)),n.setState({serverError:c})}),ap(rp(n),"removePreview",function(e){var t=n.state.draft,r=Ju(t.fileInfos),o=Ju(t.uploadsInProgress);n.handleUploadError(null);var a=r.findIndex(function(t){return t.id===e});-1===a?-1!==(a=o.indexOf(e))&&(o.splice(a,1),n.refs.fileUpload&&n.refs.fileUpload.getWrappedInstance()&&n.refs.fileUpload.getWrappedInstance().cancelUpload(e)):r.splice(a,1);var i=ep({},t,{fileInfos:r,uploadsInProgress:o});n.props.onUpdateCommentDraft(i),n.setState({draft:i}),n.draftsForPost[n.props.rootId]=i,n.handleFileUploadChange()}),ap(rp(n),"getFileCount",function(){var e=n.state.draft,t=e.fileInfos,r=e.uploadsInProgress;return t.length+r.length}),ap(rp(n),"getFileUploadTarget",function(){return n.refs.textbox.getWrappedInstance()}),ap(rp(n),"getCreateCommentControls",function(){return n.refs.createCommentControls}),ap(rp(n),"shouldEnableAddButton",function(){return!!n.props.enableAddButton||Object(Et.k)(n.state.serverError)}),ap(rp(n),"focusTextbox",function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];!n.refs.textbox||!e&&j.m()||n.refs.textbox.getWrappedInstance().focus()}),ap(rp(n),"showPostDeletedModal",function(){n.setState({showPostDeletedModal:!0})}),ap(rp(n),"hidePostDeletedModal",function(){n.setState({showPostDeletedModal:!1}),n.props.resetCreatePostRequest()}),ap(rp(n),"handleBlur",function(){n.lastBlurAt=Date.now()}),ap(rp(n),"handleHeightChange",function(e,t){n.setState({renderScrollbar:e>t})}),n.state={showPostDeletedModal:!1,showConfirmModal:!1,showEmojiPicker:!1,showPreview:!1,draft:{message:"",uploadsInProgress:[],fileInfos:[]},channelTimezoneCount:0,uploadsProgressPercent:{},renderScrollbar:!1},n.lastBlurAt=0,n.draftsForPost={},n.doInitialScrollToBottom=!1,n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&op(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"UNSAFE_componentWillMount",value:function(){this.props.clearCommentDraftUploads(),this.props.onResetHistoryIndex(),this.setState({draft:ep({},this.props.draft,{uploadsInProgress:[]})})}},{key:"componentDidMount",value:function(){this.focusTextbox(),document.addEventListener("paste",this.pasteHandler),document.addEventListener("keydown",this.focusTextboxIfNecessary),""!==this.props.draft.message&&(this.doInitialScrollToBottom=!0)}},{key:"componentWillUnmount",value:function(){this.props.resetCreatePostRequest(),document.removeEventListener("paste",this.pasteHandler),document.removeEventListener("keydown",this.focusTextboxIfNecessary)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){"api.post.create_post.root_id.app_error"===e.createPostErrorId&&e.createPostErrorId!==this.props.createPostErrorId&&this.showPostDeletedModal(),e.rootId!==this.props.rootId&&this.setState({draft:ep({},e.draft,{uploadsInProgress:[]})}),this.props.messageInHistory!==e.messageInHistory&&this.setState({draft:e.draft})}},{key:"componentDidUpdate",value:function(e,t){t.draft.uploadsInProgress.length<this.state.draft.uploadsInProgress.length&&this.scrollToBottom(),e.rootId===this.props.rootId&&e.selectedPostFocussedAt===this.props.selectedPostFocussedAt||this.focusTextbox(),this.doInitialScrollToBottom&&(this.scrollToBottom(),this.doInitialScrollToBottom=!1)}},{key:"render",value:function(){var e=this.state.draft,t=this.props.readOnlyChannel,n=this.context.intl.formatMessage,r=this.shouldEnableAddButton(),o=this.state.renderScrollbar,a=T.ab("accessibility.sections.rhsFooter","reply input region"),i=_.a.createElement(Y.c,{id:"notify_all.title.confirm",defaultMessage:"Confirm sending notifications to entire channel"}),s=_.a.createElement(Y.c,{id:"notify_all.confirm",defaultMessage:"Confirm"}),c="";c=this.state.channelTimezoneCount&&this.props.isTimezoneEnabled?_.a.createElement(Fu.b,{id:"notify_all.question_timezone",defaultMessage:"By using @all or @channel you are about to send notifications to **{totalMembers} people** in **{timezones, number} {timezones, plural, one {timezone} other {timezones}}**. Are you sure you want to do this?",values:{totalMembers:this.props.channelMembersCount-1,timezones:this.state.channelTimezoneCount}}):_.a.createElement(Y.c,{id:"notify_all.question",defaultMessage:"By using @all or @channel you are about to send notifications to {totalMembers} people. Are you sure you want to do this?",values:{totalMembers:this.props.channelMembersCount-1}});var l=null;this.state.serverError&&(l=_.a.createElement(Qu,{id:"postServerError",error:this.state.serverError,submittedMessage:this.state.serverError.submittedMessage,handleSubmit:this.handleSubmit}));var u=null;if(this.state.postError){var p="post-error"+(this.state.errorClass?" "+this.state.errorClass:"");u=_.a.createElement("label",{className:p},this.state.postError)}var f=null;!t&&(e.fileInfos.length>0||e.uploadsInProgress.length>0)&&(f=_.a.createElement(tu,{fileInfos:e.fileInfos,onRemove:this.removePreview,uploadsInProgress:e.uploadsInProgress,uploadsProgressPercent:this.state.uploadsProgressPercent,ref:"preview"}));var d=null;e.uploadsInProgress.length>0&&(d=_.a.createElement("span",{className:"pull-right post-right-comments-upload-in-progress"},1===e.uploadsInProgress.length?_.a.createElement(Y.c,{id:"create_comment.file",defaultMessage:"File uploading"}):_.a.createElement(Y.c,{id:"create_comment.files",defaultMessage:"Files uploading"})));var m,h="btn btn-primary comment-btn pull-right";r||(h+=" disabled"),t||this.state.showPreview||(m=_.a.createElement(Cu,{ref:"fileUpload",fileCount:this.getFileCount(),getTarget:this.getFileUploadTarget,onFileUploadChange:this.handleFileUploadChange,onUploadStart:this.handleUploadStart,onFileUpload:this.handleFileUploadComplete,onUploadError:this.handleUploadError,onUploadProgress:this.handleUploadProgress,rootId:this.props.rootId,postType:"comment"}));var b,y=null,g=n({id:"emoji_picker.emojiPicker",defaultMessage:"Emoji Picker"}).toLowerCase();!this.props.enableEmojiPicker||t||this.state.showPreview||(y=_.a.createElement("div",null,_.a.createElement(Eo,{show:this.state.showEmojiPicker,target:this.getCreateCommentControls,onHide:this.hideEmojiPicker,onEmojiClose:this.hideEmojiPicker,onEmojiClick:this.handleEmojiClick,onGifClick:this.handleGifClick,enableGifPicker:this.props.enableGifPicker,topOffset:55}),_.a.createElement("button",{"aria-label":g,type:"button",onClick:this.toggleEmojiPicker,className:"style--none emoji-picker__container post-action"},_.a.createElement(Vn,{className:"icon icon--emoji emoji-rhs "+(this.state.showEmojiPicker?"active":"")})))),b=t?T.ab("create_post.read_only","This channel is read-only. Only members with permission can post here."):T.ab("create_comment.addComment","Add a comment...");var v="";return o&&(v=" scroll"),_.a.createElement("form",{onSubmit:this.handleSubmit},_.a.createElement("div",{role:"application",id:"rhsFooter","aria-label":a,tabIndex:"-1",className:"post-create a11y__region".concat(v),"data-a11y-sort-order":"4"},_.a.createElement("div",{id:this.props.rootId,className:"post-create-body comment-create-body"},_.a.createElement("div",{className:"post-body__cell"},_.a.createElement(Hi,{onChange:this.handleChange,onKeyPress:this.commentMsgKeyPress,onKeyDown:this.handleKeyDown,onComposition:this.emitTypingEvent,onHeightChange:this.handleHeightChange,handlePostError:this.handlePostError,value:t?"":e.message,onBlur:this.handleBlur,createMessage:b,emojiEnabled:this.props.enableEmojiPicker,initialText:"",channelId:this.props.channelId,isRHS:!0,popoverMentionKeyClick:!0,id:"reply_textbox",ref:"textbox",disabled:t,characterLimit:this.props.maxPostSize,preview:this.state.showPreview,badConnection:this.props.badConnection,listenForMentionKeyClick:!0}),_.a.createElement("span",{ref:"createCommentControls",className:"post-body__actions"},m,y))),_.a.createElement("div",{className:"post-create-footer"},_.a.createElement("div",{className:"d-flex justify-content-between"},_.a.createElement(xu,{channelId:this.props.channelId,postId:this.props.rootId}),_.a.createElement(Qi,{characterLimit:this.props.maxPostSize,showPreview:this.state.showPreview,updatePreview:this.updatePreview,message:t?"":this.state.message})),_.a.createElement("div",null,_.a.createElement("input",{type:"button",className:h,value:n({id:"create_comment.comment",defaultMessage:"Add Comment"}),onClick:this.handleSubmit}),d,u,f,l))),_.a.createElement(Hu,{show:this.state.showPostDeletedModal,onHide:this.hidePostDeletedModal}),_.a.createElement(Xs.a,{title:i,message:c,confirmButtonText:s,show:this.state.showConfirmModal,onConfirm:this.handleNotifyAllConfirmation,onCancel:this.hideNotifyAllModal}))}}])&&tp(n.prototype,r),o&&tp(n,o),t}();ap(sp,"propTypes",{channelId:v.a.string.isRequired,channelMembersCount:v.a.number.isRequired,rootId:v.a.string.isRequired,rootDeleted:v.a.bool.isRequired,messageInHistory:v.a.string,draft:v.a.shape({message:v.a.string.isRequired,uploadsInProgress:v.a.array.isRequired,fileInfos:v.a.array.isRequired}).isRequired,enableAddButton:v.a.bool.isRequired,codeBlockOnCtrlEnter:v.a.bool,ctrlSend:v.a.bool,latestPostId:v.a.string,locale:v.a.string.isRequired,getSidebarBody:v.a.func,createPostErrorId:v.a.string,clearCommentDraftUploads:v.a.func.isRequired,onUpdateCommentDraft:v.a.func.isRequired,updateCommentDraftWithRootId:v.a.func.isRequired,onSubmit:v.a.func.isRequired,onResetHistoryIndex:v.a.func.isRequired,onMoveHistoryIndexBack:v.a.func.isRequired,onMoveHistoryIndexForward:v.a.func.isRequired,onEditLatestPost:v.a.func.isRequired,getChannelTimezones:v.a.func.isRequired,resetCreatePostRequest:v.a.func.isRequired,readOnlyChannel:v.a.bool,enableConfirmNotificationsToChannel:v.a.bool.isRequired,enableEmojiPicker:v.a.bool.isRequired,enableGifPicker:v.a.bool.isRequired,badConnection:v.a.bool.isRequired,maxPostSize:v.a.number.isRequired,rhsExpanded:v.a.bool.isRequired,isTimezoneEnabled:v.a.bool.isRequired,selectedPostFocussedAt:v.a.number.isRequired}),ap(sp,"contextTypes",{intl:Y.i.isRequired});var cp=Object(r.connect)(function(){var e=Object(ea.makeGetMessageInHistoryItem)(L.Posts.MESSAGE_TYPES.COMMENT);return function(t,n){var r=t.requests.posts.createPost.error||{},o=Object(Nc.i)(t,P.G.COMMENT_DRAFT,n.rootId),a=0!==o.message.trim().length||0!==o.fileInfos.length,i=Object(d.getAllChannelStats)(t)[n.channelId]?Object(d.getAllChannelStats)(t)[n.channelId].member_count:1,s=e(t),c=t.entities.channels.channels[n.channelId]||{},f=Object(u.getConfig)(t),m="true"===f.EnableConfirmNotificationsToChannel,h="true"===f.EnableEmojiPicker,b="true"===f.EnableGifPicker,y=Vc(t)>1,g="true"===f.ExperimentalTimezone;return{draft:o,messageInHistory:s,enableAddButton:a,channelMembersCount:i,codeBlockOnCtrlEnter:Object(l.getBool)(t,L.Preferences.CATEGORY_ADVANCED_SETTINGS,"code_block_ctrl_enter",!0),ctrlSend:Object(l.getBool)(t,L.Preferences.CATEGORY_ADVANCED_SETTINGS,"send_on_ctrl_enter"),createPostErrorId:r.server_error_id,readOnlyChannel:!Object(p.isCurrentUserSystemAdmin)(t)&&"true"===f.ExperimentalTownSquareIsReadOnly&&c.name===P.i.DEFAULT_CHANNEL,enableConfirmNotificationsToChannel:m,enableEmojiPicker:h,enableGifPicker:b,locale:Object(Wc.a)(t),maxPostSize:parseInt(f.MaxPostSize,10)||P.i.DEFAULT_CHARACTER_LIMIT,rhsExpanded:Object(Nc.a)(t),badConnection:y,isTimezoneEnabled:g,selectedPostFocussedAt:Object(Nc.r)(t)}}},function(){var e,t,n,r,a,i,c,l;function u(){return Object(A.resetHistoryIndex)(L.Posts.MESSAGE_TYPES.COMMENT)}return function(p,f){return i!==f.rootId&&(e=function(e){return function(t){return ll(e,t)}}(f.rootId),n=ul(f.rootId,-1),r=ul(f.rootId,1)),i===f.rootId&&c===f.channelId||(a=ml(f.channelId,f.rootId)),i===f.rootId&&c===f.channelId&&l===f.latestPostId||(t=function(e,t,n){return function(){var r,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r=al(regeneratorRuntime.mark(function r(a,i){var s,c,l,u,p;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(s=Object(Nc.i)(i(),P.G.COMMENT_DRAFT,t),c=s.message,a(Object(A.addMessageIntoHistory)(c)),a(ll(t,null)),l=T.a.exec(c),u=Object(zc.getCustomEmojisByName)(i()),p=new rl.a(u),!l||!p.has(l[2])){r.next=11;break}a(fl(n,l[1],l[2])),r.next=17;break;case 11:if(0!==c.indexOf("/")||o.ignoreSlash){r.next=16;break}return r.next=14,a(dl(e,t,s));case 14:r.next=17;break;case 16:a(pl(e,t,s));case 17:case"end":return r.stop()}},r)})),function(e,t){return r.apply(this,arguments)}}}(f.channelId,f.rootId,f.latestPostId)),i=f.rootId,c=f.channelId,l=f.latestPostId,Object(o.bindActionCreators)({clearCommentDraftUploads:cl,onUpdateCommentDraft:e,updateCommentDraftWithRootId:ll,onSubmit:t,onResetHistoryIndex:u,onMoveHistoryIndexBack:n,onMoveHistoryIndexForward:r,onEditLatestPost:a,resetCreatePostRequest:A.resetCreatePostRequest,getChannelTimezones:s.getChannelTimezones},p)}})(sp),lp=n(312),up=n(310),pp=n(242);function fp(e){return(fp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function mp(e,t){return!t||"object"!==fp(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function hp(e){return(hp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function bp(e,t){return(bp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var yp=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),mp(this,hp(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bp(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.date,n=e.enableTimezone,r=e.timeZone,o=n&&r?{timeZone:r}:{};return _.a.createElement("div",{className:"date-separator"},_.a.createElement("hr",{className:"separator__hr"}),_.a.createElement("div",{className:"separator__text"},_.a.createElement(Y.a,Object.assign({},o,{value:t,weekday:"short",month:"short",day:"2-digit",year:"numeric"}))))}}])&&dp(n.prototype,r),o&&dp(n,o),t}();!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(yp,"propTypes",{date:v.a.oneOfType([v.a.number,v.a.instanceOf(Date)]).isRequired,timeZone:v.a.string,enableTimezone:v.a.bool});var gp=Object(r.connect)(function(e,t){var n,r=Object(p.getCurrentUserId)(e);return n=t.userTimezone?t.userTimezone:Object(lp.getUserTimezone)(e,r),{enableTimezone:Object(pp.a)(e),timeZone:Object(up.getUserCurrentTimezone)(n)}})(yp),vp=n(69);function Ep(e){return(Ep="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Op(e,t){return!t||"object"!==Ep(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function wp(e){return(wp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Cp(e,t){return(Cp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Sp=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Op(this,wp(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Cp(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){if(!this.props.isMobile)return _.a.createElement("noscript",null);if(0===this.props.createAt)return _.a.createElement("noscript",null);var e=_.a.createElement(Y.a,{value:this.props.createAt,weekday:"short",day:"2-digit",month:"short",year:"numeric"}),t="post-list__timestamp";return this.props.isScrolling&&(t+=" scrolling"),this.props.isRhsPost&&(t+=" rhs"),_.a.createElement("div",{className:t},_.a.createElement("div",null,_.a.createElement("span",null,e)))}}])&&_p(n.prototype,r),o&&_p(n,o),t}();!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Sp,"propTypes",{isScrolling:v.a.bool.isRequired,isMobile:v.a.bool,createAt:v.a.oneOfType([v.a.instanceOf(Date),v.a.number]).isRequired,isRhsPost:v.a.bool});var Pp=Object(r.connect)(function(e,t){var n=t.postId;if(vp.isCombinedUserActivityPost(n)){var r=vp.getPostIdsForCombinedUserActivityPost(n);n=r[r.length-1]}var o=Object(ea.getPost)(e,n);return{createAt:o?o.create_at:0}})(Sp),jp=n(4),Tp=n.n(jp);function kp(e){return(kp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Np(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Rp(e,t){return!t||"object"!==kp(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Mp(e){return(Mp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ip(e,t){return(Ip=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function xp(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ap=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Rp(this,Mp(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ip(e,t)}(t,_.a.Component),n=t,(r=[{key:"render",value:function(){return this.props.hasPermission&&!this.props.invert?this.props.children:!this.props.hasPermission&&this.props.invert?this.props.children:null}}])&&Np(n.prototype,r),o&&Np(n,o),t}();xp(Ap,"defaultProps",{invert:!1}),xp(Ap,"propTypes",{channelId:v.a.string,teamId:v.a.string,permissions:v.a.arrayOf(v.a.string).isRequired,hasPermission:v.a.bool.isRequired,invert:v.a.bool.isRequired,children:v.a.node.isRequired});var Lp=Object(r.connect)(function(e,t){if(!t.channelId||null===t.teamId||void 0===t.teamId)return{hasPermission:!1};var n=!0,r=!1,o=void 0;try{for(var a,i=t.permissions[Symbol.iterator]();!(n=(a=i.next()).done);n=!0){var s=a.value;if(Object(D.haveIChannelPermission)(e,{channel:t.channelId,team:t.teamId,permission:s}))return{hasPermission:!0}}}catch(e){r=!0,o=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw o}}return{hasPermission:!1}})(Ap),Dp=n(1516);function Up(e){return(Up="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Hp(e){return(Hp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Fp(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Bp(e,t){return(Bp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Gp(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Vp=80,Wp=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=Hp(t).call(this,e),n=!o||"object"!==Up(o)&&"function"!=typeof o?Fp(r):o,Gp(Fp(n),"handleEditDisable",function(){n.setState({canEdit:!1})}),Gp(Fp(n),"handleFlagMenuItemActivated",function(){n.props.isFlagged?n.props.actions.unflagPost(n.props.post.id):n.props.actions.flagPost(n.props.post.id)}),Gp(Fp(n),"handleAddReactionMenuItemActivated",function(e){e.preventDefault(),n.props.handleAddReactionClick&&n.props.handleAddReactionClick()}),Gp(Fp(n),"handlePermalinkMenuItemActivated",function(e){e.preventDefault(),Object(S.j)(n.props.post)}),Gp(Fp(n),"handlePinMenuItemActivated",function(){n.props.post.is_pinned?n.props.actions.unpinPost(n.props.post.id):n.props.actions.pinPost(n.props.post.id)}),Gp(Fp(n),"handleDeleteMenuItemActivated",function(e){e.preventDefault();var t={ModalId:P.r.DELETE_POST,dialogType:ae,dialogProps:{post:n.props.post,commentCount:n.props.commentCount,isRHS:n.props.location===P.q.RHS_ROOT||n.props.location===P.q.RHS_COMMENT}};n.props.actions.openModal(t)}),Gp(Fp(n),"handleEditMenuItemActivated",function(){n.props.actions.setEditingPost(n.props.post.id,n.props.commentCount,n.props.location===P.q.CENTER?"post_textbox":"reply_textbox",n.props.post.root_id?T.ab("rhs_comment.comment","Comment"):T.ab("create_post.post","Post"),n.props.location===P.q.RHS_ROOT||n.props.location===P.q.RHS_COMMENT)}),Gp(Fp(n),"tooltip",_.a.createElement(El.a,{id:"dotmenu-icon-tooltip",className:"hidden-xs"},_.a.createElement(Y.c,{id:"post_info.dot_menu.tooltip.more_actions",defaultMessage:"More Actions"}))),Gp(Fp(n),"refCallback",function(e){if(e){var t=e.rect();(t.y||t.top)+t.height>window.innerHeight-Vp&&n.setState({openUp:!0})}}),n.editDisableAction=new Gc(n.handleEditDisable),n.state={openUp:!1},n.buttonRef=_.a.createRef(),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Bp(e,t)}(t,E["Component"]),n=t,o=[{key:"getDerivedStateFromProps",value:function(e){return{canDelete:Et.a(e.post)&&!e.isReadOnly,canEdit:Et.b(e.post)&&!e.isReadOnly}}}],(r=[{key:"disableCanEditPostByTime",value:function(){var e=this.props,t=e.post,n=e.isLicensed,r=e.postEditTimeLimit;if(Et.b(t)&&n&&String(r)!==String(P.UNSET_POST_EDIT_TIME_LIMIT)){var o=t.create_at+1e3*r-T.D();o>0&&this.editDisableAction.fireAfter(o+1e3)}}},{key:"componentDidMount",value:function(){this.disableCanEditPostByTime()}},{key:"componentWillUnmount",value:function(){this.editDisableAction.cancel()}},{key:"render",value:function(){var e=this,t=Et.m(this.props.post),n=T.U(),r=this.props.pluginMenuItems.filter(function(t){return t.filter?t.filter(e.props.post.id):t}).map(function(t){return _.a.createElement(Dp.a,{key:t.id+"_pluginmenuitem",text:t.text,onClick:function(){t.action&&t.action(e.props.post.id)}})});return this.state.canDelete||this.state.canEdit||0!==r.length||!t?_.a.createElement(pu.a,{onToggle:this.props.handleDropdownOpened},_.a.createElement(vl.a,{className:"hidden-xs",delayShow:500,placement:"top",overlay:this.tooltip,rootClose:!0},_.a.createElement("button",{id:"".concat(this.props.location,"_button_").concat(this.props.post.id),"aria-label":T.ab("post_info.dot_menu.tooltip.more_actions","More Actions").toLowerCase(),className:"post__dropdown color--link style--none",type:"button","aria-expanded":"false"})),_.a.createElement(fu.a,{id:"".concat(this.props.location,"_dropdown_").concat(this.props.post.id),openLeft:!0,openUp:this.state.openUp,ref:this.refCallback,ariaLabel:T.ab("post_info.menuAriaLabel","Post extra options")},_.a.createElement(Lp,{channelId:this.props.post.channel_id,teamId:this.props.teamId,permissions:[Tp.a.ADD_REACTION]},_.a.createElement(Dp.a,{show:n&&!t&&!this.props.isReadOnly&&this.props.enableEmojiPicker,text:T.ab("rhs_root.mobile.add_reaction","Add Reaction"),onClick:this.handleAddReactionMenuItemActivated})),_.a.createElement(Dp.a,{show:n&&!t&&this.props.isFlagged,text:T.ab("rhs_root.mobile.unflag","Unflag"),onClick:this.handleFlagMenuItemActivated}),_.a.createElement(Dp.a,{show:n&&!t&&!this.props.isFlagged,text:T.ab("rhs_root.mobile.flag","Flag"),onClick:this.handleFlagMenuItemActivated}),_.a.createElement(Dp.a,{show:!t&&this.props.location===P.q.CENTER,text:T.ab("post_info.reply","Reply"),onClick:this.props.handleCommentClick}),_.a.createElement(Dp.a,{show:!t,text:T.ab("post_info.permalink","Permalink"),onClick:this.handlePermalinkMenuItemActivated}),_.a.createElement(Dp.a,{id:"unpin_post_".concat(this.props.post.id),show:!t&&!this.props.isReadOnly&&this.props.post.is_pinned,text:T.ab("post_info.unpin","Unpin"),onClick:this.handlePinMenuItemActivated}),_.a.createElement(Dp.a,{id:"pin_post_".concat(this.props.post.id),show:!t&&!this.props.isReadOnly&&!this.props.post.is_pinned,text:T.ab("post_info.pin","Pin"),onClick:this.handlePinMenuItemActivated}),_.a.createElement(Dp.a,{id:"delete_post_".concat(this.props.post.id),show:this.state.canDelete,text:T.ab("post_info.del","Delete"),onClick:this.handleDeleteMenuItemActivated}),_.a.createElement(Dp.a,{id:"edit_post_".concat(this.props.post.id),show:this.state.canEdit,text:T.ab("post_info.edit","Edit"),onClick:this.handleEditMenuItemActivated}),r,_.a.createElement(I.a,{postId:this.props.post.id,pluggableName:"PostDropdownMenuItem"}))):null}}])&&qp(n.prototype,r),o&&qp(n,o),t}();Gp(Wp,"propTypes",{post:v.a.object.isRequired,teamId:v.a.string,location:v.a.oneOf([P.q.CENTER,P.q.RHS_ROOT,P.q.RHS_COMMENT,P.q.SEARCH]).isRequired,commentCount:v.a.number,isFlagged:v.a.bool,handleCommentClick:v.a.func,handleDropdownOpened:v.a.func,handleAddReactionClick:v.a.func,isReadOnly:v.a.bool,pluginMenuItems:v.a.arrayOf(v.a.object),isLicensed:v.a.bool.isRequired,postEditTimeLimit:v.a.string.isRequired,enableEmojiPicker:v.a.bool.isRequired,actions:v.a.shape({flagPost:v.a.func.isRequired,unflagPost:v.a.func.isRequired,setEditingPost:v.a.func.isRequired,pinPost:v.a.func.isRequired,unpinPost:v.a.func.isRequired,openModal:v.a.func.isRequired}).isRequired}),Gp(Wp,"defaultProps",{post:{},commentCount:0,isFlagged:!1,isReadOnly:!1,pluginMenuItems:[],location:P.q.CENTER,enableEmojiPicker:!1});var Kp=Object(r.connect)(function(e){return{postEditTimeLimit:Object(u.getConfig)(e).PostEditTimeLimit,isLicensed:"true"===Object(u.getLicense)(e).IsLicensed,teamId:Object(f.getCurrentTeamId)(e),pluginMenuItems:e.plugins.components.PostDropdownMenu}},function(e){return{actions:Object(o.bindActionCreators)({flagPost:q.d,unflagPost:q.l,setEditingPost:q.j,pinPost:q.g,unpinPost:q.m,openModal:U.b},e)}})(Wp);function zp(e){return(zp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Yp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Qp(e,t){return!t||"object"!==zp(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Zp(e){return(Zp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Jp(e,t){return(Jp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Xp=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Qp(this,Zp(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Jp(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){return _.a.createElement("span",this.props,_.a.createElement(Y.c,{id:"generic_icons.download",defaultMessage:"Download Icon"},function(e){return _.a.createElement("svg",{width:"40px",height:"40px",viewBox:"0 0 42 42",role:"icon","aria-label":e},_.a.createElement("g",{stroke:"inherit",strokeWidth:"1",fill:"none",fillRule:"evenodd"},_.a.createElement("g",{transform:"translate(-986.000000, -1142.000000)"},_.a.createElement("g",{transform:"translate(50.000000, 1034.000000)"},_.a.createElement("g",{transform:"translate(539.000000, 54.000000)"},_.a.createElement("g",{transform:"translate(398.000000, 55.000000)"},_.a.createElement("g",{transform:"translate(11.000000, 11.000000)",fillRule:"nonzero",fill:"inherit"},_.a.createElement("path",{d:"M8.7345,14.1405 C8.74725,14.1525 8.763,14.15775 8.7765,14.16825 C8.802,14.18775 8.82675,14.20875 8.85675,14.22075 C8.9025,14.24025 8.95125,14.25 9,14.25 C9.04875,14.25 9.0975,14.24025 9.14325,14.22075 C9.18975,14.20125 9.23175,14.17275 9.267,14.1375 L13.764,9.6405 C13.91025,9.49425 13.91025,9.2565 13.764,9.11025 C13.61775,8.964 13.38,8.964 13.23375,9.11025 L9.375,12.969 L9.375,0.375 C9.375,0.168 9.207,0 9,0 C8.793,0 8.625,0.168 8.625,0.375 L8.625,12.9705 L4.76475,9.11025 C4.6185,8.964 4.38075,8.964 4.2345,9.11025 C4.08825,9.2565 4.08825,9.49425 4.2345,9.6405 L8.7345,14.1405 Z M17.25,13.5 C17.043,13.5 16.875,13.668 16.875,13.875 L16.875,17.25 L1.125,17.25 L1.125,13.875 C1.125,13.668 0.957,13.5 0.75,13.5 C0.543,13.5 0.375,13.668 0.375,13.875 L0.375,17.625 C0.375,17.832 0.543,18 0.75,18 L17.25,18 C17.457,18 17.625,17.832 17.625,17.625 L17.625,13.875 C17.625,13.668 17.457,13.5 17.25,13.5 Z"}))))))))}))}}])&&Yp(n.prototype,r),o&&Yp(n,o),t}();function $p(e){return($p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ef(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tf(e,t){return!t||"object"!==$p(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function nf(e){return(nf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rf(e,t){return(rf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var of=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),tf(this,nf(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rf(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e=this.props.fileInfo,t=Object(T.y)(e.extension);if(t===P.m.IMAGE){var n="post-image";e.width<P.Q.THUMBNAIL_WIDTH&&e.height<P.Q.THUMBNAIL_HEIGHT?n+=" small":n+=" normal";var r=Object(hl.getFileThumbnailUrl)(e.id);return Object(T.R)(e.extension)&&!e.has_preview_image&&(r=Object(hl.getFileUrl)(e.id)),_.a.createElement("div",{className:n,style:{backgroundImage:"url(".concat(r,")"),backgroundSize:"cover"}})}return e.extension===P.m.SVG&&this.props.enableSVGs?_.a.createElement("img",{alt:"file thumbnail image",className:"post-image normal",src:Object(hl.getFileUrl)(e.id)}):_.a.createElement("div",{className:"file-icon "+Object(T.A)(t)})}}])&&ef(n.prototype,r),o&&ef(n,o),t}();!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(of,"propTypes",{enableSVGs:v.a.bool.isRequired,fileInfo:v.a.object.isRequired});var af=Object(r.connect)(function(e){return{enableSVGs:"true"===Object(u.getConfig)(e).EnableSVGs}})(of);function sf(e){return(sf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function lf(e){return(lf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function uf(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pf(e,t){return(pf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ff(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var df=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=lf(t).call(this,e),n=!o||"object"!==sf(o)&&"function"!=typeof o?uf(r):o,ff(uf(n),"loadFiles",function(){var e=n.props.fileInfo;if(Object(T.y)(e.extension)===P.m.IMAGE){var t=Object(hl.getFileThumbnailUrl)(e.id);Object(T.Z)(t,n.handleImageLoaded)}else e.extension===P.m.SVG&&n.props.enableSVGs&&Object(T.Z)(Object(hl.getFileUrl)(e.id),n.handleImageLoaded)}),ff(uf(n),"handleImageLoaded",function(){n.mounted&&n.setState({loaded:!0})}),ff(uf(n),"onAttachmentClick",function(e){e.preventDefault(),n.props.handleImageClick&&n.props.handleImageClick(n.props.index)}),n.state={loaded:Object(T.y)(e.fileInfo.extension)!==P.m.IMAGE},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pf(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"componentDidMount",value:function(){this.mounted=!0,this.loadFiles()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){if(e.fileInfo.id!==this.props.fileInfo.id){var t=e.fileInfo.extension;this.setState({loaded:Object(T.y)(t)!==P.m.IMAGE&&!(e.enableSVGs&&t===P.m.SVG)})}}},{key:"componentDidUpdate",value:function(e){this.state.loaded||this.props.fileInfo.id===e.fileInfo.id||this.loadFiles()}},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"render",value:function(){var e,t,n,r=this.props,o=r.compactDisplay,a=r.fileInfo,i=Object(jl.f)(a.name),s="".concat(Object(T.ab)("file_attachment.thumbnail","file thumbnail")," ").concat(a.name).toLowerCase();return o||(e=_.a.createElement("a",{"aria-label":s,className:"post-image__thumbnail",href:"#",onClick:this.onAttachmentClick},this.state.loaded?_.a.createElement(af,{fileInfo:a}):_.a.createElement("div",{className:"post-image__load"})),t=_.a.createElement("div",{className:"post-image__detail_wrapper",onClick:this.onAttachmentClick},_.a.createElement("div",{className:"post-image__detail"},_.a.createElement("span",{className:"post-image__name"},i),_.a.createElement("span",{className:"post-image__type"},a.extension.toUpperCase()),_.a.createElement("span",{className:"post-image__size"},Object(T.p)(a.size))))),this.props.canDownloadFiles&&(n=_.a.createElement(Il,{fileInfo:a,compactDisplay:o,canDownload:this.props.canDownloadFiles,handleImageClick:this.onAttachmentClick,iconClass:"post-image__download"},_.a.createElement(Xp,null))),_.a.createElement("div",{className:"post-image__column"},e,_.a.createElement("div",{className:"post-image__details"},t,n))}}])&&cf(n.prototype,r),o&&cf(n,o),t}();ff(df,"propTypes",{fileInfo:v.a.object.isRequired,index:v.a.number.isRequired,handleImageClick:v.a.func,compactDisplay:v.a.bool,canDownloadFiles:v.a.bool,enableSVGs:v.a.bool.isRequired});var mf=Object(r.connect)(function(e){var t=Object(u.getConfig)(e);return{canDownloadFiles:Object(jl.a)(t),enableSVGs:"true"===t.EnableSVGs}})(df),hf=n(1594),bf=n(1659);function yf(e){return(yf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function gf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function vf(e){return(vf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ef(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _f(e,t){return(_f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Of=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=vf(t).call(this,e))||"object"!==yf(o)&&"function"!=typeof o?Ef(r):o).handleFileInfoChanged=n.handleFileInfoChanged.bind(Ef(n)),n.handleLoadError=n.handleLoadError.bind(Ef(n)),n.stop=n.stop.bind(Ef(n)),n.state={canPlay:!0},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_f(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"UNSAFE_componentWillMount",value:function(){this.handleFileInfoChanged(this.props.fileInfo)}},{key:"componentDidMount",value:function(){this.refs.source&&qc()(uu.a.findDOMNode(this.refs.source)).one("error",this.handleLoadError)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.props.fileUrl!==e.fileUrl&&this.handleFileInfoChanged(e.fileInfo)}},{key:"handleFileInfoChanged",value:function(e){var t=uu.a.findDOMNode(this.refs.video);t||(t=document.createElement("video"));var n=t.canPlayType(e.mime_type);this.setState({canPlay:"probably"===n||"maybe"===n})}},{key:"componentDidUpdate",value:function(){this.refs.source&&qc()(uu.a.findDOMNode(this.refs.source)).one("error",this.handleLoadError)}},{key:"handleLoadError",value:function(){this.setState({canPlay:!1})}},{key:"stop",value:function(){if(this.refs.video){var e=uu.a.findDOMNode(this.refs.video);e.pause(),e.currentTime=0}}},{key:"render",value:function(){if(!this.state.canPlay)return _.a.createElement(bf.a,{fileInfo:this.props.fileInfo,fileUrl:this.props.fileUrl});var e=P.Q.WEB_VIDEO_WIDTH,t=P.Q.WEB_VIDEO_HEIGHT;return T.U()&&(e=P.Q.MOBILE_VIDEO_WIDTH,t=P.Q.MOBILE_VIDEO_HEIGHT),_.a.createElement("video",{key:this.props.fileInfo.id,ref:"video","data-setup":"{}",controls:"controls",width:e,height:t},_.a.createElement("source",{ref:"source",src:this.props.fileUrl}))}}])&&gf(n.prototype,r),o&&gf(n,o),t}();!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Of,"propTypes",{fileInfo:v.a.object.isRequired,fileUrl:v.a.string.isRequired});var wf=n(298),Cf=n(1538);function Sf(e){return(Sf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function jf(e){return(jf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Tf(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kf(e,t){return(kf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Nf=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=jf(t).call(this,e))||"object"!==Sf(o)&&"function"!=typeof o?Tf(r):o).updateStateFromProps=n.updateStateFromProps.bind(Tf(n)),n.handleReceivedError=n.handleReceivedError.bind(Tf(n)),n.handleReceivedCode=n.handleReceivedCode.bind(Tf(n)),n.state={code:"",lang:"",loading:!0,success:!0},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kf(e,t)}(t,_.a.Component),n=t,o=[{key:"supports",value:function(e){return Boolean(wf.b(e.extension))}}],(r=[{key:"componentDidMount",value:function(){this.updateStateFromProps(this.props)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.props.fileUrl!==e.fileUrl&&this.updateStateFromProps(e)}},{key:"updateStateFromProps",value:function(e){var t=wf.b(e.fileInfo.extension);!t||e.fileInfo.size>P.Q.CODE_PREVIEW_MAX_FILE_SIZE?this.setState({code:"",lang:"",loading:!1,success:!1}):(this.setState({code:"",lang:t,loading:!0}),qc.a.ajax({async:!0,url:e.fileUrl,type:"GET",dataType:"text",error:this.handleReceivedError,success:this.handleReceivedCode}))}},{key:"handleReceivedCode",value:function(e){var t=e;"#document"===e.nodeName&&(t=(new XMLSerializer).serializeToString(e)),this.setState({code:t,loading:!1,success:!0})}},{key:"handleReceivedError",value:function(){this.setState({loading:!1,success:!1})}},{key:"render",value:function(){if(this.state.loading)return _.a.createElement("div",{className:"view-image__loading"},_.a.createElement(Cf.a,null));if(!this.state.success)return _.a.createElement(bf.a,{fileInfo:this.props.fileInfo,fileUrl:this.props.fileUrl});for(var e=this.state.code.match(/\r\n|\r|\n|$/g).length,t="",n=1;n<=e;n++)t+=t?"\n"+n:n;var r=wf.c(this.state.lang),o=wf.d(this.state.lang,this.state.code);return _.a.createElement("div",{className:"post-code"},_.a.createElement("span",{className:"post-code__language"},"".concat(this.props.fileInfo.name," - ").concat(r)),_.a.createElement("div",{className:"post-code__container"},_.a.createElement("code",{className:"hljs"},_.a.createElement("table",null,_.a.createElement("tbody",null,_.a.createElement("tr",null,_.a.createElement("td",{className:"post-code__lineno"},t),_.a.createElement("td",{dangerouslySetInnerHTML:{__html:o}})))))))}}])&&Pf(n.prototype,r),o&&Pf(n,o),t}();Nf.propTypes={fileInfo:v.a.object.isRequired,fileUrl:v.a.string.isRequired};var Rf=n(1769),Mf=n(2031),If=n.n(Mf);function xf(e){var t=e.fileInfo,n=e.canDownloadFiles,r=t.has_preview_image,o=t.id,a=t.link||Object(hl.getFileDownloadUrl)(o),i=r?Object(hl.getFilePreviewUrl)(o):a;return n?_.a.createElement("a",{href:a,target:"_blank",rel:"noopener noreferrer",download:!0},_.a.createElement("img",{alt:"preview url image",src:i})):_.a.createElement("img",{src:i})}function Af(e){return(Af="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Lf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Df(e,t){return!t||"object"!==Af(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Uf(e){return(Uf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qf(e,t){return(qf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Hf(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}xf.propTypes={fileInfo:v.a.object.isRequired,canDownloadFiles:v.a.bool.isRequired};var Ff=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Df(this,Uf(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qf(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e="";this.props.enablePublicLink&&this.props.showPublicLink&&(e=_.a.createElement("div",null,_.a.createElement("a",{href:"#",className:"public-link text","data-title":"Public Image",onClick:this.props.onGetPublicLink},_.a.createElement(Y.c,{id:"view_image_popover.publicLink",defaultMessage:"Get Public Link"})),_.a.createElement("span",{className:"text"}," | ")));var t="modal-button-bar";this.props.show&&(t+=" footer--show");var n=null;if(this.props.canDownloadFiles){var r,o={};this.props.isExternalFile&&!this.props.isDesktopApp?r=_.a.createElement(Y.c,{id:"view_image_popover.open",defaultMessage:"Open"}):(r=_.a.createElement(Y.c,{id:"view_image_popover.download",defaultMessage:"Download"}),o.download=this.props.filename),n=_.a.createElement("div",{className:"image-links"},e,_.a.createElement("a",Object.assign({href:this.props.fileURL,className:"text",target:"_blank",rel:"noopener noreferrer"},o),r))}return _.a.createElement("div",{ref:"imageFooter",className:t},_.a.createElement("span",{className:"pull-left text"},_.a.createElement(Y.c,{id:"view_image_popover.file",defaultMessage:"File {count, number} of {total, number}",values:{count:this.props.fileIndex+1,total:this.props.totalFiles}})),n)}}])&&Lf(n.prototype,r),o&&Lf(n,o),t}();Hf(Ff,"propTypes",{show:v.a.bool.isRequired,fileIndex:v.a.number.isRequired,totalFiles:v.a.number.isRequired,filename:v.a.string.isRequired,fileURL:v.a.string.isRequired,showPublicLink:v.a.bool,enablePublicLink:v.a.bool.isRequired,canDownloadFiles:v.a.bool.isRequired,isExternalFile:v.a.bool.isRequired,onGetPublicLink:v.a.func,isDesktopApp:v.a.bool.isRequired}),Hf(Ff,"defaultProps",{show:!1,fileIndex:0,totalFiles:0,filename:"",fileURL:"",showPublicLink:!0});var Bf=Object(r.connect)(function(){return{isDesktopApp:Object(j.c)()}})(Ff);function Gf(e){return(Gf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Vf(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){Qf(e,t,n[t])})}return e}function Wf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Kf(e){return(Kf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function zf(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Yf(e,t){return(Yf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Qf(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Zf=P.Q.KeyCodes,Jf=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=Kf(t).call(this,e),n=!o||"object"!==Gf(o)&&"function"!=typeof o?zf(r):o,Qf(zf(n),"handleNext",function(e){e&&e.stopPropagation();var t=n.state.imageIndex+1;t>n.props.fileInfos.length-1&&(t=0),n.showImage(t)}),Qf(zf(n),"handlePrev",function(e){e&&e.stopPropagation();var t=n.state.imageIndex-1;t<0&&(t=n.props.fileInfos.length-1),n.showImage(t)}),Qf(zf(n),"handleKeyPress",function(e){T.S(e,Zf.RIGHT)?n.handleNext():T.S(e,Zf.LEFT)&&n.handlePrev()}),Qf(zf(n),"onModalShown",function(e){document.addEventListener("keyup",n.handleKeyPress),n.showImage(e.startIndex)}),Qf(zf(n),"onModalHidden",function(){document.addEventListener("keyup",n.handleKeyPress),n.refs.video&&n.refs.video.stop()}),Qf(zf(n),"showImage",function(e){n.setState({imageIndex:e});var t=window.innerHeight-100;n.setState({imageHeight:t}),n.state.loaded[e]||n.loadImage(e)}),Qf(zf(n),"loadImage",function(e){var t,r=n.props.fileInfos[e];T.y(r.extension)===P.m.IMAGE&&Boolean(r.id)?(t=r.has_image_preview?Object(hl.getFilePreviewUrl)(r.id):Object(hl.getFileUrl)(r.id),T.Z(t,function(){return n.handleImageLoaded(e)},function(t){return n.handleImageProgress(e,t)})):n.handleImageLoaded(e)}),Qf(zf(n),"handleImageLoaded",function(e){n.setState(function(t){return{loaded:Vf({},t.loaded,Qf({},e,!0))}})}),Qf(zf(n),"handleImageProgress",function(e,t){n.setState(function(n){return{progress:Vf({},n.progress,Qf({},e,t))}})}),Qf(zf(n),"handleGetPublicLink",function(){n.props.onModalDismissed(),S.k(n.props.fileInfos[n.state.imageIndex].id)}),Qf(zf(n),"onMouseEnterImage",function(){n.setState({showFooter:!0})}),Qf(zf(n),"onMouseLeaveImage",function(){n.setState({showFooter:!1})}),n.state={imageIndex:n.props.startIndex,imageHeight:"100%",loaded:T.q(!1,n.props.fileInfos.length),progress:T.q(0,n.props.fileInfos.length),showFooter:!1},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Yf(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"UNSAFE_componentWillReceiveProps",value:function(e){!0===e.show&&!1===this.props.show?this.onModalShown(e):!1===e.show&&!0===this.props.show&&this.onModalHidden(),this.props.fileInfos.length!==e.fileInfos.length&&this.setState({loaded:T.q(!1,e.fileInfos.length),progress:T.q(0,e.fileInfos.length)})}},{key:"render",value:function(){if(this.props.fileInfos.length<1||this.props.fileInfos.length-1<this.state.imageIndex)return null;var e,t=this.props.fileInfos[this.state.imageIndex],n=!t.link,r=t.link||t.name,o=t.link||Object(hl.getFileUrl)(t.id),a=t.link||Object(hl.getFileDownloadUrl)(t.id),i=!t.id;if(this.state.loaded[this.state.imageIndex]){var s=T.y(t.extension);e=s===P.m.IMAGE||s===P.m.SVG?_.a.createElement(xf,{fileInfo:t,canDownloadFiles:this.props.canDownloadFiles}):s===P.m.VIDEO||s===P.m.AUDIO?_.a.createElement(Of,{fileInfo:t,fileUrl:o}):t&&t.extension&&t.extension===P.m.PDF?_.a.createElement(k.a,{doLoad:If.a,fileInfo:t,fileUrl:o}):Nf.supports(t)?_.a.createElement(Nf,{fileInfo:t,fileUrl:o}):_.a.createElement(bf.a,{fileInfo:t,fileUrl:o})}else{var c=T.ab("view_image.loading","Loading"),l=Math.floor(this.state.progress[this.state.imageIndex]);e=_.a.createElement(Rf.a,{loading:c,progress:l})}var u=!0,p=!1,f=void 0;try{for(var d,m=this.props.pluginFilePreviewComponents[Symbol.iterator]();!(u=(d=m.next()).done);u=!0){var h=d.value;if(h.override(t,this.props.post)){e=_.a.createElement(h.component,{fileInfo:t,post:this.props.post});break}}}catch(e){p=!0,f=e}finally{try{u||null==m.return||m.return()}finally{if(p)throw f}}var b=null,y=null;this.props.fileInfos.length>1&&(b=_.a.createElement("a",{id:"previewArrowLeft",ref:"previewArrowLeft",className:"modal-prev-bar",href:"#",onClick:this.handlePrev},_.a.createElement("i",{className:"image-control image-prev"})),y=_.a.createElement("a",{id:"previewArrowRight",ref:"previewArrowRight",className:"modal-next-bar",href:"#",onClick:this.handleNext},_.a.createElement("i",{className:"image-control image-next"})));var g="modal-close";return this.state.showFooter&&(g+=" modal-close--show"),_.a.createElement(z.a,{show:this.props.show,onHide:this.props.onModalDismissed,className:"modal-image",dialogClassName:"a11y__modal modal-image",role:"dialog","aria-labelledby":"viewImageModalLabel"},_.a.createElement(z.a.Body,null,_.a.createElement("div",{className:"modal-image__wrapper",onClick:this.props.onModalDismissed},_.a.createElement("div",{onMouseEnter:this.onMouseEnterImage,onMouseLeave:this.onMouseLeaveImage,onClick:function(e){return e.stopPropagation()}},_.a.createElement(z.a.Title,{componentClass:"h1",id:"viewImageModalLabel",className:"hide"},r),_.a.createElement("div",{className:g,onClick:this.props.onModalDismissed}),_.a.createElement("div",{className:"modal-image__content"},e),_.a.createElement(Bf,{show:this.state.showFooter,showPublicLink:n,fileIndex:this.state.imageIndex,totalFiles:this.props.fileInfos.length,filename:r,fileURL:a,enablePublicLink:this.props.enablePublicLink,canDownloadFiles:this.props.canDownloadFiles,isExternalFile:i,onGetPublicLink:this.handleGetPublicLink}))),b,y))}}])&&Wf(n.prototype,r),o&&Wf(n,o),t}();Qf(Jf,"propTypes",{post:v.a.object.isRequired,show:v.a.bool.isRequired,onModalDismissed:v.a.func.isRequired,fileInfos:v.a.arrayOf(v.a.object).isRequired,startIndex:v.a.number.isRequired,canDownloadFiles:v.a.bool.isRequired,enablePublicLink:v.a.bool.isRequired,pluginFilePreviewComponents:v.a.arrayOf(v.a.object)}),Qf(Jf,"defaultProps",{show:!1,fileInfos:[],startIndex:0,pluginFilePreviewComponents:[]});var Xf=Object(r.connect)(function(e,t){var n=Object(u.getConfig)(e);return{canDownloadFiles:Object(jl.a)(n),enablePublicLink:"true"===n.EnablePublicLink,pluginFilePreviewComponents:e.plugins.components.FilePreview,post:t.post||Object(ea.getPost)(e,t.postId)}})(Jf);function $f(e){return($f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ed(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function td(e){return(td=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function nd(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rd(e,t){return(rd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function od(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ad=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=td(t).call(this,e),n=!o||"object"!==$f(o)&&"function"!=typeof o?nd(r):o,od(nd(n),"imageLoaded",function(){n.mounted&&n.setState({loaded:!0})}),od(nd(n),"handleImageClick",function(e){e.preventDefault(),n.setState({showPreviewModal:!0})}),od(nd(n),"showPreviewModal",function(){n.setState({showPreviewModal:!1})}),od(nd(n),"toggleEmbedVisibility",function(){n.props.actions.toggleEmbedVisibility(n.props.postId)}),n.state={loaded:!1,showPreviewModal:!1,dimensions:{width:e.fileInfo.width,height:e.fileInfo.height}},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rd(e,t)}(t,_.a.PureComponent),n=t,o=[{key:"getDerivedStateFromProps",value:function(e,t){return e.fileInfo.width!==t.dimensions.width||e.fileInfo.height!==t.dimensions.height?{dimensions:{width:e.fileInfo.width,height:e.fileInfo.height}}:null}}],(r=[{key:"componentDidMount",value:function(){this.mounted=!0}},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"render",value:function(){var e=this.props.fileInfo,t=this.state.loaded,n=e.has_preview_image,r=e.id,o=Object(hl.getFileUrl)(r),a=n?Object(hl.getFilePreviewUrl)(r):o,i=e.height,s=e.width,c="";(s<50||i<50)&&(c="min-preview ",i>s&&(c+="min-preview--portrait "));var l,u=_.a.createElement("button",{key:"toggle",className:"style--none post__embed-visibility color--link","data-expanded":this.props.isEmbedVisible,"aria-label":"Toggle Embed Visibility",onClick:this.toggleEmbedVisibility}),p=_.a.createElement("div",{className:"image-name"},u,_.a.createElement("div",{onClick:this.handleImageClick},e.name)),f="",d={},m={},h="";return Object(T.y)(e.extension)===P.m.SVG&&(h="svg",this.state.dimensions.height?d={width:"100%"}:m={height:150,width:"auto"}),t&&(l=_.a.createElement(Xf,{show:this.state.showPreviewModal,onModalDismissed:this.showPreviewModal,fileInfos:[e],postId:this.props.postId}),f="image-fade-in"),_.a.createElement("div",{className:"file-view--single"},_.a.createElement("div",{className:"file__image"},p,this.props.isEmbedVisible&&_.a.createElement("div",{className:"image-container",style:m},_.a.createElement("div",{className:"image-loaded ".concat(f," ").concat(h),style:d},_.a.createElement(hf.a,{onClick:this.handleImageClick,className:c,src:a,dimensions:this.state.dimensions,fileInfo:this.props.fileInfo,onImageLoaded:this.imageLoaded,showLoader:this.props.isEmbedVisible}))),l))}}])&&ed(n.prototype,r),o&&ed(n,o),t}();od(ad,"propTypes",{postId:v.a.string.isRequired,fileInfo:v.a.object.isRequired,isRhsOpen:v.a.bool.isRequired,isEmbedVisible:v.a.bool,actions:v.a.shape({toggleEmbedVisibility:v.a.func.isRequired}).isRequired}),od(ad,"defaultProps",{fileInfo:{}});var id=Object(r.connect)(function(e){return{isRhsOpen:Object(Nc.c)(e)}},function(e){return{actions:Object(o.bindActionCreators)({toggleEmbedVisibility:q.k},e)}})(ad);function sd(e){return(sd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cd(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ld(e){return(ld=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ud(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pd(e,t){return(pd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function fd(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var dd=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=ld(t).call(this,e),n=!o||"object"!==sd(o)&&"function"!=typeof o?ud(r):o,fd(ud(n),"hidePreviewModal",function(){n.setState({showPreviewModal:!1})}),n.handleImageClick=n.handleImageClick.bind(ud(n)),n.state={showPreviewModal:!1,startImgIndex:0},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pd(e,t)}(t,_.a.Component),n=t,(r=[{key:"handleImageClick",value:function(e){this.setState({showPreviewModal:!0,startImgIndex:e})}},{key:"render",value:function(){var e=this.props,t=e.compactDisplay,n=e.enableSVGs,r=e.fileInfos,o=e.fileCount,a=e.locale;if(!1===t)if(r&&1===r.length){var i=Object(T.y)(r[0].extension);if(i===P.m.IMAGE||i===P.m.SVG&&n)return _.a.createElement(id,{fileInfo:r[0],isEmbedVisible:this.props.isEmbedVisible,postId:this.props.post.id})}else if(1===o&&this.props.isEmbedVisible)return _.a.createElement("div",{style:md.minHeightPlaceholder});var s=Object(hl.sortFileInfos)(r,a),c=[];if(s&&s.length>0)for(var l=0;l<s.length;l++){var u=s[l];c.push(_.a.createElement(mf,{key:u.id,fileInfo:s[l],index:l,handleImageClick:this.handleImageClick,compactDisplay:t}))}else if(o>0)for(var p=0;p<o;p++)c.push(_.a.createElement("div",{key:"fileCount-".concat(p),className:"post-image__column post-image__column--placeholder"}));return _.a.createElement(_.a.Fragment,null,_.a.createElement("div",{className:"post-image__columns clearfix"},c),_.a.createElement(Xf,{show:this.state.showPreviewModal,onModalDismissed:this.hidePreviewModal,startIndex:this.state.startImgIndex,fileInfos:s,postId:this.props.post.id}))}}])&&cd(n.prototype,r),o&&cd(n,o),t}();fd(dd,"propTypes",{post:v.a.object.isRequired,fileCount:v.a.number.isRequired,fileInfos:v.a.arrayOf(v.a.object),compactDisplay:v.a.bool,enableSVGs:v.a.bool,isEmbedVisible:v.a.bool,locale:v.a.string.isRequired});var md={minHeightPlaceholder:{minHeight:"385px"}};var hd=Object(r.connect)(function(){var e=Object(Gs.makeGetFilesForPost)();return function(t,n){var r=n.post?n.post.id:"",o=e(t,r),a=0;return n.post.metadata&&n.post.metadata.files?a=(n.post.metadata.files||[]).length:n.post.file_ids?a=n.post.file_ids.length:n.post.filenames&&(a=n.post.filenames.length),{enableSVGs:"true"===Object(u.getConfig)(t).EnableSVGs,fileInfos:o,fileCount:a,isEmbedVisible:Object(K.b)(t,n.post.id),locale:Object(Wc.a)(t)}}})(dd),bd=n(1545),yd=n(1692);function gd(e){return(gd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vd(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ed(e){return(Ed=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Od(e,t){return(Od=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function wd(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Cd=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=Ed(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==gd(o)&&"function"!=typeof o?_d(r):o,wd(_d(n),"getProfilePictureURL",function(){var e=n.props,t=e.post,r=e.user;return r&&r.id===t.user_id?T.J(r):t.user_id?T.J(t.user_id):""}),wd(_d(n),"getStatus",function(e,t,r){return e||t||r&&r.is_bot?"":n.props.status}),wd(_d(n),"getPostIconURL",function(e,t,r){var o=n.props,a=o.enablePostIconOverride,i=o.hasImageProxy,s=o.post.props,c="",l="";return s&&(c=s.override_icon_url,l=s.use_user_icon),n.props.compactDisplay?"":!t&&r&&!l&&a?c&&""!==c?Et.f(c,i):P.Q.DEFAULT_WEBHOOK_LOGO:e}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Od(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.compactDisplay,n=e.isBusy,r=e.isRHS,o=e.post,a=e.user,i=e.isBot,s=Et.m(o),c=Et.l(o);if(s&&!t&&!c&&!i)return _.a.createElement(yd.a,{className:"icon"});var l=Et.e(o),u=!l&&!c,p=this.getProfilePictureURL(),f=this.getPostIconURL(p,l,c),d=o.props?o.props.override_icon_emoji:"",m="string"==typeof d&&""!==d,h=this.getStatus(l,c,a);return _.a.createElement(bd.a,{hasMention:u,isBusy:n,isRHS:r,src:f,profileSrc:p,isEmoji:m,status:h,userId:a?a.id:null,username:a?a.username:null})}}])&&vd(n.prototype,r),o&&vd(n,o),t}();wd(Cd,"propTypes",{compactDisplay:v.a.bool.isRequired,enablePostIconOverride:v.a.bool.isRequired,hasImageProxy:v.a.bool.isRequired,isBusy:v.a.bool,isRHS:v.a.bool,post:v.a.object.isRequired,status:v.a.string,user:v.a.object,isBot:v.a.bool,postIconOverrideURL:v.a.string}),wd(Cd,"defaultProps",{status:P.O.OFFLINE});var Sd=Object(r.connect)(function(e,t){var n=Object(u.getConfig)(e),r=Object(p.getUser)(e,t.userId);return{enablePostIconOverride:"true"===n.EnablePostIconOverride,hasImageProxy:"true"===n.HasImageProxy,status:Object(p.getStatusForUserId)(e,t.userId),isBot:Boolean(r&&r.is_bot),user:r}})(Cd);function Pd(e){return(Pd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jd(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Td(e){return(Td=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function kd(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Nd(e,t){return(Nd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Rd(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Md=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=Td(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==Pd(o)&&"function"!=typeof o?kd(r):o,Rd(kd(n),"retryPost",function(e){e.preventDefault();var t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){Rd(e,t,n[t])})}return e}({},n.props.post);Reflect.deleteProperty(t,"id"),n.props.actions.createPost(t)}),Rd(kd(n),"cancelPost",function(e){e.preventDefault(),n.props.actions.removePost(n.props.post)}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Nd(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){return _.a.createElement("span",{className:"pending-post-actions"},_.a.createElement("a",{className:"post-retry",href:"#",onClick:this.retryPost},_.a.createElement(Y.c,{id:"pending_post_actions.retry",defaultMessage:"Retry"}))," - ",_.a.createElement("a",{className:"post-cancel",href:"#",onClick:this.cancelPost},_.a.createElement(Y.c,{id:"pending_post_actions.cancel",defaultMessage:"Cancel"})))}}])&&jd(n.prototype,r),o&&jd(n,o),t}();Rd(Md,"propTypes",{post:v.a.object.isRequired,actions:v.a.shape({createPost:v.a.func.isRequired,removePost:v.a.func.isRequired}).isRequired});var Id=Object(r.connect)(null,function(e){return{actions:Object(o.bindActionCreators)({createPost:q.b,removePost:A.removePost},e)}})(Md);function xd(e){return(xd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ad(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ld(e,t){return!t||"object"!==xd(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Dd(e){return(Dd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ud(e,t){return(Ud=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var qd=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ld(this,Dd(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ud(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){return _.a.createElement("span",this.props,_.a.createElement(Y.c,{id:"generic_icons.flag",defaultMessage:"Flag Icon"},function(e){return _.a.createElement("svg",{width:"14px",height:"14px",viewBox:"0 0 16 16",role:"icon","aria-label":e},_.a.createElement("g",{stroke:"none",strokeWidth:"1",fill:"inherit",fillRule:"evenodd"},_.a.createElement("g",{transform:"translate(-1106.000000, -33.000000)",fillRule:"nonzero",fill:"inherit"},_.a.createElement("g",null,_.a.createElement("g",{transform:"translate(1096.000000, 22.000000)"},_.a.createElement("g",{transform:"translate(10.000000, 11.000000)"},_.a.createElement("path",{d:"M8,1 L2,1 C2,0.447 1.553,0 1,0 C0.447,0 0,0.447 0,1 L0,15.5 C0,15.776 0.224,16 0.5,16 L1.5,16 C1.776,16 2,15.776 2,15.5 L2,11 L7,11 L7,12 C7,12.553 7.447,13 8,13 L15,13 C15.553,13 16,12.553 16,12 L16,4 C16,3.447 15.553,3 15,3 L9,3 L9,2 C9,1.447 8.553,1 8,1 Z M9,11 L9,9.5 C9,9.224 8.776,9 8.5,9 L2,9 L2,3 L7,3 L7,4.5 C7,4.776 7.224,5 7.5,5 L14,5 L14,11 L9,11 Z"})))))))}))}}])&&Ad(n.prototype,r),o&&Ad(n,o),t}();function Hd(e){return(Hd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fd(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Bd(e,t){return!t||"object"!==Hd(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Gd(e){return(Gd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Vd(e,t){return(Vd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Wd=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Bd(this,Gd(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vd(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){return _.a.createElement("span",this.props,_.a.createElement(Y.c,{id:"generic_icons.flagged",defaultMessage:"Flagged Icon"},function(e){return _.a.createElement("svg",{width:"16px",height:"16px",viewBox:"0 0 16 16",role:"icon","aria-label":e},_.a.createElement("g",{stroke:"none",strokeWidth:"1",fill:"inherit",fillRule:"evenodd"},_.a.createElement("g",{transform:"translate(-1073.000000, -33.000000)",fillRule:"nonzero",fill:"inherit"},_.a.createElement("g",{transform:"translate(-1.000000, 0.000000)"},_.a.createElement("g",{transform:"translate(1064.000000, 22.000000)"},_.a.createElement("g",{transform:"translate(10.000000, 11.000000)"},_.a.createElement("path",{d:"M8,1 L2,1 C2,0.447 1.553,0 1,0 C0.447,0 0,0.447 0,1 L0,15.5 C0,15.776 0.224,16 0.5,16 L1.5,16 C1.776,16 2,15.776 2,15.5 L2,11 L7,11 L7,12 C7,12.553 7.447,13 8,13 L15,13 C15.553,13 16,12.553 16,12 L16,4 C16,3.447 15.553,3 15,3 L9,3 L9,2 C9,1.447 8.553,1 8,1 Z"})))))))}))}}])&&Fd(n.prototype,r),o&&Fd(n,o),t}();function Kd(e){return(Kd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zd(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Yd(e){return(Yd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Qd(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zd(e,t){return(Zd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Jd(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Xd=function(e){function t(){var e,n,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,r=Yd(t).call(this),e=!r||"object"!==Kd(r)&&"function"!=typeof r?Qd(n):r,Jd(Qd(e),"handlePress",function(t){t.preventDefault();var n=e.props,r=n.actions,o=n.isFlagged,a=n.postId;o?r.unflagPost(a):r.flagPost(a)}),Jd(Qd(e),"handleA11yActivateEvent",function(){e.setState({a11yActive:!0})}),Jd(Qd(e),"handleA11yDeactivateEvent",function(){e.setState({a11yActive:!1})}),e.buttonRef=_.a.createRef(),e.state={a11yActive:!1},e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Zd(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"componentDidMount",value:function(){this.buttonRef.current&&(this.buttonRef.current.addEventListener(P.c.ACTIVATE,this.handleA11yActivateEvent),this.buttonRef.current.addEventListener(P.c.DEACTIVATE,this.handleA11yDeactivateEvent))}},{key:"componentWillUnmount",value:function(){this.buttonRef.current&&(this.buttonRef.current.removeEventListener(P.c.ACTIVATE,this.handleA11yActivateEvent),this.buttonRef.current.removeEventListener(P.c.DEACTIVATE,this.handleA11yDeactivateEvent))}},{key:"componentDidUpdate",value:function(){this.state.a11yActive&&this.buttonRef.current&&this.buttonRef.current.dispatchEvent(new Event(P.c.UPDATE))}},{key:"render",value:function(){if(this.props.isEphemeral)return null;var e,t=this.props.isFlagged,n=t?"visible":"";return e=t?_.a.createElement(Wd,{className:"icon"}):_.a.createElement(qd,{className:"icon"}),_.a.createElement("button",{ref:this.buttonRef,id:"".concat(this.props.location,"_flagIcon_").concat(this.props.postId),"aria-label":t?Object(T.ab)("flag_post.unflag","Unflag").toLowerCase():Object(T.ab)("flag_post.flag","Flag for follow up").toLowerCase(),className:"style--none flag-icon__container "+n,onClick:this.handlePress},_.a.createElement(vl.a,{key:"flagtooltipkey"+n,delayShow:P.Q.OVERLAY_TIME_DELAY,placement:"top",overlay:_.a.createElement(El.a,{id:"flagTooltip"},_.a.createElement(Y.c,{id:t?Object(Ne.b)("flag_post.unflag"):Object(Ne.b)("flag_post.flag"),defaultMessage:t?"Unflag":"Flag for follow up"}))},e))}}])&&zd(n.prototype,r),o&&zd(n,o),t}();Jd(Xd,"propTypes",{location:v.a.oneOf([P.q.CENTER,P.q.RHS_ROOT,P.q.RHS_COMMENT,P.q.SEARCH]).isRequired,postId:v.a.string.isRequired,isFlagged:v.a.bool.isRequired,isEphemeral:v.a.bool,actions:v.a.shape({flagPost:v.a.func.isRequired,unflagPost:v.a.func.isRequired}).isRequired}),Jd(Xd,"defaultProps",{isEphemeral:!1,location:P.q.CENTER});var $d=Object(r.connect)(null,function(e){return{actions:Object(o.bindActionCreators)({flagPost:q.d,unflagPost:q.l},e)}})(Xd),em=n(1869);function tm(e){return(tm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nm(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function rm(e){return(rm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function om(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function am(e,t){return(am=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function im(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var sm=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,n=!(o=(e=rm(t)).call.apply(e,[this].concat(i)))||"object"!==tm(o)&&"function"!=typeof o?om(r):o,im(om(n),"handleClick",function(){Object(T.U)()&&S.c()}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&am(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e=_.a.createElement(em.a,{eventTime:this.props.eventTime});if(Object(j.m)()||!this.props.isPermalink)return _.a.createElement("div",{role:"presentation",className:"post__permalink"},e);var t=this.props,n=t.location,r=t.postId,o=t.teamUrl;return _.a.createElement(Fi.a,{role:"presentation",id:"".concat(n,"_time_").concat(r),to:"".concat(o,"/pl/").concat(r),className:"post__permalink",onClick:this.handleClick},e)}}])&&nm(n.prototype,r),o&&nm(n,o),t}();im(sm,"propTypes",{isPermalink:v.a.bool.isRequired,eventTime:v.a.number.isRequired,location:v.a.oneOf([P.q.CENTER,P.q.RHS_ROOT,P.q.RHS_COMMENT,P.q.SEARCH]).isRequired,postId:v.a.string,teamUrl:v.a.string}),im(sm,"defaultProps",{eventTime:0,location:P.q.CENTER});var cm=Object(r.connect)(function(e){return{teamUrl:Object(f.getCurrentRelativeTeamUrl)(e)}})(sm);function lm(e){return(lm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function um(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pm(e){return(pm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fm(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dm(e,t){return(dm=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function mm(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var hm=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=pm(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==lm(o)&&"function"!=typeof o?fm(r):o,mm(fm(n),"handleAddEmoji",function(e){n.setState({showEmojiPicker:!1});var t=e.name||e.aliases[0];n.props.actions.addReaction(n.props.postId,t),n.props.toggleEmojiPicker()}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dm(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e,t,n=this.props,r=n.channelId,o=n.location,a=n.postId,i=n.showEmojiPicker,s=n.teamId;return o!==P.q.RHS_ROOT&&o!==P.q.RHS_COMMENT||(e=Eo.RHS_SPACE_REQUIRED_ABOVE,t=Eo.RHS_SPACE_REQUIRED_BELOW),_.a.createElement(Lp,{channelId:r,teamId:s,permissions:[Tp.a.ADD_REACTION]},_.a.createElement("div",null,_.a.createElement(Eo,{show:i,target:this.props.getDotMenuRef,onHide:this.props.toggleEmojiPicker,onEmojiClose:this.props.toggleEmojiPicker,onEmojiClick:this.handleAddEmoji,topOffset:-7,spaceRequiredAbove:e,spaceRequiredBelow:t}),_.a.createElement("button",{id:"".concat(o,"_reaction_").concat(a),"aria-label":Object(T.ab)("post_info.tooltip.add_reactions","Add Reaction").toLowerCase(),className:"reacticon__container color--link style--none",onClick:this.props.toggleEmojiPicker},_.a.createElement(vl.a,{className:"hidden-xs",delayShow:500,placement:"top",overlay:_.a.createElement(El.a,{id:"reaction-icon-tooltip",className:"hidden-xs"},_.a.createElement(Y.c,{id:"post_info.tooltip.add_reactions",defaultMessage:"Add Reaction"}))},_.a.createElement(Vn,{className:"icon icon--emoji"})))))}}])&&um(n.prototype,r),o&&um(n,o),t}();mm(hm,"propTypes",{channelId:v.a.string,postId:v.a.string.isRequired,teamId:v.a.string.isRequired,getDotMenuRef:v.a.func.isRequired,location:v.a.oneOf([P.q.CENTER,P.q.RHS_ROOT,P.q.RHS_COMMENT]).isRequired,showEmojiPicker:v.a.bool.isRequired,toggleEmojiPicker:v.a.func.isRequired,actions:v.a.shape({addReaction:v.a.func.isRequired}).isRequired}),mm(hm,"defaultProps",{location:P.q.CENTER,showEmojiPicker:!1});var bm=Object(r.connect)(null,function(e){return{actions:Object(o.bindActionCreators)({addReaction:q.a},e)}})(hm),ym=(n(248),n(953)),gm=n.n(ym);function vm(e){return(vm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Em(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _m(e){return(_m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Om(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wm(e,t){return(wm=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Cm(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Sm=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=_m(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==vm(o)&&"function"!=typeof o?Om(r):o,Cm(Om(n),"handleAddReaction",function(e){e.preventDefault();var t=n.props,r=t.actions,o=t.post,a=t.emojiName;r.addReaction(o.id,a)}),Cm(Om(n),"handleRemoveReaction",function(e){e.preventDefault(),n.props.actions.removeReaction(n.props.post.id,n.props.emojiName)}),Cm(Om(n),"loadMissingProfiles",function(){var e=n.props.reactions.map(function(e){return e.user_id});n.props.actions.getMissingProfilesByIds(e)}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wm(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){if(!this.props.emojiImageUrl)return null;var e,t,n=!1,r=[],o=this.props.otherUsersCount,a=!0,i=!1,s=void 0;try{for(var c,l=this.props.profiles[Symbol.iterator]();!(a=(c=l.next()).done);a=!0){var u=c.value;u.id===this.props.currentUserId?n=!0:r.push(T.v(u))}}catch(e){i=!0,s=e}finally{try{a||null==l.return||l.return()}finally{if(i)throw s}}r.sort(),n&&r.unshift(T.ab("reaction.you","You")),e=o>0?r.length>0?_.a.createElement(Y.c,{id:"reaction.usersAndOthersReacted",defaultMessage:"{users} and {otherUsers, number} other {otherUsers, plural, one {user} other {users}}",values:{users:r.join(", "),otherUsers:o}}):_.a.createElement(Y.c,{id:"reaction.othersReacted",defaultMessage:"{otherUsers, number} {otherUsers, plural, one {user} other {users}}",values:{otherUsers:o}}):r.length>1?_.a.createElement(Y.c,{id:"reaction.usersReacted",defaultMessage:"{users} and {lastUser}",values:{users:r.slice(0,-1).join(", "),lastUser:r[r.length-1]}}):r[0],t=r.length+o>1?n?_.a.createElement(Y.c,{id:"reaction.reactionVerb.youAndUsers",defaultMessage:"reacted"}):_.a.createElement(Y.c,{id:"reaction.reactionVerb.users",defaultMessage:"reacted"}):n?_.a.createElement(Y.c,{id:"reaction.reactionVerb.you",defaultMessage:"reacted"}):_.a.createElement(Y.c,{id:"reaction.reactionVerb.user",defaultMessage:"reacted"});var p,f,d=_.a.createElement(Y.c,{id:"reaction.reacted",defaultMessage:"{users} {reactionVerb} with {emoji}",values:{users:_.a.createElement("b",null,e),reactionVerb:t,emoji:_.a.createElement("b",null,":"+this.props.emojiName+":")}}),m="post-reaction",h=this.props.emojiName.replace(/_/g," "),b="".concat(T.ab("reaction.reactWidth.ariaLabel","react with")," ").concat(h);return n?(this.props.canRemoveReaction?(p=this.handleRemoveReaction,b="".concat(T.ab("reaction.removeReact.ariaLabel","remove reaction")," ").concat(h),f=_.a.createElement(Y.c,{id:"reaction.clickToRemove",defaultMessage:"(click to remove)"})):m+=" post-reaction--read-only",m+=" post-reaction--current-user"):!n&&this.props.canAddReaction?(p=this.handleAddReaction,f=_.a.createElement(Y.c,{id:"reaction.clickToAdd",defaultMessage:"(click to add)"})):m+=" post-reaction--read-only",_.a.createElement("button",{id:"postReaction-".concat(this.props.post.id,"-").concat(this.props.emojiName),"aria-label":b,className:"style--none ".concat(m),onClick:p},_.a.createElement(vl.a,{delayShow:1e3,placement:"top",shouldUpdatePosition:!0,overlay:_.a.createElement(El.a,{id:"".concat(this.props.post.id,"-").concat(this.props.emojiName,"-reaction")},d,_.a.createElement("br",null),f),onEnter:this.loadMissingProfiles},_.a.createElement("span",null,_.a.createElement("span",{className:"post-reaction__emoji emoticon",style:{backgroundImage:"url("+this.props.emojiImageUrl+")"}}),_.a.createElement("span",{className:"post-reaction__count"},this.props.reactionCount))))}}])&&Em(n.prototype,r),o&&Em(n,o),t}();function Pm(e,t,n,r,o,a,i,s){return!!Object(D.haveIChannelPermission)(e,{team:t,channel:n,permission:s})&&!(r===gm.a.DEFAULT_CHANNEL&&"true"===o.ExperimentalTownSquareIsReadOnly&&"true"===a.IsLicensed&&!i.roles.includes("system_admin"))}Cm(Sm,"propTypes",{post:v.a.object.isRequired,currentUserId:v.a.string.isRequired,emojiName:v.a.string.isRequired,reactionCount:v.a.number.isRequired,profiles:v.a.array.isRequired,otherUsersCount:v.a.number.isRequired,reactions:v.a.arrayOf(v.a.object).isRequired,canAddReaction:v.a.bool.isRequired,canRemoveReaction:v.a.bool.isRequired,emojiImageUrl:v.a.string.isRequired,actions:v.a.shape({addReaction:v.a.func.isRequired,getMissingProfilesByIds:v.a.func.isRequired,removeReaction:v.a.func.isRequired})});var jm=Object(r.connect)(function(){var e=Object(p.makeGetProfilesForReactions)();return function(t,n){var r,o=Object(u.getConfig)(t),a=Object(u.getLicense)(t),i=Object(p.getCurrentUser)(t),s=e(t,n.reactions);r=cr.a.has(n.emojiName)?cr.d[cr.a.get(n.emojiName)]:Object(zc.getCustomEmojisByName)(t).get(n.emojiName);var c="";r&&(c=Object(Er.getEmojiImageUrl)(r));var l=Object(d.getChannel)(t,n.post.channel_id)||{},f=0!==l.delete_at,m=l.team_id,h=!1,b=!1;return f||(h=Pm(t,m,n.post.channel_id,l.name,o,a,i,Tp.a.REMOVE_REACTION),b=Pm(t,m,n.post.channel_id,l.name,o,a,i,Tp.a.ADD_REACTION)),{profiles:s,otherUsersCount:n.reactions.length-s.length,currentUserId:Object(p.getCurrentUserId)(t),reactionCount:n.reactions.length,canAddReaction:h,canRemoveReaction:b,emojiImageUrl:c}}},function(e){return{actions:Object(o.bindActionCreators)({addReaction:q.a,removeReaction:A.removeReaction,getMissingProfilesByIds:i.getMissingProfilesByIds},e)}})(Sm);function Tm(e){return(Tm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function km(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Nm(e){return(Nm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Rm(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Mm(e,t){return(Mm=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Im(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var xm=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=Nm(t).call(this,e),n=!o||"object"!==Tm(o)&&"function"!=typeof o?Rm(r):o,Im(Rm(n),"getTarget",function(){return n.refs.addReactionButton}),Im(Rm(n),"handleEmojiClick",function(e){n.setState({showEmojiPicker:!1});var t=e.name||e.aliases[0];n.props.actions.addReaction(n.props.post.id,t)}),Im(Rm(n),"hideEmojiPicker",function(){n.setState({showEmojiPicker:!1})}),Im(Rm(n),"toggleEmojiPicker",function(){n.setState({showEmojiPicker:!n.state.showEmojiPicker})}),n.state={showEmojiPicker:!1},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Mm(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"componentDidUpdate",value:function(e){this.props.reactions!==e.reactions&&Object(T.k)()&&this.props.actions.scrollPostList()}},{key:"render",value:function(){var e=this,t=new Map,n=[];if(this.props.reactions)for(var r=0,o=Object.values(this.props.reactions);r<o.length;r++){var a=o[r],i=a.emoji_name;t.has(i)?t.get(i).push(a):(n.push(i),t.set(i,[a]))}if(0===t.size)return null;var s=n.map(function(n){return _.a.createElement(jm,{key:n,post:e.props.post,emojiName:n,reactions:t.get(n)||[]})}),c=this.getTarget(),l=15;c&&(l=window.innerWidth-c.getBoundingClientRect().right-260)<0&&(l=15);var u=null;if(this.props.enableEmojiPicker){var p=_.a.createElement(El.a,{id:"addReactionTooltip"},_.a.createElement(Y.c,{id:"reaction_list.addReactionTooltip",defaultMessage:"Add reaction"}));u=_.a.createElement("span",{className:"emoji-picker__container"},_.a.createElement(Eo,{show:this.state.showEmojiPicker,target:this.getTarget,onHide:this.hideEmojiPicker,onEmojiClose:this.hideEmojiPicker,onEmojiClick:this.handleEmojiClick,rightOffset:l,topOffset:-5}),_.a.createElement(vl.a,{placement:"top",delayShow:P.Q.OVERLAY_TIME_DELAY,overlay:p},_.a.createElement(Lp,{channelId:this.props.post.channel_id,teamId:this.props.teamId,permissions:[Tp.a.ADD_REACTION]},_.a.createElement("button",{"aria-label":Object(T.ab)("reaction.add.ariaLabel","add reaction"),className:"style--none post-reaction",onClick:this.toggleEmojiPicker},_.a.createElement("span",{id:"addReaction-".concat(this.props.post.id),className:"post-reaction__add",ref:"addReactionButton"},"+")))))}var f="post-add-reaction";return this.state.showEmojiPicker&&(f+=" post-add-reaction-emoji-picker-open"),_.a.createElement("div",{"aria-label":Object(T.ab)("reaction.container.ariaLabel","reactions"),className:"post-reaction-list"},s,_.a.createElement("div",{className:f},u))}}])&&km(n.prototype,r),o&&km(n,o),t}();Im(xm,"propTypes",{post:v.a.object.isRequired,teamId:v.a.string,reactions:v.a.object,enableEmojiPicker:v.a.bool.isRequired,actions:v.a.shape({addReaction:v.a.func.isRequired,scrollPostList:v.a.func.isRequired})});var Am=Object(r.connect)(function(){var e=Object(ea.makeGetReactionsForPost)();return function(t,n){var r="true"===Object(u.getConfig)(t).EnableEmojiPicker&&!n.isReadOnly;return{teamId:(Object(d.getChannel)(t,n.post.channel_id)||{}).team_id,reactions:e(t,n.post.id),enableEmojiPicker:r}}},function(e){return{actions:Object(o.bindActionCreators)({addReaction:q.a,scrollPostList:Oo.j},e)}})(xm),Lm=n(1654);function Dm(e){return(Dm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Um(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qm(e){return(qm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Hm(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Fm(e,t){return(Fm=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Bm(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Gm=600,Vm=200,Wm=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=qm(t).call(this,e),n=!o||"object"!==Dm(o)&&"function"!=typeof o?Hm(r):o,Bm(Hm(n),"toggleCollapse",function(e){e.preventDefault(),n.setState(function(e){return{isCollapsed:!e.isCollapsed}})}),Bm(Hm(n),"checkTextOverflow",function(){n.overflowRef&&window.cancelAnimationFrame(n.overflowRef),n.overflowRef=window.requestAnimationFrame(function(){var e=n.refs.textContainer,t=!1;e&&e.scrollHeight>n.maxHeight&&(t=!0),t!==n.state.isOverflow&&n.setState({isOverflow:t})})}),Bm(Hm(n),"handleResize",function(){n.checkTextOverflow()}),n.maxHeight=n.props.isAttachmentText?Vm:Gm,n.state={isCollapsed:!0,isOverflow:!1},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fm(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"componentDidMount",value:function(){this.checkTextOverflow(),window.addEventListener("resize",this.handleResize)}},{key:"componentDidUpdate",value:function(e){this.props.text===e.text&&this.props.isRHSExpanded===e.isRHSExpanded&&this.props.isRHSOpen===e.isRHSOpen&&this.props.checkOverflow===e.checkOverflow||this.checkTextOverflow()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleResize),this.overflowRef&&window.cancelAnimationFrame(this.overflowRef)}},{key:"render",value:function(){var e,t=this.state,n=t.isCollapsed,r=t.isOverflow,o=this.props,a=o.children,i=o.isAttachmentText,s=o.compactDisplay,c="post-message";n?(e=this.maxHeight,c+=" post-message--collapsed"):c+=" post-message--expanded";var l="post-collapse__gradient",u="post-collapse__show-more";i&&(l="post-attachment-collapse__gradient",u="post-attachment-collapse__show-more");var p=null;if(r){!i&&n&&s&&(e-=22);var f="fa fa-angle-up",d=Object(T.ab)("post_info.message.show_less","Show Less");n&&(f="fa fa-angle-down",d=Object(T.ab)("post_info.message.show_more","Show More")),p=_.a.createElement("div",{className:"post-collapse"},_.a.createElement("div",{id:"collapseGradient",className:l}),_.a.createElement("div",{className:u},_.a.createElement("div",{className:"post-collapse__show-more-line"}),_.a.createElement("button",{id:"showMoreButton",className:"post-collapse__show-more-button",onClick:this.toggleCollapse},_.a.createElement("span",{className:f}),d),_.a.createElement("div",{className:"post-collapse__show-more-line"}))),c+=" post-message--overflow"}return _.a.createElement("div",{className:c},_.a.createElement("div",{style:{maxHeight:e},className:"post-message__text-container",ref:"textContainer"},a),p)}}])&&Um(n.prototype,r),o&&Um(n,o),t}();Bm(Wm,"propTypes",{children:v.a.node,checkOverflow:v.a.number,isAttachmentText:v.a.bool,isRHSExpanded:v.a.bool.isRequired,isRHSOpen:v.a.bool.isRequired,text:v.a.string,compactDisplay:v.a.bool.isRequired});var Km=Object(r.connect)(function(e){return{isRHSExpanded:Object(Nc.a)(e),isRHSOpen:Object(Nc.c)(e),compactDisplay:Object(l.get)(e,P.z.CATEGORY_DISPLAY_SETTINGS,P.z.MESSAGE_DISPLAY,P.z.MESSAGE_DISPLAY_DEFAULT)===P.z.MESSAGE_DISPLAY_COMPACT}})(Wm);function zm(e){return(zm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ym(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Qm(e,t){return!t||"object"!==zm(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Zm(e){return(Zm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Jm(e,t){return(Jm=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Xm=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Qm(this,Zm(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Jm(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.action,n=e.handleAction;return _.a.createElement("button",{"data-action-id":t.id,"data-action-cookie":t.cookie,key:t.id,onClick:n},_.a.createElement(Co.a,{message:t.name,options:{mentionHighlight:!1,markdown:!1,autolinkedUrlSchemes:[]}}))}}])&&Ym(n.prototype,r),o&&Ym(n,o),t}();!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Xm,"propTypes",{action:v.a.object.isRequired,handleAction:v.a.func.isRequired});var $m=n(1750),eh=n(1675),th=n(1751),nh=n(1752);function rh(e){return(rh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function oh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ah(e){return(ah=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ih(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sh(e,t){return(sh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ch(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var lh=function(e){function t(e){var n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=ah(t).call(this,e),n=!o||"object"!==rh(o)&&"function"!=typeof o?ih(r):o,ch(ih(n),"handleSelected",function(e){if(e){var t=n.props.action,r="",o="";"users"===t.data_source?(o=e.username,r=e.id):"channels"===t.data_source?(o=e.display_name,r=e.id):(o=e.text,r=e.value),n.props.actions.selectAttachmentMenuAction(n.props.postId,n.props.action.id,n.props.action.cookie,n.props.action.data_source,o,r),n.setState({value:o})}});var a,i=e.action;n.providers=[],i&&("users"===i.data_source?n.providers=[new eh.a]:"channels"===i.data_source?n.providers=[new th.a]:i.options&&(n.providers=[new $m.a(i.options)]));var s="";return i.default_option&&i.options&&(s=(a=i.options.find(function(e){return e.value===i.default_option}))?a.text:""),n.state={selected:a,value:s},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&sh(e,t)}(t,_.a.PureComponent),n=t,o=[{key:"getDerivedStateFromProps",value:function(e,t){return e.selected&&e.selected!==t.selected?{value:e.selected.text,selected:e.selected}:null}}],(r=[{key:"render",value:function(){var e=this.props.action;return _.a.createElement(nh.a,{providers:this.providers,onSelected:this.handleSelected,placeholder:e.name,inputClassName:"post-attachment-dropdown",value:this.state.value})}}])&&oh(n.prototype,r),o&&oh(n,o),t}();ch(lh,"propTypes",{postId:v.a.string.isRequired,action:v.a.object.isRequired,selected:v.a.object,actions:v.a.shape({selectAttachmentMenuAction:v.a.func.isRequired}).isRequired});var uh=Object(r.connect)(function(e,t){var n=e.views.posts.menuActions[t.postId];return{selected:n&&n[t.action&&t.action.id]}},function(e){return{actions:Object(o.bindActionCreators)({selectAttachmentMenuAction:W},e)}})(lh),ph=n(829);function fh(e){return(fh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function mh(e,t){return!t||"object"!==fh(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function hh(e){return(hh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function bh(e,t){return(bh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var yh=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),mh(this,hh(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bh(e,t)}(t,ph["a"]),n=t,(r=[{key:"link",value:function(e,t,n){var r=e;Object(ss.c)(e)||(r="http://".concat(r));var o='<a class="theme markdown__link" href="'.concat(r,'" target="_blank"');return t&&(o+=' title="'+t+'"'),o+=">".concat(n,"</a>")}}])&&dh(n.prototype,r),o&&dh(n,o),t}();function gh(e){return(gh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Eh(e){return(Eh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Oh(e,t){return(Oh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function wh(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ch=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=Eh(t).call(this,e),n=!o||"object"!==gh(o)&&"function"!=typeof o?_h(r):o,wh(_h(n),"handleHeightReceivedForThumbUrl",function(e){var t=e.height,r=n.props.attachment;(!n.props.imagesMetadata||n.props.imagesMetadata&&!n.props.imagesMetadata[r.thumb_url])&&n.handleHeightReceived(t)}),wh(_h(n),"handleHeightReceivedForImageUrl",function(e){var t=e.height,r=n.props.attachment;(!n.props.imagesMetadata||n.props.imagesMetadata&&!n.props.imagesMetadata[r.image_url])&&n.handleHeightReceived(t)}),wh(_h(n),"handleHeightReceived",function(e){n.mounted&&e>0&&n.setState(function(e){return{checkOverflow:e.checkOverflow+1}})}),wh(_h(n),"renderPostActions",function(){var e=n.props.attachment.actions;if(!e||!e.length)return"";var t=[];return e.forEach(function(e){if(e.id&&e.name)switch(e.type){case"select":t.push(_.a.createElement(uh,{key:e.id,postId:n.props.postId,action:e}));break;case"button":default:t.push(_.a.createElement(Xm,{key:e.id,action:e,handleAction:n.handleAction}))}}),_.a.createElement("div",{className:"attachment-actions"},t)}),wh(_h(n),"handleAction",function(e){e.preventDefault();var t=e.currentTarget.getAttribute("data-action-id"),r=e.currentTarget.getAttribute("data-action-cookie");n.props.actions.doPostActionWithCookie(n.props.postId,t,r)}),wh(_h(n),"getFieldsTable",function(){var e=n.props.attachment.fields;if(!e||!e.length)return"";var t=[],r=[],o=[],a=0,i=!1,s=0,c={markdown:!1,mentionHighlight:!1};return e.forEach(function(e,n){(2===a||!0!==e.short||i)&&(t.push(_.a.createElement("table",{className:"attachment-fields",key:"attachment__table__"+s},_.a.createElement("thead",null,_.a.createElement("tr",null,r)),_.a.createElement("tbody",null,_.a.createElement("tr",null,o)))),r=[],o=[],a=0,s+=1,i=!1),r.push(_.a.createElement("th",{className:"attachment-field__caption",key:"attachment__field-caption-"+n+"__"+s,width:"50%"},_.a.createElement(Co.a,{message:e.title,options:c}))),o.push(_.a.createElement("td",{className:"attachment-field",key:"attachment__field-"+n+"__"+s},_.a.createElement(Co.a,{message:e.value}))),a+=1,i=!(!0===e.short)}),r.length>0&&t.push(_.a.createElement("table",{className:"attachment-fields",key:"attachment__table__"+s},_.a.createElement("thead",null,_.a.createElement("tr",null,r)),_.a.createElement("tbody",null,_.a.createElement("tr",null,o)))),_.a.createElement("div",null,t)}),n.state={checkOverflow:0},n.imageProps={onImageLoaded:n.handleHeightReceived},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Oh(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"componentDidMount",value:function(){this.mounted=!0}},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"render",value:function(){var e,t=this,n=this.props,r=n.attachment,o=n.options,a="";r.pretext&&(a="attachment--pretext",e=_.a.createElement("div",{className:"attachment__thumb-pretext"},_.a.createElement(Co.a,{message:r.pretext})));var i,s,c,l,u=[];if((r.author_name||r.author_icon)&&(r.author_icon&&u.push(_.a.createElement(Lm.a,{key:"attachment__author-icon",src:r.author_icon,imageMetadata:this.props.imagesMetadata[r.author_icon]},function(e){return _.a.createElement("img",{alt:"attachment author icon",className:"attachment__author-icon",src:e,height:"14",width:"14"})})),r.author_name&&u.push(_.a.createElement("span",{className:"attachment__author-name",key:"attachment__author-name"},r.author_name))),r.author_link&&Object(ss.f)(r.author_link)&&(u=_.a.createElement("a",{href:r.author_link,target:"_blank",rel:"noopener noreferrer"},u)),r.title&&(i=r.title_link&&Object(ss.f)(r.title_link)?_.a.createElement("h1",{className:"attachment__title"},_.a.createElement("a",{className:"attachment__title-link",href:r.title_link,target:"_blank",rel:"noopener noreferrer"},r.title)):_.a.createElement("h1",{className:"attachment__title"},_.a.createElement(Co.a,{message:r.title,options:{mentionHighlight:!1,renderer:new yh,autolinkedUrlSchemes:[]}}))),r.text&&(s=_.a.createElement(Km,{checkOverflow:this.state.checkOverflow,isAttachmentText:!0,text:r.text},_.a.createElement(Co.a,{message:r.text||"",options:o,imageProps:this.imageProps}))),r.image_url){var p=this.props.imagesMetadata[r.image_url];c=_.a.createElement("div",{className:"attachment__image-container"},_.a.createElement(Lm.a,{src:r.image_url,imageMetadata:p},function(e){return _.a.createElement(hf.a,{className:"attachment__image",onImageLoaded:t.handleHeightReceivedForImageUrl,src:e,dimensions:p})}))}if(r.thumb_url){var f=this.props.imagesMetadata[r.thumb_url];l=_.a.createElement("div",{className:"attachment__thumb-container"},_.a.createElement(Lm.a,{src:r.thumb_url,imageMetadata:f},function(e){return _.a.createElement(hf.a,{onImageLoaded:t.handleHeightReceivedForThumbUrl,src:e,dimensions:f})}))}var d,m=this.getFieldsTable(),h=this.renderPostActions();return r.color&&"#"===r.color[0]&&(d={borderLeftColor:r.color}),_.a.createElement("div",{className:"attachment "+a,ref:"attachment"},e,_.a.createElement("div",{className:"attachment__content"},_.a.createElement("div",{className:d?"clearfix attachment__container":"clearfix attachment__container attachment__container--"+r.color,style:d},u,i,_.a.createElement("div",null,_.a.createElement("div",{className:l?"attachment__body":"attachment__body attachment__body--no_thumb",onClick:T.G},s,c,m,h),l,_.a.createElement("div",{style:Sh.footer})))))}}])&&vh(n.prototype,r),o&&vh(n,o),t}();wh(Ch,"propTypes",{postId:v.a.string.isRequired,attachment:v.a.object.isRequired,options:v.a.object,imagesMetadata:v.a.object,actions:v.a.shape({doPostActionWithCookie:v.a.func.isRequired}).isRequired});var Sh={footer:{clear:"both"}};var Ph=Object(r.connect)(null,function(e){return{actions:Object(o.bindActionCreators)({doPostActionWithCookie:A.doPostActionWithCookie},e)}})(Ch);function jh(e){return(jh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Th(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function kh(e,t){return!t||"object"!==jh(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Nh(e){return(Nh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Rh(e,t){return(Rh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Mh(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ih=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),kh(this,Nh(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Rh(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e=this,t=[];return this.props.attachments.forEach(function(n,r){t.push(_.a.createElement(Ph,{attachment:n,postId:e.props.postId,key:"att_"+r,options:e.props.options,imagesMetadata:e.props.imagesMetadata}))}),_.a.createElement("div",{id:"messageAttachmentList_".concat(this.props.postId),className:"attachment__list"},t)}}])&&Th(n.prototype,r),o&&Th(n,o),t}();function xh(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"x",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"y";return Math.sqrt(Math.pow(e[n]-t[n],2)+Math.pow(e[r]-t[r],2))}function Ah(e){return(Ah="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Lh(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function Dh(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){Lh(a,r,o,i,s,"next",e)}function s(e){Lh(a,r,o,i,s,"throw",e)}i(void 0)})}}function Uh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qh(e){return(qh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Hh(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Fh(e,t){return(Fh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Bh(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Mh(Ih,"propTypes",{postId:v.a.string.isRequired,attachments:v.a.array.isRequired,options:v.a.object,imagesMetadata:v.a.object}),Mh(Ih,"defaultProps",{imagesMetadata:{}});var Gh={height:80,width:80},Vh=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=qh(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==Ah(o)&&"function"!=typeof o?Hh(r):o,Bh(Hh(n),"getImageMetadata",function(e){if(!e)return null;var t=n.props.post.metadata.images;return t?t[e]:null}),Bh(Hh(n),"isLargeImage",function(e){if(!e)return!1;var t=e.height,n=e.width;return n>=150&&n/t>=16/9}),Bh(Hh(n),"handleRemovePreview",Dh(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(t=Object.assign({},n.props.post.props))[P.y.REMOVE_LINK_PREVIEW]="true",r={id:n.props.post.id,props:t},e.abrupt("return",n.props.actions.editPost(r));case 4:case"end":return e.stop()}},e)}))),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fh(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"renderImageToggle",value:function(){return _.a.createElement("button",{className:"style--none post__embed-visibility color--link","data-expanded":this.props.isEmbedVisible,"aria-label":"Toggle Embed Visibility",onClick:this.props.toggleEmbedVisibility})}},{key:"renderLargeImage",value:function(e,t){return this.props.isEmbedVisible?_.a.createElement(Lm.a,{src:e,imageMetadata:t},function(e){return _.a.createElement(hf.a,{className:"attachment__image attachment__image--opengraph large_image",src:e,dimensions:t})}):null}},{key:"renderSmallImage",value:function(e,t){return this.props.isEmbedVisible?_.a.createElement("div",{className:"attachment__image__container--opengraph"},_.a.createElement(Lm.a,{src:e,imageMetadata:t},function(e){return _.a.createElement(hf.a,{className:"attachment__image attachment__image--opengraph",src:e,dimensions:t})})):null}},{key:"truncateText",value:function(e){return e&&e.length>300?e.substring(0,300-"...".length)+"...":e}},{key:"hasPreviewBeenRemoved",value:function(){var e=this.props.post;return!(!e||!e.props)&&"true"===e.props[P.y.REMOVE_LINK_PREVIEW]}},{key:"render",value:function(){if(!this.props.previewEnabled||!this.props.enableLinkPreviews)return null;if(!this.props.post||Object(Et.m)(this.props.post))return null;if(this.hasPreviewBeenRemoved())return null;var e=this.props.openGraphData;if(!e)return null;var t,n,r=function(e,t){if(!e||!e.images||0===e.images.length)return null;var n=e.images.map(function(e){var n=e.secure_url||e.url;return e.width&&e.height||!t||!t[n]?e:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){Bh(e,t,n[t])})}return e}({},e,{height:e.height||t[n].height,width:e.width||t[n].width})}),r=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"x",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"y",o={},a=!0,i=!1,s=void 0;try{for(var c,l=t[Symbol.iterator]();!(a=(c=l.next()).done);a=!0){var u=c.value;void 0===o[n]||void 0===o[r]?o=u:xh(u,e,n,r)<xh(o,e,n,r)&&(o=u)}}catch(e){i=!0,s=e}finally{try{a||null==l.return||l.return()}finally{if(i)throw s}}return o}(Gh,n,"width","height");return r.secure_url||r.url}(e,this.props.post.metadata.images),o=this.getImageMetadata(r),a=this.isLargeImage(o);return this.props.currentUserId===this.props.post.user_id&&(t=_.a.createElement("button",{id:"removePreviewButton",type:"button",className:"btn-close","aria-label":"Close",onClick:this.handleRemovePreview},_.a.createElement("span",{"aria-hidden":"true"},"×"))),(e.description||r)&&(n=_.a.createElement("div",{className:"attachment__body attachment__body--opengraph"},_.a.createElement("div",null,this.truncateText(e.description)," ",r&&a&&this.renderImageToggle()),r&&a&&this.renderLargeImage(r,o))),_.a.createElement("div",{className:"attachment attachment--opengraph"},_.a.createElement("div",{className:"attachment__content"},_.a.createElement("div",{className:"clearfix attachment__container attachment__container--opengraph"},_.a.createElement("div",{className:"attachment__body__wrap attachment__body__wrap--opengraph"},_.a.createElement("span",{className:"sitename"},this.truncateText(e.site_name)),t,_.a.createElement("h1",{className:"attachment__title attachment__title--opengraph"+(e.title?"":" is-url")},_.a.createElement("a",{className:"attachment__title-link attachment__title-link--opengraph",href:Object(ss.g)(e.url||this.props.link),target:"_blank",rel:"noopener noreferrer",title:e.title||e.url||this.props.link},this.truncateText(e.title||e.url||this.props.link))),n),r&&!a&&this.renderSmallImage(r,o))))}}])&&Uh(n.prototype,r),o&&Uh(n,o),t}();Bh(Vh,"propTypes",{link:v.a.string.isRequired,currentUserId:v.a.string,post:v.a.object,openGraphData:v.a.object,enableLinkPreviews:v.a.bool.isRequired,previewEnabled:v.a.bool.isRequired,isEmbedVisible:v.a.bool,toggleEmbedVisibility:v.a.func.isRequired,actions:v.a.shape({editPost:v.a.func.isRequired}).isRequired});var Wh=Object(r.connect)(function(e,t){var n=Object(u.getConfig)(e);return{currentUserId:Object(p.getCurrentUserId)(e),enableLinkPreviews:"true"===n.EnableLinkPreviews,openGraphData:Object(ea.getOpenGraphMetadataForUrl)(e,t.link),previewEnabled:Object(l.getBool)(e,P.z.CATEGORY_DISPLAY_SETTINGS,P.z.LINK_PREVIEW_DISPLAY,!0)}},function(e){return{actions:Object(o.bindActionCreators)({editPost:V},e)}})(Vh);function Kh(e){return(Kh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Yh(e){return(Yh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Qh(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zh(e,t){return(Zh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Jh(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Xh=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=Yh(t).call(this,e),n=!o||"object"!==Kh(o)&&"function"!=typeof o?Qh(r):o,Jh(Qh(n),"showModal",function(e){e.preventDefault(),n.setState({showModal:!0})}),Jh(Qh(n),"hideModal",function(){n.setState({showModal:!1})}),n.state={showModal:!1},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Zh(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e=this;return _.a.createElement("div",{className:"post__embed-container"},_.a.createElement(Lm.a,{src:this.props.link,imageMetadata:this.props.imageMetadata},function(t){return _.a.createElement(_.a.Fragment,null,_.a.createElement(hf.a,{className:"img-div attachment__image cursor--pointer",src:t,dimensions:e.props.imageMetadata,showLoader:!0,onClick:e.showModal}),_.a.createElement(Xf,{show:e.state.showModal,onModalDismissed:e.hideModal,post:e.props.post,startIndex:0,fileInfos:[{has_preview_image:!1,link:t,extension:e.props.imageMetadata.format}]}))}))}}])&&zh(n.prototype,r),o&&zh(n,o),t}();Jh(Xh,"propTypes",{imageMetadata:v.a.object.isRequired,link:v.a.string.isRequired,post:v.a.object.isRequired});var $h=Xh,eb=n(1598),tb=n(1535);function nb(e){return(nb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rb(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ob(e){return(ob=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ab(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ib(e,t){return(ib=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var sb=/(?:http|https):\/\/(?:www\.|m\.)?(?:(?:youtube\.com\/(?:(?:v\/)|(?:(?:watch|embed\/watch)(?:\/|.*v=))|(?:embed\/)|(?:user\/[^\/]+\/u\/[0-9]\/)))|(?:youtu\.be\/))([^#&?]*)/,cb=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=ob(t).call(this,e))||"object"!==nb(o)&&"function"!=typeof o?ab(r):o).updateStateFromProps=n.updateStateFromProps.bind(ab(n)),n.handleReceivedMetadata=n.handleReceivedMetadata.bind(ab(n)),n.handleMetadataError=n.handleMetadataError.bind(ab(n)),n.loadWithoutKey=n.loadWithoutKey.bind(ab(n)),n.play=n.play.bind(ab(n)),n.stop=n.stop.bind(ab(n)),n.state={loaded:!1,failed:!1,playing:!1,title:""},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ib(e,t)}(t,_.a.PureComponent),n=t,o=[{key:"isYoutubeLink",value:function(e){return e.trim().match(sb)}}],(r=[{key:"UNSAFE_componentWillMount",value:function(){this.updateStateFromProps(this.props)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.updateStateFromProps(e)}},{key:"updateStateFromProps",value:function(e){var t=e.link,n=t.trim().match(sb);n&&11===n[1].length&&(!1===e.show&&this.stop(),e.channelId!==e.currentChannelId&&this.stop(),this.setState({videoId:n[1],time:this.handleYoutubeTime(t)}))}},{key:"handleYoutubeTime",value:function(e){var t=e.match(/[\\?&](t|start|time_continue)=([0-9]+h)?([0-9]+m)?([0-9]+s?)/);if(!t||!t[0])return"";var n=t[2]?t[2].match(/([0-9]+)h/):null,r=t[3]?t[3].match(/([0-9]+)m/):null,o=t[4]?t[4].match(/([0-9]+)s?/):null,a=0;return n&&n[1]&&(a+=3600*parseInt(n[1],10)),r&&r[1]&&(a+=60*parseInt(r[1],10)),o&&o[1]&&(a+=parseInt(o[1],10)),"&start="+a.toString()}},{key:"componentDidMount",value:function(){var e=this.props.googleDeveloperKey;e?Object(eb.a)(e,this.state.videoId,this.handleReceivedMetadata,this.handleMetadataError):this.loadWithoutKey()}},{key:"loadWithoutKey",value:function(){this.setState({loaded:!0,thumb:Et.f("https://i.ytimg.com/vi/"+this.state.videoId+"/hqdefault.jpg",this.props.hasImageProxy)})}},{key:"handleMetadataError",value:function(){this.setState({failed:!0,loaded:!0,title:T.ab("youtube_video.notFound","Video not found")})}},{key:"handleReceivedMetadata",value:function(e){if(!(e&&e.items&&e.items.length&&e.items[0].snippet))return this.setState({failed:!0,loaded:!0,title:T.ab("youtube_video.notFound","Video not found")}),null;var t=e.items[0].snippet,n="https://i.ytimg.com/vi/"+this.state.videoId+"/hqdefault.jpg";return"live"===t.liveBroadcastContent&&(n="https://i.ytimg.com/vi/"+this.state.videoId+"/hqdefault_live.jpg"),this.setState({loaded:!0,receivedYoutubeData:!0,title:t.title,thumb:Et.f(n,this.props.hasImageProxy)}),null}},{key:"play",value:function(){this.setState({playing:!0})}},{key:"stop",value:function(){this.setState({playing:!1})}},{key:"render",value:function(){return this.state.loaded?(this.state.title&&(e=_.a.createElement("h4",null,_.a.createElement("span",{className:"video-type"},"YouTube - "),_.a.createElement("span",{className:"video-title"},_.a.createElement("a",{href:this.props.link,target:"blank",rel:"noopener noreferrer"},this.state.title)))),t=this.state.failed?_.a.createElement("div",null,_.a.createElement("div",{className:"video-thumbnail__container"},_.a.createElement("div",{className:"video-thumbnail__error"},_.a.createElement("div",null,_.a.createElement(tb.a,{additionalClassName:"fa-2x"})),_.a.createElement("div",null,T.ab("youtube_video.notFound","Video not found"))))):this.state.playing?_.a.createElement("iframe",{src:"https://www.youtube.com/embed/"+this.state.videoId+"?autoplay=1&autohide=1&border=0&wmode=opaque&fs=1&enablejsapi=1"+this.state.time,width:"480px",height:"360px",type:"text/html",frameBorder:"0",allowFullScreen:"allowfullscreen"}):_.a.createElement("div",{className:"embed-responsive embed-responsive-4by3 video-div__placeholder"},_.a.createElement("div",{className:"video-thumbnail__container"},_.a.createElement("img",{alt:"youtube video thumbnail",className:"video-thumbnail",src:this.state.thumb}),_.a.createElement("div",{className:"block"},_.a.createElement("span",{className:"play-button"},_.a.createElement("span",null))))),_.a.createElement("div",{className:"post__embed-container"},_.a.createElement("div",null,e,_.a.createElement("div",{className:"video-div embed-responsive-item",onClick:this.play},t)))):_.a.createElement("div",{className:"post__embed-container"},_.a.createElement("div",{className:"video-loading"}));var e,t}}])&&rb(n.prototype,r),o&&rb(n,o),t}();!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(cb,"propTypes",{channelId:v.a.string.isRequired,currentChannelId:v.a.string.isRequired,hasImageProxy:v.a.bool.isRequired,link:v.a.string.isRequired,show:v.a.bool.isRequired,googleDeveloperKey:v.a.string});var lb=Object(r.connect)(function(e){var t=Object(u.getConfig)(e);return{currentChannelId:Object(d.getCurrentChannelId)(e),googleDeveloperKey:t.GoogleDeveloperKey,hasImageProxy:"true"===t.HasImageProxy}})(cb);function ub(e){return(ub="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pb(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fb(e){return(fb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function db(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mb(e,t){return(mb=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function hb(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var bb=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=fb(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==ub(o)&&"function"!=typeof o?db(r):o,hb(db(n),"toggleEmbedVisibility",function(){n.props.actions.toggleEmbedVisibility(n.props.post.id)}),hb(db(n),"getEmbed",function(){var e=n.props.post.metadata;return e&&e.embeds&&0!==e.embeds.length?e.embeds[0]:null}),hb(db(n),"isEmbedToggleable",function(e){return"image"===e.type||"opengraph"===e.type&&lb.isYoutubeLink(e.url)}),hb(db(n),"renderEmbed",function(e){switch(e.type){case"image":return n.props.isEmbedVisible?_.a.createElement($h,{imageMetadata:n.props.post.metadata.images[e.url],link:e.url,post:n.props.post}):null;case"message_attachment":var t=[];return n.props.post.props&&n.props.post.props.attachments&&(t=n.props.post.props.attachments),_.a.createElement(Ih,{attachments:t,postId:n.props.post.id,options:n.props.options,imagesMetadata:n.props.post.metadata.images});case"opengraph":return lb.isYoutubeLink(e.url)?n.props.isEmbedVisible?_.a.createElement(lb,{channelId:n.props.post.channel_id,link:e.url,show:n.props.isEmbedVisible}):null:_.a.createElement(Wh,{link:e.url,isEmbedVisible:n.props.isEmbedVisible,post:n.props.post,toggleEmbedVisibility:n.toggleEmbedVisibility});default:return null}}),hb(db(n),"renderToggle",function(e){return _.a.createElement("button",{key:"toggle",className:"style--none post__embed-visibility color--link ".concat(e?"pull-left":""),"data-expanded":n.props.isEmbedVisible,"aria-label":"Toggle Embed Visibility",onClick:n.toggleEmbedVisibility})}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mb(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e=this.getEmbed();if(e){var t=this.isEmbedToggleable(e),n=/^\s*https?:\/\/.*$/.test(this.props.post.message);return _.a.createElement("div",null,t&&n&&this.renderToggle(!0),this.props.children,t&&!n&&this.renderToggle(!1),this.renderEmbed(e))}return this.props.children}}])&&pb(n.prototype,r),o&&pb(n,o),t}();hb(bb,"propTypes",{post:v.a.object.isRequired,children:v.a.element,isEmbedVisible:v.a.bool,options:v.a.object,actions:v.a.shape({toggleEmbedVisibility:v.a.func.isRequired}).isRequired});var yb=Object(r.connect)(function(e,t){return{isEmbedVisible:Object(K.b)(e,t.post.id)}},function(e){return{actions:Object(o.bindActionCreators)({toggleEmbedVisibility:q.k},e)}})(bb);function gb(e){return(gb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vb(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Eb(e){return(Eb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ob(e,t){return(Ob=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function wb(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Cb=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=Eb(t).call(this,e),n=!o||"object"!==gb(o)&&"function"!=typeof o?_b(r):o,wb(_b(n),"handleHeightReceived",function(e){e>0&&n.setState(function(e){return{checkOverflow:e.checkOverflow+1}})}),n.state={collapse:!0,hasOverflow:!1,checkOverflow:0},n.imageProps={onImageLoaded:n.handleHeightReceived},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ob(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"renderDeletedPost",value:function(){return _.a.createElement("p",null,_.a.createElement(Y.c,{id:"post_body.deleted",defaultMessage:"(message deleted)"}))}},{key:"renderEditedIndicator",value:function(){return Et.j(this.props.post)?_.a.createElement("span",{id:"postEdited_".concat(this.props.post.id),className:"post-edited__indicator"},_.a.createElement(Y.c,{id:"post_message_view.edited",defaultMessage:"(edited)"})):null}},{key:"render",value:function(){var e=this.props,t=e.post,n=e.enableFormatting,r=e.options,o=e.pluginPostTypes,a=e.compactDisplay,i=e.isRHS,s=e.theme;if(t.state===L.Posts.POST_DELETED)return this.renderDeletedPost();if(!n)return _.a.createElement("span",null,t.message);var c=t.props&&t.props.type?t.props.type:t.type;if(o.hasOwnProperty(c)){var l=o[c].component;return _.a.createElement(l,{post:t,compactDisplay:a,isRHS:i,theme:s})}var u=t.message,p=T.V(t);if(a&&p){var f=T.ab("post_info.message.visible.compact"," (Only visible to you)");u=u.concat(f)}return _.a.createElement(Km,{checkOverflow:this.state.checkOverflow,text:u},_.a.createElement("div",{"aria-readonly":"true",tabIndex:"0",id:"postMessageText_".concat(t.id),className:"post-message__text",onClick:T.G},_.a.createElement(Ca,{message:u,imageProps:this.imageProps,isRHS:i,options:r,post:t,channelId:t.channel_id})),this.renderEditedIndicator(),_.a.createElement(I.a,{pluggableName:"PostMessageAttachment",postId:t.id,onHeightChange:this.handleHeightReceived}))}}])&&vb(n.prototype,r),o&&vb(n,o),t}();wb(Cb,"propTypes",{post:v.a.object.isRequired,enableFormatting:v.a.bool,options:v.a.object,compactDisplay:v.a.bool,isRHS:v.a.bool,isRHSOpen:v.a.bool,isRHSExpanded:v.a.bool,theme:v.a.object.isRequired,pluginPostTypes:v.a.object}),wb(Cb,"defaultProps",{options:{},isRHS:!1,pluginPostTypes:{}});var Sb=Object(r.connect)(function(e){return{enableFormatting:Object(l.getBool)(e,L.Preferences.CATEGORY_ADVANCED_SETTINGS,"formatting",!0),isRHSExpanded:Object(Nc.a)(e),isRHSOpen:Object(Nc.c)(e),pluginPostTypes:e.plugins.postTypes,theme:Object(l.getTheme)(e)}})(Cb);function Pb(e){var t=e.post,n=e.previewCollapsed,r=e.previewEnabled,o=e.isEmbedVisible,a=e.pluginPostTypes,i=t.type&&a.hasOwnProperty(t.type),s=_.a.createElement(Sb,{post:t,isRHS:!0,hasMention:!0});return t.state===L.Posts.POST_DELETED||i?s:_.a.createElement(yb,{post:t,previewCollapsed:n,previewEnabled:r,isEmbedVisible:o},s)}var jb=n(1676);function Tb(e){return(Tb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kb(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Nb(e,t){return!t||"object"!==Tb(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Rb(e){return(Rb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Mb(e,t){return(Mb=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ib=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Nb(this,Rb(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Mb(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){return _.a.createElement("span",this.props,_.a.createElement(Y.c,{id:"generic_icons.info",defaultMessage:"Info Icon"},function(e){return _.a.createElement("svg",{className:"svg-text-color","aria-label":e,width:"24px",height:"24px",viewBox:"0 0 24 24",version:"1.1"},_.a.createElement("g",{stroke:"none",strokeWidth:"1",fill:"inherit",fillRule:"evenodd"},_.a.createElement("g",{transform:"translate(-1015.000000, -516.000000)",fill:"inherit"},_.a.createElement("path",{d:"M1027,540 C1020.37258,540 1015,534.627417 1015,528 C1015,521.372583 1020.37258,516 1027,516 C1033.62742,516 1039,521.372583 1039,528 C1039,534.627417 1033.62742,540 1027,540 Z M1027,527 C1025.89543,527 1025,527.895431 1025,529 L1025,533 C1025,534.104569 1025.89543,535 1027,535 C1028.10457,535 1029,534.104569 1029,533 L1029,529 C1029,527.895431 1028.10457,527 1027,527 Z M1027,525 C1028.10457,525 1029,524.104569 1029,523 C1029,521.895431 1028.10457,521 1027,521 C1025.89543,521 1025,521.895431 1025,523 C1025,524.104569 1025.89543,525 1027,525 Z"}))))}))}}])&&kb(n.prototype,r),o&&kb(n,o),t}(),xb=n(1731);function Ab(e){return(Ab="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Lb(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Db(e){return(Db=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ub(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qb(e,t){return(qb=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Hb(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Fb=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=Db(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==Ab(o)&&"function"!=typeof o?Ub(r):o,Hb(Ub(n),"hideProfilePopover",function(){n.refs.overlay.hide()}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qb(e,t)}(t,E["PureComponent"]),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.disablePopover,n=e.displayName,r=e.isBusy,o=e.isRHS,a=e.hasMention,i=e.hideStatus,s=e.overwriteName,c=e.user,l=e.userId,u=s||n||"...";if(t)return _.a.createElement("div",{className:"user-popover"},u);var p="right";o&&!Object(T.U)()&&(p="left");var f="";return c&&(f=Object(T.J)(c)),_.a.createElement(_.a.Fragment,null,_.a.createElement(vl.a,{ref:"overlay",trigger:"click",placement:p,rootClose:!0,overlay:_.a.createElement(xb.a,{userId:l,src:f,isBusy:r,hide:this.hideProfilePopover,hideStatus:i,isRHS:o,hasMention:a})},_.a.createElement("button",{"aria-label":u.toLowerCase(),className:"user-popover style--none"},u)),_.a.createElement(ka.a,{show:Boolean(c&&c.is_bot),className:"badge-popoverlist"}))}}])&&Lb(n.prototype,r),o&&Lb(n,o),t}();Hb(Fb,"propTypes",{disablePopover:v.a.bool,displayName:v.a.string,hasMention:v.a.bool,hideStatus:v.a.bool,isBusy:v.a.bool,isRHS:v.a.bool,overwriteName:v.a.node,user:v.a.object,userId:v.a.string}),Hb(Fb,"defaultProps",{disablePopover:!1,hasMention:!1,hideStatus:!1,isRHS:!1,overwriteImage:"",overwriteName:""});var Bb=Object(r.connect)(function(){var e=Object(p.makeGetDisplayName)();return function(t,n){return{displayName:e(t,n.userId),user:Object(p.getUser)(t,n.userId)}}})(Fb);function Gb(e){return(Gb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Vb(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Wb(e){return(Wb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Kb(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zb(e,t){return(zb=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Yb(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Qb=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=Wb(t).call(this,e),n=!o||"object"!==Gb(o)&&"function"!=typeof o?Kb(r):o,Yb(Kb(n),"removePost",function(){n.props.removePost(n.props.post)}),Yb(Kb(n),"createRemovePostButton",function(){return _.a.createElement("button",{className:"post__remove theme color--link style--none",type:"button",onClick:n.removePost},"×")}),Yb(Kb(n),"renderPostTime",function(){var e=n.props.post,t=!(L.Posts.POST_DELETED===e.state||Object(Yc.isPostPendingOrFailed)(e));return _.a.createElement(cm,{isPermalink:t,eventTime:e.create_at,postId:e.id,location:P.q.RHS_COMMENT})}),Yb(Kb(n),"toggleEmojiPicker",function(){var e=!n.state.showEmojiPicker;n.setState({showEmojiPicker:e})}),Yb(Kb(n),"getClassName",function(e,t){var r="post post--thread same--root post--comment";return n.props.currentUserId===e.user_id&&(r+=" current--user"),t&&(r+=" post--system"),n.props.compactDisplay&&(r+=" post--compact"),e.is_pinned&&(r+=" post--pinned"),(n.state.dropdownOpened||n.state.showEmojiPicker)&&(r+=" post--hovered"),n.props.isConsecutivePost&&(r+=" same--user"),r}),Yb(Kb(n),"handleDropdownOpened",function(e){n.setState({dropdownOpened:e})}),Yb(Kb(n),"getDotMenuRef",function(){return n.refs.dotMenu}),Yb(Kb(n),"setHover",function(){n.setState({hover:!0})}),Yb(Kb(n),"unsetHover",function(){n.setState({hover:!1})}),Yb(Kb(n),"handleA11yActivateEvent",function(){n.setState({a11yActive:!0})}),Yb(Kb(n),"handleA11yDeactivateEvent",function(){n.setState({a11yActive:!1})}),Yb(Kb(n),"handlePostFocus",function(){var e=n.props,t=e.post,r=e.author,o=e.reactions,a=e.isFlagged;n.setState({currentAriaLabel:Et.d(t,r,a,o,n.context.intl)})}),n.postRef=_.a.createRef(),n.state={showEmojiPicker:!1,dropdownOpened:!1,hover:!1,a11yActive:!1,currentAriaLabel:""},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zb(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"componentDidMount",value:function(){this.postRef.current&&(this.postRef.current.addEventListener(P.c.ACTIVATE,this.handleA11yActivateEvent),this.postRef.current.addEventListener(P.c.DEACTIVATE,this.handleA11yDeactivateEvent))}},{key:"componentWillUnmount",value:function(){this.postRef.current&&(this.postRef.current.removeEventListener(P.c.ACTIVATE,this.handleA11yActivateEvent),this.postRef.current.removeEventListener(P.c.DEACTIVATE,this.handleA11yDeactivateEvent))}},{key:"componentDidUpdate",value:function(){this.state.a11yActive&&this.postRef.current.dispatchEvent(new Event(P.c.UPDATE))}},{key:"render",value:function(){var e,t,n,r,o=this,a=this.props,i=a.post,s=a.isConsecutivePost,c=a.isReadOnly,l=a.channelIsArchived,u=i&&i.state===L.Posts.POST_DELETED,p=Object(Yc.isPostEphemeral)(i),f=Et.m(i),d=Et.e(i),m=null;(this.props.compactDisplay||Object(T.U)())&&(m=_.a.createElement(Bb,{userId:i.user_id,isBusy:this.props.isBusy,isRHS:!0,hasMention:!0})),s||(m=_.a.createElement(Bb,{userId:i.user_id,isBusy:this.props.isBusy,isRHS:!0,hasMention:!0}),t=_.a.createElement(Sd,{compactDisplay:this.props.compactDisplay,isBusy:this.props.isBusy,isRHS:!0,post:i,userId:i.user_id}),i.props&&i.props.from_webhook?(m=i.props.override_username&&this.props.enablePostUsernameOverride?_.a.createElement(Bb,{userId:i.user_id,hideStatus:!0,overwriteName:i.props.override_username,disablePopover:!0}):_.a.createElement(Bb,{userId:i.user_id,hideStatus:!0,disablePopover:!0}),e=_.a.createElement(ka.a,{className:"col col__name"})):d?(m=_.a.createElement("span",{className:"auto-responder"},_.a.createElement(Bb,{userId:i.user_id,hideStatus:!0,isBusy:this.props.isBusy,isRHS:!0,hasMention:!0})),e=_.a.createElement(jb.a,{className:"col col__name"},_.a.createElement(Y.c,{id:"post_info.auto_responder",defaultMessage:"AUTOMATIC REPLY"}))):f&&(m=_.a.createElement(Bb,{overwriteName:_.a.createElement(Y.c,{id:"post_info.system",defaultMessage:"System"}),overwriteImage:P.Q.SYSTEM_MESSAGE_PROFILE_IMAGE,disablePopover:!0}),n=_.a.createElement("span",{className:"post__visibility"},_.a.createElement(Y.c,{id:"post_info.message.visible",defaultMessage:"(Only visible to you)"}))));var h="";i.failed&&(h+=" post-failed",r=_.a.createElement(Id,{post:this.props.post})),Et.j(this.props.post)&&(h+=" post--edited");var b,y,g,v=null;if(i.file_ids&&i.file_ids.length>0&&(v=_.a.createElement(hd,{post:i,compactDisplay:this.props.compactDisplay})),c||p||i.failed||f||!this.props.enableEmojiPicker||l||(b=_.a.createElement(bm,{channelId:i.channel_id,postId:i.id,teamId:this.props.teamId,getDotMenuRef:this.getDotMenuRef,location:P.q.RHS_COMMENT,showEmojiPicker:this.state.showEmojiPicker,toggleEmojiPicker:this.toggleEmojiPicker})),p)y=_.a.createElement("div",{className:"col col__remove"},this.createRemovePostButton());else if(u)y=null;else if(!f&&(this.state.hover||this.state.a11yActive||this.state.dropdownOpened||this.state.showEmojiPicker)){var E=_.a.createElement(Kp,{post:this.props.post,location:P.q.RHS_COMMENT,isFlagged:this.props.isFlagged,handleDropdownOpened:this.handleDropdownOpened,handleAddReactionClick:this.toggleEmojiPicker,isReadOnly:c||l,enableEmojiPicker:this.props.enableEmojiPicker});y=_.a.createElement("div",{ref:"dotMenu",className:"col col__reply"},E,b)}i.is_pinned&&(g=_.a.createElement("span",{className:"post__pinned-badge"},_.a.createElement(Y.c,{id:"post_info.pinned",defaultMessage:"Pinned"})));var O=null;(this.state.hover||this.state.a11yActive||this.state.dropdownOpened||this.state.showEmojiPicker||this.props.isFlagged)&&(O=_.a.createElement($d,{location:P.q.RHS_COMMENT,postId:i.id,isFlagged:this.props.isFlagged,isEphemeral:p}));var w,C=this.renderPostTime();return i.props&&i.props.card&&(w=_.a.createElement(vl.a,{delayShow:P.Q.OVERLAY_TIME_DELAY,placement:"top",overlay:_.a.createElement(El.a,null,_.a.createElement(Y.c,{id:"post_info.info.view_additional_info",defaultMessage:"View additional info"}))},_.a.createElement("button",{className:"card-icon__container icon--show style--none",onClick:function(e){e.preventDefault(),o.props.handleCardClick(o.props.post)}},_.a.createElement(Ib,{className:"icon icon__info","aria-hidden":"true"})))),_.a.createElement("div",{role:"listitem",ref:this.postRef,id:"rhsPost_"+i.id,tabIndex:"-1",className:"a11y__section ".concat(this.getClassName(i,f)),onMouseOver:this.setHover,onMouseLeave:this.unsetHover,"aria-label":this.state.currentAriaLabel,onFocus:this.handlePostFocus},_.a.createElement("div",{role:"application",className:"post__content"},_.a.createElement("div",{className:"post__img"},t),_.a.createElement("div",null,_.a.createElement("div",{className:"post__header"},_.a.createElement("div",{className:"col col__name"},m,e),_.a.createElement("div",{className:"col"},C,g,w,O,n),y),_.a.createElement("div",{className:"post__body"},_.a.createElement("div",{className:h},r,_.a.createElement(Pb,{post:i,previewCollapsed:this.props.previewCollapsed,previewEnabled:this.props.previewEnabled,isEmbedVisible:this.props.isEmbedVisible,pluginPostTypes:this.props.pluginPostTypes})),v,_.a.createElement(Am,{post:i,isReadOnly:c||l})))))}}])&&Vb(n.prototype,r),o&&Vb(n,o),t}();function Zb(e,t){var n=t.post,r=t.previousPostId&&Object(ea.getPost)(e,t.previousPostId),o=!1;if(r){var a=Boolean(n.props&&n.props.from_webhook),i=Boolean(r.props&&r.props.from_webhook);!(r&&r.user_id===n.user_id&&n.create_at-r.create_at<=L.Posts.POST_COLLAPSE_TIMEOUT)||a||i||Object(Yc.isSystemMessage)(n)||Object(Yc.isSystemMessage)(r)||r.root_id!==n.root_id&&r.id!==n.root_id||(o=!0)}return o}Yb(Qb,"propTypes",{post:v.a.object,teamId:v.a.string.isRequired,currentUserId:v.a.string.isRequired,compactDisplay:v.a.bool,author:v.a.string,reactions:v.a.object,isFlagged:v.a.bool,isBusy:v.a.bool,removePost:v.a.func.isRequired,previewCollapsed:v.a.string.isRequired,previewEnabled:v.a.bool.isRequired,isEmbedVisible:v.a.bool,enableEmojiPicker:v.a.bool.isRequired,enablePostUsernameOverride:v.a.bool.isRequired,isReadOnly:v.a.bool.isRequired,pluginPostTypes:v.a.object,channelIsArchived:v.a.bool.isRequired,isConsecutivePost:v.a.bool,handleCardClick:v.a.func}),Yb(Qb,"contextTypes",{intl:Y.i.isRequired});var Jb=Object(r.connect)(function(e,t){var n=Object(ea.makeGetReactionsForPost)(),r=Object(p.makeGetDisplayName)(),o=Object(u.getConfig)(e),a="true"===o.EnableEmojiPicker,i="true"===o.EnablePostUsernameOverride,s=t.teamId||Object(f.getCurrentTeamId)(e),c=e.entities.channels.channels[t.post.channel_id];return{author:r(e,t.post.user_id),reactions:n(e,t.post.id),enableEmojiPicker:a,enablePostUsernameOverride:i,isEmbedVisible:Object(K.b)(e,t.post.id),isReadOnly:Object(d.isChannelReadOnlyById)(e,t.post.channel_id),teamId:s,pluginPostTypes:e.plugins.postTypes,channelIsArchived:0!==c.delete_at,isConsecutivePost:Zb(e,t),isFlagged:null!=Object(l.get)(e,P.z.CATEGORY_FLAGGED_POST,t.post.id,null),compactDisplay:Object(l.get)(e,P.z.CATEGORY_DISPLAY_SETTINGS,P.z.MESSAGE_DISPLAY,P.z.MESSAGE_DISPLAY_DEFAULT)===P.z.MESSAGE_DISPLAY_COMPACT}})(Qb);function Xb(e){return(Xb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ey(e){return(ey=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ty(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ny(e,t){return(ny=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ry(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var oy=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=ey(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==Xb(o)&&"function"!=typeof o?ty(r):o,ry(ty(n),"handleBack",function(e){switch(e.preventDefault(),n.props.previousRhsState){case P.A.SEARCH:n.props.actions.showSearchResults();break;case P.A.MENTION:n.props.actions.showMentions();break;case P.A.FLAG:n.props.actions.showFlaggedPosts();break;case P.A.PIN:n.props.actions.showPinnedPosts()}}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ny(e,t)}(t,_.a.Component),n=t,(r=[{key:"render",value:function(){var e,t,n=_.a.createElement(El.a,{id:"closeSidebarTooltip"},_.a.createElement(Y.c,{id:"rhs_header.closeSidebarTooltip",defaultMessage:"Close Sidebar"}));switch(this.props.previousRhsState){case P.A.SEARCH:case P.A.MENTION:t=_.a.createElement(El.a,{id:"backToResultsTooltip"},_.a.createElement(Y.c,{id:"rhs_header.backToResultsTooltip",defaultMessage:"Back to Search Results"}));break;case P.A.FLAG:t=_.a.createElement(El.a,{id:"backToResultsTooltip"},_.a.createElement(Y.c,{id:"rhs_header.backToFlaggedTooltip",defaultMessage:"Back to Flagged Posts"}));break;case P.A.PIN:t=_.a.createElement(El.a,{id:"backToResultsTooltip"},_.a.createElement(Y.c,{id:"rhs_header.backToPinnedTooltip",defaultMessage:"Back to Pinned Posts"}))}var r=_.a.createElement(El.a,{id:"expandSidebarTooltip"},_.a.createElement(Y.c,{id:"rhs_header.expandSidebarTooltip",defaultMessage:"Expand Sidebar"})),o=_.a.createElement(El.a,{id:"shrinkSidebarTooltip"},_.a.createElement(Y.c,{id:"rhs_header.shrinkSidebarTooltip",defaultMessage:"Shrink Sidebar"}));return t&&(e=_.a.createElement("a",{href:"#",onClick:this.handleBack,className:"sidebar--right__back"},_.a.createElement(vl.a,{delayShow:P.Q.OVERLAY_TIME_DELAY,placement:"top",overlay:t},_.a.createElement(Y.c,{id:"generic_icons.back",defaultMessage:"Back Icon"},function(e){return _.a.createElement("i",{className:"fa fa-angle-left","aria-label":e})})))),_.a.createElement("div",{className:"sidebar--right__header"},_.a.createElement("span",{className:"sidebar--right__title"},e,_.a.createElement(Y.c,{id:"rhs_header.details",defaultMessage:"Message Details"})),_.a.createElement("div",{className:"pull-right"},_.a.createElement("button",{type:"button",className:"sidebar--right__expand","aria-label":"Expand",onClick:this.props.actions.toggleRhsExpanded},_.a.createElement(vl.a,{delayShow:P.Q.OVERLAY_TIME_DELAY,placement:"top",overlay:r},_.a.createElement(Y.c,{id:"rhs_header.expandSidebarTooltip.icon",defaultMessage:"Expand Sidebar Icon"},function(e){return _.a.createElement("i",{className:"fa fa-expand","aria-label":e})})),_.a.createElement(vl.a,{delayShow:P.Q.OVERLAY_TIME_DELAY,placement:"top",overlay:o},_.a.createElement(Y.c,{id:"rhs_header.expandTooltip.icon",defaultMessage:"Shrink Sidebar Icon"},function(e){return _.a.createElement("i",{className:"fa fa-compress","aria-label":e})}))),_.a.createElement("button",{id:"rhsCloseButton",type:"button",className:"sidebar--right__close","aria-label":"Close",onClick:this.props.actions.closeRightHandSide},_.a.createElement(vl.a,{delayShow:P.Q.OVERLAY_TIME_DELAY,placement:"top",overlay:n},_.a.createElement(Y.c,{id:"rhs_header.closeTooltip.icon",defaultMessage:"Close Sidebar Icon"},function(e){return _.a.createElement("i",{className:"fa fa-sign-out","aria-label":e})})))))}}])&&$b(n.prototype,r),o&&$b(n,o),t}();ry(oy,"propTypes",{previousRhsState:v.a.oneOf(Object.values(P.A)),actions:v.a.shape({showMentions:v.a.func,showSearchResults:v.a.func,showFlaggedPosts:v.a.func,showPinnedPosts:v.a.func,closeRightHandSide:v.a.func,toggleRhsExpanded:v.a.func})});var ay=Object(r.connect)(null,function(e){return{actions:Object(o.bindActionCreators)({showSearchResults:kc.n,showMentions:kc.k,showFlaggedPosts:kc.j,showPinnedPosts:kc.l,closeRightHandSide:kc.b,toggleRhsExpanded:kc.p},e)}})(oy);function iy(e){return(iy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sy(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function cy(e){return(cy=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ly(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uy(e,t){return(uy=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function py(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var fy=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=cy(t).call(this,e),n=!o||"object"!==iy(o)&&"function"!=typeof o?ly(r):o,py(ly(n),"renderPostTime",function(e){var t=n.props.post;if(t.type===P.Q.PostTypes.FAKE_PARENT_DELETED)return null;var r=!(e||L.Posts.POST_DELETED===t.state||Yc.isPostPendingOrFailed(t));return _.a.createElement(cm,{isPermalink:r,eventTime:t.create_at,postId:t.id,location:P.q.RHS_ROOT})}),py(ly(n),"toggleEmojiPicker",function(){var e=!n.state.showEmojiPicker;n.setState({showEmojiPicker:e})}),py(ly(n),"getClassName",function(e,t){var r="post post--root post--thread";return n.props.currentUserId===e.user_id&&(r+=" current--user"),t&&(r+=" post--system"),n.props.compactDisplay&&(r+=" post--compact"),e.is_pinned&&(r+=" post--pinned"),(n.state.dropdownOpened||n.state.showEmojiPicker)&&(r+=" post--hovered"),r}),py(ly(n),"handleDropdownOpened",function(e){n.setState({dropdownOpened:e})}),py(ly(n),"handlePostFocus",function(){var e=n.props,t=e.post,r=e.author,o=e.reactions,a=e.isFlagged;n.setState({currentAriaLabel:Et.d(t,r,a,o,n.context.intl)})}),py(ly(n),"getDotMenuRef",function(){return n.refs.dotMenu}),n.state={showEmojiPicker:!1,testStateObj:!0,dropdownOpened:!1,currentAriaLabel:""},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&uy(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e,t,n=this,r=this.props,o=r.post,a=r.isReadOnly,i=r.teamId,s=r.channelIsArchived,c=r.channelType,l=r.channelDisplayName,u=o&&o.state===L.Posts.POST_DELETED,p=T.V(o),f=Et.m(o);e="D"===c?_.a.createElement(Y.c,{id:"rhs_root.direct",defaultMessage:"Direct Message"}):l,a||p||o.failed||f||!this.props.enableEmojiPicker||s||(t=_.a.createElement(bm,{channelId:o.channel_id,postId:o.id,teamId:i,getDotMenuRef:this.getDotMenuRef,location:P.q.RHS_ROOT,showEmojiPicker:this.state.showEmojiPicker,toggleEmojiPicker:this.toggleEmojiPicker}));var d,m,h=null;o.file_ids&&o.file_ids.length>0&&(h=_.a.createElement(hd,{post:o,compactDisplay:this.props.compactDisplay})),f?d=_.a.createElement(Bb,{overwriteName:_.a.createElement(Y.c,{id:"post_info.system",defaultMessage:"System"}),overwriteImage:P.Q.SYSTEM_MESSAGE_PROFILE_IMAGE,disablePopover:!0}):o.props&&o.props.from_webhook?(d=o.props.override_username&&this.props.enablePostUsernameOverride?_.a.createElement(Bb,{key:o.user_id,userId:o.user_id,hideStatus:!0,overwriteName:o.props.override_username,disablePopover:!0}):_.a.createElement(Bb,{key:o.user_id,userId:o.user_id,hideStatus:!0,disablePopover:!0}),m=_.a.createElement(ka.a,null)):d=_.a.createElement(Bb,{key:o.user_id,userId:o.user_id,isBusy:this.props.isBusy,isRHS:!0,hasMention:!0});var b,y="";Et.j(this.props.post)&&(y+=" post--edited"),o.is_pinned&&(b=_.a.createElement("span",{className:"post__pinned-badge"},_.a.createElement(Y.c,{id:"post_info.pinned",defaultMessage:"Pinned"})));var g,v,E,O=_.a.createElement(Kp,{post:this.props.post,location:P.q.RHS_ROOT,isFlagged:this.props.isFlagged,handleDropdownOpened:this.handleDropdownOpened,handleAddReactionClick:this.toggleEmojiPicker,commentCount:this.props.commentCount,isReadOnly:a||s,enableEmojiPicker:this.props.enableEmojiPicker});return u||this.props.post.type===P.Q.PostTypes.FAKE_PARENT_DELETED||(g=_.a.createElement("div",{ref:"dotMenu",className:"col col__reply"},O,t)),!p&&!o.failed&&!f&&(v=_.a.createElement($d,{location:P.q.RHS_ROOT,postId:o.id,isFlagged:this.props.isFlagged})),this.props.post.props&&this.props.post.props.card&&(E=_.a.createElement(vl.a,{delayShow:P.Q.OVERLAY_TIME_DELAY,placement:"top",overlay:_.a.createElement(El.a,null,_.a.createElement(Y.c,{id:"post_info.info.view_additional_info",defaultMessage:"View additional info"}))},_.a.createElement("button",{className:"card-icon__container icon--show style--none",onClick:function(e){e.preventDefault(),n.props.handleCardClick(n.props.post)}},_.a.createElement(Ib,{className:"icon icon__info","aria-hidden":"true"})))),_.a.createElement("div",{role:"listitem",id:"rhsPost_"+o.id,tabIndex:"-1",className:"thread__root a11y__section ".concat(this.getClassName(o,f)),"aria-label":this.state.currentAriaLabel,onFocus:this.handlePostFocus},_.a.createElement("div",{className:"post-right-channel__name"},e),_.a.createElement("div",{role:"application",className:"post__content"},_.a.createElement("div",{className:"post__img"},_.a.createElement(Sd,{compactDisplay:this.props.compactDisplay,isBusy:this.props.isBusy,isRHS:!0,post:o,userId:o.user_id})),_.a.createElement("div",null,_.a.createElement("div",{className:"post__header"},_.a.createElement("div",{className:"col__name"},d,m),_.a.createElement("div",{className:"col"},this.renderPostTime(p),b,E,v),g),_.a.createElement("div",{className:"post__body"},_.a.createElement("div",{className:y},_.a.createElement(Pb,{post:o,previewCollapsed:this.props.previewCollapsed,previewEnabled:this.props.previewEnabled,isEmbedVisible:this.props.isEmbedVisible,pluginPostTypes:this.props.pluginPostTypes})),h,_.a.createElement(Am,{post:o,isReadOnly:a||s})))))}}])&&sy(n.prototype,r),o&&sy(n,o),t}();py(fy,"propTypes",{post:v.a.object.isRequired,teamId:v.a.string.isRequired,currentUserId:v.a.string.isRequired,compactDisplay:v.a.bool,commentCount:v.a.number.isRequired,author:v.a.string,reactions:v.a.object,isFlagged:v.a.bool,previewCollapsed:v.a.string,previewEnabled:v.a.bool,isBusy:v.a.bool,isEmbedVisible:v.a.bool,enableEmojiPicker:v.a.bool.isRequired,enablePostUsernameOverride:v.a.bool.isRequired,isReadOnly:v.a.bool.isRequired,pluginPostTypes:v.a.object,channelIsArchived:v.a.bool.isRequired,channelType:v.a.string,channelDisplayName:v.a.string,handleCardClick:v.a.func.isRequired}),py(fy,"contextTypes",{intl:Y.i.isRequired}),py(fy,"defaultProps",{commentCount:0});var dy=Object(r.connect)(function(e,t){var n=Object(ea.makeGetReactionsForPost)(),r=Object(p.makeGetDisplayName)(),o=Object(u.getConfig)(e),a="true"===o.EnableEmojiPicker,i="true"===o.EnablePostUsernameOverride,s=t.teamId||Object(f.getCurrentTeamId)(e),c=Object(d.getChannel)(e,t.post.channel_id)||{};return{author:r(e,t.post.user_id),reactions:n(e,t.post.id),enableEmojiPicker:a,enablePostUsernameOverride:i,isEmbedVisible:Object(K.b)(e,t.post.id),isReadOnly:Object(d.isChannelReadOnlyById)(e,t.post.channel_id),teamId:s,pluginPostTypes:e.plugins.postTypes,channelIsArchived:0!==c.delete_at,channelType:c.type,channelDisplayName:c.display_name,isFlagged:null!=Object(l.get)(e,P.z.CATEGORY_FLAGGED_POST,t.post.id,null),compactDisplay:Object(l.get)(e,P.z.CATEGORY_DISPLAY_SETTINGS,P.z.MESSAGE_DISPLAY,P.z.MESSAGE_DISPLAY_DEFAULT)===P.z.MESSAGE_DISPLAY_COMPACT}})(fy);function my(e){return(my="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hy(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function by(e){return(by=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function yy(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gy(e,t){return(gy=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function vy(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ey(e){return _.a.createElement("div",Object.assign({},e,{className:"scrollbar--view"}))}function _y(e){return _.a.createElement("div",Object.assign({},e,{className:"scrollbar--horizontal"}))}function Oy(e){return _.a.createElement("div",Object.assign({},e,{className:"scrollbar--vertical"}))}var wy=function(e){function t(e){var n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=by(t).call(this,e),n=!o||"object"!==my(o)&&"function"!=typeof o?yy(r):o,vy(yy(n),"handleResize",function(){n.setState({windowWidth:T.mb(),windowHeight:T.lb()}),j.m()&&"reply_textbox"===document.activeElement.id&&n.scrollToBottom()}),vy(yy(n),"handleCardClick",function(e){e&&n.props.actions.selectPostCard(e)}),vy(yy(n),"handleCardClickPost",function(e){e&&n.props.actions.selectPostCard(e)}),vy(yy(n),"onBusy",function(e){n.setState({isBusy:e})}),vy(yy(n),"filterPosts",function(e,t,n){var r=[];return e.forEach(function(e){"system_ephemeral"===e.type&&e.create_at<n||e.root_id===t.id&&r.unshift(e)}),r}),vy(yy(n),"scrollToBottom",function(){qc()(".post-right__scroll")[0]&&qc()(".post-right__scroll").parent().scrollTop(qc()(".post-right__scroll")[0].scrollHeight)}),vy(yy(n),"updateFloatingTimestamp",function(){if(T.U()&&n.props.posts){for(var e=n.refs.rhspostlist.childNodes,t=n.refs.rhspostlist.getBoundingClientRect(),r="",o=0;o<e.length;o++)if(e[o].offsetTop+t.top-100>0){r=n.props.posts[o].id;break}r!==n.state.topRhsPostId&&n.setState({topRhsPostId:r})}}),vy(yy(n),"handleScroll",function(){n.updateFloatingTimestamp(),n.state.isScrolling||n.setState({isScrolling:!0}),n.scrollStopAction.fireAfter(P.Q.SCROLL_DELAY)}),vy(yy(n),"handleScrollStop",function(){n.setState({isScrolling:!1})}),vy(yy(n),"getSidebarBody",function(){return n.refs.sidebarbody}),n.scrollStopAction=new Gc(n.handleScrollStop);var a=(new Date).getTime();return n.state={windowWidth:T.mb(),windowHeight:T.lb(),isScrolling:!1,topRhsPostId:0,openTime:a},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gy(e,t)}(t,_.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){this.scrollToBottom(),window.addEventListener("resize",this.handleResize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleResize)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.props.selected&&e.selected&&this.props.selected.id!==e.selected.id&&this.setState({openTime:(new Date).getTime()})}},{key:"componentDidUpdate",value:function(e){var t=e.posts||[],n=this.props.posts||[];t.length>=n.length||n[n.length-1].user_id===this.props.currentUserId&&this.scrollToBottom()}},{key:"shouldComponentUpdate",value:function(e,t){return!T.c(t.postsArray,this.props.posts)||(!T.c(t.selected,this.props.selected)||(e.previewEnabled!==this.props.previewEnabled||(t.isBusy!==this.state.isBusy||(t.isScrolling!==this.state.isScrolling||t.topRhsPostId!==this.state.topRhsPostId))))}},{key:"render",value:function(){if(null==this.props.posts||null==this.props.selected)return _.a.createElement("div",null);var e=this.filterPosts(this.props.posts,this.props.selected,this.state.openTime),t=this.props,n=t.selected,r=t.currentUserId,o=n.create_at;!o&&this.props.posts.length>0&&(o=this.props.posts[this.props.posts.length-1].create_at);for(var a,i=T.s(o),s=i,c=[],l=e.length,u=0;u<l;u++){var p=e[u],f=u>0?e[u-1].id:"",d=T.s(p.create_at);d.toDateString()!==s.toDateString()&&(s=d,c.push(_.a.createElement(gp,{key:d,date:d})));var m=p.id?p.id:p.pending_post_id;c.push(_.a.createElement(Jb,{key:m+"commentKey",ref:p.id,post:p,previousPostId:f,teamId:this.props.channel.team_id,currentUserId:r,isBusy:this.state.isBusy,removePost:this.props.actions.removePost,previewCollapsed:this.props.previewCollapsed,previewEnabled:this.props.previewEnabled,handleCardClick:this.handleCardClickPost}))}var h=n.type===P.Q.PostTypes.FAKE_PARENT_DELETED,b=0!==this.props.channel.delete_at;if(h||(a=b?_.a.createElement("div",{className:"channel-archived-warning"},_.a.createElement(Fu.b,{id:"archivedChannelMessage",defaultMessage:"You are viewing an **archived channel**. New messages cannot be posted."})):_.a.createElement("div",{className:"post-create__container"},_.a.createElement(cp,{channelId:n.channel_id,rootId:n.id,rootDeleted:n.state===L.Posts.POST_DELETED,latestPostId:l>0?e[l-1].id:n.id,getSidebarBody:this.getSidebarBody}))),this.props.channel.type===P.Q.DM_CHANNEL){var y=T.u(this.props.channel.id);y&&y.delete_at&&(a=_.a.createElement("div",{className:"post-create-message"},_.a.createElement(Y.c,{id:"create_post.deactivated",defaultMessage:"You are viewing an archived channel with a deactivated user."})))}return _.a.createElement("div",{id:"rhsContainer",className:"sidebar-right__body",ref:"sidebarbody"},_.a.createElement(Pp,{isScrolling:this.state.isScrolling,isMobile:T.U(),postId:this.state.topRhsPostId,isRhsPost:!0}),_.a.createElement(ay,{previousRhsState:this.props.previousRhsState}),_.a.createElement(Fc.a,{autoHide:!0,autoHideTimeout:500,autoHideDuration:500,renderThumbHorizontal:_y,renderThumbVertical:Oy,renderView:Ey,onScroll:this.handleScroll},_.a.createElement("div",{className:"post-right__scroll"},_.a.createElement("div",{role:"application",id:"rhsContent","aria-label":T.ab("accessibility.sections.rhsContent","message details complimentary region"),className:"post-right__content a11y__region","data-a11y-sort-order":"3","data-a11y-focus-child":!0,"data-a11y-order-reversed":!0},!h&&_.a.createElement(gp,{date:i}),_.a.createElement(dy,{ref:n.id,post:n,commentCount:l,teamId:this.props.channel.team_id,currentUserId:this.props.currentUserId,previewCollapsed:this.props.previewCollapsed,previewEnabled:this.props.previewEnabled,isBusy:this.state.isBusy,handleCardClick:this.handleCardClick}),h&&i&&_.a.createElement(gp,{date:i}),_.a.createElement("div",{ref:"rhspostlist",className:"post-right-comments-container"},c)),a)))}}])&&hy(n.prototype,r),o&&hy(n,o),t}();vy(wy,"propTypes",{posts:v.a.arrayOf(v.a.object).isRequired,channel:v.a.object.isRequired,selected:v.a.object.isRequired,previousRhsState:v.a.string,currentUserId:v.a.string.isRequired,previewCollapsed:v.a.string.isRequired,previewEnabled:v.a.bool.isRequired,actions:v.a.shape({removePost:v.a.func.isRequired,selectPostCard:v.a.func.isRequired}).isRequired});var Cy=Object(r.connect)(function(){var e=Object(ea.makeGetPostsForThread)();return function(t){var n=Object(Nc.o)(t),r=null,o=[];return n&&(o=e(t,{rootId:n.id}),r=Object(d.getChannel)(t,n.channel_id)),{selected:n,channel:r,posts:o,previewCollapsed:Object(l.get)(t,P.z.CATEGORY_DISPLAY_SETTINGS,P.z.COLLAPSE_DISPLAY,P.z.COLLAPSE_DISPLAY_DEFAULT),previewEnabled:Object(l.getBool)(t,P.z.CATEGORY_DISPLAY_SETTINGS,P.z.LINK_PREVIEW_DISPLAY,P.z.LINK_PREVIEW_DISPLAY_DEFAULT)}}},function(e){return{actions:Object(o.bindActionCreators)({removePost:A.removePost,selectPostCard:kc.e},e)}})(wy);function Sy(e){return(Sy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Py(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function jy(e){return(jy=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ty(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ky(e,t){return(ky=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ny(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ry=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=jy(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==Sy(o)&&"function"!=typeof o?Ty(r):o,Ny(Ty(n),"handleBack",function(e){switch(e.preventDefault(),n.props.previousRhsState){case P.A.SEARCH:n.props.actions.showSearchResults();break;case P.A.MENTION:n.props.actions.showMentions();break;case P.A.FLAG:n.props.actions.showFlaggedPosts();break;case P.A.PIN:n.props.actions.showPinnedPosts()}}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ky(e,t)}(t,_.a.Component),n=t,(r=[{key:"render",value:function(){var e,t;switch(this.props.previousRhsState){case P.A.SEARCH:case P.A.MENTION:t=_.a.createElement(El.a,{id:"backToResultsTooltip"},_.a.createElement(Y.c,{id:"rhs_header.backToResultsTooltip",defaultMessage:"Back to Search Results"}));break;case P.A.FLAG:t=_.a.createElement(El.a,{id:"backToResultsTooltip"},_.a.createElement(Y.c,{id:"rhs_header.backToFlaggedTooltip",defaultMessage:"Back to Flagged Posts"}));break;case P.A.PIN:t=_.a.createElement(El.a,{id:"backToResultsTooltip"},_.a.createElement(Y.c,{id:"rhs_header.backToPinnedTooltip",defaultMessage:"Back to Pinned Posts"}))}var n=_.a.createElement(El.a,{id:"closeSidebarTooltip"},_.a.createElement(Y.c,{id:"rhs_header.closeSidebarTooltip",defaultMessage:"Close Sidebar"})),r=_.a.createElement(El.a,{id:"expandSidebarTooltip"},_.a.createElement(Y.c,{id:"rhs_header.expandSidebarTooltip",defaultMessage:"Expand Sidebar"})),o=_.a.createElement(El.a,{id:"shrinkSidebarTooltip"},_.a.createElement(Y.c,{id:"rhs_header.shrinkSidebarTooltip",defaultMessage:"Shrink Sidebar"}));return t&&(e=_.a.createElement("a",{href:"#",onClick:this.handleBack,className:"sidebar--right__back"},_.a.createElement(vl.a,{delayShow:P.Q.OVERLAY_TIME_DELAY,placement:"top",overlay:t},_.a.createElement(Y.c,{id:"generic_icons.back",defaultMessage:"Back Icon"},function(e){return _.a.createElement("i",{className:"fa fa-angle-left","aria-label":e})})))),_.a.createElement("div",{className:"sidebar--right__header"},_.a.createElement("span",{className:"sidebar--right__title"},e,_.a.createElement(Y.c,{id:"search_header.title5",defaultMessage:"Extra information"})),_.a.createElement("div",{className:"pull-right"},_.a.createElement("button",{type:"button",className:"sidebar--right__expand","aria-label":"Expand",onClick:this.props.actions.toggleRhsExpanded},_.a.createElement(vl.a,{delayShow:P.Q.OVERLAY_TIME_DELAY,placement:"top",overlay:r},_.a.createElement(Y.c,{id:"rhs_header.expandSidebarTooltip.icon",defaultMessage:"Expand Sidebar Icon"},function(e){return _.a.createElement("i",{className:"fa fa-expand","aria-label":e})})),_.a.createElement(vl.a,{delayShow:P.Q.OVERLAY_TIME_DELAY,placement:"top",overlay:o},_.a.createElement(Y.c,{id:"rhs_header.expandTooltip.icon",defaultMessage:"Shrink Sidebar Icon"},function(e){return _.a.createElement("i",{className:"fa fa-compress","aria-label":e})}))),_.a.createElement("button",{type:"button",className:"sidebar--right__close","aria-label":"Close",onClick:this.props.actions.closeRightHandSide},_.a.createElement(vl.a,{delayShow:P.Q.OVERLAY_TIME_DELAY,placement:"top",overlay:n},_.a.createElement(Y.c,{id:"rhs_header.closeTooltip.icon",defaultMessage:"Close Sidebar Icon"},function(e){return _.a.createElement("i",{className:"fa fa-sign-out","aria-label":e})})))))}}])&&Py(n.prototype,r),o&&Py(n,o),t}();Ny(Ry,"propTypes",{previousRhsState:v.a.oneOf(Object.values(P.A)),actions:v.a.shape({showMentions:v.a.func,showSearchResults:v.a.func,showFlaggedPosts:v.a.func,showPinnedPosts:v.a.func,closeRightHandSide:v.a.func,toggleRhsExpanded:v.a.func.isRequired})});var My=Object(r.connect)(null,function(e){return{actions:Object(o.bindActionCreators)({showMentions:kc.k,showSearchResults:kc.n,showFlaggedPosts:kc.j,showPinnedPosts:kc.l,closeRightHandSide:kc.b,toggleRhsExpanded:kc.p},e)}})(Ry);function Iy(e){return(Iy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xy(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ay(e){return(Ay=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ly(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Dy(e,t){return(Dy=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Uy(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qy(e){return _.a.createElement("div",Object.assign({},e,{className:"scrollbar--view"}))}function Hy(e){return _.a.createElement("div",Object.assign({},e,{className:"scrollbar--horizontal"}))}function Fy(e){return _.a.createElement("div",Object.assign({},e,{className:"scrollbar--vertical"}))}var By=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=Ay(t).call(this,e),n=!o||"object"!==Iy(o)&&"function"!=typeof o?Ly(r):o,Uy(Ly(n),"handleScroll",function(){n.state.isScrolling||n.setState({isScrolling:!0}),n.scrollStopAction.fireAfter(P.Q.SCROLL_DELAY)}),Uy(Ly(n),"handleScrollStop",function(){n.setState({isScrolling:!1})}),Uy(Ly(n),"getSidebarBody",function(){return n.refs.sidebarbody}),Uy(Ly(n),"handleClick",function(){T.U()&&S.c()}),n.scrollStopAction=new Gc(n.handleScrollStop),n.state={isScrolling:!1,topRhsPostCreateAt:0},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Dy(e,t)}(t,_.a.Component),n=t,(r=[{key:"shouldComponentUpdate",value:function(e,t){return!T.c(t.selected,this.props.selected)||t.isScrolling!==this.state.isScrolling}},{key:"render",value:function(){if(null==this.props.selected)return _.a.createElement("div",null);var e=this.props,t=e.selected,n=e.pluginPostCardTypes,r=e.teamUrl,o=t.type,a=null;if(n.hasOwnProperty(o)){var i=n[o].component;a=_.a.createElement(i,{post:t})}a||(a=_.a.createElement("div",{className:"info-card"},_.a.createElement(Co.a,{message:t.props&&t.props.card})));var s=_.a.createElement(Bb,{userId:t.user_id,hideStatus:!0,disablePopover:!0});t.props.override_username&&this.props.enablePostUsernameOverride&&(s=_.a.createElement(Bb,{userId:t.user_id,hideStatus:!0,disablePopover:!0,overwriteName:t.props.override_username}));var c=_.a.createElement(Sd,{compactDisplay:!1,post:t,userId:t.user_id});return _.a.createElement("div",{className:"sidebar-right__body sidebar-right__card",ref:"sidebarbody"},_.a.createElement(My,{previousRhsState:this.props.previousRhsState}),_.a.createElement(Fc.a,{autoHide:!0,autoHideTimeout:500,autoHideDuration:500,renderThumbHorizontal:Hy,renderThumbVertical:Fy,renderView:qy,onScroll:this.handleScroll},_.a.createElement("div",{className:"post-right__scroll"},a,_.a.createElement("div",{className:"d-flex post-card--info"},_.a.createElement("div",{className:"post-card--post-by overflow--ellipsis"},_.a.createElement(Y.c,{id:"rhs_card.message_by",defaultMessage:"Message by {avatar} {user}",values:{user:s,avatar:c}})),_.a.createElement("div",{className:"post-card--view-post"},_.a.createElement(Fi.a,{to:"".concat(r,"/pl/").concat(t.id),className:"post__permalink",onClick:this.handleClick},_.a.createElement(Y.c,{id:"rhs_card.jump",defaultMessage:"Jump"})))))))}}])&&xy(n.prototype,r),o&&xy(n,o),t}();Uy(By,"propTypes",{selected:v.a.object,pluginPostCardTypes:v.a.object,previousRhsState:v.a.oneOf(Object.values(P.A)),enablePostUsernameOverride:v.a.bool,teamUrl:v.a.string}),Uy(By,"defaultProps",{pluginPostCardTypes:{}});var Gy=Object(r.connect)(function(e){var t=Object(Nc.p)(e);return{enablePostUsernameOverride:"true"===Object(u.getConfig)(e).EnablePostUsernameOverride,selected:t,pluginPostCardTypes:e.plugins.postCardTypes,teamUrl:Object(f.getCurrentRelativeTeamUrl)(e)}})(By),Vy=n(1766);function Wy(e){return(Wy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ky(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function zy(e,t){return!t||"object"!==Wy(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Yy(e){return(Yy=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Qy(e,t){return(Qy=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Zy=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),zy(this,Yy(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qy(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){return _.a.createElement(Y.c,{id:"generic_icons.select",defaultMessage:"Select Icon"},function(e){return _.a.createElement("i",{className:"fa fa fa-plus-square",title:e})})}}])&&Ky(n.prototype,r),o&&Ky(n,o),t}();function Jy(e){return(Jy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xy(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function eg(e,t,n){return t&&$y(e.prototype,t),n&&$y(e,n),e}function tg(e,t){return!t||"object"!==Jy(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ng(e){return(ng=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rg(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&og(e,t)}function og(e,t){return(og=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ag(e){return e.type===P.Q.DM_CHANNEL?"@"+e.display_name:e.type===P.Q.GM_CHANNEL?"@"+e.display_name.replace(/ /g,""):e.name}var ig=function(e){function t(){return Xy(this,t),tg(this,ng(t).apply(this,arguments))}return rg(t,Na["a"]),eg(t,[{key:"render",value:function(){var e=this.props,t=e.item,n="search-autocomplete__item";e.isSelection&&(n+=" selected a11y--focused");var r=ag(t),o=null;if(t.type===P.Q.DM_CHANNEL){var a=Object(T.u)(t.id);o=_.a.createElement(ka.a,{show:Boolean(a&&a.is_bot),className:"badge-popoverlist"})}return _.a.createElement("div",Object.assign({onClick:this.handleClick,className:n},Na.a.baseProps),_.a.createElement(Zy,null),_.a.createElement("span",{className:"search-autocomplete__name"},r),o)}}]),t}(),sg=function(e){function t(){return Xy(this,t),tg(this,ng(t).apply(this,arguments))}return rg(t,Ta["a"]),eg(t,[{key:"handlePretextChanged",value:function(e,t){var n=this,r=/\b(?:in|channel):\s*(\S*)$/i.exec(e.toLowerCase());if(r){var o=r[1];this.startNewRequest(o),Object(Ya.c)(o,function(e){if(!n.shouldCancelDispatch(o)){var r=e.sort(Ka.sortChannelsByTypeAndDisplayName.bind(null,"en")),a=r.map(ag);t({matchedPretext:o,terms:a,items:r,component:ig})}})}return Boolean(r)}}]),t}();function cg(e){return(cg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lg(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ug(e,t){return!t||"object"!==cg(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function pg(e){return(pg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fg(e,t){return(fg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function dg(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var mg=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=ug(this,pg(t).call(this,e))).suggestionReadOut=_.a.createRef(),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fg(e,t)}(t,Mi["a"]),n=t,(r=[{key:"generateLabel",value:function(e){e.username?(this.currentLabel=e.username,(e.first_name||e.last_name)&&e.nickname?this.currentLabel+=" ".concat(e.first_name," ").concat(e.last_name," ").concat(e.nickname):e.nickname?this.currentLabel+=" ".concat(e.nickname):(e.first_name||e.last_name)&&(this.currentLabel+=" ".concat(e.first_name," ").concat(e.last_name))):e.type===P.Q.DM_CHANNEL||e.type===P.Q.GM_CHANNEL?this.currentLabel=e.display_name:this.currentLabel=e.name,this.currentLabel&&(this.currentLabel=this.currentLabel.toLowerCase()),this.announceLabel()}},{key:"getContent",value:function(){return qc()(uu.a.findDOMNode(this.refs.popover)).find(".popover-content")}},{key:"renderChannelDivider",value:function(e){var t;return t=e===P.Q.OPEN_CHANNEL?_.a.createElement(Y.c,{id:"suggestion.search.public",defaultMessage:"Public Channels"}):e===P.Q.PRIVATE_CHANNEL?_.a.createElement(Y.c,{id:"suggestion.search.private",defaultMessage:"Private Channels"}):_.a.createElement(Y.c,{id:"suggestion.search.direct",defaultMessage:"Direct Messages"}),_.a.createElement("div",{key:e+"-divider",className:"search-autocomplete__divider"},_.a.createElement("span",null,t))}},{key:"render",value:function(){if(0===this.props.items.length)return null;for(var e=[],t=0;t<this.props.items.length;t++){var n=this.props.items[t],r=this.props.terms[t],o=r===this.props.selection,a=this.props.components[t];this.props.renderDividers&&(0!==t&&n.type===this.props.items[t-1].type||(n.type===P.Q.OPEN_CHANNEL?e.push(this.renderChannelDivider(P.Q.OPEN_CHANNEL)):n.type===P.Q.PRIVATE_CHANNEL?e.push(this.renderChannelDivider(P.Q.PRIVATE_CHANNEL)):0!==t&&this.props.items[t-1].type!==P.Q.OPEN_CHANNEL&&this.props.items[t-1].type!==P.Q.PRIVATE_CHANNEL||e.push(this.renderChannelDivider(P.Q.DM_CHANNEL)))),o&&(this.currentItem=n),e.push(_.a.createElement(a,{key:r,ref:r,item:n,term:r,matchedPretext:this.props.matchedPretext[t],isSelection:o,onClick:this.props.onCompleteWord}))}return _.a.createElement(Vy.a,{ref:"popover",id:"search-autocomplete__popover",className:"search-help-popover autocomplete visible",placement:"bottom"},_.a.createElement("div",{ref:this.suggestionReadOut,"aria-live":"polite",className:"hidden-label"}),e)}}])&&lg(n.prototype,r),o&&lg(n,o),t}();function hg(e){return(hg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bg(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function yg(e,t){return!t||"object"!==hg(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function gg(e){return(gg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function vg(e,t){return(vg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}dg(mg,"propTypes",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){dg(e,t,n[t])})}return e}({},Mi.a.propTypes));var Eg=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),yg(this,gg(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vg(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){if(0===this.props.items.length)return null;var e=this.props.items[0],t=this.props.terms[0],n=this.props.components[0],r=_.a.createElement(n,{key:t,ref:t,item:e,term:t,matchedPretext:this.props.matchedPretext[0],isSelection:!1,onClick:this.props.onCompleteWord});return _.a.createElement(Vy.a,{ref:"popover",id:"search-autocomplete__popover",className:"search-help-popover autocomplete visible",placement:"bottom"},r)}}])&&bg(n.prototype,r),o&&bg(n,o),t}();function _g(e){return(_g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Og(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wg(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Cg(e,t,n){return t&&wg(e.prototype,t),n&&wg(e,n),e}function Sg(e,t){return!t||"object"!==_g(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Pg(e){return(Pg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function jg(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Tg(e,t)}function Tg(e,t){return(Tg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Eg,"propTypes",{onCompleteWord:v.a.func.isRequired,items:v.a.array.isRequired,terms:v.a.array.isRequired,components:v.a.array.isRequired,matchedPretext:v.a.array.isRequired});var kg=function(e){function t(){return Og(this,t),Sg(this,Pg(t).apply(this,arguments))}return jg(t,Na["a"]),Cg(t,[{key:"render",value:function(){var e=this.props,t=e.item,n="search-autocomplete__item";e.isSelection&&(n+=" selected a11y--focused");var r=t.username,o="";return(t.first_name||t.last_name)&&t.nickname?o="- ".concat(T.z(t)," (").concat(t.nickname,")"):t.nickname?o="- (".concat(t.nickname,")"):(t.first_name||t.last_name)&&(o="- ".concat(T.z(t))),_.a.createElement("div",Object.assign({className:n,onClick:this.handleClick},Na.a.baseProps),_.a.createElement(Zy,null),_.a.createElement("img",{alt:"",className:"profile-img rounded",src:T.J(t)}),_.a.createElement("div",{className:"mention--align"},_.a.createElement("span",null,r),_.a.createElement(ka.a,{show:Boolean(t.is_bot),className:"badge-autocomplete"}),_.a.createElement("span",{className:"mention__fullname"}," ",o)))}}]),t}(),Ng=function(e){function t(){return Og(this,t),Sg(this,Pg(t).apply(this,arguments))}return jg(t,Ta["a"]),Cg(t,[{key:"handlePretextChanged",value:function(e,t){var n=this,r=/\bfrom:\s*(\S*)$/i.exec(e.toLowerCase());if(r){var o=r[1];this.startNewRequest(o),Object(lc.c)(o,function(e){if(!n.shouldCancelDispatch(o)){var r=Object.assign([],e.users),a=r.map(function(e){return e.username});t({matchedPretext:o,terms:a,items:r,component:kg})}})}return Boolean(r)}},{key:"allowDividers",value:function(){return!1}}]),t}(),Rg=n(2032),Mg=n.n(Rg);n(2039);function Ig(e){return(Ig="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xg(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ag(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Lg(e,t,n){return t&&Ag(e.prototype,t),n&&Ag(e,n),e}function Dg(e,t){return!t||"object"!==Ig(t)&&"function"!=typeof t?qg(e):t}function Ug(e){return(Ug=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qg(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Hg(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fg(e,t)}function Fg(e,t){return(Fg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Bg=function(e){function t(e){var n;return xg(this,t),(n=Dg(this,Ug(t).call(this,e))).handleDayClick=n.handleDayClick.bind(qg(n)),n}return Hg(t,Na["a"]),Lg(t,[{key:"handleDayClick",value:function(e){var t=e.toISOString().split("T")[0];this.props.onClick(t,this.props.matchedPretext)}},{key:"render",value:function(){return _.a.createElement(Mg.a,{onDayClick:this.handleDayClick,showOutsideDays:!0})}}]),t}(),Gg=function(e){function t(){return xg(this,t),Dg(this,Ug(t).apply(this,arguments))}return Hg(t,Ta["a"]),Lg(t,[{key:"handlePretextChanged",value:function(e,t){var n=/\b(?:on|before|after):\s*(\S*)$/i.exec(e.toLowerCase());if(n){var r=n[1];this.startNewRequest(r);var o=Object.assign([],[{label:"Selected Date",date:r}]);t({matchedPretext:r,terms:o.map(function(e){return e.date}),items:o,component:Bg})}return Boolean(n)}},{key:"allowDividers",value:function(){return!1}},{key:"presentationType",value:function(){return"date"}}]),t}();function Vg(e){var t,n,r=e.iconComponent,o=e.ariaLabel,a=e.buttonClass,i=e.buttonId,s=e.onClick,c=e.tooltipKey,l=e.tooltipText,u={flaggedPosts:{class:"text-nowrap",id:"flaggedTooltip",messageID:Object(Ne.b)("channel_header.flagged"),message:"Flagged Posts"},pinnedPosts:{class:"",id:"pinnedPostTooltip",messageID:Object(Ne.b)("channel_header.pinnedPosts"),message:"Pinned Posts"},recentMentions:{class:"",id:"recentMentionsTooltip",messageID:Object(Ne.b)("channel_header.recentMentions"),message:"Recent Mentions"},search:{class:"",id:"searchTooltip",messageID:Object(Ne.b)("channel_header.search"),message:"Search"}};return t="plugin"===c&&l?_.a.createElement(El.a,{id:"pluginTooltip",className:""},_.a.createElement("span",null,l)):function(e){return null==u[e]?null:_.a.createElement(El.a,{id:u[e].id,className:u[e].class},_.a.createElement(Y.c,{id:u[e].messageID,defaultMessage:u[e].message}))}(c),o&&(n="".concat(Object(T.ab)(u[c].messageID,u[c].message))),t?_.a.createElement("div",{className:"flex-child"},_.a.createElement(vl.a,{trigger:["hover"],delayShow:P.i.OVERLAY_TIME_DELAY,placement:"bottom",overlay:t},_.a.createElement("button",{id:i,"aria-label":n,className:a||"channel-header__icon icon--hidden style--none",onClick:s},r))):_.a.createElement("div",{className:"flex-child"},_.a.createElement("button",{id:i,className:a||"channel-header__icon icon--hidden style--none",onClick:s},r))}function Wg(e){return(Wg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Kg(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function zg(e,t){return!t||"object"!==Wg(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Yg(e){return(Yg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Qg(e,t){return(Qg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Vg.propTypes={ariaLabel:v.a.bool,buttonClass:v.a.string,buttonId:v.a.string.isRequired,iconComponent:v.a.element.isRequired,onClick:v.a.func.isRequired,tooltipKey:v.a.string,tooltipText:v.a.string};var Zg=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),zg(this,Yg(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qg(e,t)}(t,E["PureComponent"]),n=t,(r=[{key:"render",value:function(){return _.a.createElement(_.a.Fragment,null,this.props.withTitle&&_.a.createElement("h4",null,_.a.createElement(Y.c,{id:"search_bar.usage.title",defaultMessage:"Search Options"})),_.a.createElement(Fu.b,{id:"search_bar.usage.tips",defaultMessage:'* Use **"quotation marks"** to search for phrases\\n* Use **from:** to find posts from specific users and **in:** to find posts in specific channels\\n* Use **on:** to find posts on a specific date\\n* Use **before:** to find posts before a specific date\\n* Use **after:** to find posts after a specific date'}))}}])&&Kg(n.prototype,r),o&&Kg(n,o),t}();function Jg(e){return(Jg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xg(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $g(e,t){return!t||"object"!==Jg(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ev(e){return(ev=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function tv(e,t){return(tv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Zg,"propTypes",{withTitle:v.a.bool});var nv=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),$g(this,ev(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tv(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){return _.a.createElement("span",this.props,_.a.createElement(Y.c,{id:"generic_icons.mention",defaultMessage:"Mention Icon"},function(e){return _.a.createElement("svg",{width:"14px",height:"14px",viewBox:"0 0 20 20",version:"1.1",role:"icon","aria-label":e},_.a.createElement("g",{stroke:"none",strokeWidth:"1",fill:"inherit",fillRule:"evenodd"},_.a.createElement("g",{transform:"translate(-1057.000000, -31.000000)",fill:"inherit"},_.a.createElement("g",null,_.a.createElement("g",{transform:"translate(1049.000000, 22.000000)"},_.a.createElement("path",{d:"M17.4296875,15.8867188 C15.9882812,15.8867188 15.1210938,17.0351562 15.1210938,18.96875 C15.1210938,20.8789062 15.9882812,22.0507812 17.4179688,22.0507812 C18.8945312,22.0507812 19.84375,20.8554688 19.84375,18.96875 C19.84375,17.0820312 18.90625,15.8867188 17.4296875,15.8867188 Z M17.8398438,9.125 C23.3242188,9.125 27.25,12.59375 27.25,17.7734375 C27.25,21.5117188 25.5625,23.9609375 22.7734375,23.9609375 C21.4023438,23.9609375 20.265625,23.1992188 20.078125,22.0390625 L19.9609375,22.0390625 C19.46875,23.2226562 18.4140625,23.8789062 17.0429688,23.8789062 C14.6054687,23.8789062 12.9648438,21.8867188 12.9648438,18.9101562 C12.9648438,16.0625 14.6171875,14.09375 16.9960938,14.09375 C18.25,14.09375 19.3632812,14.7382812 19.8085938,15.7460938 L19.9375,15.7460938 L19.9375,14.328125 L21.9179688,14.328125 L21.9179688,20.984375 C21.9179688,21.7578125 22.328125,22.2851562 23.171875,22.2851562 C24.4726562,22.2851562 25.421875,20.6679688 25.421875,17.8320312 C25.421875,13.5664062 22.2929688,10.7421875 17.7109375,10.7421875 C13.1640625,10.7421875 9.90625,14.140625 9.90625,18.96875 C9.90625,24.1367188 13.3515625,27.0429688 18.109375,27.0429688 C19.5625,27.0429688 21.0507812,26.84375 21.7773438,26.5390625 L21.7773438,28.15625 C20.78125,28.484375 19.4570312,28.671875 18.0273438,28.671875 C12.2382812,28.671875 8.078125,25.109375 8.078125,18.8984375 C8.078125,13.0625 12.0859375,9.125 17.8398438,9.125 Z"}))))))}))}}])&&Xg(n.prototype,r),o&&Xg(n,o),t}(),rv=n(1599);function ov(e){return(ov="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function av(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function iv(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function sv(e){return(sv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function cv(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lv(e,t){return(lv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function uv(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var pv=P.Q.KeyCodes,fv=function(e){function t(){var e,n,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,r=sv(t).call(this),e=!r||"object"!==ov(r)&&"function"!=typeof r?cv(n):r,uv(cv(e),"handleClose",function(){e.props.actions.closeRightHandSide()}),uv(cv(e),"handleKeyDown",function(e){T.S(e,pv.ESCAPE)&&(e.stopPropagation(),e.preventDefault())}),uv(cv(e),"handleChange",function(t){var n=t.target.value;e.props.actions.updateSearchTerms(n)}),uv(cv(e),"handleUserBlur",function(){setTimeout(function(){e.setState({focused:!1})},200)}),uv(cv(e),"handleClear",function(){e.props.actions.updateSearchTerms("")}),uv(cv(e),"handleUserFocus",function(){e.setState({focused:!0})}),uv(cv(e),"handleSearch",function(){var t,n=(t=regeneratorRuntime.mark(function t(n){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!n.length){t.next=6;break}return t.next=3,e.props.actions.showSearchResults();case 3:r=t.sent,r.error||e.handleSearchOnSuccess();case 6:case"end":return t.stop()}},t)}),function(){var e=this,n=arguments;return new Promise(function(r,o){var a=t.apply(e,n);function i(e){av(a,r,o,i,s,"next",e)}function s(e){av(a,r,o,i,s,"throw",e)}i(void 0)})});return function(e){return n.apply(this,arguments)}}()),uv(cv(e),"handleSearchOnSuccess",function(){T.U()&&e.search&&(e.search.value="")}),uv(cv(e),"handleSubmit",function(t){t.preventDefault();var n=e.props.searchTerms.trim();0!==n.length&&(e.handleSearch(n),e.search.blur())}),uv(cv(e),"searchMentions",function(t){t.preventDefault(),e.props.isMentionSearch?e.props.actions.closeRightHandSide():e.props.actions.showMentions()}),uv(cv(e),"getFlagged",function(t){t.preventDefault(),e.props.isFlaggedPosts?e.props.actions.closeRightHandSide():e.props.actions.showFlaggedPosts()}),uv(cv(e),"getSearch",function(t){e.search=t}),e.state={focused:!1},e.suggestionProviders=[new sg,new Ng,new Gg],e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lv(e,t)}(t,_.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){T.U()&&setTimeout(function(){var e=document.querySelector(".app__body .sidebar--menu");e&&e.classList.remove("visible")})}},{key:"renderHintPopover",value:function(){if(T.U())return null;var e="search-help-popover";return!this.props.searchTerms&&this.state.focused&&(e+=" visible"),_.a.createElement(Vy.a,{id:"searchbar-help-popup",placement:"bottom",className:e},_.a.createElement(Zg,{withTitle:!0}))}},{key:"render",value:function(){var e,t;if(this.props.showMentionFlagBtns){var n=this.props.isMentionSearch?"active":"";e=_.a.createElement(Vg,{iconComponent:_.a.createElement(nv,{className:"icon icon__mentions","aria-hidden":"true"}),buttonClass:"channel-header__icon style--none "+n,buttonId:"channelHeaderMentionButton",onClick:this.searchMentions,tooltipKey:"recentMentions"});var r=this.props.isFlaggedPosts?"active":"";t=_.a.createElement(Vg,{iconComponent:_.a.createElement(qd,{className:"icon icon__flag"}),buttonClass:"channel-header__icon style--none "+r,buttonId:"channelHeaderFlagButton",onClick:this.getFlagged,tooltipKey:"flaggedPosts"})}var o=!this.props.isSearchingTerm&&this.props.searchTerms&&""!==this.props.searchTerms.trim(),a="search__form";this.state.focused&&(a+=" focused");var i=_.a.createElement(El.a,{id:"searchClearTooltip"},_.a.createElement(Y.c,{id:"search_bar.clear",defaultMessage:"Clear search query"}));return _.a.createElement("div",{className:"sidebar-right__table"},_.a.createElement("div",{className:"sidebar-collapse__container"},_.a.createElement("div",{id:"sidebarCollapse",className:"sidebar-collapse",onClick:this.handleClose},_.a.createElement(Y.c,{id:"generic_icons.back",defaultMessage:"Back Icon"},function(e){return _.a.createElement("span",{className:"fa fa-2x fa-angle-left",title:e})}))),_.a.createElement("div",{id:"searchFormContainer",className:"search-form__container"},_.a.createElement("form",{role:"application",className:a,onSubmit:this.handleSubmit,style:dv.searchForm,autoComplete:"off"},_.a.createElement(rv.a,{id:"searchIcon",className:"search__icon","aria-hidden":"true"}),_.a.createElement(Ri.a,{ref:this.getSearch,id:"searchBox",tabIndex:"0",className:"search-bar a11y__region","data-a11y-sort-order":"8","aria-describedby":"searchbar-help-popup",placeholder:T.ab("search_bar.search","Search"),value:this.props.searchTerms,onFocus:this.handleUserFocus,onBlur:this.handleUserBlur,onChange:this.handleChange,onKeyDown:this.handleKeyDown,listComponent:mg,dateComponent:Eg,providers:this.suggestionProviders,type:"search",autoFocus:this.props.isFocus&&""===this.props.searchTerms,delayInputUpdate:!0,renderDividers:!0}),o&&_.a.createElement("div",{id:"searchClearButton",className:"sidebar__search-clear visible",onClick:this.handleClear},_.a.createElement(vl.a,{delayShow:P.Q.OVERLAY_TIME_DELAY,placement:"bottom",overlay:i},_.a.createElement("span",{className:"sidebar__search-clear-x","aria-hidden":"true"},"×"))),this.props.isSearchingTerm&&_.a.createElement(Cf.a,null),this.renderHintPopover())),e,t)}}])&&iv(n.prototype,r),o&&iv(n,o),t}();uv(fv,"propTypes",{isSearchingTerm:v.a.bool,searchTerms:v.a.string,isMentionSearch:v.a.bool,isFlaggedPosts:v.a.bool,showMentionFlagBtns:v.a.bool,isFocus:v.a.bool,actions:v.a.shape({updateSearchTerms:v.a.func,showSearchResults:v.a.func,showMentions:v.a.func,showFlaggedPosts:v.a.func,closeRightHandSide:v.a.func})}),uv(fv,"defaultProps",{showMentionFlagBtns:!0,isFocus:!1});var dv={searchForm:{overflow:"visible"}};var mv=Object(r.connect)(function(e){var t=Object(Nc.k)(e);return{isSearchingTerm:Object(Nc.g)(e),searchTerms:Object(Nc.m)(e),isMentionSearch:t===P.A.MENTION,isFlaggedPosts:t===P.A.FLAG}},function(e){return{actions:Object(o.bindActionCreators)({updateSearchTerms:kc.r,showSearchResults:kc.n,showMentions:kc.k,showFlaggedPosts:kc.j,closeRightHandSide:kc.b},e)}})(fv),hv=n(296),bv=n(2040);function yv(e){return(yv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function gv(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function vv(e,t){return!t||"object"!==yv(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ev(e){return(Ev=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _v(e,t){return(_v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ov=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),vv(this,Ev(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_v(e,t)}(t,_.a.Component),n=t,(r=[{key:"render",value:function(){var e=_.a.createElement(El.a,{id:"closeSidebarTooltip"},_.a.createElement(Y.c,{id:"rhs_header.closeSidebarTooltip",defaultMessage:"Close Sidebar"})),t=_.a.createElement(El.a,{id:"expandSidebarTooltip"},_.a.createElement(Y.c,{id:"rhs_header.expandSidebarTooltip",defaultMessage:"Expand Sidebar"})),n=_.a.createElement(El.a,{id:"shrinkSidebarTooltip"},_.a.createElement(Y.c,{id:"rhs_header.shrinkSidebarTooltip",defaultMessage:"Shrink Sidebar"}));return _.a.createElement("div",{className:"sidebar--right__header"},_.a.createElement("span",{className:"sidebar--right__title"},this.props.children),_.a.createElement("div",{className:"pull-right"},_.a.createElement("button",{type:"button",className:"sidebar--right__expand","aria-label":"Expand",onClick:this.props.actions.toggleRhsExpanded},_.a.createElement(vl.a,{delayShow:P.Q.OVERLAY_TIME_DELAY,placement:"top",overlay:t},_.a.createElement(Y.c,{id:"rhs_header.expandSidebarTooltip.icon",defaultMessage:"Expand Sidebar Icon"},function(e){return _.a.createElement("i",{className:"fa fa-expand","aria-label":e})})),_.a.createElement(vl.a,{delayShow:P.Q.OVERLAY_TIME_DELAY,placement:"top",overlay:n},_.a.createElement(Y.c,{id:"rhs_header.expandTooltip.icon",defaultMessage:"Shrink Sidebar Icon"},function(e){return _.a.createElement("i",{className:"fa fa-compress","aria-label":e})}))),_.a.createElement("button",{id:"searchResultsCloseButton",type:"button",className:"sidebar--right__close","aria-label":"Close",onClick:this.props.actions.closeRightHandSide},_.a.createElement(vl.a,{delayShow:P.Q.OVERLAY_TIME_DELAY,placement:"top",overlay:e},_.a.createElement(Y.c,{id:"rhs_header.closeTooltip.icon",defaultMessage:"Close Sidebar Icon"},function(e){return _.a.createElement("i",{className:"fa fa-sign-out","aria-label":e})})))))}}])&&gv(n.prototype,r),o&&gv(n,o),t}();!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Ov,"propTypes",{children:v.a.element,actions:v.a.shape({closeRightHandSide:v.a.func,toggleRhsExpanded:v.a.func.isRequired})});var wv=Object(r.connect)(null,function(e){return{actions:Object(o.bindActionCreators)({closeRightHandSide:kc.b,toggleRhsExpanded:kc.p},e)}})(Ov);function Cv(e){return(Cv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Sv(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Pv(e,t){return!t||"object"!==Cv(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function jv(e){return(jv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Tv(e,t){return(Tv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var kv=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Pv(this,jv(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Tv(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){return _.a.createElement("span",this.props,_.a.createElement(Y.c,{id:"generic_icons.reply",defaultMessage:"Reply Icon"},function(e){return _.a.createElement("svg",{id:"Layer_1",x:"0px",y:"0px",width:"17px",height:"17px",viewBox:"-158 242 18 18",style:Nv,role:"icon","aria-label":e},_.a.createElement("path",{d:"M-142.2,252.6c-2-3-4.8-4.7-8.3-4.8v-3.3c0-0.2-0.1-0.3-0.2-0.3s-0.3,0-0.4,0.1l-6.9,6.2c-0.1,0.1-0.1,0.2-0.1,0.3 c0,0.1,0,0.2,0.1,0.3l6.9,6.4c0.1,0.1,0.3,0.1,0.4,0.1c0.1-0.1,0.2-0.2,0.2-0.4v-3.8c4.2,0,7.4,0.4,9.6,4.4c0.1,0.1,0.2,0.2,0.3,0.2 c0,0,0.1,0,0.1,0c0.2-0.1,0.3-0.3,0.2-0.4C-140.2,257.3-140.6,255-142.2,252.6z M-150.8,252.5c-0.2,0-0.4,0.2-0.4,0.4v3.3l-6-5.5 l6-5.3v2.8c0,0.2,0.2,0.4,0.4,0.4c3.3,0,6,1.5,8,4.5c0.5,0.8,0.9,1.6,1.2,2.3C-144,252.8-147.1,252.5-150.8,252.5z"}))}))}}])&&Sv(n.prototype,r),o&&Sv(n,o),t}(),Nv={enableBackground:"new -158 242 18 18"};function Rv(e){return(Rv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Mv(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Iv(e,t){return!t||"object"!==Rv(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xv(e){return(xv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Av(e,t){return(Av=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Lv(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Dv=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Iv(this,xv(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Av(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e="",t="comment-icon__container";this.props.commentCount>0?(t+=" icon--show",e=_.a.createElement("span",{className:"comment-count"},this.props.commentCount)):""!==this.props.searchStyle&&(t=t+" "+this.props.searchStyle);var n=_.a.createElement(El.a,{id:"comment-icon-tooltip",className:"hidden-xs"},_.a.createElement(Y.c,{id:"post_info.comment_icon.tooltip.reply",defaultMessage:"Reply"}));return _.a.createElement("button",{id:"".concat(this.props.location,"_commentIcon_").concat(this.props.postId),"aria-label":Object(T.ab)("post_info.comment_icon.tooltip.reply","Reply").toLowerCase(),className:t+" color--link style--none "+this.props.extraClass,onClick:this.props.handleCommentClick},_.a.createElement(vl.a,{className:"hidden-xs",delayShow:500,placement:"top",overlay:n},_.a.createElement("span",{className:"d-flex"},_.a.createElement(kv,{className:"comment-icon"}),e)))}}])&&Mv(n.prototype,r),o&&Mv(n,o),t}();Lv(Dv,"propTypes",{location:v.a.oneOf([P.q.CENTER,P.q.SEARCH]).isRequired,handleCommentClick:v.a.func.isRequired,searchStyle:v.a.string,commentCount:v.a.number,postId:v.a.string,extraClass:v.a.string}),Lv(Dv,"defaultProps",{searchStyle:"",commentCount:0,extraClass:"",location:P.q.CENTER});var Uv=n(1575);function qv(e){return(qv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hv(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Fv(e){return(Fv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Bv(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Gv(e,t){return(Gv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Vv(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Wv=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=Fv(t).call(this,e),n=!o||"object"!==qv(o)&&"function"!=typeof o?Bv(r):o,Vv(Bv(n),"handleFocusRHSClick",function(e){e.preventDefault(),n.props.actions.selectPost(n.props.post)}),Vv(Bv(n),"handleJumpClick",function(){T.U()&&n.props.actions.closeRightHandSide(),n.props.actions.setRhsExpanded(!1),Q.a.push("/".concat(n.props.currentTeamName,"/pl/").concat(n.props.post.id))}),Vv(Bv(n),"handleCardClick",function(e){e&&n.props.actions.selectPostCard(e)}),Vv(Bv(n),"handleDropdownOpened",function(e){n.setState({dropdownOpened:e})}),Vv(Bv(n),"renderPostTime",function(){var e=n.props.post,t=!(L.Posts.POST_DELETED===e.state||Yc.isPostPendingOrFailed(e));return _.a.createElement(cm,{isPermalink:t,eventTime:e.create_at,postId:e.id,location:P.q.SEARCH})}),Vv(Bv(n),"getClassName",function(){var e="post post--thread";return n.props.compactDisplay&&(e+=" post--compact"),n.state.dropdownOpened&&(e+=" post--hovered"),e}),n.state={dropdownOpened:!1},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gv(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e,t=this,n=this.props,r=n.post,o=n.channelIsArchived,a=n.channelId,i=n.channelType,s=this.props.channelName;i===P.Q.DM_CHANNEL&&(s=_.a.createElement(Y.c,{id:"search_item.direct",defaultMessage:"Direct Message (with {username})",values:{username:T.v(T.u(a))}}));var c=!1;r.props&&r.props.from_webhook&&r.props.override_username&&this.props.enablePostUsernameOverride&&(e=r.props.override_username,c=!0);var l=_.a.createElement(Sd,{compactDisplay:this.props.compactDisplay,post:r,userId:r.user_id}),u=_.a.createElement("div",{className:"post__img"},l),p="";Et.j(this.props.post)&&(p+=" post--edited");var f,d,m,h,b,y=null;r.file_ids&&r.file_ids.length>0&&(y=_.a.createElement(hd,{post:r,compactDisplay:this.props.compactDisplay})),r.state===P.Q.POST_DELETED||r.state===L.Posts.POST_DELETED?f=_.a.createElement("p",null,_.a.createElement(Y.c,{id:"post_body.deleted",defaultMessage:"(message deleted)"})):(d=_.a.createElement($d,{location:P.q.SEARCH,postId:r.id,isFlagged:this.props.isFlagged}),r.props&&r.props.card&&(m=_.a.createElement(vl.a,{delayShow:P.Q.OVERLAY_TIME_DELAY,placement:"top",overlay:_.a.createElement(El.a,null,_.a.createElement(Y.c,{id:"post_info.info.view_additional_info",defaultMessage:"View additional info"}))},_.a.createElement("button",{className:"card-icon__container icon--show style--none",onClick:function(e){e.preventDefault(),t.handleCardClick(t.props.post)}},_.a.createElement(Ib,{className:"icon icon__info","aria-hidden":"true"})))),h=_.a.createElement("div",{className:"col__controls col__reply"},_.a.createElement(Kp,{post:r,location:P.q.SEARCH,isFlagged:this.props.isFlagged,handleDropdownOpened:this.handleDropdownOpened,commentCount:this.props.commentCountForPost,isReadOnly:o||null}),_.a.createElement(Dv,{location:P.q.SEARCH,handleCommentClick:this.handleFocusRHSClick,postId:r.id,searchStyle:"search-item__comment"}),_.a.createElement("a",{onClick:this.handleJumpClick,className:"search-item__jump"},_.a.createElement(Y.c,{id:"search_item.jump",defaultMessage:"Jump"}))),f=_.a.createElement(yb,{post:r,options:{searchTerm:this.props.term,searchMatches:this.props.matches}},_.a.createElement(Sb,{post:r,options:{searchTerm:this.props.term,searchMatches:this.props.matches,mentionHighlight:this.props.isMentionSearch}}))),r.is_pinned&&(b=_.a.createElement("span",{className:"post__pinned-badge"},_.a.createElement(Y.c,{id:"post_info.pinned",defaultMessage:"Pinned"})));var g=T.s(r.create_at);return _.a.createElement("div",{"data-testid":"search-item-container",className:"search-item__container"},_.a.createElement(gp,{date:g}),_.a.createElement("div",{className:this.getClassName()},_.a.createElement("div",{className:"search-channel__name"},s,o&&_.a.createElement("span",{className:"search-channel__archived"},_.a.createElement(Uv.a,{className:"icon icon__archive channel-header-archived-icon svg-text-color"}),_.a.createElement(Y.c,{id:"search_item.channelArchived",defaultMessage:"Archived"}))),_.a.createElement("div",{role:"application",className:"post__content"},u,_.a.createElement("div",null,_.a.createElement("div",{className:"post__header"},_.a.createElement("div",{className:"col col__name"},_.a.createElement(Bb,{userId:r.user_id,overwriteName:e,disablePopover:c,isRHS:!0}),_.a.createElement(ka.a,{show:Boolean(r.props&&r.props.from_webhook&&!this.props.isBot)})),_.a.createElement("div",{className:"col"},this.renderPostTime(),b,m,d),h),_.a.createElement("div",{className:"search-item-snippet post__body"},_.a.createElement("div",{className:p},f,y))))))}}])&&Hv(n.prototype,r),o&&Hv(n,o),t}();Vv(Wv,"propTypes",{post:v.a.object,matches:v.a.array,channelId:v.a.string,channelName:v.a.string,channelType:v.a.string,channelIsArchived:v.a.bool,compactDisplay:v.a.bool,isMentionSearch:v.a.bool,term:v.a.string,isFlagged:v.a.bool,currentTeamName:v.a.string,commentCountForPost:v.a.number,enablePostUsernameOverride:v.a.bool.isRequired,isBot:v.a.bool.isRequired,actions:v.a.shape({closeRightHandSide:v.a.func.isRequired,selectPost:v.a.func.isRequired,selectPostCard:v.a.func.isRequired,setRhsExpanded:v.a.func.isRequired}).isRequired}),Vv(Wv,"defaultProps",{isBot:!1,channelIsArchived:!1});var Kv=Object(r.connect)(function(){var e=Object(ea.makeGetCommentCountForPost)();return function(t,n){var r=Object(u.getConfig)(t),o=Object(l.getMyPreferences)(t),a="true"===r.EnablePostUsernameOverride,i=n.post,s=Object(p.getUser)(t,i.user_id),c=Object(d.getChannel)(t,i.channel_id)||{delete_at:0};return{channelId:c.id,channelName:c.display_name,channelType:c.type,channelIsArchived:0!==c.delete_at,currentTeamName:Object(f.getCurrentTeam)(t).name,commentCountForPost:e(t,{post:i}),enablePostUsernameOverride:a,isFlagged:Object(Yc.isPostFlagged)(i.id,o),isBot:!!s&&s.is_bot}}},function(e){return{actions:Object(o.bindActionCreators)({closeRightHandSide:kc.b,selectPost:kc.g,selectPostCard:kc.f,setRhsExpanded:kc.i},e)}})(Wv);function zv(e){return(zv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Yv(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Qv(e,t){return!t||"object"!==zv(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Zv(e){return(Zv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Jv(e,t){return(Jv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Xv=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Qv(this,Zv(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Jv(e,t)}(t,E["PureComponent"]),n=t,(r=[{key:"render",value:function(){return _.a.createElement("li",null,_.a.createElement(Y.c,{id:"search_results.usage.dataRetention",defaultMessage:"Only messages posted in the last {days} days are returned. Contact your System Administrator for more detail.",values:{days:this.props.dataRetentionMessageRetentionDays}}))}}])&&Yv(n.prototype,r),o&&Yv(n,o),t}();function $v(e){return($v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eE(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tE(e,t){return!t||"object"!==$v(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function nE(e){return(nE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rE(e,t){return(rE=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Xv,"propTypes",{dataRetentionMessageRetentionDays:v.a.string});var oE=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),tE(this,nE(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rE(e,t)}(t,E["PureComponent"]),n=t,(r=[{key:"render",value:function(){return _.a.createElement(_.a.Fragment,null,_.a.createElement("ul",null,_.a.createElement("li",null,_.a.createElement(Y.c,{id:"search_results.usageFlag1",defaultMessage:"You haven't flagged any messages yet."})),_.a.createElement("li",null,_.a.createElement(Y.c,{id:"search_results.usageFlag2",defaultMessage:"You can add a flag to messages and comments by clicking the {flagIcon} icon next to the timestamp.",values:{flagIcon:_.a.createElement(qd,{className:"usage__icon"})}})),_.a.createElement("li",null,_.a.createElement(Y.c,{id:"search_results.usageFlag4",defaultMessage:"Flags are a way to mark messages for follow up. Your flags are personal, and cannot be seen by other users."})),this.props.dataRetentionEnableMessageDeletion&&_.a.createElement(Xv,{dataRetentionMessageRetentionDays:this.props.dataRetentionMessageRetentionDays})))}}])&&eE(n.prototype,r),o&&eE(n,o),t}();function aE(e){return(aE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function iE(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function sE(e,t){return!t||"object"!==aE(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function cE(e){return(cE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function lE(e,t){return(lE=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(oE,"propTypes",{dataRetentionEnableMessageDeletion:v.a.bool,dataRetentionMessageRetentionDays:v.a.string});var uE=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),sE(this,cE(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lE(e,t)}(t,E["PureComponent"]),n=t,(r=[{key:"render",value:function(){return _.a.createElement(_.a.Fragment,null,_.a.createElement("h4",{id:"noResultsMessage"},_.a.createElement(Y.c,{id:"search_results.noResults",defaultMessage:"No results found. Try again?"})),_.a.createElement("ul",null,_.a.createElement("li",null,_.a.createElement(Y.c,{id:"search_results.noResults.partialPhraseSuggestion",defaultMessage:'If you\'re searching a partial phrase (ex. searching "rea", looking for "reach" or "reaction"), append a * to your search term.'})),_.a.createElement("li",null,_.a.createElement(Y.c,{id:"search_results.noResults.stopWordsSuggestion",defaultMessage:'Two letter searches and common words like "this", "a" and "is" won\'t appear in search results due to the excessive results returned.'})),this.props.dataRetentionEnableMessageDeletion&&_.a.createElement(Xv,{dataRetentionMessageRetentionDays:this.props.dataRetentionMessageRetentionDays})))}}])&&iE(n.prototype,r),o&&iE(n,o),t}();function pE(e){return(pE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fE(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function dE(e,t){return!t||"object"!==pE(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function mE(e){return(mE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function hE(e,t){return(hE=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(uE,"propTypes",{dataRetentionEnableMessageDeletion:v.a.bool,dataRetentionMessageRetentionDays:v.a.string});var bE=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),dE(this,mE(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hE(e,t)}(t,E["PureComponent"]),n=t,(r=[{key:"render",value:function(){return _.a.createElement(_.a.Fragment,null,_.a.createElement("ul",null,_.a.createElement("li",null,_.a.createElement(Y.c,{id:"search_results.usagePin1",defaultMessage:"There are no pinned messages yet."})),_.a.createElement("li",null,_.a.createElement(Y.c,{id:"search_results.usagePin2",defaultMessage:"All members of this channel can pin important or useful messages."})),_.a.createElement("li",null,_.a.createElement(Y.c,{id:"search_results.usagePin3",defaultMessage:"Pinned messages are visible to all channel members."})),_.a.createElement("li",null,_.a.createElement(Y.c,{id:"search_results.usagePin4",defaultMessage:'To pin a message: Go to the message that you want to pin and click [...] > "Pin to channel".'})),this.props.dataRetentionEnableMessageDeletion&&_.a.createElement(Xv,{dataRetentionMessageRetentionDays:this.props.dataRetentionMessageRetentionDays})))}}])&&fE(n.prototype,r),o&&fE(n,o),t}();!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(bE,"propTypes",{dataRetentionEnableMessageDeletion:v.a.bool,dataRetentionMessageRetentionDays:v.a.string});var yE=n(1525);function gE(e){return(gE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vE(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function EE(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _E(e){return(_E=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function OE(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wE(e,t){return(wE=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function CE(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var SE=30;function PE(e){return _.a.createElement("div",Object.assign({},e,{className:"scrollbar--view"}))}function jE(e){return _.a.createElement("div",Object.assign({},e,{className:"scrollbar--horizontal"}))}function TE(e){return _.a.createElement("div",Object.assign({},e,{className:"scrollbar--vertical"}))}var kE=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=_E(t).call(this,e),n=!o||"object"!==gE(o)&&"function"!=typeof o?OE(r):o,CE(OE(n),"handleResize",function(){n.setState({windowWidth:T.mb(),windowHeight:T.lb()})}),CE(OE(n),"scrollToTop",function(){n.refs.scrollbars.scrollToTop()}),CE(OE(n),"handleScroll",function(){if(!(n.props.isFlaggedPosts||n.props.isPinnedPosts||n.props.isSearchingTerm||n.props.isSearchGettingMore)){var e=n.refs.scrollbars.getScrollHeight();n.refs.scrollbars.getScrollTop()+n.refs.scrollbars.getClientHeight()+SE>=e&&n.loadMorePosts()}}),CE(OE(n),"loadMorePosts",Object(au.debounce)(function(){n.props.actions.getMorePostsForSearch()},100)),n.state={windowWidth:T.mb(),windowHeight:T.lb()},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wE(e,t)}(t,_.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){this.scrollToTop(),window.addEventListener("resize",this.handleResize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleResize)}},{key:"shouldComponentUpdate",value:function(e,t){return function(e,t,n,r){for(var o in t)if(t.hasOwnProperty(o)&&"results"!==o&&t[o]!==e[o])return!0;for(var a in r)if(r.hasOwnProperty(a)&&r[a]!==n[a])return!0;var i=e.results,s=t.results;if(i.length!==s.length)return!0;for(var c=0;c<i.length;c++)if(i[c]!==s[c])return!0;return!1}(this.props,e,this.state,t)}},{key:"componentDidUpdate",value:function(e){this.props.searchTerms!==e.searchTerms&&this.scrollToTop()}},{key:"render",value:function(){var e=this,t=this.props.results,n=!t||0===t.length,r=this.props.searchTerms,o=null,a=null;if(this.props.isSearchingTerm||this.props.isSearchingFlaggedPost||this.props.isSearchingPinnedPost)o=_.a.createElement("div",{className:"sidebar--right__subheader"},_.a.createElement("div",{className:"sidebar--right__loading"},_.a.createElement(yE.a,{text:T.ab("search_header.loading","Searching")})));else if(this.props.isFlaggedPosts&&n)o=_.a.createElement("div",{className:"sidebar--right__subheader"},_.a.createElement(oE,{dataRetentionEnableMessageDeletion:this.props.dataRetentionEnableMessageDeletion,dataRetentionMessageRetentionDays:this.props.dataRetentionMessageRetentionDays}));else if(this.props.isPinnedPosts&&n)o=_.a.createElement("div",{className:"sidebar--right__subheader"},_.a.createElement(bE,{dataRetentionEnableMessageDeletion:this.props.dataRetentionEnableMessageDeletion,dataRetentionMessageRetentionDays:this.props.dataRetentionMessageRetentionDays}));else if(!r&&n)o=_.a.createElement("div",{className:"sidebar--right__subheader"},_.a.createElement(Zg,null));else if(n)o=_.a.createElement("div",{className:"sidebar--right__subheader"},_.a.createElement(uE,{dataRetentionEnableMessageDeletion:this.props.dataRetentionEnableMessageDeletion,dataRetentionMessageRetentionDays:this.props.dataRetentionMessageRetentionDays}));else{var i;this.props.isPinnedPosts?(i=vE(t)).sort(function(e,t){return t.create_at-e.create_at}):i=t,o=i.map(function(t){return _.a.createElement(Kv,{key:t.id,compactDisplay:e.props.compactDisplay,post:t,matches:e.props.matches[t.id],term:e.props.isFlaggedPosts||e.props.isPinnedPosts||e.props.isMentionSearch?"":r,isMentionSearch:e.props.isMentionSearch})},this),this.props.isSearchAtEnd||this.props.isFlaggedPosts||this.props.isPinnedPosts||(a=_.a.createElement("div",{className:"loading-screen"},_.a.createElement("div",{className:"loading__content"},_.a.createElement("div",{className:"round round-1"}),_.a.createElement("div",{className:"round round-2"}),_.a.createElement("div",{className:"round round-3"}))))}var s=_.a.createElement(Y.c,{id:"search_header.results",defaultMessage:"Search Results"});return this.props.isMentionSearch?s=_.a.createElement(Y.c,{id:"search_header.title2",defaultMessage:"Recent Mentions"}):this.props.isFlaggedPosts?s=_.a.createElement(Y.c,{id:"search_header.title3",defaultMessage:"Flagged Posts"}):this.props.isPinnedPosts?s=_.a.createElement(Y.c,{id:"search_header.title4",defaultMessage:"Pinned posts in {channelDisplayName}",values:{channelDisplayName:this.props.channelDisplayName}}):this.props.isCard&&(s=_.a.createElement(Y.c,{id:"search_header.title5",defaultMessage:"Extra information"})),_.a.createElement("div",{className:"sidebar-right__body"},_.a.createElement(wv,null,s),_.a.createElement(Fc.a,{ref:"scrollbars",autoHide:!0,autoHideTimeout:500,autoHideDuration:500,renderThumbHorizontal:jE,renderThumbVertical:TE,renderView:PE,onScroll:this.handleScroll},_.a.createElement("div",{id:"search-items-container",className:"search-items-container"},o,a)))}}])&&EE(n.prototype,r),o&&EE(n,o),t}();CE(kE,"propTypes",{results:v.a.array,matches:v.a.object,currentUser:v.a.object,searchTerms:v.a.string,isSearchingTerm:v.a.bool,isSearchingFlaggedPost:v.a.bool,isSearchingPinnedPost:v.a.bool,isSearchGettingMore:v.a.bool,isSearchAtEnd:v.a.bool,compactDisplay:v.a.bool,isMentionSearch:v.a.bool,isFlaggedPosts:v.a.bool,isPinnedPosts:v.a.bool,isCard:v.a.bool,channelDisplayName:v.a.string.isRequired,dataRetentionEnableMessageDeletion:v.a.bool.isRequired,dataRetentionMessageRetentionDays:v.a.string,actions:v.a.shape({getMorePostsForSearch:v.a.func.isRequired})}),CE(kE,"defaultProps",{matches:{},currentUser:{}});var NE=Object(r.connect)(function(){var e,t;return function(n){var r=Object(u.getConfig)(n),o="true"===r.DataRetentionEnableMessageDeletion,a=r.DataRetentionMessageRetentionDays,i="true"===r.ExperimentalViewArchivedChannels,s=Object(ea.getSearchResults)(n);s&&s!==e&&(t=[],(e=s).forEach(function(e){if(e){var r=Object(d.getChannel)(n,e.channel_id);r&&0!==r.delete_at&&!i||t.push(e)}}));var c=Object(bv.getCurrentSearchForCurrentTeam)(n)||{};return{results:t,matches:Object(ea.getSearchMatches)(n),currentUser:Object(p.getCurrentUser)(n),searchTerms:Object(Nc.l)(n),isSearchingTerm:Object(Nc.g)(n),isSearchingFlaggedPost:Object(Nc.e)(n),isSearchingPinnedPost:Object(Nc.f)(n),isSearchGettingMore:Object(Nc.d)(n),isSearchAtEnd:c.isEnd,compactDisplay:l.get(n,P.z.CATEGORY_DISPLAY_SETTINGS,P.z.MESSAGE_DISPLAY,P.z.MESSAGE_DISPLAY_DEFAULT)===P.z.MESSAGE_DISPLAY_COMPACT,dataRetentionEnableMessageDeletion:o,dataRetentionMessageRetentionDays:a}}},function(e){return{actions:Object(o.bindActionCreators)({getMorePostsForSearch:hv.getMorePostsForSearch},e)}})(kE);function RE(e){return(RE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ME(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function IE(e,t){return!t||"object"!==RE(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xE(e){return(xE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function AE(e,t){return(AE=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var LE=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),IE(this,xE(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&AE(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){return _.a.createElement("div",{id:"rhsContainer",className:"sidebar-right__body",ref:"sidebarbody"},_.a.createElement(wv,null,this.props.title),_.a.createElement(I.a,{pluggableName:"RightHandSidebarComponent",pluggableId:this.props.pluggableId}))}}])&&ME(n.prototype,r),o&&ME(n,o),t}();!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(LE,"propTypes",{title:v.a.oneOfType([v.a.string,v.a.object]),pluggableId:v.a.string.isRequired});var DE=Object(r.connect)(function(e){var t=e.plugins.components.RightHandSidebarComponent,n=Object(Nc.h)(e),r=t.find(function(e){return e.id===n});return{title:r?r.title:"",pluggableId:n}})(LE);function UE(e){return(UE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qE(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function HE(e){return(HE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function FE(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BE(e,t){return(BE=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function GE(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var VE=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=HE(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==UE(o)&&"function"!=typeof o?FE(r):o,GE(FE(n),"onShrink",function(){n.props.actions.setRhsExpanded(!1)}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&BE(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"componentDidUpdate",value:function(e){var t=e.searchVisible||e.postRightVisible,n=this.props.searchVisible||this.props.postRightVisible;!t&&n&&(Object(vt.d)("ui","ui_rhs_opened"),T.k()&&setTimeout(this.props.actions.scrollPostList,0));var r=this.props,o=r.actions,a=r.isPinnedPosts,i=r.channel;a&&e.isPinnedPosts===a&&i.id!==e.channel.id&&o.showPinnedPosts(i.id)}},{key:"render",value:function(){var e=this.props,t=e.channel,n=e.currentUserId,r=e.isFlaggedPosts,o=e.isMentionSearch,a=e.isPinnedPosts,i=e.postRightVisible,s=e.postCardVisible,c=e.previousRhsState,l=e.searchVisible,u=e.isPluginView,p=null,f="";this.props.isExpanded&&(f="sidebar--right--expanded");var d=null;n&&(d=_.a.createElement(mv,{isFocus:l&&!r&&!a}));var m="";return t&&(m=t.type===P.Q.DM_CHANNEL||t.type===P.Q.GM_CHANNEL?T.ab("rhs_root.direct","Direct Message"):t.display_name),l?p=_.a.createElement("div",{className:"sidebar--right__content"},_.a.createElement("div",{className:"search-bar__container channel-header alt"},d),_.a.createElement(NE,{isMentionSearch:o,isFlaggedPosts:r,isPinnedPosts:a,toggleSize:this.toggleSize,shrink:this.onShrink,channelDisplayName:m})):i?p=_.a.createElement("div",{className:"post-right__container"},_.a.createElement(Dc,{overlayType:"right"}),_.a.createElement("div",{className:"search-bar__container channel-header alt"},d),_.a.createElement(Cy,{previousRhsState:c,currentUserId:n,toggleSize:this.toggleSize,shrink:this.onShrink})):u?p=_.a.createElement("div",{className:"post-right__container"},_.a.createElement("div",{className:"search-bar__container channel-header alt"},d),_.a.createElement(DE,null)):s&&(p=_.a.createElement("div",{className:"post-right__container"},_.a.createElement("div",{className:"search-bar__container channel-header alt"},d),_.a.createElement(Gy,{previousRhsState:c}))),p||(f=""),_.a.createElement("div",{className:Mc()("sidebar--right",f,{"move--left":this.props.isOpen}),id:"sidebar-right"},_.a.createElement("div",{onClick:this.onShrink,className:"sidebar--right__bg"}),_.a.createElement("div",{className:"sidebar-right-container"},p))}}])&&qE(n.prototype,r),o&&qE(n,o),t}();GE(VE,"propTypes",{isExpanded:v.a.bool.isRequired,isOpen:v.a.bool.isRequired,currentUserId:v.a.string.isRequired,channel:v.a.object,postRightVisible:v.a.bool,postCardVisible:v.a.bool,searchVisible:v.a.bool,isMentionSearch:v.a.bool,isFlaggedPosts:v.a.bool,isPinnedPosts:v.a.bool,isPluginView:v.a.bool,previousRhsState:v.a.string,actions:v.a.shape({setRhsExpanded:v.a.func.isRequired,showPinnedPosts:v.a.func.isRequired,scrollPostList:v.a.func.isRequired})});var WE=Object(r.connect)(function(e){var t=Object(Nc.k)(e),n=Object(Nc.n)(e),r=null;if(n&&null==(r=Object(d.getChannel)(e,n))){var o=e.views.channel.focusedPostId,a=Object(ea.getPost)(e,o);null!=a&&(r=Object(d.getChannel)(e,a.channel_id))}return{isExpanded:Object(Nc.a)(e),isOpen:Object(Nc.c)(e),channel:r,currentUserId:Object(p.getCurrentUserId)(e),postRightVisible:Boolean(Object(Nc.s)(e)),postCardVisible:Boolean(Object(Nc.q)(e)),searchVisible:Boolean(t)&&t!==P.A.PLUGIN,previousRhsState:Object(Nc.j)(e),isMentionSearch:t===P.A.MENTION,isFlaggedPosts:t===P.A.FLAG,isPinnedPosts:t===P.A.PIN,isPluginView:t===P.A.PLUGIN}},function(e){return{actions:Object(o.bindActionCreators)({setRhsExpanded:kc.i,showPinnedPosts:kc.l,scrollPostList:Oo.j},e)}})(VE),KE=n(2381),zE=n(2041),YE=n.n(zE),QE=n(2042),ZE=n.n(QE);function JE(e){return(JE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function XE(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $E(e){return($E=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function e_(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function t_(e,t){return(t_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function n_(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var r_=P.Q.Preferences,o_=P.Q.TutorialSteps,a_=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=$E(t).call(this,e),n=!o||"object"!==JE(o)&&"function"!=typeof o?e_(r):o,n_(e_(n),"show",function(){n.setState({show:!0})}),n_(e_(n),"hide",function(){n.setState({show:!1})}),n_(e_(n),"handleNext",function(){if(n.state.currentScreen<n.props.screens.length-1)n.setState({currentScreen:n.state.currentScreen+1});else{if(n.props.diagnosticsTag){var e=n.props.diagnosticsTag;n.props.screens.length>1&&(e+="_"+(n.state.currentScreen+1).toString()),n.state.currentScreen===n.props.screens.length-1?e+="_okay":e+="_next",Object(vt.d)("tutorial",e)}var t=n.props,r=t.currentUserId,o=t.actions,a=o.closeRhsMenu,i=o.savePreferences,s=[{user_id:r,category:r_.TUTORIAL_STEP,name:r,value:(n.props.step+1).toString()}];a(),n.hide(),i(r,s)}}),n_(e_(n),"skipTutorial",function(e){if(e.preventDefault(),n.props.diagnosticsTag){var t=n.props.diagnosticsTag;n.props.screens.length>1&&(t+="_"+n.state.currentScreen),t+="_skip",Object(vt.d)("tutorial",t)}var r=n.props,o=r.currentUserId,a=r.actions,i=[{user_id:o,category:r_.TUTORIAL_STEP,name:o,value:o_.FINISHED.toString()}];a.savePreferences(o,i)}),n_(e_(n),"handleCircleClick",function(e,t){e.preventDefault(),n.setState({currentScreen:t})}),n_(e_(n),"getTarget",function(){return n.refs.target}),n.state={currentScreen:0,show:!1},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&t_(e,t)}(t,_.a.Component),n=t,(r=[{key:"render",value:function(){var e=this,t=this.state.currentScreen===this.props.screens.length-1?_.a.createElement(Y.c,{id:"tutorial_tip.ok",defaultMessage:"Okay"}):_.a.createElement(Y.c,{id:"tutorial_tip.next",defaultMessage:"Next"}),n=[];if(this.props.screens.length>1)for(var r=function(t){var r="circle";t===e.state.currentScreen&&(r+=" active"),n.push(_.a.createElement("a",{href:"#",key:"dotactive"+t,className:r,"data-screen":t,onClick:function(n){return e.handleCircleClick(n,t)}}))},o=0;o<this.props.screens.length;o++)r(o);var a=YE.a;return"tip-overlay--header"!==this.props.overlayClass&&"tip-overlay--sidebar"!==this.props.overlayClass&&"tip-overlay--header--up"!==this.props.overlayClass||(a=ZE.a),_.a.createElement("div",{id:"tipButton",className:"tip-div "+this.props.overlayClass,onClick:this.show},_.a.createElement("img",{alt:"tutorial tip",className:"tip-button",src:a,width:"35",onClick:this.show,ref:"target"}),_.a.createElement(ie.a,{show:this.state.show},_.a.createElement("div",{className:"tip-backdrop"})),_.a.createElement(ie.a,{placement:this.props.placement,show:this.state.show,rootClose:!0,onHide:this.hide,target:this.getTarget},_.a.createElement("div",{className:"tip-overlay "+this.props.overlayClass},_.a.createElement("div",{className:"arrow"}),this.props.screens[this.state.currentScreen],_.a.createElement("div",{className:"tutorial__footer"},_.a.createElement("div",{className:"tutorial__circles"},n),_.a.createElement("div",{className:"text-right"},_.a.createElement("button",{id:"tipNextButton",className:"btn btn-primary",onClick:this.handleNext},t),_.a.createElement("div",{className:"tip-opt"},_.a.createElement(Y.c,{id:"tutorial_tip.seen",defaultMessage:"Seen this before? "}),_.a.createElement("a",{href:"#",onClick:this.skipTutorial},_.a.createElement(Y.c,{id:"tutorial_tip.out",defaultMessage:"Opt out of these tips."}))))))))}}])&&XE(n.prototype,r),o&&XE(n,o),t}();n_(a_,"propTypes",{currentUserId:v.a.string.isRequired,step:v.a.number.isRequired,screens:v.a.array.isRequired,placement:v.a.string.isRequired,overlayClass:v.a.string,diagnosticsTag:v.a.string,actions:v.a.shape({closeRhsMenu:v.a.func.isRequired,savePreferences:v.a.func.isRequired})}),n_(a_,"defaultProps",{overlayClass:""});var i_=Object(r.connect)(function(e){var t=Object(p.getCurrentUserId)(e);return{currentUserId:t,step:Object(l.getInt)(e,P.z.TUTORIAL_STEP,t,0)}},function(e){return{actions:Object(o.bindActionCreators)({closeRhsMenu:kc.a,savePreferences:cc.savePreferences},e)}})(a_),s_=function(e){var t=e.toggleFunc,n=e.onBottom,r=[];r.push(_.a.createElement("div",null,_.a.createElement("h4",null,_.a.createElement(Y.c,{id:"sidebar_header.tutorial.title",defaultMessage:"Main Menu"})),_.a.createElement("p",null,_.a.createElement(Fu.b,{id:"sidebar_header.tutorial.body1",defaultMessage:"The **Main Menu** is where you can **Invite New Members**, access your **Account Settings** and set your **Theme Color**."})),_.a.createElement("p",null,_.a.createElement(Fu.b,{id:"sidebar_header.tutorial.body2",defaultMessage:"Team administrators can also access their **Team Settings** from this menu."})),_.a.createElement("p",null,_.a.createElement(Fu.b,{id:"sidebar_header.tutorial.body3",defaultMessage:"System administrators will find a **System Console** option to administrate the entire system."}))));var o="right",a="left";return n&&(o="bottom",a="up"),_.a.createElement("div",{onClick:t},_.a.createElement(i_,{placement:o,screens:r,overlayClass:"tip-overlay--header--"+a,diagnosticsTag:"tutorial_tip_3_main_menu"}))};s_.propTypes={toggleFunc:v.a.func,onBottom:v.a.bool.isRequired};var c_=s_,l_=n(76);function u_(e){return(u_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p_(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function f_(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){v_(e,t,n[t])})}return e}function d_(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function m_(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){d_(a,r,o,i,s,"next",e)}function s(e){d_(a,r,o,i,s,"throw",e)}i(void 0)})}}function h_(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function b_(e){return(b_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y_(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g_(e,t){return(g_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v_(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var E_=Object(Y.g)({emailError:{id:Object(Ne.b)("invite_member.emailError"),defaultMessage:"Please enter a valid email address"},firstname:{id:Object(Ne.b)("invite_member.firstname"),defaultMessage:"First name"},lastname:{id:Object(Ne.b)("invite_member.lastname"),defaultMessage:"Last name"},modalTitle:{id:Object(Ne.b)("invite_member.modalTitle"),defaultMessage:"Discard Invitations?"},modalMessage:{id:Object(Ne.b)("invite_member.modalMessage"),defaultMessage:"You have unsent invitations, are you sure you want to discard them?"},modalButton:{id:Object(Ne.b)("invite_member.modalButton"),defaultMessage:"Yes, Discard"}}),__=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=b_(t).call(this,e),n=!o||"object"!==u_(o)&&"function"!=typeof o?y_(r):o,v_(y_(n),"onHide",function(){n.setState({show:!1})}),v_(y_(n),"handleSubmit",m_(regeneratorRuntime.mark(function e(){var t,r,o,a,i,s,c,l,u,p,f,d,m,h;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(t=n.state.inviteIds,r=t.length,o=[],a=[],i=f_({},n.state.emailErrors),s=f_({},n.state.firstNameErrors),c=f_({},n.state.lastNameErrors),l=!0,u=0;u<r;u++)p={},f=t[u],p.email=uu.a.findDOMNode(n.refs["email"+f]).value.trim(),p.firstName=uu.a.findDOMNode(n.refs["first_name"+f]).value.trim(),p.lastName=uu.a.findDOMNode(n.refs["last_name"+f]).value.trim(),""===p.email&&0!==f||(p.email&&Object(l_.isEmail)(p.email)?i[f]="":(i[f]=n.props.intl.formatMessage(E_.emailError),l=!1),o.push(p));if(n.setState({emailErrors:i,firstNameErrors:s,lastNameErrors:c}),l&&0!==o.length){e.next=12;break}return e.abrupt("return");case 12:return o.forEach(function(e){a.push(e.email)}),n.setState({isSendingEmails:!0}),e.next=16,n.props.actions.sendEmailInvitesToTeam(n.props.teamId,a);case 16:d=e.sent,m=d.data,h=d.error,m?(n.handleHide(!1),n.setState({isSendingEmails:!1})):h&&("api.team.invite_members.already.app_error"===h.id?(i[h.detailed_error]=h.message,n.setState({emailErrors:i})):n.setState({serverError:h.message}),n.setState({isSendingEmails:!1}));case 20:case"end":return e.stop()}},e)}))),v_(y_(n),"handleHide",function(e){if(e){for(var t=!1,r=0;r<n.state.inviteIds.length;r++){var o=n.state.inviteIds[r];if(""!==uu.a.findDOMNode(n.refs["email"+o]).value.trim()){t=!0;break}}if(t)return void n.setState({showConfirmModal:!0})}n.clearFields(),n.setState({show:!1,showConfirmModal:!1})}),v_(y_(n),"addInviteFields",function(){var e=n.state.idCount+1,t=p_(n.state.inviteIds);t.push(e),n.setState({inviteIds:t,idCount:e})}),v_(y_(n),"clearFields",function(){for(var e=n.state.inviteIds,t=0;t<e.length;t++){var r=e[t];uu.a.findDOMNode(n.refs["email"+r]).value="",uu.a.findDOMNode(n.refs["first_name"+r]).value="",uu.a.findDOMNode(n.refs["last_name"+r]).value=""}n.setState({inviteIds:[0],idCount:0,emailErrors:{},firstNameErrors:{},lastNameErrors:{}})}),v_(y_(n),"removeInviteFields",function(e){var t=n.state.idCount,r=n.state.inviteIds.filter(function(t){return t!==e});r.length||r.push(++t),n.setState({inviteIds:r,idCount:t})}),v_(y_(n),"showGetTeamInviteLinkModal",function(){n.handleHide(!1),S.l()}),v_(y_(n),"handleKeyDown",function(e){T.S(e,P.Q.KeyCodes.ENTER)&&(e.preventDefault(),n.handleSubmit())}),v_(y_(n),"hideConfirmModal",function(){n.setState({showConfirmModal:!1})}),n.state={show:!0,inviteIds:[0],idCount:0,emailErrors:{},firstNameErrors:{},lastNameErrors:{},showConfirmModal:!1,isSendingEmails:!1},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g_(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e=this.props.currentUser,t=this.props.intl.formatMessage;if(null!=e&&null!=this.props.teamType){for(var n=[],r=this.state.inviteIds,o=0;o<r.length;o++){var a=r[o],i=null;this.state.emailErrors[a]&&(i=_.a.createElement("label",{className:"control-label"},this.state.emailErrors[a]));var s=null;this.state.firstNameErrors[a]&&(s=_.a.createElement("label",{className:"control-label"},this.state.firstNameErrors[a]));var c=null;this.state.lastNameErrors[a]&&(c=_.a.createElement("label",{className:"control-label"},this.state.lastNameErrors[a]));var l=null;a&&(l=_.a.createElement("div",null,_.a.createElement("button",{type:"button",className:"btn btn-link remove__member",onClick:this.removeInviteFields.bind(this,a)},_.a.createElement("span",{className:"fa fa-trash",title:t({id:"generic_icons.remove",defaultMessage:"Remove Icon"})}))));var u="form-group invite";i&&(u+=" has-error");var p,f="form-group";s&&(f+=" has-error");var d="form-group";c&&(d+=" has-error"),p=_.a.createElement("div",{className:"row row--invite"},_.a.createElement("div",{className:"col-sm-6"},_.a.createElement("div",{className:f},_.a.createElement(ke.a,{onKeyDown:this.handleKeyDown,type:"text",className:"form-control",ref:"first_name"+a,placeholder:E_.firstname,maxLength:"64",disabled:!this.props.enableUserCreation,spellCheck:"false"}),s)),_.a.createElement("div",{className:"col-sm-6"},_.a.createElement("div",{className:d},_.a.createElement(ke.a,{onKeyDown:this.handleKeyDown,type:"text",className:"form-control",ref:"last_name"+a,placeholder:E_.lastname,maxLength:"64",disabled:!this.props.enableUserCreation,spellCheck:"false"}),c))),n[a]=_.a.createElement("div",{key:"key"+a},l,_.a.createElement("div",{className:u},_.a.createElement("input",{onKeyUp:this.displayNameKeyUp,onKeyDown:this.handleKeyDown,type:"text",ref:"email"+a,className:"form-control",placeholder:"email@domain.com",maxLength:"64",disabled:!this.props.enableUserCreation,spellCheck:"false",autoFocus:!0}),i),p)}var m=null;this.state.serverError&&(m=_.a.createElement("div",{className:"form-group has-error"},_.a.createElement("label",{className:"control-label"},this.state.serverError)));var h=null,b=null;if(this.props.enableUserCreation){h=_.a.createElement("div",null,m,_.a.createElement("button",{type:"button",className:"btn btn-link",onClick:this.addInviteFields},_.a.createElement(Y.c,{id:"invite_member.addAnother",defaultMessage:"Add another"})),_.a.createElement("br",null),_.a.createElement("br",null),_.a.createElement("span",null,_.a.createElement(Fu.b,{id:"invite_member.autoJoin",defaultMessage:"People invited automatically join the **{channel}** channel.",values:{channel:this.props.defaultChannelName}})));var y=_.a.createElement(Y.c,{id:"invite_member.send",defaultMessage:"Send Invitation"});this.state.inviteIds.length>1&&(y=_.a.createElement(Y.c,{id:"invite_member.send2",defaultMessage:"Send Invitations"})),b=_.a.createElement("button",{onClick:this.handleSubmit,type:"button",className:"btn btn-primary",disabled:this.state.isSendingEmails},_.a.createElement(yE.a,{loading:this.state.isSendingEmails,text:T.ab("invite_member.sending"," Sending")},y))}else if(this.props.enableUserCreation){var g=null;if(e&&"O"===this.props.teamType){var v=_.a.createElement("button",{className:"color--link style--none",onClick:this.showGetTeamInviteLinkModal},_.a.createElement(Y.c,{id:"invite_member.inviteLink",defaultMessage:"Team Invite Link"}));g=_.a.createElement("p",null,_.a.createElement(Y.c,{id:"invite_member.teamInviteLink",defaultMessage:"You can also invite people using the {link}.",values:{link:v}}))}h=_.a.createElement("div",null,_.a.createElement("p",null,_.a.createElement(Y.c,{id:"invite_member.content",defaultMessage:"Email is currently disabled for your team, and email invitations cannot be sent. Contact your System Administrator to enable email and email invitations."})),g)}else h=_.a.createElement("div",null,_.a.createElement("p",null,_.a.createElement(Y.c,{id:"invite_member.disabled",defaultMessage:"User creation has been disabled for your team. Please ask your Team Administrator for details."})));return _.a.createElement("div",null,_.a.createElement(z.a,{dialogClassName:"a11y__modal modal-invite-member",show:this.state.show,onHide:this.handleHide.bind(this,!0),onExited:this.props.onHide,enforceFocus:!this.state.showConfirmModal,backdrop:!this.state.isSendingEmails||"static",role:"dialog","aria-labelledby":"inviteMemberModalLabel"},_.a.createElement(z.a.Header,{closeButton:!this.state.isSendingEmails},_.a.createElement(z.a.Title,{componentClass:"h1",id:"inviteMemberModalLabel"},_.a.createElement(Y.c,{id:"invite_member.newMember",defaultMessage:"Send Email Invite"}))),_.a.createElement(z.a.Body,{ref:"modalBody"},_.a.createElement("form",null,n),h),_.a.createElement(z.a.Footer,null,_.a.createElement("button",{type:"button",className:"btn btn-link",onClick:this.handleHide.bind(this,!0),disabled:this.state.isSendingEmails},_.a.createElement(Y.c,{id:"invite_member.cancel",defaultMessage:"Cancel"})),b)),_.a.createElement(Xs.a,{title:t(E_.modalTitle),message:t(E_.modalMessage),confirmButtonText:t(E_.modalButton),show:this.state.showConfirmModal,onConfirm:this.handleHide.bind(this,!1),onCancel:this.hideConfirmModal}))}return null}}])&&h_(n.prototype,r),o&&h_(n,o),t}();v_(__,"propTypes",{intl:Y.i.isRequired,enableUserCreation:v.a.bool.isRequired,currentUser:v.a.object.isRequired,defaultChannelName:v.a.string.isRequired,teamType:v.a.string.isRequired,teamId:v.a.string.isRequired,onHide:v.a.func.isRequired,actions:v.a.shape({sendEmailInvitesToTeam:v.a.func.isRequired}).isRequired});var O_=Object(Y.h)(__);var w_=Object(r.connect)(function(e){var t="true"===Object(u.getConfig)(e).EnableUserCreation,n=Object(d.getChannelsNameMapInCurrentTeam)(e)[P.Q.DEFAULT_CHANNEL],r=Object(f.getCurrentTeam)(e);return{enableUserCreation:t,currentUser:Object(p.getCurrentUser)(e),defaultChannelName:n?n.display_name:"",teamType:r?r.type:"",teamId:r?r.id:""}},function(e){return{actions:Object(o.bindActionCreators)({sendEmailInvitesToTeam:c.sendEmailInvitesToTeam},e)}})(O_),C_=n(1588),S_=n(1570);function P_(e){return(P_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function j_(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function T_(e,t){return!t||"object"!==P_(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function k_(e){return(k_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function N_(e,t){return(N_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var R_=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),T_(this,k_(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&N_(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){return _.a.createElement("span",this.props,_.a.createElement(Y.c,{id:"navbar_dropdown.leave.icon",defaultMessage:"Leave Team Icon"},function(e){return _.a.createElement("svg",{width:"100%",height:"100%",viewBox:"0 0 164 164",style:M_,role:"icon","aria-label":e},_.a.createElement("path",{d:"M26.023,164L26.023,7.035L26.022,0.32L137.658,0.32L137.658,164L124.228,164L124.228, 13.749L39.452,13.749L39.452,164L26.023, 164ZM118.876,164L118.876,18.619L58.137,32.918L58.137,149.701L118.876,164Z"}))}))}}])&&j_(n.prototype,r),o&&j_(n,o),t}(),M_={fillRule:"evenodd",clipRule:"evenodd",strokeLinejoin:"round",strokeMiterlimit:1.41421},I_=n(1580);function x_(e){return(x_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function A_(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function L_(e){return(L_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function D_(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function U_(e,t){return(U_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function q_(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var H_=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=L_(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==x_(o)&&"function"!=typeof o?D_(r):o,q_(D_(n),"handleKeyPress",function(e){Object(T.S)(e,P.Q.KeyCodes.ENTER)&&n.handleSubmit(e)}),q_(D_(n),"handleSubmit",function(){n.props.onHide(),n.props.actions.leaveTeam(n.props.currentTeamId,n.props.currentUserId),n.props.actions.toggleSideBarRightMenu()}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&U_(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"componentDidMount",value:function(){this.props.show&&document.addEventListener("keypress",this.handleKeyPress)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keypress",this.handleKeyPress)}},{key:"render",value:function(){return _.a.createElement(z.a,{dialogClassName:"a11y__modal",className:"modal-confirm",show:this.props.show,onHide:this.props.onHide,id:"leaveTeamModal",role:"dialog","aria-labelledby":"leaveTeamModalLabel"},_.a.createElement(z.a.Header,{closeButton:!1},_.a.createElement(z.a.Title,{componentClass:"h1",id:"leaveTeamModalLabel"},_.a.createElement(Y.c,{id:"leave_team_modal.title",defaultMessage:"Leave the team?"}))),_.a.createElement(z.a.Body,null,_.a.createElement(Y.c,{id:"leave_team_modal.desc",defaultMessage:"You will be removed from all public and private channels.  If the team is private you will not be able to rejoin the team.  Are you sure?"})),_.a.createElement(z.a.Footer,null,_.a.createElement("button",{type:"button",className:"btn btn-link",onClick:this.props.onHide,id:"leaveTeamNo"},_.a.createElement(Y.c,{id:"leave_team_modal.no",defaultMessage:"No"})),_.a.createElement("button",{type:"button",className:"btn btn-danger",onClick:this.handleSubmit,id:"leaveTeamYes"},_.a.createElement(Y.c,{id:"leave_team_modal.yes",defaultMessage:"Yes"}))))}}])&&A_(n.prototype,r),o&&A_(n,o),t}();q_(H_,"propTypes",{currentUserId:v.a.string.isRequired,currentTeamId:v.a.string.isRequired,onHide:v.a.func.isRequired,show:v.a.bool.isRequired,intl:Y.i.isRequired,actions:v.a.shape({leaveTeam:v.a.func.isRequired,toggleSideBarRightMenu:v.a.func.isRequired})});var F_=Object(Y.h)(H_);var B_=Object(r.connect)(function(e){var t=P.r.LEAVE_TEAM;return{currentUserId:Object(p.getCurrentUserId)(e),currentTeamId:Object(f.getCurrentTeamId)(e),show:Object(I_.a)(e,t)}},function(e){return{actions:Object(o.bindActionCreators)({leaveTeam:c.removeUserFromTeam,toggleSideBarRightMenu:S.o},e)}})(F_),G_=n(1546),V_=n(1865);function W_(e){return(W_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function K_(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function z_(e){return(z_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Y_(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Q_(e,t){return(Q_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Z_=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=z_(t).call(this,e))||"object"!==W_(o)&&"function"!=typeof o?Y_(r):o).handleTermChange=n.handleTermChange.bind(Y_(n)),n.nextPage=n.nextPage.bind(Y_(n)),n.previousPage=n.previousPage.bind(Y_(n)),n.search=n.search.bind(Y_(n)),n.state={term:"",page:0},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Q_(e,t)}(t,_.a.Component),n=t,(r=[{key:"handleTermChange",value:function(e){this.setState({term:e})}},{key:"nextPage",value:function(){this.setState({page:this.state.page+1}),this.props.nextPage(this.state.page+1)}},{key:"previousPage",value:function(){this.setState({page:this.state.page-1})}},{key:"search",value:function(e){this.props.search(e),""!==e&&this.setState({page:0})}},{key:"render",value:function(){return _.a.createElement(V_.a,Object.assign({},this.props,{nextPage:this.nextPage,previousPage:this.previousPage,search:this.search,page:this.state.page,term:this.state.term,onTermChange:this.handleTermChange}))}}])&&K_(n.prototype,r),o&&K_(n,o),t}();function J_(e){return(J_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function X_(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $_(e,t){return!t||"object"!==J_(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function eO(e){return(eO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function tO(e,t){return(tO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Z_,"propTypes",{users:v.a.arrayOf(v.a.object),usersPerPage:v.a.number,total:v.a.number,extraInfo:v.a.object,nextPage:v.a.func.isRequired,search:v.a.func.isRequired,actions:v.a.arrayOf(v.a.func),actionProps:v.a.object,actionUserProps:v.a.object,focusOnMount:v.a.bool});var nO=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),$_(this,eO(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tO(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){return _.a.createElement(Y.c,{id:"generic_icons.dropdown",defaultMessage:"Dropdown Icon"},function(e){return _.a.createElement("i",{className:"fa fa-angle-down",title:e})})}}])&&X_(n.prototype,r),o&&X_(n,o),t}();function rO(e){return(rO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function oO(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function aO(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){oO(a,r,o,i,s,"next",e)}function s(e){oO(a,r,o,i,s,"throw",e)}i(void 0)})}}function iO(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function sO(e){return(sO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function cO(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lO(e,t){return(lO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function uO(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var pO=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=sO(t).call(this,e),n=!o||"object"!==rO(o)&&"function"!=typeof o?cO(r):o,uO(cO(n),"handleMakeMember",aO(regeneratorRuntime.mark(function e(){var t,r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.props.currentUser,n.props.user.id!==t.id||!t.roles.includes("system_admin")){e.next=5;break}n.handleDemote(n.props.user,"team_user"),e.next=19;break;case 5:return e.next=7,n.props.actions.updateTeamMemberSchemeRoles(n.props.teamMember.team_id,n.props.user.id,!0,!1);case 7:if(r=e.sent,!(o=r.error)){e.next=13;break}n.setState({serverError:o.message}),e.next=19;break;case 13:if(n.props.actions.getUser(n.props.user.id),n.props.actions.getTeamMember(n.props.teamMember.team_id,n.props.user.id),n.props.user.id!==t.id){e.next=19;break}return e.next=18,n.props.actions.getMyTeamMembers();case 18:n.props.actions.getMyTeamUnreads();case 19:case"end":return e.stop()}},e)}))),uO(cO(n),"handleRemoveFromTeam",aO(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.props.actions.removeUserFromTeamAndGetStats(n.props.teamMember.team_id,n.props.user.id);case 2:t=e.sent,(r=t.error)&&n.setState({serverError:r.message});case 5:case"end":return e.stop()}},e)}))),uO(cO(n),"handleMakeAdmin",aO(regeneratorRuntime.mark(function e(){var t,r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.props.currentUser,n.props.user.id!==t.id||!t.roles.includes("system_admin")){e.next=5;break}n.handleDemote(n.props.user,"team_user team_admin"),e.next=10;break;case 5:return e.next=7,n.props.actions.updateTeamMemberSchemeRoles(n.props.teamMember.team_id,n.props.user.id,!0,!0);case 7:r=e.sent,(o=r.error)?n.setState({serverError:o.message}):(n.props.actions.getUser(n.props.user.id),n.props.actions.getTeamMember(n.props.teamMember.team_id,n.props.user.id));case 10:case"end":return e.stop()}},e)}))),uO(cO(n),"handleDemote",function(e,t,r){n.setState({serverError:n.state.serverError,showDemoteModal:!0,user:e,role:t,newRole:r})}),uO(cO(n),"handleDemoteCancel",function(){n.setState({serverError:null,showDemoteModal:!1,user:null,role:null,newRole:null})}),uO(cO(n),"handleDemoteSubmit",aO(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.props.actions.updateTeamMemberSchemeRoles(n.props.teamMember.team_id,n.props.user.id,!0,!1);case 2:t=e.sent,(r=t.error)?n.setState({serverError:r.message}):(n.props.actions.getUser(n.props.user.id),Q.a.push(n.props.teamUrl));case 5:case"end":return e.stop()}},e)}))),n.state={serverError:null,showDemoteModal:!1,user:null,role:null},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lO(e,t)}(t,_.a.Component),n=t,(r=[{key:"render",value:function(){var e=null;this.state.serverError&&(e=_.a.createElement("div",{className:"has-error"},_.a.createElement("label",{className:"has-error control-label"},this.state.serverError)));var t=this.props,n=t.currentTeam,r=t.teamMember,o=t.user,a=_.a.createElement(Y.c,{id:"team_members_dropdown.member",defaultMessage:"Member"});(r.roles.length>0&&T.L(r.roles)||r.scheme_admin)&&(a=_.a.createElement(Y.c,{id:"team_members_dropdown.teamAdmin",defaultMessage:"Team Admin"})),o.roles.length>0&&T.W(o.roles)&&(a=_.a.createElement(Y.c,{id:"team_members_dropdown.systemAdmin",defaultMessage:"System Admin"}));var i=this.props.currentUser,s=(T.L(r.roles)||r.scheme_admin)&&!T.W(o.roles),c=!T.L(r.roles)&&!T.W(o.roles)&&!r.scheme_admin;o.delete_at>0&&(a=_.a.createElement(Y.c,{id:"team_members_dropdown.inactive",defaultMessage:"Inactive"}),s=!1,c=!1);var l=o.id!==i.id&&!n.group_constrained,u=null;if(o.id===i.id){var p=_.a.createElement(Y.c,{id:"team_members_dropdown.confirmDemoteRoleTitle",defaultMessage:"Confirm demotion from System Admin role"}),f=_.a.createElement("div",null,_.a.createElement(Y.c,{id:"team_members_dropdown.confirmDemoteDescription",defaultMessage:"If you demote yourself from the System Admin role and there is not another user with System Admin privileges, you'll need to re-assign a System Admin by accessing the Mattermost server through a terminal and running the following command."}),_.a.createElement("br",null),_.a.createElement("br",null),_.a.createElement(Y.c,{id:"team_members_dropdown.confirmDemotionCmd",defaultMessage:"platform roles system_admin {username}",vallues:{username:i.username}}),e),d=_.a.createElement(Y.c,{id:"team_members_dropdown.confirmDemotion",defaultMessage:"Confirm Demotion"});u=_.a.createElement(Xs.a,{show:this.state.showDemoteModal,title:p,message:f,confirmButtonText:d,onConfirm:this.handleDemoteSubmit,onCancel:this.handleDemoteCancel})}if(!l&&!c&&!s)return _.a.createElement("div",null,a);var m=this.props,h=m.index,b=m.totalUsers,y=!1;return b>3&&b-h<=3&&(y=!0),_.a.createElement(pu.a,null,_.a.createElement("button",{id:"teamMembersDropdown_".concat(o.username),className:"dropdown-toggle theme color--link style--none",type:"button","aria-expanded":"true"},_.a.createElement("span",null,a," "),_.a.createElement(nO,null)),_.a.createElement("div",null,_.a.createElement(fu.a,{openLeft:!0,openUp:y,ariaLabel:T.ab("team_members_dropdown.menuAriaLabel","Team member role change")},_.a.createElement(Dp.a,{id:"removeFromTeam",show:l,onClick:this.handleRemoveFromTeam,text:T.ab("team_members_dropdown.leave_team","Remove From Team")}),_.a.createElement(Dp.a,{show:c,onClick:this.handleMakeAdmin,text:T.ab("team_members_dropdown.makeAdmin","Make Team Admin")}),_.a.createElement(Dp.a,{show:s,onClick:this.handleMakeMember,text:T.ab("team_members_dropdown.makeMember","Make Member")})),u,e))}}])&&iO(n.prototype,r),o&&iO(n,o),t}();uO(pO,"propTypes",{user:v.a.object.isRequired,currentUser:v.a.object.isRequired,teamMember:v.a.object.isRequired,teamUrl:v.a.string.isRequired,currentTeam:v.a.object.isRequired,index:v.a.number.isRequired,totalUsers:v.a.number.isRequired,actions:v.a.shape({getMyTeamMembers:v.a.func.isRequired,getMyTeamUnreads:v.a.func.isRequired,getUser:v.a.func.isRequired,getTeamMember:v.a.func.isRequired,getTeamStats:v.a.func.isRequired,getChannelStats:v.a.func.isRequired,updateTeamMemberSchemeRoles:v.a.func.isRequired,removeUserFromTeamAndGetStats:v.a.func.isRequired,updateUserActive:v.a.func.isRequired}).isRequired});var fO=Object(r.connect)(function(e){return{currentUser:Object(p.getCurrentUser)(e),currentChannelId:Object(d.getCurrentChannelId)(e),teamUrl:Object(f.getCurrentRelativeTeamUrl)(e),currentTeam:Object(f.getCurrentTeam)(e)}},function(e){return{actions:Object(o.bindActionCreators)({getMyTeamMembers:c.getMyTeamMembers,getMyTeamUnreads:c.getMyTeamUnreads,getUser:i.getUser,getTeamMember:c.getTeamMember,getTeamStats:c.getTeamStats,getChannelStats:s.getChannelStats,updateUserActive:i.updateUserActive,updateTeamMemberSchemeRoles:c.updateTeamMemberSchemeRoles,removeUserFromTeamAndGetStats:b.d},e)}})(pO);function dO(e){return(dO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mO(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function hO(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){mO(a,r,o,i,s,"next",e)}function s(e){mO(a,r,o,i,s,"throw",e)}i(void 0)})}}function bO(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function yO(e){return(yO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function gO(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vO(e,t){return(vO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function EO(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _O=50,OO=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=yO(t).call(this,e),n=!o||"object"!==dO(o)&&"function"!=typeof o?gO(r):o,EO(gO(n),"loadComplete",function(){n.setState({loading:!1})}),EO(gO(n),"nextPage",function(e){n.props.actions.loadProfilesAndTeamMembers(e+1,_O)}),EO(gO(n),"search",function(e){n.props.actions.setModalSearchTerm(e)}),n.searchTimeoutId=0,n.state={loading:!0},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vO(e,t)}(t,_.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){var e=this;this.props.actions.loadProfilesAndTeamMembers(0,P.Q.PROFILE_CHUNK_SIZE,this.props.currentTeamId).then(function(t){t.data&&e.loadComplete()}),this.props.actions.getTeamStats(this.props.currentTeamId)}},{key:"componentWillUnmount",value:function(){this.props.actions.setModalSearchTerm("")}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this;if(this.props.searchTerm!==e.searchTerm){clearTimeout(this.searchTimeoutId);var n=e.searchTerm;if(""===n)return this.loadComplete(),void(this.searchTimeoutId="");var r=setTimeout(hO(regeneratorRuntime.mark(function o(){var a,i,s,c,l,u;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return a=e.actions,i=a.loadStatusesForProfilesList,s=a.loadTeamMembersForProfilesList,c=a.searchProfiles,o.next=3,c(n,{team_id:e.currentTeamId});case 3:if(l=o.sent,u=l.data,r===t.searchTimeoutId){o.next=7;break}return o.abrupt("return");case 7:t.setState({loading:!0}),i(u),s(u,e.currentTeamId).then(function(e){e.data&&t.loadComplete()});case 10:case"end":return o.stop()}},o)})),P.Q.SEARCH_TIMEOUT_MILLISECONDS);this.searchTimeoutId=r}}},{key:"render",value:function(){var e=null;this.props.canManageTeamMembers&&(e=[fO]);var t,n=this.props.teamMembers,r=this.props.users,o={};if(this.state.loading)t=null;else{t=[];for(var a=0;a<r.length;a++){var i=r[a];n[i.id]&&0===i.delete_at&&(t.push(i),o[i.id]={teamMember:n[i.id]})}}return _.a.createElement(Z_,{users:t,usersPerPage:_O,total:this.props.totalTeamMembers,nextPage:this.nextPage,search:this.search,actions:e,actionUserProps:o,focusOnMount:!j.m()})}}])&&bO(n.prototype,r),o&&bO(n,o),t}();EO(OO,"propTypes",{searchTerm:v.a.string.isRequired,users:v.a.arrayOf(v.a.object).isRequired,teamMembers:v.a.object.isRequired,currentTeamId:v.a.string.isRequired,totalTeamMembers:v.a.number.isRequired,canManageTeamMembers:v.a.bool,actions:v.a.shape({searchProfiles:v.a.func.isRequired,getTeamStats:v.a.func.isRequired,loadProfilesAndTeamMembers:v.a.func.isRequired,loadStatusesForProfilesList:v.a.func.isRequired,loadTeamMembersForProfilesList:v.a.func.isRequired,setModalSearchTerm:v.a.func.isRequired}).isRequired});var wO=Object(r.connect)(function(e,t){var n,r=Object(D.haveITeamPermission)(e,{team:t.teamId,permission:L.Permissions.MANAGE_TEAM_ROLES}),o=e.views.search.modalSearch;n=o?Object(p.searchProfilesInCurrentTeam)(e,o):Object(p.getProfilesInCurrentTeam)(e);var a=Object(f.getCurrentTeamStats)(e)||{active_member_count:0};return{searchTerm:o,users:n,teamMembers:Object(f.getMembersInCurrentTeam)(e)||{},currentTeamId:e.entities.teams.currentTeamId,totalTeamMembers:a.active_member_count,canManageTeamMembers:r}},function(e){return{actions:Object(o.bindActionCreators)({searchProfiles:i.searchProfiles,getTeamStats:c.getTeamStats,loadProfilesAndTeamMembers:lc.g,loadStatusesForProfilesList:m.b,loadTeamMembersForProfilesList:lc.m,setModalSearchTerm:G_.a},e)}})(OO);function CO(e){return(CO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function SO(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function PO(e){return(PO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function jO(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function TO(e,t){return(TO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function kO(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var NO=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=PO(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==CO(o)&&"function"!=typeof o?jO(r):o,kO(jO(n),"onHide",function(){n.props.onHide()}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&TO(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"componentDidMount",value:function(){this.props.onLoad&&this.props.onLoad()}},{key:"render",value:function(){var e="";return this.props.currentTeam&&(e=this.props.currentTeam.display_name),_.a.createElement(z.a,{dialogClassName:"a11y__modal more-modal",show:this.props.show,onHide:this.onHide,onExited:this.props.onHide,role:"dialog","aria-labelledby":"teamMemberModalLabel"},_.a.createElement(z.a.Header,{closeButton:!0},_.a.createElement(z.a.Title,{componentClass:"h1",id:"teamMemberModalLabel"},_.a.createElement(Y.c,{id:"team_member_modal.members",defaultMessage:"{team} Members",values:{team:e}}))),_.a.createElement(z.a.Body,null,_.a.createElement(wO,{teamId:this.props.currentTeam.id})))}}])&&SO(n.prototype,r),o&&SO(n,o),t}();kO(NO,"propTypes",{show:v.a.bool.isRequired,currentTeam:v.a.object.isRequired,onHide:v.a.func.isRequired,onLoad:v.a.func});var RO=Object(r.connect)(function(e){var t=P.r.TEAM_MEMBERS;return{currentTeam:Object(f.getCurrentTeam)(e),show:Object(I_.a)(e,t)}})(NO),MO=n(1761),IO=n.n(MO),xO=n(1506),AO=n(1517),LO=n(1789),DO=n(1600);function UO(e){return(UO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qO(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){KO(e,t,n[t])})}return e}function HO(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function FO(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){HO(a,r,o,i,s,"next",e)}function s(e){HO(a,r,o,i,s,"throw",e)}i(void 0)})}}function BO(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function GO(e){return(GO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function VO(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function WO(e,t){return(WO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function KO(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var zO=["image/jpeg","image/png","image/bmp"],YO=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=GO(t).call(this,e),n=!o||"object"!==UO(o)&&"function"!=typeof o?VO(r):o,KO(VO(n),"handleAllowedDomainsSubmit",FO(regeneratorRuntime.mark(function e(){var t,r,o,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={serverError:"",clientError:""},(r=qO({},n.props.team)).allowed_domains=n.state.allowed_domains,e.next=5,n.props.actions.patchTeam(r);case 5:o=e.sent,(a=o.error)?(t.serverError=a.message,n.setState(t)):n.updateSection("");case 8:case"end":return e.stop()}},e)}))),KO(VO(n),"handleOpenInviteSubmit",FO(regeneratorRuntime.mark(function e(){var t,r,o,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={serverError:"",clientError:""},(r=qO({},n.props.team)).allow_open_invite=n.state.allow_open_invite,e.next=5,n.props.actions.patchTeam(r);case 5:o=e.sent,(a=o.error)?(t.serverError=a.message,n.setState(t)):n.updateSection("");case 8:case"end":return e.stop()}},e)}))),KO(VO(n),"handleNameSubmit",FO(regeneratorRuntime.mark(function e(){var t,r,o,a,i,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t={serverError:"",clientError:""},r=!0,(o=n.state.name.trim())?o.length<P.Q.MIN_TEAMNAME_LENGTH?(t.clientError=_.a.createElement(Y.c,{id:"general_tab.teamNameRestrictions",defaultMessage:"Team Name must be {min} or more characters up to a maximum of {max}. You can add a longer team description.",values:{min:P.Q.MIN_TEAMNAME_LENGTH,max:P.Q.MAX_TEAMNAME_LENGTH}}),r=!1):t.clientError="":(t.clientError=T.ab("general_tab.required","This field is required"),r=!1),n.setState(t),r){e.next=7;break}return e.abrupt("return");case 7:return(a=qO({},n.props.team)).display_name=n.state.name,e.next=11,n.props.actions.patchTeam(a);case 11:i=e.sent,(s=i.error)?(t.serverError=s.message,n.setState(t)):n.updateSection("");case 14:case"end":return e.stop()}},e)}))),KO(VO(n),"handleInviteIdSubmit",FO(regeneratorRuntime.mark(function e(){var t,r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={serverError:"",clientError:""},n.setState(t),e.next=4,n.props.actions.regenerateTeamInviteId(n.props.team.id);case 4:r=e.sent,(o=r.error)?(t.serverError=o.message,n.setState(t)):n.updateSection("");case 7:case"end":return e.stop()}},e)}))),KO(VO(n),"handleDescriptionSubmit",FO(regeneratorRuntime.mark(function e(){var t,r,o,a,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t={serverError:"",clientError:""},r=!0,n.state.description.trim()===n.props.team.description?(t.clientError=T.ab("general_tab.chooseDescription","Please choose a new description for your team"),r=!1):t.clientError="",n.setState(t),r){e.next=7;break}return e.abrupt("return");case 7:return(o=qO({},n.props.team)).description=n.state.description,e.next=11,n.props.actions.patchTeam(o);case 11:a=e.sent,(i=a.error)?(t.serverError=i.message,n.setState(t)):n.updateSection("");case 14:case"end":return e.stop()}},e)}))),KO(VO(n),"handleTeamIconSubmit",FO(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.state.teamIconFile){e.next=2;break}return e.abrupt("return");case 2:if(n.state.submitActive){e.next=4;break}return e.abrupt("return");case 4:return n.setState({loadingIcon:!0,clientError:"",serverError:""}),e.next=7,n.props.actions.setTeamIcon(n.props.team.id,n.state.teamIconFile);case 7:t=e.sent,(r=t.error)?n.setState({loadingIcon:!1,serverError:r.message}):(n.setState({loadingIcon:!1,submitActive:!1}),n.updateSection(""));case 10:case"end":return e.stop()}},e)}))),KO(VO(n),"handleTeamIconRemove",FO(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({loadingIcon:!0,clientError:"",serverError:""}),e.next=3,n.props.actions.removeTeamIcon(n.props.team.id);case 3:t=e.sent,(r=t.error)?n.setState({loadingIcon:!1,serverError:r.message}):(n.setState({loadingIcon:!1,submitActive:!1}),n.updateSection(""));case 6:case"end":return e.stop()}},e)}))),KO(VO(n),"handleUpdateSection",function(e){n.updateSection(e)}),n.updateSection=n.updateSection.bind(VO(n)),n.handleNameSubmit=n.handleNameSubmit.bind(VO(n)),n.handleAllowedDomainsSubmit=n.handleAllowedDomainsSubmit.bind(VO(n)),n.handleInviteIdSubmit=n.handleInviteIdSubmit.bind(VO(n)),n.handleOpenInviteSubmit=n.handleOpenInviteSubmit.bind(VO(n)),n.handleDescriptionSubmit=n.handleDescriptionSubmit.bind(VO(n)),n.handleTeamIconSubmit=n.handleTeamIconSubmit.bind(VO(n)),n.handleClose=n.handleClose.bind(VO(n)),n.updateName=n.updateName.bind(VO(n)),n.updateDescription=n.updateDescription.bind(VO(n)),n.updateTeamIcon=n.updateTeamIcon.bind(VO(n)),n.updateAllowedDomains=n.updateAllowedDomains.bind(VO(n)),n.handleOpenInviteRadio=n.handleOpenInviteRadio.bind(VO(n)),n.state=n.setupInitialState(e),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&WO(e,t)}(t,_.a.Component),n=t,(r=[{key:"updateSection",value:function(e){qc()(".section-max").length&&qc()(".settings-modal .modal-body").scrollTop(0).perfectScrollbar("update"),this.setState(this.setupInitialState(this.props)),this.props.updateSection(e)}},{key:"setupInitialState",value:function(e){var t=e.team;return{name:t.display_name,invite_id:t.invite_id,allow_open_invite:t.allow_open_invite,description:t.description,allowed_domains:t.allowed_domains,serverError:"",clientError:"",teamIconFile:null,loadingIcon:!1,submitActive:!1}}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.setState({name:e.team.display_name,description:e.team.description,allowed_domains:e.team.allowed_domains,invite_id:e.team.invite_id,allow_open_invite:e.team.allow_open_invite})}},{key:"handleOpenInviteRadio",value:function(e){this.setState({allow_open_invite:e})}},{key:"handleClose",value:function(){this.updateSection("")}},{key:"componentDidMount",value:function(){qc()("#team_settings").on("hidden.bs.modal",this.handleClose)}},{key:"componentWillUnmount",value:function(){qc()("#team_settings").off("hidden.bs.modal",this.handleClose)}},{key:"updateName",value:function(e){this.setState({name:e.target.value})}},{key:"updateDescription",value:function(e){this.setState({description:e.target.value})}},{key:"updateTeamIcon",value:function(e){if(e&&e.target&&e.target.files&&e.target.files[0]){var t=e.target.files[0];zO.includes(t.type)?t.size>this.props.maxFileSize?this.setState({clientError:T.ab("general_tab.teamIconTooLarge","Unable to upload team icon. File is too large.")}):this.setState({teamIconFile:e.target.files[0],clientError:"",submitActive:!0}):this.setState({clientError:T.ab("general_tab.teamIconInvalidFileType","Only BMP, JPG or PNG images may be used for team icons")})}else this.setState({teamIconFile:null,clientError:T.ab("general_tab.teamIconError","An error occurred while selecting the image.")})}},{key:"updateAllowedDomains",value:function(e){this.setState({allowed_domains:e.target.value})}},{key:"render",value:function(){var e,t,n,r,o,a,i,s=this,c=this.props.team,l=null,u=null;if(this.state.clientError&&(l=this.state.clientError),this.state.serverError&&(u=this.state.serverError),"open_invite"===this.props.activeSection){var p;p=c.group_constrained?[_.a.createElement("div",{key:"userOpenInviteOptions"},_.a.createElement("div",null,_.a.createElement(Fu.b,{id:"team_settings.openInviteDescription.groupConstrained",defaultMessage:"No, members of this team are added and removed by linked groups. [Learn More](!https://mattermost.com/pl/default-ldap-group-constrained-team-channel.html)"})))]:[_.a.createElement("fieldset",{key:"userOpenInviteOptions"},_.a.createElement("div",{className:"radio"},_.a.createElement("label",null,_.a.createElement("input",{id:"teamOpenInvite",name:"userOpenInviteOptions",type:"radio",defaultChecked:this.state.allow_open_invite,onChange:this.handleOpenInviteRadio.bind(this,!0)}),_.a.createElement(Y.c,{id:"general_tab.yes",defaultMessage:"Yes"})),_.a.createElement("br",null)),_.a.createElement("div",{className:"radio"},_.a.createElement("label",null,_.a.createElement("input",{id:"teamOpenInviteNo",name:"userOpenInviteOptions",type:"radio",defaultChecked:!this.state.allow_open_invite,onChange:this.handleOpenInviteRadio.bind(this,!1)}),_.a.createElement(Y.c,{id:"general_tab.no",defaultMessage:"No"})),_.a.createElement("br",null)),_.a.createElement("div",{className:"margin-top x3"},_.a.createElement(Y.c,{id:"general_tab.openInviteDesc",defaultMessage:"When allowed, a link to this team will be included on the landing page allowing anyone with an account to join this team."})))],e=_.a.createElement(xO.a,{title:T.ab("general_tab.openInviteTitle","Allow any user with an account on this server to join this team"),inputs:p,submit:this.handleOpenInviteSubmit,serverError:u,updateSection:this.handleUpdateSection})}else{var f="";f=!0===this.state.allow_open_invite?T.ab("general_tab.yes","Yes"):c.group_constrained?T.ab("team_settings.openInviteSetting.groupConstrained","No, members of this team are added and removed by linked groups."):T.ab("general_tab.no","No"),e=_.a.createElement(AO.a,{title:T.ab("general_tab.openInviteTitle","Allow any user with an account on this server to join this team"),describe:f,updateSection:this.handleUpdateSection,section:"open_invite"})}if("invite_id"===this.props.activeSection&&this.props.canInviteTeamMembers){var d=[];d.push(_.a.createElement("div",{key:"teamInviteSetting"},_.a.createElement("div",{className:"row"},_.a.createElement("label",{className:"col-sm-5 control-label visible-xs-block"}),_.a.createElement("div",{className:"col-sm-12"},_.a.createElement("input",{id:"teamInviteId",autoFocus:!0,className:"form-control",type:"text",value:this.state.invite_id,maxLength:"32",onFocus:T.cb,readOnly:!0}))),_.a.createElement("div",{className:"setting-list__hint"},_.a.createElement(Y.c,{id:"general_tab.codeLongDesc",defaultMessage:"The Invite Code is used as part of the URL in the team invitation link created by {getTeamInviteLink} in the main menu. Regenerating creates a new team invitation link and invalidates the previous link.",values:{getTeamInviteLink:_.a.createElement("strong",null,_.a.createElement(Y.c,{id:"general_tab.getTeamInviteLink",defaultMessage:"Get Team Invite Link"}))}})))),t=_.a.createElement(xO.a,{title:T.ab("general_tab.codeTitle","Invite Code"),inputs:d,submit:this.handleInviteIdSubmit,serverError:u,clientError:l,updateSection:this.handleUpdateSection,saveButtonText:T.ab("general_tab.regenerate","Regenerate")})}else this.props.canInviteTeamMembers&&(t=_.a.createElement(AO.a,{title:T.ab("general_tab.codeTitle","Invite Code"),describe:T.ab("general_tab.codeDesc","Click 'Edit' to regenerate Invite Code."),updateSection:this.handleUpdateSection,section:"invite_id"}));if("name"===this.props.activeSection){var m=[],h=_.a.createElement(Y.c,{id:"general_tab.teamName",defaultMessage:"Team Name"});T.U()&&(h=""),m.push(_.a.createElement("div",{key:"teamNameSetting",className:"form-group"},_.a.createElement("label",{className:"col-sm-5 control-label"},h),_.a.createElement("div",{className:"col-sm-7"},_.a.createElement("input",{id:"teamName",autoFocus:!0,className:"form-control",type:"text",maxLength:P.Q.MAX_TEAMNAME_LENGTH.toString(),onChange:this.updateName,value:this.state.name,onFocus:T.cb}))));var b=_.a.createElement("span",null,T.ab("general_tab.teamNameInfo","Set the name of the team as it appears on your sign-in screen and at the top of the left-hand sidebar."));n=_.a.createElement(xO.a,{title:T.ab("general_tab.teamName","Team Name"),inputs:m,submit:this.handleNameSubmit,serverError:u,clientError:l,updateSection:this.handleUpdateSection,extraInfo:b})}else{var y=this.state.name;n=_.a.createElement(AO.a,{title:T.ab("general_tab.teamName","Team Name"),describe:y,updateSection:this.handleUpdateSection,section:"name"})}if("description"===this.props.activeSection){var g=[],v=_.a.createElement(Y.c,{id:"general_tab.teamDescription",defaultMessage:"Team Description"});T.U()&&(v=""),g.push(_.a.createElement("div",{key:"teamDescriptionSetting",className:"form-group"},_.a.createElement("label",{className:"col-sm-5 control-label"},v),_.a.createElement("div",{className:"col-sm-7"},_.a.createElement("input",{id:"teamDescription",autoFocus:!0,className:"form-control",type:"text",maxLength:P.Q.MAX_TEAMDESCRIPTION_LENGTH.toString(),onChange:this.updateDescription,value:this.state.description,onFocus:T.cb}))));var E=_.a.createElement("span",null,T.ab("general_tab.teamDescriptionInfo","Team description provides additional information to help users select the right team. Maximum of 50 characters."));r=_.a.createElement(xO.a,{title:T.ab("general_tab.teamDescription","Team Description"),inputs:g,submit:this.handleDescriptionSubmit,serverError:u,clientError:l,updateSection:this.handleUpdateSection,extraInfo:E})}else{var O="";O=this.state.description?this.state.description:_.a.createElement(Y.c,{id:"general_tab.emptyDescription",defaultMessage:"Click 'Edit' to add a team description."}),r=_.a.createElement(AO.a,{title:T.ab("general_tab.teamDescription","Team Description"),describe:O,updateSection:this.handleUpdateSection,section:"description"})}"team_icon"===this.props.activeSection?o=_.a.createElement(LO.a,{imageContext:"team",title:T.ab("general_tab.teamIcon","Team Icon"),src:T.I(c),file:this.state.teamIconFile,serverError:this.state.serverError,clientError:this.state.clientError,loadingPicture:this.state.loadingIcon,submitActive:this.state.submitActive,updateSection:function(e){s.updateSection(""),e.preventDefault()},onFileChange:this.updateTeamIcon,onSubmit:this.handleTeamIconSubmit,onRemove:this.handleTeamIconRemove}):(a=c.last_team_icon_update?_.a.createElement(Y.c,{id:"general_tab.teamIconLastUpdated",defaultMessage:"Image last updated {date}",values:{date:_.a.createElement(Y.a,{value:new Date(c.last_team_icon_update),day:"2-digit",month:"short",year:"numeric"})}}):T.U()?T.ab("general_tab.teamIconEditHintMobile","Click to upload an image"):T.ab("general_tab.teamIconEditHint","Click 'Edit' to upload an image."),o=_.a.createElement(AO.a,{title:T.ab("general_tab.teamIcon","Team Icon"),describe:a,section:"team_icon",updateSection:this.handleUpdateSection}));if("allowed_domains"===this.props.activeSection){var w=[];w.push(_.a.createElement("div",{key:"allowedDomainsSetting",className:"form-group"},_.a.createElement("div",{className:"col-sm-12"},_.a.createElement(ke.a,{id:"allowedDomains",autoFocus:!0,className:"form-control",type:"text",onChange:this.updateAllowedDomains,value:this.state.allowed_domains,onFocus:T.cb,placeholder:{id:Object(Ne.b)("general_tab.AllowedDomainsExample"),defaultMessage:"corp.mattermost.com, mattermost.org"}}))));var C=_.a.createElement("span",null,T.ab("general_tab.AllowedDomainsInfo",'Users can only join the team if their email matches a specific domain (e.g. "mattermost.org") or list of comma-separated domains (e.g. "corp.mattermost.com, mattermost.org").'));i=_.a.createElement(xO.a,{title:T.ab("general_tab.allowedDomains","Allow only users with a specific email domain to join this team"),inputs:w,submit:this.handleAllowedDomainsSubmit,serverError:u,clientError:l,updateSection:this.handleUpdateSection,extraInfo:C})}else{var S="";S=this.state.allowed_domains?this.state.allowed_domains:_.a.createElement(Y.c,{id:"general_tab.allowedDomainsEdit",defaultMessage:"Click 'Edit' to add an email domain whitelist."}),i=_.a.createElement(AO.a,{title:T.ab("general_tab.allowedDomains","allowedDomains"),describe:S,updateSection:this.handleUpdateSection,section:"allowed_domains"})}return _.a.createElement("div",null,_.a.createElement("div",{className:"modal-header"},_.a.createElement("button",{id:"closeButton",type:"button",className:"close","data-dismiss":"modal","aria-label":"Close",onClick:this.props.closeModal},_.a.createElement("span",{"aria-hidden":"true"},"×")),_.a.createElement("h4",{className:"modal-title",ref:"title"},_.a.createElement("div",{className:"modal-back"},_.a.createElement("span",{onClick:this.props.collapseModal},_.a.createElement(DO.a,null))),_.a.createElement(Y.c,{id:"general_tab.title",defaultMessage:"General Settings"}))),_.a.createElement("div",{ref:"wrapper",className:"user-settings"},_.a.createElement("h3",{className:"tab-header"},_.a.createElement(Y.c,{id:"general_tab.title",defaultMessage:"General Settings"})),_.a.createElement("div",{className:"divider-dark first"}),n,_.a.createElement("div",{className:"divider-light"}),r,_.a.createElement("div",{className:"divider-light"}),o,!c.group_constrained&&_.a.createElement(_.a.Fragment,null,_.a.createElement("div",{className:"divider-light"}),i),_.a.createElement("div",{className:"divider-light"}),e,!c.group_constrained&&_.a.createElement(_.a.Fragment,null,_.a.createElement("div",{className:"divider-light"}),t),_.a.createElement("div",{className:"divider-dark"})))}}])&&BO(n.prototype,r),o&&BO(n,o),t}();KO(YO,"propTypes",{updateSection:v.a.func.isRequired,team:v.a.object.isRequired,activeSection:v.a.string.isRequired,closeModal:v.a.func.isRequired,collapseModal:v.a.func.isRequired,maxFileSize:v.a.number.isRequired,actions:v.a.shape({patchTeam:v.a.func.isRequired,regenerateTeamInviteId:v.a.func.isRequired,removeTeamIcon:v.a.func.isRequired,setTeamIcon:v.a.func.isRequired}).isRequired,canInviteTeamMembers:v.a.bool.isRequired});var QO=Object(r.connect)(function(e,t){var n=Object(u.getConfig)(e);return{maxFileSize:parseInt(n.MaxFileSize,10),canInviteTeamMembers:Object(D.haveITeamPermission)(e,{team:t.team.id,permission:L.Permissions.INVITE_USER})}},function(e){return{actions:Object(o.bindActionCreators)({patchTeam:c.patchTeam,regenerateTeamInviteId:c.regenerateTeamInviteId,removeTeamIcon:c.removeTeamIcon,setTeamIcon:c.setTeamIcon},e)}})(YO);function ZO(e){return(ZO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function JO(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function XO(e){return(XO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $O(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ew(e,t){return(ew=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var tw=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=XO(t).call(this,e))||"object"!==ZO(o)&&"function"!=typeof o?$O(r):o).doFileSelect=n.doFileSelect.bind($O(n)),n.doSubmit=n.doSubmit.bind($O(n)),n.state={clientError:n.props.clientError,serverError:n.props.serverError,filename:""},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ew(e,t)}(t,_.a.Component),n=t,(r=[{key:"UNSAFE_componentWillReceiveProps",value:function(){this.setState({clientError:this.props.clientError,serverError:this.props.serverError})}},{key:"doFileSelect",value:function(e){e.preventDefault();var t=qc()(e.target).val();"fakepath"===t.substring(3,11)&&(t=t.substring(12)),this.setState({clientError:"",serverError:"",filename:t})}},{key:"doSubmit",value:function(e){e.preventDefault();var t=uu.a.findDOMNode(this.refs.uploadinput);t.files&&t.files[0]?this.props.submit(t.files[0]):this.setState({clientError:!0})}},{key:"render",value:function(){var e=null;this.state.clientError&&(e=_.a.createElement("div",{className:"file-status"},_.a.createElement(Y.c,{id:"setting_upload.noFile",defaultMessage:"No file selected."})));var t=null;this.state.serverError&&(t=_.a.createElement("div",{className:"file-status"},this.state.serverError));var n=null,r="btn btn-sm btn-primary disabled";return this.state.filename&&(n=_.a.createElement("div",{className:"file-status file-name"},this.state.filename),r="btn btn-sm btn-primary"),_.a.createElement("ul",{className:"section-max"},_.a.createElement("li",{className:"col-sm-12 section-title"},this.props.title),_.a.createElement("li",{className:"col-sm-offset-3 col-sm-9"},this.props.helpText),_.a.createElement("li",{className:"col-sm-offset-3 col-sm-9"},_.a.createElement("ul",{className:"setting-list"},_.a.createElement("li",{className:"setting-list-item"},_.a.createElement("span",{className:"btn btn-sm btn-primary btn-file sel-btn"},_.a.createElement(Y.c,{id:"setting_upload.select",defaultMessage:"Select file"}),_.a.createElement("input",{ref:"uploadinput",accept:this.props.fileTypesAccepted,type:"file",onChange:this.doFileSelect})),_.a.createElement("a",{className:r,onClick:this.doSubmit},_.a.createElement(Y.c,{id:"setting_upload.import",defaultMessage:"Import"})),n,t,e))))}}])&&JO(n.prototype,r),o&&JO(n,o),t}();function nw(e){return(nw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rw(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ow(e){return(ow=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function aw(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iw(e,t){return(iw=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}tw.propTypes={title:v.a.string.isRequired,submit:v.a.func.isRequired,fileTypesAccepted:v.a.string.isRequired,clientError:v.a.string,serverError:v.a.string,helpText:v.a.object};var sw=Object(Y.g)({importSlack:{id:Object(Ne.b)("team_import_tab.importSlack"),defaultMessage:"Import from Slack (Beta)"}}),cw=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=ow(t).call(this,e))||"object"!==nw(o)&&"function"!=typeof o?aw(r):o).onImportFailure=n.onImportFailure.bind(aw(n)),n.onImportSuccess=n.onImportSuccess.bind(aw(n)),n.doImportSlack=n.doImportSlack.bind(aw(n)),n.state={status:"ready",link:""},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&iw(e,t)}(t,_.a.Component),n=t,(r=[{key:"onImportFailure",value:function(){this.setState({status:"fail"})}},{key:"onImportSuccess",value:function(e){this.setState({status:"done",link:"data:application/octet-stream;charset=utf-8,"+encodeURIComponent(atob(e.results))})}},{key:"doImportSlack",value:function(e){this.setState({status:"in-progress",link:""}),T.K(e,this.onImportSuccess,this.onImportFailure)}},{key:"render",value:function(){var e,t=this.props.intl.formatMessage,n=_.a.createElement("a",{href:"https://docs.mattermost.com/administration/migrating.html#migrating-from-slack",target:"_blank",rel:"noopener noreferrer"},_.a.createElement(Y.c,{id:"team_import_tab.importHelpDocsLink",defaultMessage:"documentation"})),r=_.a.createElement("strong",null,_.a.createElement(Y.c,{id:"team_import_tab.importHelpExportInstructions",defaultMessage:"Slack > Administration > Workspace settings > Import/Export Data > Export > Start Export"})),o=_.a.createElement("a",{href:"https://github.com/grundleborg/slack-advanced-exporter",target:"_blank",rel:"noopener noreferrer"},_.a.createElement(Y.c,{id:"team_import_tab.importHelpExporterLink",defaultMessage:"Slack Advanced Exporter"})),a=_.a.createElement("a",{href:"https://docs.mattermost.com/administration/migrating.html#migrating-from-slack-using-the-mattermost-cli",target:"_blank",rel:"noopener noreferrer"},_.a.createElement(Y.c,{id:"team_import_tab.importHelpCliDocsLink",defaultMessage:"CLI tool for Slack import"})),i=_.a.createElement("div",null,_.a.createElement("p",null,_.a.createElement(Y.c,{id:"team_import_tab.importHelpLine1",defaultMessage:"Slack import to Mattermost supports importing of messages in your Slack team's public channels."})),_.a.createElement("p",null,_.a.createElement(Y.c,{id:"team_import_tab.importHelpLine2",defaultMessage:"To import a team from Slack, go to {exportInstructions}. See {uploadDocsLink} to learn more.",values:{exportInstructions:r,uploadDocsLink:n}})),_.a.createElement("p",null,_.a.createElement(Y.c,{id:"team_import_tab.importHelpLine3",defaultMessage:"To import posts with attached files, see {slackAdvancedExporterLink} for details.",values:{slackAdvancedExporterLink:o}})),_.a.createElement("p",null,_.a.createElement(Y.c,{id:"team_import_tab.importHelpLine4",defaultMessage:"For Slack teams with over 10,000 messages, we recommend using the {cliLink}.",values:{cliLink:a}}))),s=_.a.createElement(tw,{title:t(sw.importSlack),submit:this.doImportSlack,helpText:i,fileTypesAccepted:".zip"});switch(this.state.status){case"ready":e="";break;case"in-progress":e=_.a.createElement("p",{className:"confirm-import alert alert-warning"},_.a.createElement(Cf.a,{text:T.ab("team_import_tab.importing","Importing...")}));break;case"done":e=_.a.createElement("p",{className:"confirm-import alert alert-success"},_.a.createElement(vs.a,null),_.a.createElement(Y.c,{id:"team_import_tab.successful",defaultMessage:" Import successful: "}),_.a.createElement("a",{href:this.state.link,download:"MattermostImportSummary.txt"},_.a.createElement(Y.c,{id:"team_import_tab.summary",defaultMessage:"View Summary"})));break;case"fail":e=_.a.createElement("p",{className:"confirm-import alert alert-warning"},_.a.createElement(tb.a,null),_.a.createElement(Y.c,{id:"team_import_tab.failure",defaultMessage:" Import failure: "}),_.a.createElement("a",{href:this.state.link,download:"MattermostImportSummary.txt"},_.a.createElement(Y.c,{id:"team_import_tab.summary",defaultMessage:"View Summary"})))}return _.a.createElement("div",null,_.a.createElement("div",{className:"modal-header"},_.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close",onClick:this.props.closeModal},_.a.createElement("span",{"aria-hidden":"true"},"×")),_.a.createElement("h4",{className:"modal-title",ref:"title"},_.a.createElement("div",{className:"modal-back"},_.a.createElement("span",{onClick:this.props.collapseModal},_.a.createElement(DO.a,null))),_.a.createElement(Y.c,{id:"team_import_tab.import",defaultMessage:"Import"}))),_.a.createElement("div",{ref:"wrapper",className:"user-settings"},_.a.createElement("h3",{className:"tab-header"},_.a.createElement(Y.c,{id:"team_import_tab.import",defaultMessage:"Import"})),_.a.createElement("div",{className:"divider-dark first"}),s,_.a.createElement("div",{className:"divider-dark"}),e))}}])&&rw(n.prototype,r),o&&rw(n,o),t}();cw.propTypes={intl:Y.i.isRequired,closeModal:v.a.func.isRequired,collapseModal:v.a.func.isRequired};var lw=Object(Y.h)(cw),uw=function(e){var t,n=e.activeTab,r=e.activeSection,o=e.updateSection,a=e.closeModal,i=e.collapseModal,s=e.team;if(!s)return null;switch(n){case"general":t=_.a.createElement("div",null,_.a.createElement(QO,{team:s,activeSection:r,updateSection:o,closeModal:a,collapseModal:i}));break;case"import":t=_.a.createElement("div",null,_.a.createElement(lw,{team:s,activeSection:r,updateSection:o,closeModal:a,collapseModal:i}));break;default:t=_.a.createElement("div",null)}return t};uw.defaultProps={activeTab:"",activeSection:""},uw.propTypes={activeTab:v.a.string.isRequired,activeSection:v.a.string.isRequired,updateSection:v.a.func.isRequired,closeModal:v.a.func.isRequired,collapseModal:v.a.func.isRequired,team:v.a.object.isRequired};var pw=uw;var fw=Object(r.connect)(function(e){return{team:Object(f.getCurrentTeam)(e)}})(pw);function dw(e){return(dw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mw(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function hw(e){return(hw=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function bw(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yw(e,t){return(yw=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function gw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var vw=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=hw(t).call(this,e),n=!o||"object"!==dw(o)&&"function"!=typeof o?bw(r):o,gw(bw(n),"updateTab",function(e){n.setState({activeTab:e,activeSection:""}),T.U()||qc()(".settings-modal .modal-body").scrollTop(0).perfectScrollbar("update")}),gw(bw(n),"updateSection",function(e){qc()(".section-max").length&&qc()(".settings-modal .modal-body").scrollTop(0).perfectScrollbar("update"),n.setState({activeSection:e})}),gw(bw(n),"closeModal",function(){n.props.onHide()}),gw(bw(n),"collapseModal",function(){qc()(uu.a.findDOMNode(n.refs.modalBody)).closest(".modal-dialog").removeClass("display--content"),n.setState({active_tab:"",active_section:""})}),gw(bw(n),"handleHide",function(){n.props.onHide()}),gw(bw(n),"handleHidden",function(){n.setState({activeTab:"general",activeSection:""})}),n.state={activeTab:"general",activeSection:""},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yw(e,t)}(t,_.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){T.U()||qc()(".settings-modal .settings-content").perfectScrollbar()}},{key:"render",value:function(){var e=[];return e.push({name:"general",uiName:T.ab("team_settings_modal.generalTab","General"),icon:"icon fa fa-cog",iconTitle:T.ab("generic_icons.settings","Settings Icon")}),e.push({name:"import",uiName:T.ab("team_settings_modal.importTab","Import"),icon:"icon fa fa-upload",iconTitle:T.ab("generic_icons.upload","Upload Icon")}),_.a.createElement(z.a,{dialogClassName:"a11y__modal settings-modal settings-modal--action",show:this.props.show,onHide:this.handleHide,onExited:this.handleHidden,role:"dialog","aria-labelledby":"teamSettingsModalLabel"},_.a.createElement(z.a.Header,{id:"teamSettingsModalLabel",closeButton:!0},_.a.createElement(z.a.Title,{componentClass:"h1"},_.a.createElement(Y.c,{id:"team_settings_modal.title",defaultMessage:"Team Settings"}))),_.a.createElement(z.a.Body,{ref:"modalBody"},_.a.createElement("div",{className:"settings-table"},_.a.createElement("div",{className:"settings-links"},_.a.createElement(k.a,{doLoad:IO.a,tabs:e,activeTab:this.state.activeTab,updateTab:this.updateTab})),_.a.createElement("div",{className:"settings-content minimize-settings"},_.a.createElement(fw,{activeTab:this.state.activeTab,activeSection:this.state.activeSection,updateSection:this.updateSection,closeModal:this.closeModal,collapseModal:this.collapseModal})))))}}])&&mw(n.prototype,r),o&&mw(n,o),t}();gw(vw,"propTypes",{show:v.a.bool,onHide:v.a.func});var Ew=Object(r.connect)(function(e){var t=P.r.TEAM_SETTINGS;return{show:Object(I_.a)(e,t)}})(vw),_w=n(1870),Ow=n(1571),ww=n(1581);function Cw(e){return(Cw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Sw(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function Pw(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){Sw(a,r,o,i,s,"next",e)}function s(e){Sw(a,r,o,i,s,"throw",e)}i(void 0)})}}function jw(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Tw(e){return(Tw=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function kw(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Nw(e,t){return(Nw=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Rw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Mw=50,Iw=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=Tw(t).call(this,e),n=!o||"object"!==Cw(o)&&"function"!=typeof o?kw(r):o,Rw(kw(n),"handleHide",function(){n.props.actions.setModalSearchTerm(""),n.setState({show:!1})}),Rw(kw(n),"handleExit",function(){n.props.onHide&&n.props.onHide()}),Rw(kw(n),"handleResponse",function(e){var t=null;e&&e.message&&(t=e.message),n.setState({saving:!1,addError:t})}),Rw(kw(n),"handleSubmit",function(){var e=Pw(regeneratorRuntime.mark(function e(t){var r,o,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.preventDefault(),0!==(r=n.state.values.map(function(e){return e.id})).length){e.next=4;break}return e.abrupt("return");case 4:return n.setState({saving:!0}),e.next=7,n.props.actions.addUsersToTeam(n.props.currentTeamId,r);case 7:o=e.sent,a=o.error,n.handleResponse(a),a||n.handleHide();case 11:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),Rw(kw(n),"addValue",function(e){var t=Object.assign([],n.state.values),r=t.map(function(e){return e.id});e&&e.id&&-1===r.indexOf(e.id)&&t.push(e),n.setState({values:t})}),Rw(kw(n),"setUsersLoadingState",function(e){n.setState({loadingUsers:e})}),Rw(kw(n),"handlePageChange",function(e,t){e>t&&(n.setUsersLoadingState(!0),n.props.actions.getProfilesNotInTeam(n.props.currentTeamId,e+1,Mw).then(function(){n.setUsersLoadingState(!1)}))}),Rw(kw(n),"handleDelete",function(e){n.setState({values:e})}),Rw(kw(n),"search",function(e){n.props.actions.setModalSearchTerm(e)}),Rw(kw(n),"renderAriaLabel",function(e){return e?e.username:null}),Rw(kw(n),"renderOption",function(e,t,n){var r="";t&&(r="more-modal__row--selected");var o=e.email;return e.is_bot&&(o=null),_.a.createElement("div",{key:e.id,ref:t?"selected":e.id,className:"more-modal__row clickable "+r,onClick:function(){return n(e)}},_.a.createElement(bd.a,{src:ii.Client4.getProfilePictureUrl(e.id,e.last_picture_update),width:"32",height:"32"}),_.a.createElement("div",{className:"more-modal__details"},_.a.createElement("div",{className:"more-modal__name"},Object(T.m)(e),_.a.createElement(ka.a,{show:Boolean(e.is_bot),className:"badge-popoverlist"})),_.a.createElement("div",{className:"more-modal__description"},o)),_.a.createElement("div",{className:"more-modal__actions"},_.a.createElement("div",{className:"more-modal__actions--round"},_.a.createElement(ww.a,null))))}),n.searchTimeoutId=0,n.state={values:[],show:!0,search:!1,saving:!1,addError:null,loadingUsers:!0},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Nw(e,t)}(t,_.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){var e=this;this.props.actions.getProfilesNotInTeam(this.props.currentTeamId,this.props.currentTeamGroupConstrained,0,2*Mw).then(function(){e.setUsersLoadingState(!1)})}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this;if(this.props.searchTerm!==e.searchTerm){clearTimeout(this.searchTimeoutId);var n=e.searchTerm;if(""===n)return;this.searchTimeoutId=setTimeout(Pw(regeneratorRuntime.mark(function e(){var r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.setUsersLoadingState(!0),e.next=3,t.props.actions.searchProfiles(n,{not_in_team_id:t.props.currentTeamId,group_constrained:t.props.currentTeamGroupConstrained});case 3:r=e.sent,(o=r.data)&&t.props.actions.loadStatusesForProfilesList(o),t.setUsersLoadingState(!1);case 7:case"end":return e.stop()}},e)})),P.Q.SEARCH_TIMEOUT_MILLISECONDS)}}},{key:"renderValue",value:function(e){return e.data.username}},{key:"render",value:function(){var e=_.a.createElement("div",{id:"numPeopleRemaining"},_.a.createElement(Y.c,{id:"multiselect.numPeopleRemaining",defaultMessage:"Use ↑↓ to browse, ↵ to select. You can add {num, number} more {num, plural, one {person} other {people}}. ",values:{num:20-this.state.values.length}})),t=Object(T.ab)("multiselect.add","Add"),n=Object(T.ab)("multiselect.adding","Adding..."),r=[];this.props.users&&(r=this.props.users.filter(function(e){return 0===e.delete_at}));var o=null;return this.state.addError&&(o=_.a.createElement("div",{className:"has-error col-sm-12"},_.a.createElement("label",{className:"control-label font-weight--normal"},this.state.addError))),_.a.createElement(z.a,{id:"addUsersToTeamModal",dialogClassName:"a11y__modal more-modal more-direct-channels",show:this.state.show,onHide:this.handleHide,onExited:this.handleExit,role:"dialog","aria-labelledby":"addTeamModalLabel"},_.a.createElement(z.a.Header,{closeButton:!0},_.a.createElement(z.a.Title,{componentClass:"h1",id:"addTeamModalLabel"},_.a.createElement(Y.c,{id:"add_users_to_team.title",defaultMessage:"Add New Members To {teamName} Team",values:{teamName:_.a.createElement("strong",null,this.props.currentTeamName)}}))),_.a.createElement(z.a.Body,{role:"application"},o,_.a.createElement(Ow.a,{key:"addUsersToTeamKey",options:r,optionRenderer:this.renderOption,values:this.state.values,valueRenderer:this.renderValue,ariaLabelRenderer:this.renderAriaLabel,perPage:Mw,handlePageChange:this.handlePageChange,handleInput:this.search,handleDelete:this.handleDelete,handleAdd:this.addValue,handleSubmit:this.handleSubmit,maxValues:20,numRemainingText:e,buttonSubmitText:t,buttonSubmitLoadingText:n,saving:this.state.saving,loading:this.state.loadingUsers,placeholderText:Object(T.ab)("multiselect.placeholder","Search and add members")})))}}])&&jw(n.prototype,r),o&&jw(n,o),t}();Rw(Iw,"propTypes",{currentTeamName:v.a.string.isRequired,currentTeamId:v.a.string.isRequired,currentTeamGroupConstrained:v.a.bool,searchTerm:v.a.string.isRequired,users:v.a.array.isRequired,onHide:v.a.func,actions:v.a.shape({getProfilesNotInTeam:v.a.func.isRequired,setModalSearchTerm:v.a.func.isRequired,searchProfiles:v.a.func.isRequired,addUsersToTeam:v.a.func.isRequired,loadStatusesForProfilesList:v.a.func.isRequired}).isRequired}),Rw(Iw,"defaultProps",{currentTeamGroupConstrained:!1});var xw=Object(r.connect)(function(e){var t,n=e.views.search.modalSearch;t=n?Object(p.searchProfilesNotInCurrentTeam)(e,n,!0):Object(p.getProfilesNotInCurrentTeam)(e);var r=Object(f.getCurrentTeam)(e)||{},o=P.r.ADD_USER_TO_TEAM;return{currentTeamName:r.display_name,currentTeamId:r.id,currentTeamGroupConstrained:r.group_constrained,searchTerm:n,users:t,show:Object(I_.a)(e,o)}},function(e){return{actions:Object(o.bindActionCreators)({getProfilesNotInTeam:i.getProfilesNotInTeam,setModalSearchTerm:G_.a,searchProfiles:i.searchProfiles,addUsersToTeam:b.c,loadStatusesForProfilesList:m.b},e)}})(Iw),Aw=n(1658),Lw=n(1636),Dw=n(1793),Uw=n(1597),qw=function(e){var t=e.to,n=e.text;return _.a.createElement(Fi.a,{to:t},n)};qw.propTypes={to:v.a.string.isRequired,text:v.a.oneOfType([v.a.string,v.a.node]).isRequired};var Hw=Object(Uw.a)(qw);Hw.displayName="MenuItemLink";var Fw=Hw,Bw=n(1696),Gw=n(1566),Vw=n(1493);function Ww(e){return(Ww="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Kw(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function zw(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){Kw(a,r,o,i,s,"next",e)}function s(e){Kw(a,r,o,i,s,"throw",e)}i(void 0)})}}function Yw(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Qw(e){return(Qw=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Zw(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Jw(e,t){return(Jw=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Xw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var $w=50,eC=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=Qw(t).call(this,e),n=!o||"object"!==Ww(o)&&"function"!=typeof o?Zw(r):o,Xw(Zw(n),"handleHide",function(){n.setState({show:!1})}),Xw(Zw(n),"handleExit",function(){n.props.onHide&&n.props.onHide()}),Xw(Zw(n),"onNext",function(){var e=n.state.page+1;n.onPageChange(e)}),Xw(Zw(n),"onPrev",function(){var e=n.state.page-1;n.onPageChange(e)}),Xw(Zw(n),"onPageChange",function(){var e=zw(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({loading:!0}),e.next=3,n.props.loadItems(t,n.state.searchTerm);case 3:r=e.sent,n.setState({page:t,items:r.items,loading:!1});case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),Xw(Zw(n),"onSearchInput",function(){var e=zw(regeneratorRuntime.mark(function e(t){var r,o,a,i,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.target,o=r.value,n.setState({loading:!0,searchTerm:o}),e.next=5,n.props.loadItems(0,o);case 5:a=e.sent,i=a.items,s=a.totalCount,n.setState({loading:!1,items:i,totalCount:s});case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),n.numPerPage=e.numPerPage||$w,n.state={show:!0,page:0,items:[],totalCount:0,loading:!0,searchTerm:""},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Jw(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"componentWillMount",value:function(){var e=zw(regeneratorRuntime.mark(function e(){var t,n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.loadItems(0,"");case 2:t=e.sent,n=t.totalCount,r=t.items,this.setState({totalCount:n,items:r,loading:!1});case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"renderRows",value:function(){var e=this;return this.state.loading?_.a.createElement("div",null,_.a.createElement(Vw.a,{position:"absolute",key:"loading"})):this.state.items.map(function(t){return e.props.renderRow(t,e)})}},{key:"paginationRange",value:function(){var e=this.state.page*this.numPerPage+1,t=e+this.state.items.length-1;return 0===t&&(e=0),{startCount:e,endCount:t}}},{key:"render",value:function(){if(!this.props.show)return null;var e=this.paginationRange(),t=e.endCount,n=e.startCount;return _.a.createElement("div",null,_.a.createElement(z.a,{dialogClassName:"a11y__modal more-modal more-modal--action",show:this.state.show,onHide:this.handleHide,onExited:this.handleExit},_.a.createElement(z.a.Header,{closeButton:!0},_.a.createElement(z.a.Title,{componentClass:"h1"},_.a.createElement("span",{className:"name"},this.props.titleText)),this.props.titleBarButtonText&&this.props.titleBarButtonOnClick&&_.a.createElement("a",{className:"btn btn-md btn-primary",href:"#",onClick:this.props.titleBarButtonOnClick},this.props.titleBarButtonText)),_.a.createElement(z.a.Body,null,_.a.createElement("div",{className:"filtered-user-list"},_.a.createElement("div",{className:"filter-row"},_.a.createElement("div",{className:"col-xs-12"},_.a.createElement("input",{id:"searchUsersInput",className:"form-control filter-textbox",placeholder:this.props.searchPlaceholderText,onChange:this.onSearchInput})),_.a.createElement("div",{className:"col-sm-12"},_.a.createElement("span",{className:"member-count pull-left"},_.a.createElement(Y.c,{id:"list_modal.paginatorCount",defaultMessage:"{startCount, number} - {endCount, number} of {total, number} total",values:{startCount:n,endCount:t,total:this.state.totalCount}})))),_.a.createElement("div",{className:"more-modal__list"},_.a.createElement("div",null,this.renderRows())),_.a.createElement("div",{className:"filter-controls"},this.state.page>0&&_.a.createElement("button",{onClick:this.onPrev,className:"btn btn-link filter-control filter-control__prev"},_.a.createElement(Y.c,{id:"filtered_user_list.prev",defaultMessage:"Previous"})),this.state.items.length>=this.props.numPerPage&&t!==this.state.totalCount&&_.a.createElement("button",{onClick:this.onNext,className:"btn btn-link filter-control filter-control__next"},_.a.createElement(Y.c,{id:"filtered_user_list.next",defaultMessage:"Next"})))))))}}])&&Yw(n.prototype,r),o&&Yw(n,o),t}();Xw(eC,"propTypes",{loadItems:v.a.func.isRequired,renderRow:v.a.func.isRequired,onHide:v.a.func,titleText:v.a.string,searchPlaceholderText:v.a.string,titleBarButtonText:v.a.string,titleBarButtonOnClick:v.a.func,numPerPage:v.a.number,show:v.a.bool}),Xw(eC,"defaultProps",{show:!0});var tC=n(1635),nC=n.n(tC);function rC(e){return(rC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function oC(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function aC(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){oC(a,r,o,i,s,"next",e)}function s(e){oC(a,r,o,i,s,"throw",e)}i(void 0)})}}function iC(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function sC(e){return(sC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function cC(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lC(e,t){return(lC=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function uC(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var pC=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=sC(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==rC(o)&&"function"!=typeof o?cC(r):o,uC(cC(n),"state",{showConfirmModal:!1,item:{member_count:0},listModal:null}),uC(cC(n),"loadItems",function(){var e=aC(regeneratorRuntime.mark(function e(t,r){var o,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.props.actions.getGroupsAssociatedToTeam(n.props.team.id,r,t,$w);case 2:return o=e.sent,a=o.data,e.abrupt("return",{items:a.groups,totalCount:a.totalGroupCount});case 5:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()),uC(cC(n),"handleDeleteCanceled",function(){n.setState({showConfirmModal:!1})}),uC(cC(n),"handleDeleteConfirmed",function(){n.setState({showConfirmModal:!1});var e=n.state,t=e.item,r=e.listModal;n.props.actions.unlinkGroupSyncable(t.id,n.props.team.id,L.Groups.SYNCABLE_TYPE_TEAM).then(aC(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r.setState({loading:!0}),e.next=3,r.props.loadItems(r.setState.page,r.state.searchTerm);case 3:t=e.sent,n=t.items,r.setState({loading:!1,items:n});case 6:case"end":return e.stop()}},e)})))}),uC(cC(n),"onClickRemoveGroup",function(e,t){n.setState({showConfirmModal:!0,item:e,listModal:t})}),uC(cC(n),"onClickConfirmRemoveGroup",function(e,t){return n.props.actions.unlinkGroupSyncable(e.id,n.props.team.id,L.Groups.SYNCABLE_TYPE_TEAM).then(aC(regeneratorRuntime.mark(function e(){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.setState({loading:!0}),e.next=3,t.props.loadItems(t.setState.page,t.state.searchTerm);case 3:n=e.sent,r=n.items,t.setState({loading:!1,items:r});case 6:case"end":return e.stop()}},e)})))}),uC(cC(n),"onHide",function(){n.props.actions.closeModal(P.r.MANAGE_TEAM_GROUPS)}),uC(cC(n),"titleButtonOnClick",function(){n.onHide(),n.props.actions.openModal({modalId:P.r.ADD_GROUPS_TO_TEAM,dialogType:Aw.a})}),uC(cC(n),"renderRow",function(e,t){return _.a.createElement("div",{key:e.id,className:"more-modal__row"},_.a.createElement("img",{className:"more-modal__image",src:nC.a,alt:"group picture",width:"32",height:"32"}),_.a.createElement("div",{className:"more-modal__details"},_.a.createElement("div",{className:"more-modal__name"},e.display_name," ","-"," ",_.a.createElement("span",null,_.a.createElement(Y.c,{id:"numMembers",defaultMessage:"{num, number} {num, plural, one {member} other {members}}",values:{num:e.member_count}})))),_.a.createElement("div",{className:"more-modal__actions"},_.a.createElement("button",{id:"removeMember",type:"button",className:"btn btn-danger btn-message",onClick:function(){return n.onClickRemoveGroup(e,t)}},_.a.createElement(Y.c,{id:"group_list_modal.removeGroupButton",defaultMessage:"Remove Group"}))))}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lC(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e=this.context.intl.formatMessage,t=this.state.item.member_count;return _.a.createElement(_.a.Fragment,null,_.a.createElement(eC,{show:!this.state.showConfirmModal,titleText:e({id:"groups",defaultMessage:"{team} Groups"},{team:this.props.team.display_name}),searchPlaceholderText:e({id:"manage_team_groups_modal.search_placeholder",defaultMessage:"Search groups"}),renderRow:this.renderRow,loadItems:this.loadItems,onHide:this.onHide,titleBarButtonText:e({id:"group_list_modal.addGroupButton",defaultMessage:"Add Groups"}),titleBarButtonOnClick:this.titleButtonOnClick}),_.a.createElement(Xs.a,{show:this.state.showConfirmModal,title:e({id:"remove_group_confirm_title",defaultMessage:"Remove Group and {memberCount, number} {memberCount, plural, one {Member} other {Members}}"},{memberCount:t}),message:e({id:"remove_group_confirm_message",defaultMessage:"{memberCount, number} {memberCount, plural, one {member} other {members}} associated to this group will be removed from the team on the next scheduled AD/LDAP synchronization. Are you sure you wish to remove this group and {memberCount} {memberCount, plural, one {member} other {members}}?"},{memberCount:t}),confirmButtonText:e({id:"remove_group_confirm_button",defaultMessage:"Yes, Remove Group and {memberCount, plural, one {Member} other {Members}}"},{memberCount:t}),onConfirm:this.handleDeleteConfirmed,onCancel:this.handleDeleteCanceled}))}}])&&iC(n.prototype,r),o&&iC(n,o),t}();uC(pC,"propTypes",{team:v.a.object.isRequired,actions:v.a.shape({getGroupsAssociatedToTeam:v.a.func.isRequired,unlinkGroupSyncable:v.a.func.isRequired,closeModal:v.a.func.isRequired,openModal:v.a.func.isRequired}).isRequired}),uC(pC,"contextTypes",{intl:Y.i});var fC=Object(r.connect)(function(e,t){return{team:e.entities.teams.teams[t.teamID]}},function(e){return{actions:Object(o.bindActionCreators)({getGroupsAssociatedToTeam:Gw.getGroupsAssociatedToTeam,closeModal:U.a,openModal:U.b,unlinkGroupSyncable:Gw.unlinkGroupSyncable},e)}})(pC);function dC(e){return(dC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mC(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function hC(e){return(hC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function bC(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yC(e,t){return(yC=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function gC(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var vC=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=hC(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==dC(o)&&"function"!=typeof o?bC(r):o,gC(bC(n),"toggleShortcutsModal",function(e){e.preventDefault(),S.n()}),gC(bC(n),"showGetTeamInviteLinkModal",function(e){e.preventDefault(),S.l()}),gC(bC(n),"handleKeyDown",function(e){Object(T.e)(e)&&e.shiftKey&&Object(T.S)(e,P.i.KeyCodes.A)&&n.props.actions.openModal({ModalId:P.r.USER_SETTINGS,dialogType:Qc.a})}),gC(bC(n),"handleEmitUserLoggedOutEvent",function(){S.e()}),gC(bC(n),"getFlagged",function(e){e.preventDefault(),n.props.actions.showFlaggedPosts(),n.props.actions.closeRhsMenu()}),gC(bC(n),"searchMentions",function(e){e.preventDefault(),n.props.isMentionSearch?n.props.actions.closeRightHandSide():(n.props.actions.closeRhsMenu(),n.props.actions.showMentions())}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yC(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"render",value:function(){var e=this,t=this.props,n=t.currentUser,r=t.teamIsGroupConstrained;if(!n)return null;var o=this.context.intl.formatMessage,a=this.props.pluginMenuItems.map(function(t){return _.a.createElement(Dp.a,{id:t.id+"_pluginmenuitem",key:t.id+"_pluginmenuitem",onClick:function(){t.action&&t.action()},text:t.text,icon:e.props.mobile&&t.mobileIcon})});return _.a.createElement(fu.a,{mobile:this.props.mobile,id:this.props.id,ariaLabel:Object(T.ab)("navbar_dropdown.menuAriaLabel","main menu")},_.a.createElement(Lw.a,null,_.a.createElement(Dp.a,{id:"recentMentions",show:this.props.mobile,onClick:this.searchMentions,icon:this.props.mobile&&_.a.createElement("i",{className:"mentions"},"@"),text:Object(T.ab)("sidebar_right_menu.recentMentions","Recent Mentions")}),_.a.createElement(Dp.a,{id:"flaggedPosts",show:this.props.mobile,onClick:this.getFlagged,icon:this.props.mobile&&_.a.createElement("i",{className:"fa fa-flag"}),text:Object(T.ab)("sidebar_right_menu.flagged","Flagged Posts")})),_.a.createElement(Lw.a,null,_.a.createElement(Bw.a,{id:"accountSettings",modalId:P.r.USER_SETTINGS,dialogType:Qc.a,text:Object(T.ab)("navbar_dropdown.accountSettings","Account Settings"),icon:this.props.mobile&&_.a.createElement("i",{className:"fa fa-cog"})})),_.a.createElement(Lw.a,null,_.a.createElement(C_.a,{teamId:this.props.teamId,permissions:[L.Permissions.MANAGE_TEAM]},_.a.createElement(Bw.a,{id:"addGroupsToTeam",show:r,modalId:P.r.ADD_GROUPS_TO_TEAM,dialogType:Aw.a,text:Object(T.ab)("navbar_dropdown.addGroupsToTeam","Add Groups to Team"),icon:this.props.mobile&&_.a.createElement("i",{className:"fa fa-user-plus"})})),_.a.createElement(C_.a,{teamId:this.props.teamId,permissions:[L.Permissions.ADD_USER_TO_TEAM]},_.a.createElement(Bw.a,{id:"addUsersToTeam",show:r,modalId:P.r.ADD_USER_TO_TEAM,dialogType:xw,text:Object(T.ab)("navbar_dropdown.addMemberToTeam","Add Members to Team"),icon:this.props.mobile&&_.a.createElement("i",{className:"fa fa-user-plus"})}))),_.a.createElement(Lw.a,null,_.a.createElement(C_.a,{teamId:this.props.teamId,permissions:[L.Permissions.ADD_USER_TO_TEAM]},_.a.createElement(C_.a,{teamId:this.props.teamId,permissions:[L.Permissions.INVITE_USER]},_.a.createElement(Bw.a,{id:"sendEmailInvite",show:this.props.enableEmailInvitations&&!r,modalId:P.r.EMAIL_INVITE,dialogType:w_,text:Object(T.ab)("navbar_dropdown.inviteMember","Send Email Invite"),icon:this.props.mobile&&_.a.createElement("i",{className:"fa fa-user-plus"})})),_.a.createElement(C_.a,{teamId:this.props.teamId,permissions:[L.Permissions.INVITE_USER]},_.a.createElement(Dp.a,{id:"getTeamInviteLink",show:this.props.teamType===P.i.OPEN_TEAM&&this.props.enableUserCreation&&!r,onClick:this.showGetTeamInviteLinkModal,text:Object(T.ab)("navbar_dropdown.teamLink","Get Team Invite Link"),icon:this.props.mobile&&_.a.createElement("i",{className:"fa fa-link"})})),_.a.createElement(Bw.a,{id:"addUsersToTeam",show:!r,modalId:P.r.ADD_USER_TO_TEAM,dialogType:xw,text:Object(T.ab)("navbar_dropdown.addMemberToTeam","Add Members to Team"),icon:this.props.mobile&&_.a.createElement("i",{className:"fa fa-user-plus"})}))),_.a.createElement(Lw.a,null,_.a.createElement(C_.a,{teamId:this.props.teamId,permissions:[L.Permissions.MANAGE_TEAM]},_.a.createElement(Bw.a,{id:"teamSettings",modalId:P.r.TEAM_SETTINGS,dialogType:Ew,text:Object(T.ab)("navbar_dropdown.teamSettings","Team Settings"),icon:this.props.mobile&&_.a.createElement("i",{className:"fa fa-globe"})})),_.a.createElement(C_.a,{teamId:this.props.teamId,permissions:[L.Permissions.MANAGE_TEAM]},_.a.createElement(Bw.a,{id:"manageGroups",show:r,modalId:P.r.MANAGE_TEAM_GROUPS,dialogProps:{teamID:this.props.teamId},dialogType:fC,text:Object(T.ab)("navbar_dropdown.manageGroups","Manage Groups"),icon:this.props.mobile&&_.a.createElement("i",{className:"fa fa-user-plus"})})),_.a.createElement(C_.a,{teamId:this.props.teamId,permissions:[L.Permissions.REMOVE_USER_FROM_TEAM,L.Permissions.MANAGE_TEAM_ROLES]},_.a.createElement(Bw.a,{id:"manageMembers",modalId:P.r.TEAM_MEMBERS,dialogType:RO,text:Object(T.ab)("navbar_dropdown.manageMembers","Manage Members"),icon:this.props.mobile&&_.a.createElement("i",{className:"fa fa-users"})})),_.a.createElement(C_.a,{teamId:this.props.teamId,permissions:[L.Permissions.REMOVE_USER_FROM_TEAM,L.Permissions.MANAGE_TEAM_ROLES],invert:!0},_.a.createElement(Bw.a,{id:"viewMembers",modalId:P.r.TEAM_MEMBERS,dialogType:RO,text:Object(T.ab)("navbar_dropdown.viewMembers","View Members"),icon:this.props.mobile&&_.a.createElement("i",{className:"fa fa-users"})}))),_.a.createElement(Lw.a,null,_.a.createElement(S_.a,{permissions:[L.Permissions.CREATE_TEAM]},_.a.createElement(Fw,{id:"createTeam",to:"/create_team",text:Object(T.ab)("navbar_dropdown.create","Create a New Team"),icon:this.props.mobile&&_.a.createElement("i",{className:"fa fa-plus-square"})})),_.a.createElement(Fw,{id:"joinTeam",show:!this.props.experimentalPrimaryTeam&&this.props.moreTeamsToJoin,to:"/select_team",text:Object(T.ab)("navbar_dropdown.join","Join Another Team"),icon:this.props.mobile&&_.a.createElement("i",{className:"fa fa-plus-square"})}),_.a.createElement(Bw.a,{id:"leaveTeam",show:!r&&this.props.experimentalPrimaryTeam!==this.props.teamName,modalId:P.r.LEAVE_TEAM,dialogType:B_,text:Object(T.ab)("navbar_dropdown.leave","Leave Team"),icon:this.props.mobile&&_.a.createElement(R_,null)})),_.a.createElement(Lw.a,null,a),_.a.createElement(Lw.a,null,_.a.createElement(C_.a,{teamId:this.props.teamId,permissions:[L.Permissions.MANAGE_SLASH_COMMANDS,L.Permissions.MANAGE_OAUTH,L.Permissions.MANAGE_INCOMING_WEBHOOKS,L.Permissions.MANAGE_OUTGOING_WEBHOOKS]},_.a.createElement(Fw,{id:"integrations",show:!this.props.mobile&&(this.props.enableIncomingWebhooks||this.props.enableOutgoingWebhooks||this.props.enableCommands||this.props.enableOAuthServiceProvider),to:"/"+this.props.teamName+"/integrations",text:Object(T.ab)("navbar_dropdown.integrations","Integrations")})),_.a.createElement(Fw,{id:"customEmojis",show:!this.props.mobile&&this.props.enableCustomEmoji&&this.props.canCreateOrDeleteCustomEmoji,to:"/"+this.props.teamName+"/emoji",text:Object(T.ab)("navbar_dropdown.emoji","Custom Emoji")})),_.a.createElement(Lw.a,null,_.a.createElement(S_.a,{permissions:[L.Permissions.MANAGE_SYSTEM]},_.a.createElement(Fw,{id:"systemConsole",show:!this.props.mobile,to:"/admin_console",text:Object(T.ab)("navbar_dropdown.console","System Console"),icon:this.props.mobile&&_.a.createElement("i",{className:"fa fa-wrench"})}))),_.a.createElement(Lw.a,null,_.a.createElement(Dw.a,{id:"helpLink",show:Boolean(this.props.helpLink),url:this.props.helpLink,text:Object(T.ab)("navbar_dropdown.help","Help"),icon:this.props.mobile&&_.a.createElement("i",{className:"fa fa-question"})}),_.a.createElement(Dp.a,{id:"keyboardShortcuts",show:!this.props.mobile,onClick:this.toggleShortcutsModal,text:Object(T.ab)("navbar_dropdown.keyboardShortcuts","Keyboard Shortcuts")}),_.a.createElement(Dw.a,{id:"reportLink",show:Boolean(this.props.reportAProblemLink),url:this.props.reportAProblemLink,text:Object(T.ab)("navbar_dropdown.report","Report a Problem"),icon:this.props.mobile&&_.a.createElement("i",{className:"fa fa-phone"})}),_.a.createElement(Dw.a,{id:"nativeAppLink",show:this.props.appDownloadLink&&!j.n(),url:Object(ss.g)(this.props.appDownloadLink),text:Object(T.ab)("navbar_dropdown.nativeApps","Download Apps"),icon:this.props.mobile&&_.a.createElement("i",{className:"fa fa-mobile"})}),_.a.createElement(Bw.a,{id:"about",modalId:P.r.ABOUT,dialogType:_w.a,text:o({id:"navbar_dropdown.about",defaultMessage:"About {appTitle}"},{appTitle:this.props.siteName||"Mattermost"}),icon:this.props.mobile&&_.a.createElement("i",{className:"fa fa-info"})})),_.a.createElement(Lw.a,null,_.a.createElement(Dp.a,{id:"logout",onClick:this.handleEmitUserLoggedOutEvent,text:Object(T.ab)("navbar_dropdown.logout","Logout"),icon:this.props.mobile&&_.a.createElement("i",{className:"fa fa-sign-out"})})))}}])&&mC(n.prototype,r),o&&mC(n,o),t}();gC(vC,"propTypes",{mobile:v.a.bool.isRequired,id:v.a.string,teamId:v.a.string,teamType:v.a.string,teamName:v.a.string,siteName:v.a.string,currentUser:v.a.object,appDownloadLink:v.a.string,enableCommands:v.a.bool.isRequired,enableCustomEmoji:v.a.bool.isRequired,canCreateOrDeleteCustomEmoji:v.a.bool.isRequired,enableIncomingWebhooks:v.a.bool.isRequired,enableOAuthServiceProvider:v.a.bool.isRequired,enableOutgoingWebhooks:v.a.bool.isRequired,enableUserCreation:v.a.bool.isRequired,enableEmailInvitations:v.a.bool.isRequired,experimentalPrimaryTeam:v.a.string,helpLink:v.a.string,reportAProblemLink:v.a.string,moreTeamsToJoin:v.a.bool.isRequired,pluginMenuItems:v.a.arrayOf(v.a.object),isMentionSearch:v.a.bool,teamIsGroupConstrained:v.a.bool.isRequired,actions:v.a.shape({openModal:v.a.func.isRequred,showMentions:v.a.func,showFlaggedPosts:v.a.func,closeRightHandSide:v.a.func.isRequired,closeRhsMenu:v.a.func.isRequired}).isRequired}),gC(vC,"defaultProps",{teamType:"",mobile:!1,pluginMenuItems:[]}),gC(vC,"contextTypes",{intl:Y.i.isRequired});var EC=Object(r.connect)(function(e){var t=Object(u.getConfig)(e),n=Object(f.getCurrentTeam)(e),r=Object(p.getCurrentUser)(e),o=t.AppDownloadLink,a="true"===t.EnableCommands,i="true"===t.EnableCustomEmoji,s=t.SiteName,c="true"===t.EnableIncomingWebhooks,l="true"===t.EnableOAuthServiceProvider,d="true"===t.EnableOutgoingWebhooks,m="true"===t.EnableUserCreation,h="true"===t.EnableEmailInvitations,b=t.ExperimentalPrimaryTeam,y=t.HelpLink,g=t.ReportAProblemLink,v=Object(D.haveISystemPermission)(e,{permission:L.Permissions.CREATE_EMOJIS})||Object(D.haveISystemPermission)(e,{permission:L.Permissions.DELETE_EMOJIS});if(!v){var E=!0,_=!1,O=void 0;try{for(var w,C=Object(f.getMyTeams)(e)[Symbol.iterator]();!(E=(w=C.next()).done);E=!0){var S=w.value;if(Object(D.haveITeamPermission)(e,{team:S.id,permission:L.Permissions.CREATE_EMOJIS})||Object(D.haveITeamPermission)(e,{team:S.id,permission:L.Permissions.DELETE_EMOJIS})){v=!0;break}}}catch(e){_=!0,O=e}finally{try{E||null==C.return||C.return()}finally{if(_)throw O}}}var j=Object(f.getJoinableTeamIds)(e),T=j&&j.length>0,k=Object(Nc.k)(e);return{appDownloadLink:o,enableCommands:a,enableCustomEmoji:i,enableIncomingWebhooks:c,enableOAuthServiceProvider:l,enableOutgoingWebhooks:d,enableUserCreation:m,enableEmailInvitations:h,experimentalPrimaryTeam:b,helpLink:y,reportAProblemLink:g,pluginMenuItems:e.plugins.components.MainMenu,canCreateOrDeleteCustomEmoji:v,moreTeamsToJoin:T,siteName:s,teamId:n.id,teamName:n.name,teamType:n.type,currentUser:r,isMentionSearch:k===P.A.MENTION,teamIsGroupConstrained:Boolean(n.group_constrained)}},function(e){return{actions:Object(o.bindActionCreators)({openModal:U.b,showMentions:kc.k,showFlaggedPosts:kc.j,closeRightHandSide:kc.b,closeRhsMenu:kc.a},e)}})(vC);function _C(e){return(_C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function OC(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function wC(e){return(wC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function CC(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function SC(e,t){return(SC=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function PC(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var jC=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,n=!(o=(e=wC(t)).call.apply(e,[this].concat(i)))||"object"!==_C(o)&&"function"!=typeof o?CC(r):o,PC(CC(n),"handleEmitUserLoggedOutEvent",function(){S.e()}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&SC(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e="";null!=this.props.siteName&&(e=this.props.siteName);var t=e;this.props.teamDisplayName&&(t=this.props.teamDisplayName);var n=null;return this.props.showTutorialTip&&(n=_.a.createElement(c_,{onBottom:!0}),this.props.actions.openRhsMenu()),_.a.createElement("div",{className:Mc()("sidebar--menu",{"move--left":this.props.isOpen&&T.U()}),id:"sidebar-menu"},_.a.createElement("div",{className:"team__header theme"},_.a.createElement(Fi.a,{className:"team__name",to:"/channels/".concat(P.i.DEFAULT_CHANNEL)},t)),_.a.createElement("div",{className:"nav-pills__container mobile-main-menu"},n,_.a.createElement(KE.a,{in:this.props.isOpen&&T.U(),classNames:"MobileRightSidebarMenu",enter:!0,exit:!0,mountOnEnter:!0,unmountOnExit:!0,timeout:{enter:500,exit:500}},_.a.createElement(EC,{mobile:!0}))))}}])&&OC(n.prototype,r),o&&OC(n,o),t}();PC(jC,"propTypes",{isOpen:v.a.bool.isRequired,teamDisplayName:v.a.string,showTutorialTip:v.a.bool.isRequired,siteName:v.a.string,actions:v.a.shape({openRhsMenu:v.a.func.isRequired})});var TC=Object(r.connect)(function(e){var t=Object(u.getConfig)(e),n=Object(f.getCurrentTeam)(e),r="true"===t.EnableTutorial,o=Object(l.getInt)(e,P.z.TUTORIAL_STEP,Object(p.getCurrentUserId)(e),P.I.FINISHED),a=t.SiteName;return{teamDisplayName:n.display_name,isOpen:Object(Nc.b)(e),showTutorialTip:r&&Object(T.U)()&&o===P.I.MENU_POPOVER,siteName:a}},function(e){return{actions:Object(o.bindActionCreators)({openRhsMenu:kc.c},e)}})(jC);function kC(e){return(kC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function NC(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function RC(e){return(RC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function MC(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function IC(e,t){return(IC=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function xC(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var AC=P.Q.ActionTypes,LC=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=RC(t).call(this,e),n=!o||"object"!==kC(o)&&"function"!=typeof o?MC(r):o,xC(MC(n),"updateShow",function(e,t){n.setState({show:e,callback:t.callback})}),xC(MC(n),"handleSubmit",function(e){e.preventDefault();var t=n.state.value;if(n.isInputValid(t)){var r=t.split(","),o={type:"custom"};o.sidebarBg=r[0],o.sidebarText=r[5],o.sidebarUnreadText=r[5],o.sidebarTextHoverBg=r[4],o.sidebarTextActiveBorder=r[2],o.sidebarTextActiveColor=r[3],o.sidebarHeaderBg=r[1],o.sidebarHeaderTextColor=r[5],o.onlineIndicator=r[6],o.awayIndicator="#E0B333",o.mentionBg=r[7],o.mentionColor="#ffffff",o.centerChannelBg="#ffffff",o.centerChannelColor="#333333",o.newMessageSeparator="#F80",o.linkColor="#2389d7",o.buttonBg="#26a970",o.buttonColor="#ffffff",o.mentionHighlightBg="#fff2bb",o.mentionHighlightLink="#2f81b7",o.codeTheme="github",n.state.callback(o),n.setState({show:!1,callback:null})}else n.setState({inputError:_.a.createElement(Y.c,{id:"user.settings.import_theme.submitError",defaultMessage:"Invalid format, please try copying and pasting in again."})})}),xC(MC(n),"handleChange",function(e){var t=e.target.value;n.setState({value:t}),n.isInputValid(t)?n.setState({inputError:null}):n.setState({inputError:_.a.createElement(Y.c,{id:"user.settings.import_theme.submitError",defaultMessage:"Invalid format, please try copying and pasting in again."})})}),xC(MC(n),"handleOnHide",function(){n.setState({show:!1})}),n.state={value:"",inputError:"",show:!1,callback:null},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&IC(e,t)}(t,_.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){gs.addModalListener(AC.TOGGLE_IMPORT_THEME_MODAL,this.updateShow)}},{key:"componentWillUnmount",value:function(){gs.removeModalListener(AC.TOGGLE_IMPORT_THEME_MODAL,this.updateShow)}},{key:"isInputValid",value:function(e){if(0===e.length)return!1;if(-1!==e.indexOf(" "))return!1;if(e.length>0&&-1===e.indexOf(","))return!1;if(e.length>0){var t=e.split(",");if(8!==t.length)return!1;for(var n=0;n<t.length;n++){if(7!==t[n].length&&4!==t[n].length)return!1;if("#"!==t[n].charAt(0))return!1}}return!0}},{key:"render",value:function(){return _.a.createElement("span",null,_.a.createElement(z.a,{dialogClassName:"a11y__modal",show:this.state.show,onHide:this.handleOnHide,role:"dialog","aria-labelledby":"importThemeModalLabel"},_.a.createElement(z.a.Header,{closeButton:!0},_.a.createElement(z.a.Title,{componentClass:"h1",id:"importThemeModalLabel"},_.a.createElement(Y.c,{id:"user.settings.import_theme.importHeader",defaultMessage:"Import Slack Theme"}))),_.a.createElement("form",{role:"form",className:"form-horizontal"},_.a.createElement(z.a.Body,null,_.a.createElement("p",null,_.a.createElement(Y.c,{id:"user.settings.import_theme.importBody",defaultMessage:'To import a theme, go to a Slack team and look for "Preferences -> Sidebar Theme". Open the custom theme option, copy the theme color values and paste them here:'})),_.a.createElement("div",{className:"form-group less"},_.a.createElement("div",{className:"col-sm-12"},_.a.createElement("input",{id:"themeVector",type:"text",className:"form-control",value:this.state.value,onChange:this.handleChange}),_.a.createElement("div",{className:"input__help"},this.state.inputError)))),_.a.createElement(z.a.Footer,null,_.a.createElement("button",{id:"cancelButton",type:"button",className:"btn btn-link",onClick:this.handleOnHide},_.a.createElement(Y.c,{id:"user.settings.import_theme.cancel",defaultMessage:"Cancel"})),_.a.createElement("button",{id:"submitButton",onClick:this.handleSubmit,type:"submit",className:"btn btn-primary",tabIndex:"3"},_.a.createElement(Y.c,{id:"user.settings.import_theme.submit",defaultMessage:"Submit"}))))))}}])&&NC(n.prototype,r),o&&NC(n,o),t}(),DC=n(1867);function UC(e){return e.views.lhs.isOpen}var qC=n(1621),HC=(n(431),n(2354));function FC(e){return(FC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function BC(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function GC(e){return(GC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function VC(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function WC(e,t){return(WC=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function KC(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var zC=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=GC(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==FC(o)&&"function"!=typeof o?VC(r):o,KC(VC(n),"copy",function(){var e=n.props.link;-1===e.indexOf("http://")&&-1===e.indexOf("https://")&&(e=n.props.siteURL+e),n.props.actions.copyToClipboard(e)}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&WC(e,t)}(t,_.a.Component),n=t,(r=[{key:"render",value:function(){var e=_.a.createElement(HC.a,{id:"copy-url-context-menu"+this.props.menuId},_.a.createElement(HC.c,{onClick:this.copy},_.a.createElement(Y.c,{id:"copy_url_context_menu.getChannelLink",defaultMessage:"Copy Link"}))),t=_.a.createElement(HC.b,{id:"copy-url-context-menu"+this.props.menuId},this.props.children);return _.a.createElement("span",null,e,t)}}])&&BC(n.prototype,r),o&&BC(n,o),t}();KC(zC,"propTypes",{children:v.a.element,link:v.a.string.isRequired,menuId:v.a.string.isRequired,siteURL:v.a.string.isRequired,actions:v.a.shape({copyToClipboard:v.a.func.isRequired})});var YC=Object(r.connect)(function(e){return{siteURL:Object(u.getConfig)(e).SiteURL}},function(){return{actions:{copyToClipboard:T.g}}})(zC);function QC(e){return(QC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ZC(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function JC(e){return(JC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function XC(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $C(e,t){return($C=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var eS=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=JC(t).call(this,e))||"object"!==QC(o)&&"function"!=typeof o?XC(r):o).handleSwitch=n.handleSwitch.bind(XC(n)),n.handleDisabled=n.handleDisabled.bind(XC(n)),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$C(e,t)}(t,_.a.Component),n=t,(r=[{key:"handleSwitch",value:function(e){e.preventDefault(),Object(vt.b)("TeamLink#click"),Object(vt.d)("ui","ui_team_sidebar_switch_team"),this.props.switchTeam(this.props.url)}},{key:"handleDisabled",value:function(e){e.preventDefault()}},{key:"render",value:function(){var e,t=this.props.teamIconUrl,n=this.context.intl.formatMessage,r=this.props.active?"active":"",o=this.props.btnClass,a=this.props.disabled?"team-disabled":"",i=this.props.active||this.props.disabled?this.handleDisabled:this.handleSwitch,s=n({id:"team.button.ariaLabel",defaultMessage:"{teamName} team"},{teamName:this.props.displayName});r||(r=this.props.unread?"unread":"",s=n({id:"team.button.unread.ariaLabel",defaultMessage:"{teamName} team unread"},{teamName:this.props.displayName}),this.props.mentions&&(s=n({id:"team.button.mentions.ariaLabel",defaultMessage:"{teamName} team, {mentionCount} mentions"},{teamName:this.props.displayName,mentionCount:this.props.mentions}),e=_.a.createElement("span",{className:"badge pull-right small"},this.props.mentions))),s=s.toLowerCase();var c=this.props.content;if(!c)if(t)c=_.a.createElement("div",{className:"team-btn__content"},_.a.createElement("div",{className:"team-btn__image",style:{backgroundImage:"url('".concat(t,"')")}}));else{var l=this.props.displayName;l=l?l.replace(/\s/g,"").substring(0,2):"??",c=_.a.createElement("div",{className:"team-btn__content"},_.a.createElement("div",{className:"team-btn__initials"},l))}var u,p=this.props.tip||Object(T.ab)("team.button.name_undefined","Name undefined"),f=_.a.createElement(vl.a,{delayShow:P.Q.OVERLAY_TIME_DELAY,placement:this.props.placement,overlay:_.a.createElement(El.a,{id:"tooltip-".concat(this.props.url)},p)},_.a.createElement("div",{className:"team-btn "+o},e,c));return Object(j.c)()?(u=_.a.createElement("button",{className:"btn btn-link "+a,onClick:i},f),this.props.url.endsWith("create_team")||this.props.url.endsWith("select_team")||(u=_.a.createElement(YC,{link:this.props.url,menuId:this.props.url},u))):u=_.a.createElement(Fi.a,{id:"".concat(this.props.url.slice(1),"TeamButton"),"aria-label":s,className:a,to:this.props.url,onClick:i},f),_.a.createElement("div",{className:"team-container ".concat(r)},u)}}])&&ZC(n.prototype,r),o&&ZC(n,o),t}();function tS(e){return(tS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nS(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function rS(e,t){return!t||"object"!==tS(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function oS(e){return(oS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function aS(e,t){return(aS=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function iS(e){return _.a.createElement("div",Object.assign({},e,{className:"scrollbar--view"}))}function sS(e){return _.a.createElement("div",Object.assign({},e,{className:"scrollbar--horizontal"}))}function cS(e){return _.a.createElement("div",Object.assign({},e,{className:"scrollbar--vertical"}))}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(eS,"contextTypes",{intl:Y.i.isRequired}),eS.defaultProps={btnClass:"",tip:"",placement:"right",active:!1,disabled:!1,unread:!1,mentions:0},eS.propTypes={btnClass:v.a.string,url:v.a.string.isRequired,displayName:v.a.string,content:v.a.node,tip:v.a.node.isRequired,active:v.a.bool,disabled:v.a.bool,unread:v.a.bool,mentions:v.a.number,placement:v.a.oneOf(["left","right","top","bottom"]),teamIconUrl:v.a.string,switchTeam:v.a.func.isRequired};var lS=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),rS(this,oS(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&aS(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"componentDidMount",value:function(){this.props.actions.getTeams(0,200)}},{key:"render",value:function(){var e=this,t=document.querySelector("#root");if(this.props.myTeams.length<=1)return t.classList.remove("multi-teams"),null;t.classList.add("multi-teams");var n=[],r=Object(qC.a)(this.props.myTeams,this.props.locale).map(function(t){var n=e.props.myTeamMembers[t.id];return _.a.createElement(eS,{key:"switch_team_"+t.name,url:"/".concat(t.name),tip:t.display_name,active:t.id===e.props.currentTeamId,displayName:t.display_name,unread:n.msg_count>0,mentions:n.mention_count,teamIconUrl:T.I(t),switchTeam:e.props.actions.switchTeam})});return this.props.moreTeamsToJoin&&!this.props.experimentalPrimaryTeam?r.push(_.a.createElement(eS,{btnClass:"team-btn__add",key:"more_teams",url:"/select_team",tip:_.a.createElement(Y.c,{id:"team_sidebar.join",defaultMessage:"Other teams you can join."}),content:"+",switchTeam:this.props.actions.switchTeam})):r.push(_.a.createElement(S_.a,{permissions:[Tp.a.CREATE_TEAM],key:"more_teams"},_.a.createElement(eS,{btnClass:"team-btn__add",url:"/create_team",tip:_.a.createElement(Y.c,{id:"navbar_dropdown.create",defaultMessage:"Create a New Team"}),content:"+",switchTeam:this.props.actions.switchTeam}))),n.push(_.a.createElement("div",{key:"team-sidebar-bottom-plugin",className:"team-sidebar-bottom-plugin is-empty"},_.a.createElement(I.a,{pluggableName:"BottomTeamSidebar"}))),_.a.createElement("div",{className:Mc()("team-sidebar",{"move--right":this.props.isOpen})},_.a.createElement("div",{className:"team-wrapper"},_.a.createElement(Fc.a,{autoHide:!0,autoHideTimeout:500,autoHideDuration:500,renderThumbHorizontal:sS,renderThumbVertical:cS,renderView:iS,onScroll:this.handleScroll},r)),n)}}])&&nS(n.prototype,r),o&&nS(n,o),t}();!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(lS,"propTypes",{myTeams:v.a.array.isRequired,currentTeamId:v.a.string.isRequired,moreTeamsToJoin:v.a.bool.isRequired,myTeamMembers:v.a.object.isRequired,isOpen:v.a.bool.isRequired,experimentalPrimaryTeam:v.a.string,locale:v.a.string.isRequired,actions:v.a.shape({getTeams:v.a.func.isRequired,switchTeam:v.a.func.isRequired}).isRequired});var uS=Object(a.f)(Object(r.connect)(function(e){var t=Object(u.getConfig)(e).ExperimentalPrimaryTeam,n=Object(f.getJoinableTeamIds)(e),r=n&&n.length>0;return{currentTeamId:Object(f.getCurrentTeamId)(e),myTeams:Object(f.getMyTeams)(e),myTeamMembers:Object(f.getTeamMemberships)(e),isOpen:UC(e),experimentalPrimaryTeam:t,locale:Object(Wc.a)(e),moreTeamsToJoin:r}},function(e){return{actions:Object(o.bindActionCreators)({getTeams:c.getTeams,switchTeam:b.e},e)}})(lS)),pS=n(1589),fS=n(2050),dS=n(2051),mS=n.n(dS),hS=n(2052),bS=n.n(hS),yS=n(1677);function gS(e){return(gS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vS(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ES(e){return(ES=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _S(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function OS(e,t){return(OS=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var wS=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=ES(t).call(this,e))||"object"!==gS(o)&&"function"!=typeof o?_S(r):o).createChannelRow=n.createChannelRow.bind(_S(n)),n.nextPage=n.nextPage.bind(_S(n)),n.previousPage=n.previousPage.bind(_S(n)),n.doSearch=n.doSearch.bind(_S(n)),n.nextTimeoutId=0,n.state={joiningChannel:"",page:0,nextDisabled:!1},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&OS(e,t)}(t,_.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){!j.m()&&this.refs.filter&&this.refs.filter.focus()}},{key:"componentDidUpdate",value:function(e,t){t.page!==this.state.page&&qc()(this.refs.channelList).scrollTop(0)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.isSearch&&!this.props.isSearch&&this.setState({page:0})}},{key:"handleJoin",value:function(e){var t=this;this.setState({joiningChannel:e.id}),this.props.handleJoin(e,function(){t.setState({joiningChannel:""})})}},{key:"createChannelRow",value:function(e){var t="".concat(e.display_name,", ").concat(e.purpose).toLowerCase();return _.a.createElement("div",{className:"more-modal__row",key:e.id},_.a.createElement("div",{className:"more-modal__details"},_.a.createElement("button",{onClick:this.handleJoin.bind(this,e),"aria-label":t,className:"style--none more-modal__name"},e.display_name),_.a.createElement("p",{className:"more-modal__description"},e.purpose)),_.a.createElement("div",{className:"more-modal__actions"},_.a.createElement("button",{onClick:this.handleJoin.bind(this,e),className:"btn btn-primary",disabled:this.state.joiningChannel},_.a.createElement(yE.a,{loading:this.state.joiningChannel===e.id,text:Object(T.ab)("more_channels.joining","Joining...")},_.a.createElement(Y.c,{id:"more_channels.join",defaultMessage:"Join"})))))}},{key:"nextPage",value:function(e){var t=this;e.preventDefault(),this.setState({page:this.state.page+1,nextDisabled:!0}),this.nextTimeoutId=setTimeout(function(){return t.setState({nextDisabled:!1})},500),this.props.nextPage(this.state.page+1),qc()(uu.a.findDOMNode(this.refs.channelListScroll)).scrollTop(0)}},{key:"previousPage",value:function(e){e.preventDefault(),this.setState({page:this.state.page-1}),qc()(uu.a.findDOMNode(this.refs.channelListScroll)).scrollTop(0)}},{key:"doSearch",value:function(){var e=this.refs.filter.value;this.props.search(e),""===e&&this.setState({page:0})}},{key:"render",value:function(){var e,t,n,r=this.props.channels;if(this.props.loading&&0===r.length)e=_.a.createElement(Vw.a,{style:{marginTop:"50%"}});else if(0===r.length)e=_.a.createElement("div",{className:"no-channel-message"},_.a.createElement("p",{className:"primary-message"},_.a.createElement(Y.c,{id:"more_channels.noMore",defaultMessage:"No more channels to join"})),this.props.noResultsText);else{var o=this.state.page*this.props.channelsPerPage,a=o+this.props.channelsPerPage,i=this.props.channels.slice(o,a);e=i.map(this.createChannelRow),i.length>=this.props.channelsPerPage&&a<this.props.channels.length&&(t=_.a.createElement("button",{className:"btn btn-link filter-control filter-control__next",onClick:this.nextPage,disabled:this.state.nextDisabled},_.a.createElement(Y.c,{id:"more_channels.next",defaultMessage:"Next"}))),this.state.page>0&&(n=_.a.createElement("button",{className:"btn btn-link filter-control filter-control__prev",onClick:this.previousPage},_.a.createElement(Y.c,{id:"more_channels.prev",defaultMessage:"Previous"})))}var s=_.a.createElement("div",{className:"filter-row filter-row--full"},_.a.createElement("div",{className:"col-sm-12"},_.a.createElement(yS.a,{id:"searchChannelsTextbox",ref:"filter",className:"form-control filter-textbox",placeholder:{id:Object(Ne.b)("filtered_channels_list.search"),defaultMessage:"Search channels"},inputComponent:ke.a,onInput:this.doSearch})));return this.props.createChannelButton&&(s=_.a.createElement("div",{className:"channel_search"},_.a.createElement("div",{className:"search_input"},_.a.createElement(yS.a,{id:"searchChannelsTextbox",ref:"filter",className:"form-control filter-textbox",placeholder:{id:Object(Ne.b)("filtered_channels_list.search"),defaultMessage:"Search channels"},inputComponent:ke.a,onInput:this.doSearch})),_.a.createElement("div",{className:"create_button"},this.props.createChannelButton))),_.a.createElement("div",{className:"filtered-user-list"},s,_.a.createElement("div",{role:"application",ref:"channelList",className:"more-modal__list"},_.a.createElement("div",{ref:"channelListScroll"},e)),_.a.createElement("div",{className:"filter-controls"},n,t))}}])&&vS(n.prototype,r),o&&vS(n,o),t}();function CS(e){return(CS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function SS(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function PS(e){return(PS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function jS(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function TS(e,t){return(TS=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function kS(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}wS.defaultProps={channels:[],isSearch:!1},wS.propTypes={channels:v.a.arrayOf(v.a.object),channelsPerPage:v.a.number,nextPage:v.a.func.isRequired,isSearch:v.a.bool,search:v.a.func.isRequired,handleJoin:v.a.func.isRequired,noResultsText:v.a.object,loading:v.a.bool,createChannelButton:v.a.element};var NS=50,RS=100,MS=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=PS(t).call(this,e),n=!o||"object"!==CS(o)&&"function"!=typeof o?jS(r):o,kS(jS(n),"handleHide",function(){n.setState({show:!1}),n.props.bodyOnly&&n.handleExit()}),kS(jS(n),"handleExit",function(){n.props.onModalDismissed&&n.props.onModalDismissed()}),kS(jS(n),"onChange",function(e){n.state.search&&!e||n.setState({searchedChannels:[],serverError:null})}),kS(jS(n),"nextPage",function(e){n.props.actions.getChannels(n.props.teamId,e+1,NS)}),kS(jS(n),"handleJoin",function(e,t){var r=n.props,o=r.actions,a=r.currentUserId,i=r.teamId,s=r.teamName;o.joinChannel(a,i,e.id).then(function(r){r.error?n.setState({serverError:r.error.message}):(Q.a.push(Object(ss.b)(s,e.name)),n.handleHide()),t&&t()})}),kS(jS(n),"search",function(e){if(clearTimeout(n.searchTimeoutId),""===e)return n.onChange(!0),n.setState({search:!1,searchedChannels:[],searching:!1}),void(n.searchTimeoutId="");n.setState({search:!0,searching:!0});var t=setTimeout(function(){n.props.actions.searchMoreChannels(e).then(function(e){t===n.searchTimeoutId&&(e.data?n.setSearchResults(e.data):n.setState({searchedChannels:[],searching:!1}))}).catch(function(){n.setState({searchedChannels:[],searching:!1})})},RS);n.searchTimeoutId=t}),kS(jS(n),"setSearchResults",function(e){n.setState({searchedChannels:e.filter(function(e){return 0===e.delete_at}),searching:!1})}),n.searchTimeoutId=0,n.state={show:!0,search:!1,searchedChannels:[],serverError:null,searching:!1},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&TS(e,t)}(t,_.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){this.props.actions.getChannels(this.props.teamId,0,100)}},{key:"render",value:function(){var e,t=this.props,n=t.channels,r=t.teamId,o=t.channelsRequestStarted,a=t.bodyOnly,i=this.state,s=i.search,c=i.searchedChannels,l=i.serverError,u=i.show,p=i.searching;l&&(e=_.a.createElement("div",{className:"form-group has-error"},_.a.createElement("label",{className:"control-label"},l)));var f=_.a.createElement(C_.a,{teamId:r,permissions:[Tp.a.CREATE_PUBLIC_CHANNEL,Tp.a.CREATE_PRIVATE_CHANNEL]},_.a.createElement("button",{id:"createNewChannel",type:"button",className:"btn btn-primary channel-create-btn",onClick:this.props.handleNewChannel},_.a.createElement(Y.c,{id:"more_channels.create",defaultMessage:"Create New Channel"}))),d=_.a.createElement(C_.a,{teamId:r,permissions:[Tp.a.CREATE_PUBLIC_CHANNEL,Tp.a.CREATE_PRIVATE_CHANNEL]},_.a.createElement("p",{className:"secondary-message"},_.a.createElement(Y.c,{id:"more_channels.createClick",defaultMessage:"Click 'Create New Channel' to make a new one"}))),m=_.a.createElement(_.a.Fragment,null,_.a.createElement(wS,{channels:s?c:n,channelsPerPage:NS,nextPage:this.nextPage,isSearch:s,search:this.search,handleJoin:this.handleJoin,noResultsText:d,loading:s?p:o,createChannelButton:a&&f}),e);return a?m:_.a.createElement(z.a,{dialogClassName:"a11y__modal more-modal more-modal--action",show:u,onHide:this.handleHide,onExited:this.handleExit,role:"dialog","aria-labelledby":"moreChannelsModalLabel"},_.a.createElement(z.a.Header,{closeButton:!0},_.a.createElement(z.a.Title,{componentClass:"h1",id:"moreChannelsModalLabel"},_.a.createElement(Y.c,{id:"more_channels.title",defaultMessage:"More Channels"})),f),_.a.createElement(z.a.Body,null,m))}}])&&SS(n.prototype,r),o&&SS(n,o),t}();kS(MS,"propTypes",{channels:v.a.array.isRequired,currentUserId:v.a.string.isRequired,teamId:v.a.string.isRequired,teamName:v.a.string.isRequired,onModalDismissed:v.a.func,handleNewChannel:v.a.func,channelsRequestStarted:v.a.bool,bodyOnly:v.a.bool,actions:v.a.shape({getChannels:v.a.func.isRequired,joinChannel:v.a.func.isRequired,searchMoreChannels:v.a.func.isRequired}).isRequired});var IS=Object(Kc.a)(d.getOtherChannels,function(e){return e&&e.filter(function(e){return 0===e.delete_at})});var xS=Object(r.connect)(function(e){var t=Object(f.getCurrentTeam)(e)||{};return{channels:IS(e)||[],currentUserId:Object(p.getCurrentUserId)(e),teamId:t.id,teamName:t.name,channelsRequestStarted:e.requests.channels.getChannels.status===L.RequestStatus.STARTED}},function(e){return{actions:Object(o.bindActionCreators)({getChannels:s.getChannels,joinChannel:s.joinChannel,searchMoreChannels:Ya.g},e)}})(MS);function AS(e){return(AS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function LS(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function DS(e){return(DS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function US(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qS(e,t){return(qS=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var HS=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=DS(t).call(this,e))||"object"!==AS(o)&&"function"!=typeof o?US(r):o).addValue=n.addValue.bind(US(n)),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qS(e,t)}(t,_.a.Component),n=t,(r=[{key:"getStyle",value:function(){var e="mentions__name";return this.props.isSelected&&(e+=" suggestion--selected"),e}},{key:"displayName",value:function(){return this.props.channel.profiles.map(function(e){return"@"+e.username}).join(", ")}},{key:"addValue",value:function(){this.props.onAdd(this.props.channel.profiles)}},{key:"render",value:function(){return _.a.createElement("div",{key:this.props.channel.id,className:"more-modal__row clickable "+this.getStyle(),onClick:this.addValue},_.a.createElement("div",{className:"more-modal__gm-icon bg-text-200"},this.props.channel.profiles.length),_.a.createElement("div",{className:"more-modal__details"},_.a.createElement("div",{className:"more-modal__name"},this.displayName())),_.a.createElement("div",{className:"more-modal__actions"},_.a.createElement("div",{className:"more-modal__actions--round"},_.a.createElement(ww.a,null))))}}])&&LS(n.prototype,r),o&&LS(n,o),t}();function FS(e){return(FS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function BS(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function GS(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function VS(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function WS(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){VS(a,r,o,i,s,"next",e)}function s(e){VS(a,r,o,i,s,"throw",e)}i(void 0)})}}function KS(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function zS(e){return(zS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function YS(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function QS(e,t){return(QS=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ZS(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(HS,"propTypes",{channel:v.a.object.isRequired,isSelected:v.a.bool.isRequired,onAdd:v.a.func.isRequired});var JS=50,XS=P.Q.MAX_USERS_IN_GM-1,$S=function(e){function t(e){var n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=zS(t).call(this,e),n=!o||"object"!==FS(o)&&"function"!=typeof o?YS(r):o,ZS(YS(n),"loadProfilesMissingStatus",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.filter(function(e){return!t[e.id]}).map(function(e){return e.id});r.length>0&&n.props.actions.getStatusesByIds(r)}),ZS(YS(n),"handleHide",function(){n.props.actions.setModalSearchTerm(""),n.setState({show:!1}),n.props.bodyOnly&&n.handleExit()}),ZS(YS(n),"setUsersLoadingState",function(e){n.setState({loadingUsers:e})}),ZS(YS(n),"handleExit",function(){n.exitToChannel&&Q.a.push(n.exitToChannel),n.props.onModalDismissed&&n.props.onModalDismissed(),n.props.onHide&&n.props.onHide()}),ZS(YS(n),"handleSubmit",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.state.values,t=n.props.actions;if(!n.state.saving){var r=e.map(function(e){return e.id});if(0!==r.length){n.setState({saving:!0});var o=function(e){var t=e.data,r=e.error;n.setState({saving:!1}),r||(n.exitToChannel="/"+n.props.currentTeamName+"/channels/"+t.name,n.handleHide())};1===r.length?t.openDirectChannelToUserId(r[0]).then(o):t.openGroupChannelToUserIds(r).then(o)}}}),ZS(YS(n),"addValue",function(e){if(Array.isArray(e))n.addUsers(e);else if("profiles"in e)n.addUsers(e.profiles);else{var t=Object.assign([],n.state.values);-1===t.indexOf(e)&&t.push(e),n.setState({values:t})}}),ZS(YS(n),"addUsers",function(e){var t=Object.assign([],n.state.values),r=t.map(function(e){return e.id}),o=!0,a=!1,i=void 0;try{for(var s,c=e[Symbol.iterator]();!(o=(s=c.next()).done);o=!0){var l=s.value;-1===r.indexOf(l.id)&&t.push(l)}}catch(e){a=!0,i=e}finally{try{o||null==c.return||c.return()}finally{if(a)throw i}}n.setState({values:t})}),ZS(YS(n),"getUserProfiles",function(e){var t=e?e+1:0;"any"===n.props.restrictDirectMessage?n.props.actions.getProfiles(t,2*JS).then(function(){n.setUsersLoadingState(!1)}):n.props.actions.getProfilesInTeam(n.props.currentTeamId,t,2*JS).then(function(){n.setUsersLoadingState(!1)})}),ZS(YS(n),"handlePageChange",function(e,t){e>t&&(n.setUsersLoadingState(!0),n.getUserProfiles(e))}),ZS(YS(n),"resetPaging",function(){n.refs.multiselect&&n.refs.multiselect.resetPaging()}),ZS(YS(n),"search",function(e){n.props.actions.setModalSearchTerm(e)}),ZS(YS(n),"handleDelete",function(e){n.setState({values:e})}),ZS(YS(n),"renderAriaLabel",function(e){return e?e.username:null}),ZS(YS(n),"renderOption",function(e,t,r){if(e.type&&"G"===e.type)return _.a.createElement(HS,{key:e.id,channel:e,isSelected:t,onAdd:r});var o=Object(T.m)(e),a=o;e.id===n.props.currentUserId?a=_.a.createElement(Y.c,{id:"more_direct_channels.directchannel.you",defaultMessage:"{displayname} (you)",values:{displayname:o}}):e.delete_at&&(a=_.a.createElement(Y.c,{id:"more_direct_channels.directchannel.deactivated",defaultMessage:"{displayname} - Deactivated",values:{displayname:o}}));var i="";t&&(i="more-modal__row--selected");var s=e.delete_at||e.is_bot?null:n.props.statuses[e.id],c=e.is_bot?null:e.email;return _.a.createElement("div",{key:e.id,ref:t?"selected":e.id,className:"more-modal__row clickable "+i,onClick:function(){return r(e)}},_.a.createElement(bd.a,{src:ii.Client4.getProfilePictureUrl(e.id,e.last_picture_update),status:s,width:"32",height:"32"}),_.a.createElement("div",{className:"more-modal__details"},_.a.createElement("div",{className:"more-modal__name"},a,_.a.createElement(ka.a,{show:Boolean(e.is_bot),className:"badge-popoverlist"})),_.a.createElement("div",{className:"more-modal__description"},c)),_.a.createElement("div",{className:"more-modal__actions"},_.a.createElement("div",{className:"more-modal__actions--round"},_.a.createElement(ww.a,null))))}),ZS(YS(n),"handleSubmitImmediatelyOn",function(e){return e.id===n.props.currentUserId||Boolean(e.delete_at)}),n.searchTimeoutId=0;var a=[];if(e.currentChannelMembers)for(var i=0;i<e.currentChannelMembers.length;i++){var s=Object.assign({},e.currentChannelMembers[i]);s.id!==e.currentUserId&&a.push(s)}return n.state={values:a,show:!0,search:!1,saving:!1,loadingUsers:!0},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&QS(e,t)}(t,_.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){this.getUserProfiles(),this.props.actions.getTotalUsersStats(),this.loadProfilesMissingStatus(this.props.users,this.props.statuses)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this;if(this.props.searchTerm!==e.searchTerm){clearTimeout(this.searchTimeoutId);var n=e.searchTerm;if(""===n)this.resetPaging();else{var r="any"===e.restrictDirectMessage?"":e.currentTeamId;this.searchTimeoutId=setTimeout(WS(regeneratorRuntime.mark(function e(){var o,a,i,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.setUsersLoadingState(!0),e.next=3,Promise.all([t.props.actions.searchProfiles(n,{team_id:r}),t.props.actions.searchGroupChannels(n)]);case 3:o=e.sent,a=GS(o,2),i=a[0].data,s=a[1].data,i&&t.props.actions.loadStatusesForProfilesList(i),s&&t.props.actions.loadProfilesForGroupChannels(s),t.resetPaging(),t.setUsersLoadingState(!1);case 11:case"end":return e.stop()}},e)})),P.Q.SEARCH_TIMEOUT_MILLISECONDS)}}this.props.users.length===e.users.length&&Object.keys(this.props.statuses).length===Object.keys(e.statuses).length||this.loadProfilesMissingStatus(e.users,e.statuses)}},{key:"renderValue",value:function(e){return e.data.username}},{key:"render",value:function(){var e,t=this;this.props.currentChannelMembers&&(this.state.values&&this.state.values.length>=XS?e=_.a.createElement(Y.c,{id:"more_direct_channels.new_convo_note.full",defaultMessage:"You've reached the maximum number of people for this conversation. Consider creating a private channel instead."}):this.props.isExistingChannel&&(e=_.a.createElement(Y.c,{id:"more_direct_channels.new_convo_note",defaultMessage:"This will start a new conversation. If you're adding a lot of people, consider creating a private channel instead."})));var n=Object(T.ab)("multiselect.go","Go"),r=Object(T.ab)("multiselect.loading","Loading.."),o=_.a.createElement(Y.c,{id:"multiselect.numPeopleRemaining",defaultMessage:"Use ↑↓ to browse, ↵ to select. You can add {num, number} more {num, plural, one {person} other {people}}. ",values:{num:XS-this.state.values.length}}),a=this.props.users||[];if(this.state.values.length)a=a.filter(function(e){return 0===e.delete_at&&e.id!==t.props.currentUserId});else{var i=[],s=[],c=!0,l=!1,u=void 0;try{for(var p,f=a[Symbol.iterator]();!(c=(p=f.next()).done);c=!0){var d=p.value;(d.delete_at?s:i).push(d)}}catch(e){l=!0,u=e}finally{try{c||null==f.return||f.return()}finally{if(l)throw u}}a=i.concat(s)}var m=this.props.groupChannels||[],h=[].concat(BS(a),BS(m)),b=_.a.createElement(Ow.a,{key:"moreDirectChannelsList",ref:"multiselect",options:h,optionRenderer:this.renderOption,values:this.state.values,valueRenderer:this.renderValue,ariaLabelRenderer:this.renderAriaLabel,perPage:JS,handlePageChange:this.handlePageChange,handleInput:this.search,handleDelete:this.handleDelete,handleAdd:this.addValue,handleSubmit:this.handleSubmit,noteText:e,maxValues:XS,numRemainingText:o,buttonSubmitText:n,buttonSubmitLoadingText:r,submitImmediatelyOn:this.handleSubmitImmediatelyOn,saving:this.state.saving,loading:this.state.loadingUsers,users:this.props.users,totalCount:this.props.totalCount,placeholderText:Object(T.ab)("multiselect.placeholder","Search and add members")});return this.props.bodyOnly?b:_.a.createElement(z.a,{dialogClassName:"a11y__modal more-modal more-direct-channels",show:this.state.show,onHide:this.handleHide,onExited:this.handleExit,role:"dialog","aria-labelledby":"moreDmModalLabel"},_.a.createElement(z.a.Header,{closeButton:!0},_.a.createElement(z.a.Title,{componentClass:"h1",id:"moreDmModalLabel"},_.a.createElement(Y.c,{id:"more_direct_channels.title",defaultMessage:"Direct Messages"}))),_.a.createElement(z.a.Body,{role:"application"},b),_.a.createElement(z.a.Footer,{className:"modal-footer--invisible"},_.a.createElement("button",{id:"closeModalButton",type:"button",className:"btn btn-link"},_.a.createElement(Y.c,{id:"general_button.close",defaultMessage:"Close"}))))}}])&&KS(n.prototype,r),o&&KS(n,o),t}();ZS($S,"propTypes",{currentUserId:v.a.string.isRequired,currentTeamId:v.a.string.isRequired,currentTeamName:v.a.string.isRequired,searchTerm:v.a.string.isRequired,users:v.a.arrayOf(v.a.object).isRequired,groupChannels:v.a.arrayOf(v.a.object).isRequired,statuses:v.a.object.isRequired,totalCount:v.a.number,currentChannelMembers:v.a.arrayOf(v.a.object),isExistingChannel:v.a.bool.isRequired,restrictDirectMessage:v.a.string,onModalDismissed:v.a.func,onHide:v.a.func,bodyOnly:v.a.bool,actions:v.a.shape({getProfiles:v.a.func.isRequired,getProfilesInTeam:v.a.func.isRequired,getStatusesByIds:v.a.func.isRequired,getTotalUsersStats:v.a.func.isRequired,loadStatusesForProfilesList:v.a.func.isRequired,loadProfilesForGroupChannels:v.a.func.isRequired,openDirectChannelToUserId:v.a.func.isRequired,openGroupChannelToUserIds:v.a.func.isRequired,searchProfiles:v.a.func.isRequired,searchGroupChannels:v.a.func.isRequired,setModalSearchTerm:v.a.func.isRequired}).isRequired});var eP=Object(l_.memoizeResult)(function(e,t){return e.filter(function(e){return Object(ja.filterProfilesMatchingTerm)(e.profiles,t).length>0})});var tP=Object(r.connect)(function(e,t){var n=Object(p.getCurrentUserId)(e),r=[];t.isExistingChannel&&(r=Object(p.getProfilesInCurrentChannel)(e));var o,a=Object(u.getConfig)(e).RestrictDirectMessage,i=e.views.search.modalSearch;o=i?"any"===a?Object(p.searchProfiles)(e,i,!1):Object(p.searchProfilesInCurrentTeam)(e,i,!1):"any"===a?Object(p.getProfiles)(e):Object(p.getProfilesInCurrentTeam)(e);var s=eP(Object(d.getChannelsWithUserProfiles)(e),i),c=Object(f.getCurrentTeam)(e),l=Object(p.getTotalUsersStats)(e)||{total_users_count:0};return{currentTeamId:c.id,currentTeamName:c.name,searchTerm:i,users:o,groupChannels:s,statuses:e.entities.users.statuses,currentChannelMembers:r,currentUserId:n,restrictDirectMessage:a,totalCount:l.total_users_count}},function(e){return{actions:Object(o.bindActionCreators)({getProfiles:i.getProfiles,getProfilesInTeam:i.getProfilesInTeam,getStatusesByIds:i.getStatusesByIds,getTotalUsersStats:i.getTotalUsersStats,loadStatusesForProfilesList:m.b,loadProfilesForGroupChannels:lc.i,openDirectChannelToUserId:Ya.e,openGroupChannelToUserIds:Ya.f,searchProfiles:i.searchProfiles,searchGroupChannels:s.searchGroupChannels,setModalSearchTerm:G_.a},e)}})($S);n(309),n(952);function nP(e){return(nP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rP(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function oP(e,t){return!t||"object"!==nP(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function aP(e){return(aP=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function iP(e,t){return(iP=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var sP=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),oP(this,aP(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&iP(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){return _.a.createElement("span",Object.assign({},this.props,{id:"draftIcon"}),_.a.createElement(Y.c,{id:"generic_icons.channel.draft",defaultMessage:"Channel Draft Icon"},function(e){return _.a.createElement("svg",{width:"14px",height:"14px",viewBox:"0 0 50 51",role:"icon","aria-label":e},_.a.createElement("g",{stroke:"none",strokeWidth:"1",fillRule:"evenodd"},_.a.createElement("path",{d:"M11.980198,46.7136356 L14.9834983,43.7103353 L7.22772277,35.9545597 L4.22442244,38.95786 L4.22442244,42.4892132 L8.44884488,42.4892132 L8.44884488,46.7136356 L11.980198,46.7136356 Z M29.2409241,16.0865729 C29.2409241,15.6025221 28.9989023,15.3605003 28.5148515,15.3605003 C28.2948284,15.3605003 28.1078116,15.4375072 27.9537954,15.5915234 L10.0660066,33.4793122 C9.91199043,33.6333283 9.8349835,33.8203452 9.8349835,34.0403683 C9.8349835,34.5244191 10.0770053,34.7664409 10.5610561,34.7664409 C10.7810792,34.7664409 10.968096,34.6894339 11.1221122,34.5354178 L29.009901,16.647629 C29.1639172,16.4936128 29.2409241,16.306596 29.2409241,16.0865729 Z M27.4587459,9.74993922 L41.1881188,23.4793122 L13.7293729,50.938058 L0,50.938058 L0,37.2086851 L27.4587459,9.74993922 Z M50,12.9182561 C50,14.0843785 49.5929634,15.0744676 48.7788779,15.8885531 L43.30033,21.3671009 L29.5709571,7.637728 L35.049505,2.19218345 C35.8415881,1.35609566 36.8316772,0.938058036 38.019802,0.938058036 C39.1859244,0.938058036 40.1870145,1.35609566 41.0231023,2.19218345 L48.7788779,9.91495573 C49.5929634,10.7730458 50,11.7741359 50,12.9182561 Z"})))}))}}])&&rP(n.prototype,r),o&&rP(n,o),t}(),cP=n(1552),lP=n(1553);function uP(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function pP(e){return(pP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fP(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function dP(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mP(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function hP(e,t,n){return t&&mP(e.prototype,t),n&&mP(e,n),e}function bP(e,t){return!t||"object"!==pP(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function yP(e,t,n){return(yP="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=gP(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function gP(e){return(gP=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function vP(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&EP(e,t)}function EP(e,t){return(EP=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var _P=Qa.a.getState,OP=function(e){function t(){return dP(this,t),bP(this,gP(t).apply(this,arguments))}return vP(t,Na["a"]),hP(t,[{key:"render",value:function(){var e=this.props,t=e.item,n=e.isSelection,r=t.channel,o=r.delete_at&&0!==r.delete_at,a=this.props.channelMember,i=null;a&&a.notify_props&&a.mention_count>0&&(i=_.a.createElement("span",{className:"badge"},a.mention_count));var s="mentions__name";n&&(s+=" suggestion--selected");var c=r.display_name,l=null;l=o?_.a.createElement(Uv.a,{className:"icon icon__archive"}):this.props.hasDraft?_.a.createElement(sP,{className:"icon icon__draft icon--body"}):r.type===P.i.OPEN_CHANNEL?_.a.createElement(cP.a,{className:"icon icon__globe icon--body"}):r.type===P.i.PRIVATE_CHANNEL?_.a.createElement(lP.a,{className:"icon icon__lock icon--body"}):r.type===P.i.GM_CHANNEL?_.a.createElement("div",{className:"status status--group"},"G"):_.a.createElement("div",{className:"pull-left"},_.a.createElement("img",{alt:"",className:"mention__image",src:T.J(r.userId)}));var u=null;if(r.type===P.i.DM_CHANNEL){var f=T.u(r.id);T.O(f)&&(f=Object(p.getUser)(_P(),r.userId)),u=_.a.createElement(ka.a,{show:Boolean(f&&f.is_bot),className:"badge-autocomplete"})}return _.a.createElement("div",Object.assign({onClick:this.handleClick,className:s,id:"switchChannel_".concat(r.name)},Na.a.baseProps),l,_.a.createElement("span",null,c),u,i)}}],[{key:"propTypes",get:function(){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){fP(e,t,n[t])})}return e}({},yP(gP(t),"propTypes",this),{channelMember:v.a.object,hasDraft:v.a.bool})}}]),t}();var wP=Object(r.connect)(function(e,t){var n=t.item&&t.item.channel?t.item.channel.id:"",r=!!n&&Object(Nc.i)(e,P.G.DRAFT,n);return{channelMember:Object(d.getMyChannelMemberships)(e)[n],hasDraft:r&&Boolean(r.message.trim()||r.fileInfos.length||r.uploadsInProgress.length)}})(OP),CP="";function SP(e,t){var n=!!e.channel.delete_at&&0!==e.channel.delete_at,r=!!t.channel.delete_at&&0!==t.channel.delete_at;if(n&&!r)return 1;if(!n&&r)return-1;if(e.type===P.i.MENTION_CHANNELS&&t.type===P.i.MENTION_MORE_CHANNELS)return-1;if(t.type===P.i.MENTION_CHANNELS&&e.type===P.i.MENTION_MORE_CHANNELS)return 1;if(e.deactivated&&!t.deactivated)return 1;if(t.deactivated&&!e.deactivated)return-1;var o=e.channel,a=t.channel,i=o.display_name.toLowerCase(),s=a.display_name.toLowerCase();o.type===P.i.DM_CHANNEL&&(i=i.substring(1)),a.type===P.i.DM_CHANNEL&&(s=s.substring(1));var c=i.startsWith(CP),l=s.startsWith(CP);return c&&l||!c&&!l?Object(Ka.sortChannelsByTypeAndDisplayName)("en",o,a):c?-1:1}var PP=function(e){function t(){return dP(this,t),bP(this,gP(t).apply(this,arguments))}return vP(t,Ta["a"]),hP(t,[{key:"handlePretextChanged",value:function(e,t){if(e){CP=e,this.startNewRequest(e);var n=Object(d.getChannelsInCurrentTeam)(_P()).concat(Object(d.getDirectAndGroupChannels)(_P())),r=Object.assign([],Object(p.searchProfiles)(_P(),e,!1));this.formatChannelsAndDispatch(e,t,n,r,!0),this.fetchUsersAndChannels(e,t)}else this.formatUnreadChannelsAndDispatch(t);return!0}},{key:"fetchUsersAndChannels",value:function(){var e,t=(e=regeneratorRuntime.mark(function e(t,n){var r,o,a,i,c,l,m,h,b,y,g,v;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=_P(),o=Object(f.getCurrentTeamId)(r)){e.next=4;break}return e.abrupt("return");case 4:return a=Object(u.getConfig)(r),i="team"===a.RestrictDirectMessage?ii.Client4.autocompleteUsers(t,o,""):ii.Client4.autocompleteUsers(t,"",""),c=s.searchChannels(o,t)(Qa.a.dispatch,Qa.a.getState),l=[],m=[],e.prev=9,e.next=12,i;case 12:return l=e.sent,e.next=15,c;case 15:h=e.sent,b=h.data,m=b,e.next=23;break;case 20:e.prev=20,e.t0=e.catch(9),Qa.a.dispatch(Object(H.logError)(e.t0));case 23:if(!this.shouldCancelDispatch(t)){e.next=25;break}return e.abrupt("return");case 25:y=Object.assign([],Object(p.searchProfiles)(r,t,!1)).concat(l.users),g=Object(p.getCurrentUserId)(r),Qa.a.dispatch({type:za.UserTypes.RECEIVED_PROFILES_LIST,data:y.filter(function(e){return e.id!==g})}),v=Object(d.getChannelsInCurrentTeam)(r).concat(Object(d.getDirectAndGroupChannels)(r)).concat(m),this.formatChannelsAndDispatch(t,n,v,y);case 30:case"end":return e.stop()}},e,this,[[9,20]])}),function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){uP(a,r,o,i,s,"next",e)}function s(e){uP(a,r,o,i,s,"throw",e)}i(void 0)})});return function(e,n){return t.apply(this,arguments)}}()},{key:"userWrappedChannel",value:function(e,t){var n="@".concat(e.username);return(e.first_name||e.last_name)&&e.nickname?n+=" - ".concat(T.z(e)," (").concat(e.nickname,")"):e.nickname?n+=" - (".concat(e.nickname,")"):(e.first_name||e.last_name)&&(n+=" - ".concat(T.z(e))),e.delete_at&&(n+=" - "+T.ab("channel_switch_modal.deactivated","Deactivated")),{channel:{display_name:n,name:e.username,id:t?t.id:e.id,userId:e.id,update_at:e.update_at,type:P.i.DM_CHANNEL,last_picture_update:e.last_picture_update||0},name:e.username,deactivated:e.delete_at}}},{key:"formatChannelsAndDispatch",value:function(e,t,n,r){var o=this,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=[],s=Object(d.getMyChannelMemberships)(_P());if(!this.shouldCancelDispatch(e)){for(var c={},f=function(e){var t=e.toLowerCase(),n=_P(),r=Object(p.getUserIdsInChannels)(n),o={};return function(e){var a=e.display_name;if(e.type===P.i.GM_CHANNEL||e.type===P.i.DM_CHANNEL){var i=r[e.id]||new Set([]);if(!i.size&&e.type===P.i.DM_CHANNEL){var s=T.E(e.name);Object(p.getUser)(n,s)&&i.add(s)}var c=!0,l=!1,u=void 0;try{for(var f,d=i[Symbol.iterator]();!(c=(f=d.next()).done);c=!0){var m=f.value,h=o[m];if(!h){var b=Object(p.getUser)(n,m);if(!b)continue;var y=b.nickname,g=b.username;h="".concat(y).concat(g).concat(T.z(b)),o[m]=h}a+=h}}catch(e){l=!0,u=e}finally{try{c||null==d.return||d.return()}finally{if(l)throw u}}}return a.toLowerCase().includes(t)}}(e),m=_P(),h=Object(u.getConfig)(m),b="true"===h.ExperimentalViewArchivedChannels,y=0,g=Object.keys(n);y<g.length;y++){var v=n[g[y]];if(!c[v.id]&&f(v)){var E=Object.assign({},v),_=0!==v.delete_at,O={channel:E,name:E.name,deactivated:!1};if(!b&&_)continue;if(_&&s[v.id])O.type=P.i.ARCHIVED_CHANNEL;else{if(_&&!s[v.id])continue;if(E.type===P.i.GM_CHANNEL){if(E.name=E.display_name,O.name=E.name,Object(Ka.isGroupChannelVisible)(h,Object(l.getMyPreferences)(m),v,Object(ea.getLastPostPerChannel)(m)[v.id],Object(Ka.isUnreadChannel)(Object(d.getMyChannelMemberships)(m),v)))O.type=P.i.MENTION_CHANNELS;else if(O.type=P.i.MENTION_MORE_CHANNELS,a)continue}else if(E.type===P.i.DM_CHANNEL){if("continue"===function(){var e=T.E(E.name),t=r.find(function(t){return t.id===e});if(!t)return"continue";if(c[t.id]=!0,O=o.userWrappedChannel(t,E),Object(Ka.isDirectChannelVisible)(t.id,h,Object(l.getMyPreferences)(m),v,Object(ea.getLastPostPerChannel)(m)[v.id],Object(Ka.isUnreadChannel)(Object(d.getMyChannelMemberships)(m),v)))O.type=P.i.MENTION_CHANNELS;else if(O.type=P.i.MENTION_MORE_CHANNELS,a)return"continue"}())continue}else if(s[v.id])O.type=P.i.MENTION_CHANNELS;else if(O.type=P.i.MENTION_MORE_CHANNELS,a||!E.display_name.toLowerCase().startsWith(e))continue}c[v.id]=!0,i.push(O)}}for(var w=0;w<r.length;w++){var C=r[w];if(!c[C.id]){var S=Object(l.getBool)(_P(),L.Preferences.CATEGORY_DIRECT_CHANNEL_SHOW,C.id,!1),j=this.userWrappedChannel(C);if(S)j.type=P.i.MENTION_CHANNELS;else if(j.type=P.i.MENTION_MORE_CHANNELS,a)continue;c[C.id]=!0,i.push(j)}}var k=i.sort(SP).map(function(e){return e.channel.name});a&&i.push({type:P.i.MENTION_MORE_CHANNELS,loading:!0}),t({matchedPretext:e,terms:k,items:i,component:wP})}}},{key:"formatUnreadChannelsAndDispatch",value:function(e){for(var t=Object(d.makeGetChannel)(),n=Object(d.getSortedUnreadChannelIds)(_P(),!1),r=[],o=0;o<n.length;o++){var a=t(_P(),{id:n[o]})||{},i={channel:a,name:a.name,deactivated:!1};if(a.type===P.i.GM_CHANNEL)i.name=a.display_name;else if(a.type===P.i.DM_CHANNEL){var s=Object(p.getUser)(_P(),T.E(a.name));if(!s)continue;i=this.userWrappedChannel(s,a)}i.type=P.i.MENTION_UNREAD_CHANNELS,r.push(i)}e({matchedPretext:"",terms:r.map(function(e){return e.channel.name}),items:r,component:wP})}}]),t}();function jP(e){return(jP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function TP(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kP(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function NP(e,t,n){return t&&kP(e.prototype,t),n&&kP(e,n),e}function RP(e,t){return!t||"object"!==jP(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function MP(e){return(MP=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function IP(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xP(e,t)}function xP(e,t){return(xP=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var AP=Qa.a.getState,LP=function(e){function t(){return TP(this,t),RP(this,MP(t).apply(this,arguments))}return IP(t,Na["a"]),NP(t,[{key:"render",value:function(){var e=this.props,t=e.item,n="mentions__name";return e.isSelection&&(n+=" suggestion--selected"),_.a.createElement("div",Object.assign({onClick:this.handleClick,className:n},Na.a.baseProps),_.a.createElement("div",{className:"status"},_.a.createElement(Y.c,{id:"general_tab.teamIcon",defaultMessage:"Team Icon"},function(e){return _.a.createElement("i",{className:"fa fa-group",title:e})})),t.display_name)}}]),t}(),DP="";function UP(e,t){var n=e.display_name.toLowerCase(),r=t.display_name.toLowerCase(),o=n.startsWith(DP),a=r.startsWith(DP);if(o&&a){var i=Object(Wc.a)(AP());return n!==r?n.localeCompare(r,i,{numeric:!0}):e.name.localeCompare(t.name,i,{numeric:!0})}return o?-1:1}var qP=function(e){function t(){return TP(this,t),RP(this,MP(t).apply(this,arguments))}return IP(t,Ta["a"]),NP(t,[{key:"handlePretextChanged",value:function(e,t){if(e){DP=e,this.startNewRequest(e);var n=f.getMyTeams(AP()).filter(function(t){return-1!==t.display_name.toLowerCase().indexOf(e)||-1!==t.name.indexOf(e)}),r=n.sort(UP).map(function(e){return e.name});return t({matchedPretext:e,terms:r,items:n,component:LP}),!0}return!1}}]),t}();function HP(e){return(HP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function FP(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function BP(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function GP(e){return(GP=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function VP(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function WP(e,t){return(WP=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function KP(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var zP="channel",YP="team",QP=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=GP(t).call(this,e),n=!o||"object"!==HP(o)&&"function"!=typeof o?VP(r):o,KP(VP(n),"focusTextbox",function(){if(null!=n.switchBox){var e=n.switchBox.getTextbox();document.activeElement!==e&&(e.focus(),T.eb(e))}}),KP(VP(n),"setSwitchBoxRef",function(e){n.switchBox=e,n.focusTextbox()}),KP(VP(n),"onShow",function(){n.setState({text:""})}),KP(VP(n),"onHide",function(){n.focusPostTextbox(),n.setState({text:""}),n.props.onHide()}),KP(VP(n),"focusPostTextbox",function(){j.m()||setTimeout(function(){var e=document.querySelector("#post_textbox");e&&e.focus()})}),KP(VP(n),"onChange",function(e){n.setState({text:e.target.value})}),KP(VP(n),"handleKeyDown",function(e){T.S(e,P.Q.KeyCodes.TAB)&&(e.preventDefault(),n.switchMode())}),KP(VP(n),"handleSubmit",function(){var e,t=(e=regeneratorRuntime.mark(function e(t){var r,o,a,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:if(n.state.mode!==zP){e.next=11;break}if(r=n.props.actions,o=r.joinChannelById,a=r.switchToChannel,i=t.channel,t.type!==P.Q.MENTION_MORE_CHANNELS||i.type!==P.Q.OPEN_CHANNEL){e.next=8;break}return e.next=8,o(i.id);case 8:a(i).then(function(e){e.data&&n.onHide()}),e.next=13;break;case 11:Q.a.push("/"+t.name),n.onHide();case 13:case"end":return e.stop()}},e)}),function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){FP(a,r,o,i,s,"next",e)}function s(e){FP(a,r,o,i,s,"throw",e)}i(void 0)})});return function(e){return t.apply(this,arguments)}}()),KP(VP(n),"enableChannelProvider",function(){n.channelProviders[0].disableDispatches=!1,n.teamProviders[0].disableDispatches=!0}),KP(VP(n),"enableTeamProvider",function(){n.teamProviders[0].disableDispatches=!1,n.channelProviders[0].disableDispatches=!0}),KP(VP(n),"switchMode",function(){n.state.mode===zP&&n.props.showTeamSwitcher?(n.enableTeamProvider(),n.setState({mode:YP})):n.state.mode===YP&&(n.enableChannelProvider(),n.setState({mode:zP}))}),KP(VP(n),"handleOnClick",function(e){e.preventDefault();var t=e.currentTarget.getAttribute("data-mode");n.enableChannelProvider(),n.setState({mode:t}),n.focusTextbox()}),n.channelProviders=[new PP],n.teamProviders=[new qP],n.switchBox=null,n.state={text:"",mode:zP},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&WP(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e,t=this.channelProviders,n=!0,r=Object(Ne.b)("quick_switch_modal.channelsShortcut.windows"),o="CTRL+K";T.T()&&(r=Object(Ne.b)("quick_switch_modal.channelsShortcut.mac"),o="CMD+K");var a,i=Object(Ne.b)("quick_switch_modal.teamsShortcut.windows"),s="CTRL+ALT+K";if(T.T()&&(i=Object(Ne.b)("quick_switch_modal.teamsShortcut.mac"),s="CMD+ALT+K"),this.props.showTeamSwitcher){var c="",l="";this.state.mode===YP?(t=this.teamProviders,n=!1,l="active"):c="active",e=_.a.createElement("div",{className:"nav nav-tabs"},_.a.createElement("li",{className:c},_.a.createElement("a",{"data-mode":"channel",href:"#",onClick:this.handleOnClick},_.a.createElement(Y.c,{id:"quick_switch_modal.channels",defaultMessage:"Channels"}),_.a.createElement("span",{className:"small"},_.a.createElement(Y.c,{id:r,defaultMessage:o})))),_.a.createElement("li",{className:l},_.a.createElement("a",{"data-mode":"team",href:"#",onClick:this.handleOnClick},_.a.createElement(Y.c,{id:"quick_switch_modal.teams",defaultMessage:"Teams"}),_.a.createElement("span",{className:"small"},_.a.createElement(Y.c,{id:i,defaultMessage:s})))))}return a=T.U()?_.a.createElement(Y.c,{id:"quick_switch_modal.help_mobile",defaultMessage:"Type to find a channel."}):this.props.showTeamSwitcher?_.a.createElement(Y.c,{id:"quick_switch_modal.help",defaultMessage:"Start typing then use TAB to toggle channels/teams, ↑↓ to browse, ↵ to select, and ESC to dismiss."}):_.a.createElement(Y.c,{id:"quick_switch_modal.help_no_team",defaultMessage:"Type to find a channel. Use ↑↓ to browse, ↵ to select, ESC to dismiss."}),_.a.createElement(z.a,{dialogClassName:"a11y__modal channel-switch-modal modal--overflow",ref:"modal",show:!0,onHide:this.onHide,enforceFocus:!1,restoreFocus:!1,role:"dialog","aria-labelledby":"quickSwitchModalLabel"},_.a.createElement(z.a.Header,{id:"quickSwitchModalLabel",closeButton:!0}),_.a.createElement(z.a.Body,null,e,_.a.createElement("div",{id:"quickSwitchHint",className:"modal__hint"},a),_.a.createElement(Ri.a,{id:"quickSwitchInput",ref:this.setSwitchBoxRef,className:"form-control focused",onChange:this.onChange,value:this.state.text,onKeyDown:this.handleKeyDown,onItemSelected:this.handleSubmit,listComponent:Mi.a,maxLength:"64",providers:t,listStyle:"bottom",completeOnTab:!1,spellCheck:"false",renderDividers:n,delayInputUpdate:!0,openWhenEmpty:!0})))}}])&&BP(n.prototype,r),o&&BP(n,o),t}();KP(QP,"propTypes",{onHide:v.a.func.isRequired,showTeamSwitcher:v.a.bool,actions:v.a.shape({joinChannelById:v.a.func.isRequired,switchToChannel:v.a.func.isRequired}).isRequired});var ZP=Object(r.connect)(function(){return{showTeamSwitcher:!1}},function(e){return{actions:Object(o.bindActionCreators)({joinChannelById:Oo.d,switchToChannel:Oo.l},e)}})(QP);function JP(e){return(JP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function XP(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $P(e){return($P=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ej(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tj(e,t){return(tj=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function nj(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var rj=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=$P(t).call(this,e),n=!o||"object"!==JP(o)&&"function"!=typeof o?ej(r):o,nj(ej(n),"onEnterKeyDown",function(e){var t=T.S(e,P.Q.KeyCodes.ENTER),r=n.props.ctrlSend;r&&t&&!e.ctrlKey?e.preventDefault():(r&&t&&e.ctrlKey||!r&&t&&!e.shiftKey&&!e.altKey)&&n.handleSubmit(e)}),nj(ej(n),"handleSubmit",function(e){e.preventDefault(),uu.a.findDOMNode(n.refs.display_name).value.trim().length<P.Q.MIN_CHANNELNAME_LENGTH?n.setState({displayNameError:!0}):n.props.onSubmitChannel()}),nj(ej(n),"handleChange",function(){var e={displayName:n.refs.display_name.value,header:n.refs.channel_header.value,purpose:n.refs.channel_purpose.value};n.props.onDataChanged(e)}),nj(ej(n),"handleOnURLChange",function(e){e.preventDefault(),n.props.onChangeURLPressed&&n.props.onChangeURLPressed()}),nj(ej(n),"handlePublicTypeSelect",function(){n.props.onTypeSwitched("O")}),nj(ej(n),"handlePrivateTypeSelect",function(){n.props.onTypeSwitched("P")}),n.state={displayNameError:""},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tj(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"UNSAFE_componentWillReceiveProps",value:function(e){!0===e.show&&!1===this.props.show&&this.setState({displayNameError:""})}},{key:"componentDidMount",value:function(){(j.f()||j.d())&&qc()("body").addClass("browser--ie")}},{key:"render",value:function(){var e=this.props,t=e.canCreatePublicChannel,n=e.canCreatePrivateChannel,r=t&&n,o=null,a=null,i="form-group";this.state.displayNameError&&(o=_.a.createElement("p",{className:"input__help error"},_.a.createElement(Y.c,{id:"channel_modal.displayNameError",defaultMessage:"Channel name must be 2 or more characters"}),this.state.displayNameError),i+=" has-error"),this.props.serverError&&(a=_.a.createElement("div",{className:"form-group has-error"},_.a.createElement("div",{className:"col-sm-12"},_.a.createElement("p",{id:"createChannelError",className:"input__help error"},this.props.serverError))));var s=_.a.createElement("div",{className:"flex-parent"},_.a.createElement(cP.a,{className:"icon icon__globe icon--body type-icon"}),_.a.createElement(Y.c,{id:"channel_modal.publicName",defaultMessage:"Public"}),_.a.createElement(Y.c,{id:"channel_modal.publicHint",defaultMessage:" - Anyone can join this channel."})),c=_.a.createElement("div",{className:"flex-parent"},_.a.createElement(lP.a,{className:"icon icon__lock icon--body type-icon"}),_.a.createElement(Y.c,{id:"channel_modal.privateName",defaultMessage:"Private"}),_.a.createElement(Y.c,{id:"channel_modal.privateHint",defaultMessage:" - Only invited members can join this channel."})),l=null;l=r?_.a.createElement("fieldset",{key:"channelType",className:"multi-select__radio"},_.a.createElement("div",{className:"radio"},_.a.createElement("label",null,_.a.createElement("input",{id:"public",type:"radio",name:"channelType",checked:"O"===this.props.channelType,onChange:this.handlePublicTypeSelect}),s)),_.a.createElement("div",{className:"radio"},_.a.createElement("label",null,_.a.createElement("input",{id:"private",type:"radio",name:"channelType",checked:"P"===this.props.channelType,onChange:this.handlePrivateTypeSelect}),c))):_.a.createElement("div",{className:"type-container multi-select__radio"},_.a.createElement("div",{className:"radio"},t?s:null,n?c:null));var u=Object(ss.d)();return _.a.createElement("span",null,_.a.createElement(z.a,{dialogClassName:"a11y__modal new-channel__modal new-channel",show:this.props.show,bsSize:"large",onHide:this.props.onModalDismissed,onExited:this.props.onModalExited,autoFocus:!0,restoreFocus:!0,role:"dialog","aria-labelledby":"newChannelModalLabel"},_.a.createElement(z.a.Header,null,_.a.createElement("button",{type:"button",className:"close",onClick:this.props.onModalDismissed},_.a.createElement("span",{"aria-hidden":"true"},"×"),_.a.createElement("span",{className:"sr-only"},"Close")),_.a.createElement(z.a.Title,{componentClass:"h1",id:"newChannelModalLabel"},_.a.createElement(Y.c,{id:"channel_modal.modalTitle",defaultMessage:"New Channel"}))),_.a.createElement("form",{role:"form",className:"form-horizontal"},_.a.createElement(z.a.Body,null,_.a.createElement("div",{className:"form-group"},_.a.createElement("label",{className:"col-sm-3 form__label control-label"},_.a.createElement(Y.c,{id:"channel_modal.type",defaultMessage:"Type"})),_.a.createElement("div",{className:"col-sm-9"},l)),_.a.createElement("div",{className:i},_.a.createElement("label",{className:"col-sm-3 form__label control-label"},_.a.createElement(Y.c,{id:"channel_modal.name",defaultMessage:"Name"})),_.a.createElement("div",{className:"col-sm-9"},_.a.createElement(ke.a,{id:"newChannelName",onChange:this.handleChange,type:"text",ref:"display_name",className:"form-control",placeholder:{id:Object(Ne.b)("channel_modal.nameEx"),defaultMessage:'E.g.: "Bugs", "Marketing", "客户支持"'},maxLength:P.Q.MAX_CHANNELNAME_LENGTH,value:this.props.channelData.displayName,autoFocus:!0,onKeyDown:this.onEnterKeyDown}),o,_.a.createElement("p",{className:"input__help dark"},"URL: "+u+this.props.channelData.name+" (",_.a.createElement("button",{className:"color--link style--none",onClick:this.handleOnURLChange},_.a.createElement(Y.c,{id:"channel_modal.edit",defaultMessage:"Edit"})),")"))),_.a.createElement("div",{className:"form-group"},_.a.createElement("div",{className:"col-sm-3"},_.a.createElement("label",{className:"form__label control-label"},_.a.createElement(Y.c,{id:"channel_modal.purpose",defaultMessage:"Purpose"})),_.a.createElement("label",{className:"form__label light"},_.a.createElement(Y.c,{id:"channel_modal.optional",defaultMessage:"(optional)"}))),_.a.createElement("div",{className:"col-sm-9"},_.a.createElement("textarea",{id:"newChannelPurpose",className:"form-control no-resize",ref:"channel_purpose",rows:"4",placeholder:T.ab("channel_modal.purposeEx",'E.g.: "A channel to file bugs and improvements"'),maxLength:"250",value:this.props.channelData.purpose,onChange:this.handleChange}),_.a.createElement("p",{className:"input__help"},_.a.createElement(Y.c,{id:"channel_modal.descriptionHelp",defaultMessage:"Describe how this channel should be used."})))),_.a.createElement("div",{className:"form-group less"},_.a.createElement("div",{className:"col-sm-3"},_.a.createElement("label",{className:"form__label control-label"},_.a.createElement(Y.c,{id:"channel_modal.header",defaultMessage:"Header"})),_.a.createElement("label",{className:"form__label light"},_.a.createElement(Y.c,{id:"channel_modal.optional",defaultMessage:"(optional)"}))),_.a.createElement("div",{className:"col-sm-9"},_.a.createElement("textarea",{id:"newChannelHeader",className:"form-control no-resize",ref:"channel_header",rows:"4",placeholder:T.ab("channel_modal.headerEx",'E.g.: "[Link Title](http://example.com)"'),maxLength:"1024",value:this.props.channelData.header,onChange:this.handleChange}),_.a.createElement("p",{className:"input__help"},_.a.createElement(Y.c,{id:"channel_modal.headerHelp",defaultMessage:"Set text that will appear in the header of the channel beside the channel name. For example, include frequently used links by typing [Link Title](http://example.com)."})),a))),_.a.createElement(z.a.Footer,null,_.a.createElement("button",{id:"cancelNewChannel",type:"button",className:"btn btn-link",onClick:this.props.onModalDismissed,onBlur:function(){return document.getElementById("newChannelName").focus()}},_.a.createElement(Y.c,{id:"channel_modal.cancel",defaultMessage:"Cancel"})),_.a.createElement("button",{id:"submitNewChannel",onClick:this.handleSubmit,type:"submit",className:"btn btn-primary"},_.a.createElement(Y.c,{id:"channel_modal.createNew",defaultMessage:"Create New Channel"}))))))}}])&&XP(n.prototype,r),o&&XP(n,o),t}();nj(rj,"propTypes",{show:v.a.bool.isRequired,currentTeamId:v.a.string.isRequired,channelType:v.a.string.isRequired,channelData:v.a.object.isRequired,ctrlSend:v.a.bool,serverError:v.a.node,onSubmitChannel:v.a.func.isRequired,onModalDismissed:v.a.func.isRequired,onModalExited:v.a.func,onTypeSwitched:v.a.func.isRequired,onChangeURLPressed:v.a.func.isRequired,onDataChanged:v.a.func.isRequired,canCreatePublicChannel:v.a.bool.isRequired,canCreatePrivateChannel:v.a.bool.isRequired});var oj=Object(r.connect)(function(e){return{ctrlSend:Object(l.getBool)(e,L.Preferences.CATEGORY_ADVANCED_SETTINGS,"send_on_ctrl_enter"),currentTeamId:Object(f.getCurrentTeamId)(e)}})(rj);function aj(e){return(aj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ij(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function sj(e){return(sj=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function cj(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lj(e,t){return(lj=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function uj(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var pj=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=sj(t).call(this,e),n=!o||"object"!==aj(o)&&"function"!=typeof o?cj(r):o,uj(cj(n),"onURLChanged",function(e){var t=e.target.value.trim();n.setState({currentURL:t.replace(/[^A-Za-z0-9-_]/g,"").toLowerCase(),userEdit:!0})}),uj(cj(n),"formattedError",function(e,t,n){return _.a.createElement("span",{key:e},_.a.createElement(Y.c,{id:t,defaultMessage:n}),_.a.createElement("br",null))}),uj(cj(n),"getURLError",function(e){var t=[];return e.length<2&&t.push(n.formattedError("error1",Object(Ne.b)("change_url.longer"),"URL must be two or more characters.")),"-"!==e.charAt(0)&&"_"!==e.charAt(0)||t.push(n.formattedError("error2",Object(Ne.b)("change_url.startWithLetter"),"URL must start with a letter or number.")),e.length>1&&("-"===e.charAt(e.length-1)||"_"===e.charAt(e.length-1))&&t.push(n.formattedError("error3",Object(Ne.b)("change_url.endWithLetter"),"URL must end with a letter or number.")),e.indexOf("__")>-1&&t.push(n.formattedError("error4",Object(Ne.b)("change_url.noUnderscore"),"URL can not contain two underscores in a row.")),0===t.length&&t.push(n.formattedError("errorlast",Object(Ne.b)("change_url.invalidUrl"),"Invalid URL")),t}),uj(cj(n),"onSubmit",function(e){e.preventDefault();var t=n.refs.urlinput.value;Object(ss.a)(t)!==t||t.length<2||t.indexOf("__")>-1?n.setState({urlError:n.getURLError(t)}):(n.setState({urlError:"",userEdit:!1}),n.props.onModalSubmit(t))}),uj(cj(n),"onCancel",function(){n.setState({urlError:"",userEdit:!1}),n.props.onModalDismissed()}),n.state={currentURL:e.currentURL,urlError:"",userEdit:!1},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lj(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.state.userEdit||this.setState({currentURL:e.currentURL})}},{key:"render",value:function(){var e="input-group input-group--limit",t=null;this.state.urlError&&(e+=" has-error"),(this.props.serverError||this.state.urlError)&&(t=_.a.createElement("div",{className:"has-error"},_.a.createElement("p",{className:"input__help error"},this.state.urlError||this.props.serverError)));var n=this.props.currentTeamURL+"/channels",r=Object(ss.d)(n),o=_.a.createElement(El.a,{id:"urlTooltip"},n);return _.a.createElement(z.a,{dialogClassName:"a11y__modal",show:this.props.show,onHide:this.onCancel,onExited:this.props.onModalExited,role:"dialog","aria-labelledby":"changeUrlModalLabel"},_.a.createElement(z.a.Header,{closeButton:!0},_.a.createElement(z.a.Title,{componentClass:"h1",id:"changeUrlModalLabel"},this.props.title)),_.a.createElement("form",{role:"form",className:"form-horizontal"},_.a.createElement(z.a.Body,null,_.a.createElement("div",{className:"modal-intro"},_.a.createElement(Y.c,{id:"channel_flow.changeUrlDescription",defaultMessage:"Some characters are now allowed in URLs and may be removed."})),_.a.createElement("div",{className:"form-group"},_.a.createElement("label",{className:"col-sm-3 form__label control-label"},_.a.createElement(Y.c,{id:"change_url.urlLabel",defaultMessage:"Channel URL"})),_.a.createElement("div",{className:"col-sm-9"},_.a.createElement("div",{className:e},_.a.createElement(vl.a,{delayShow:P.Q.OVERLAY_TIME_DELAY,placement:"top",overlay:o},_.a.createElement("span",{className:"input-group-addon"},r)),_.a.createElement("input",{type:"text",ref:"urlinput",className:"form-control",maxLength:P.Q.MAX_CHANNELNAME_LENGTH,onChange:this.onURLChanged,value:this.state.currentURL,autoFocus:!0,tabIndex:"1"})),t))),_.a.createElement(z.a.Footer,null,_.a.createElement("button",{type:"button",className:"btn btn-link",onClick:this.onCancel},_.a.createElement(Y.c,{id:"change_url.close",defaultMessage:"Close"})),_.a.createElement("button",{onClick:this.onSubmit,type:"submit",className:"btn btn-primary",tabIndex:"2"},this.props.submitButtonText))))}}])&&ij(n.prototype,r),o&&ij(n,o),t}();uj(pj,"propTypes",{show:v.a.bool.isRequired,title:v.a.node,submitButtonText:v.a.node,currentURL:v.a.string,currentTeamURL:v.a.string.isRequired,serverError:v.a.node,onModalSubmit:v.a.func.isRequired,onModalExited:v.a.func,onModalDismissed:v.a.func.isRequired}),uj(pj,"defaultProps",{show:!1,title:"Change URL",submitButtonText:"Save",currentURL:"",serverError:null});var fj=Object(r.connect)(function(e){var t=Object(f.getCurrentTeam)(e);return{currentTeamURL:"".concat(Object(ss.e)(),"/").concat(t.name)}})(pj);function dj(e){return(dj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mj(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function hj(e){return(hj=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function bj(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yj(e,t){return(yj=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function gj(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var vj=1,Ej=2,_j=3,Oj=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=hj(t).call(this,e),n=!o||"object"!==dj(o)&&"function"!=typeof o?bj(r):o,gj(bj(n),"onSubmit",function(){if(n.state.channelDisplayName)if(n.state.channelName.length<2)n.setState({flowState:_j});else{var e=n.props,t=e.actions,r={team_id:e.currentTeamId,name:n.state.channelName,display_name:n.state.channelDisplayName,purpose:n.state.channelPurpose,header:n.state.channelHeader,type:n.state.channelType};t.createChannel(r).then(function(e){e.error?n.onCreateChannelError(e.error):(n.props.onModalDismissed(),t.switchToChannel(e.data))})}else n.setState({serverError:T.ab("channel_flow.invalidName","Invalid Channel Name")})}),gj(bj(n),"onCreateChannelError",function(e){"model.channel.is_valid.2_or_more.app_error"===e.id?n.setState({flowState:_j,serverError:_.a.createElement(Y.c,{id:"channel_flow.handleTooShort",defaultMessage:"Channel URL must be 2 or more lowercase alphanumeric characters"})}):"store.sql_channel.update.exists.app_error"===e.id?n.setState({serverError:T.ab("channel_flow.alreadyExist","A channel with that URL already exists")}):n.setState({serverError:e.message})}),gj(bj(n),"typeSwitched",function(e){n.setState({channelType:e,serverError:""})}),gj(bj(n),"urlChangeRequested",function(e){e&&e.preventDefault(),n.setState({flowState:Ej})}),gj(bj(n),"urlChangeSubmitted",function(e){n.state.flowState===_j?n.setState({channelName:e,nameModified:!0},n.onSubmit):n.setState({flowState:vj,serverError:null,channelName:e,nameModified:!0})}),gj(bj(n),"urlChangeDismissed",function(){n.setState({flowState:vj})}),gj(bj(n),"channelDataChanged",function(e){n.setState({channelDisplayName:e.displayName,channelPurpose:e.purpose,channelHeader:e.header}),n.state.nameModified||n.setState({channelName:Object(ss.a)(e.displayName.trim())})}),n.state={serverError:"",channelType:e.channelType||P.Q.OPEN_CHANNEL,flowState:vj,channelDisplayName:"",channelName:"",channelPurpose:"",channelHeader:"",nameModified:!1},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yj(e,t)}(t,_.a.Component),n=t,(r=[{key:"UNSAFE_componentWillReceiveProps",value:function(e){!0===e.show&&!1===this.props.show&&this.setState({serverError:"",channelType:e.channelType,flowState:vj,channelDisplayName:"",channelName:"",channelPurpose:"",channelHeader:"",nameModified:!1})}},{key:"render",value:function(){var e={name:this.state.channelName,displayName:this.state.channelDisplayName,purpose:this.state.channelPurpose,header:this.state.channelHeader},t=!1,n=!1,r="",o="";if(this.props.show)switch(this.state.flowState){case vj:t=!0;break;case Ej:n=!0,o=r=_.a.createElement(Y.c,{id:"channel_flow.changeUrlTitle",defaultMessage:"Change Channel URL"});break;case _j:n=!0,r=_.a.createElement(Y.c,{id:"channel_flow.set_url_title",defaultMessage:"Set Channel URL"}),o=_.a.createElement(Y.c,{id:"channel_flow.create",defaultMessage:"Create Channel"})}return _.a.createElement("span",null,_.a.createElement(oj,{show:t,channelType:this.state.channelType,canCreatePublicChannel:this.props.canCreatePublicChannel,canCreatePrivateChannel:this.props.canCreatePrivateChannel,channelData:e,serverError:this.state.serverError,onSubmitChannel:this.onSubmit,onModalDismissed:this.props.onModalDismissed,onTypeSwitched:this.typeSwitched,onChangeURLPressed:this.urlChangeRequested,onDataChanged:this.channelDataChanged}),_.a.createElement(fj,{show:n,title:r,submitButtonText:o,currentURL:this.state.channelName,serverError:this.state.serverError,onModalSubmit:this.urlChangeSubmitted,onModalDismissed:this.urlChangeDismissed}))}}])&&mj(n.prototype,r),o&&mj(n,o),t}();gj(Oj,"propTypes",{show:v.a.bool.isRequired,channelType:v.a.string.isRequired,onModalDismissed:v.a.func.isRequired,currentTeamId:v.a.string.isRequired,canCreatePublicChannel:v.a.bool.isRequired,canCreatePrivateChannel:v.a.bool.isRequired,actions:v.a.shape({createChannel:v.a.func.isRequired,switchToChannel:v.a.func.isRequired})}),gj(Oj,"defaultProps",{show:!1,channelType:P.Q.OPEN_CHANNEL});var wj=Object(r.connect)(function(e){return{currentTeamId:Object(f.getCurrentTeamId)(e)}},function(e){return{actions:Object(o.bindActionCreators)({createChannel:s.createChannel,switchToChannel:Oo.l},e)}})(Oj);function Cj(e){return(Cj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Sj(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Pj(e,t){return!t||"object"!==Cj(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function jj(e){return(jj=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Tj(e,t){return(Tj=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var kj=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Pj(this,jj(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Tj(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){return _.a.createElement("span",this.props,_.a.createElement(Y.c,{id:"generic_icons.arrow.down",defaultMessage:"Down Arrow Icon"},function(e){return _.a.createElement("svg",{width:"10px",height:"10px",viewBox:"0 0 10 10",style:Nj,role:"icon","aria-label":e},_.a.createElement("g",{transform:"matrix(1,0,0,1,-20,-18)"},_.a.createElement("g",{transform:"matrix(0.0330723,0,0,0.0322634,15.8132,12.3164)"},_.a.createElement("path",{d:"M245.803,377.493C245.803,377.493 204.794,336.485 179.398,311.088C168.55,300.24 150.962,300.24 140.114,311.088C138.327,312.875 136.517,314.686 134.73,316.473C123.882,327.321 123.882,344.908 134.73,355.756C167.972,388.998 233.949,454.975 256.949,477.975C262.158,483.184 269.223,486.111 276.591,486.111C277.38,486.111 278.176,486.111 278.965,486.111C286.332,486.111 293.397,483.184 298.607,477.975C321.607,454.975 387.584,388.998 420.826,355.756C431.674,344.908 431.674,327.321 420.826,316.473C419.039,314.686 417.228,312.875 415.441,311.088C404.593,300.24 387.005,300.24 376.158,311.088C350.761,336.485 309.753,377.493 309.753,377.493C309.753,377.493 309.753,279.687 309.753,203.94C309.753,196.573 306.826,189.508 301.617,184.298C296.408,179.089 289.342,176.162 281.975,176.162C279.191,176.162 276.364,176.162 273.58,176.162C266.213,176.162 259.148,179.089 253.939,184.298C248.729,189.508 245.803,196.573 245.803,203.94L245.803,377.493Z"}))))}))}}])&&Sj(n.prototype,r),o&&Sj(n,o),t}(),Nj={fillRule:"evenodd",clipRule:"evenodd",strokeLinejoin:"round",strokeMiterlimit:1.41421};function Rj(e){return(Rj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Mj(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ij(e,t){return!t||"object"!==Rj(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xj(e){return(xj=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Aj(e,t){return(Aj=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Lj(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Dj=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ij(this,xj(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Aj(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e="none";return this.props.show&&(e="block"),_.a.createElement("div",{id:"unreadIndicator"+this.props.name,className:"nav-pills__unread-indicator "+this.props.extraClass,style:{display:e},onClick:this.props.onClick},this.props.content,_.a.createElement(kj,{className:"icon icon__unread"}))}}])&&Mj(n.prototype,r),o&&Mj(n,o),t}();Lj(Dj,"propTypes",{onClick:v.a.func.isRequired,show:v.a.bool,extraClass:v.a.string,content:v.a.node,name:v.a.string}),Lj(Dj,"defaultProps",{show:!1,extraClass:"",content:""});var Uj=n(1614);function qj(e){return(qj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hj(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Fj(e){return(Fj=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Bj(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Gj(e,t){return(Gj=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Vj(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Wj=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=Fj(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==qj(o)&&"function"!=typeof o?Bj(r):o,Vj(Bj(n),"isUserOutOfOffice",function(){return n.props.status===P.O.OUT_OF_OFFICE}),Vj(Bj(n),"setStatus",function(e){n.props.actions.setStatus({user_id:n.props.userId,status:e})}),Vj(Bj(n),"setOnline",function(e){e.preventDefault(),n.setStatus(P.O.ONLINE)}),Vj(Bj(n),"setOffline",function(e){e.preventDefault(),n.setStatus(P.O.OFFLINE)}),Vj(Bj(n),"setAway",function(e){e.preventDefault(),n.setStatus(P.O.AWAY)}),Vj(Bj(n),"setDnd",function(e){e.preventDefault(),n.setStatus(P.O.DND)}),Vj(Bj(n),"showStatusChangeConfirmation",function(e){var t={ModalId:P.r.RESET_STATUS,dialogType:gc,dialogProps:{newStatus:e}};n.props.actions.openModal(t)}),Vj(Bj(n),"renderProfilePicture",function(){return n.props.profilePicture?_.a.createElement("img",{alt:"",className:"user__picture",src:n.props.profilePicture}):null}),Vj(Bj(n),"renderDropdownIcon",function(){return _.a.createElement(Y.c,{id:"generic_icons.dropdown",defaultMessage:"Dropdown Icon"},function(e){return _.a.createElement("i",{className:"fa fa-caret-down",title:e})})}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gj(e,t)}(t,_.a.Component),n=t,(r=[{key:"render",value:function(){var e=this,t=this.isUserOutOfOffice()&&""===this.props.autoResetPref,n=this.renderProfilePicture(),r=this.renderDropdownIcon(),o=t?function(){return e.showStatusChangeConfirmation("online")}:this.setOnline,a=t?function(){return e.showStatusChangeConfirmation("dnd")}:this.setDnd,i=t?function(){return e.showStatusChangeConfirmation("away")}:this.setAway,s=t?function(){return e.showStatusChangeConfirmation("offline")}:this.setOffline;return _.a.createElement(pu.a,{onToggle:this.onToggle,style:this.props.style},_.a.createElement("div",{className:"status-wrapper status-selector"},n,_.a.createElement("button",{className:"status style--none","aria-label":Object(T.ab)("status_dropdown.menuAriaLabel","set status")},_.a.createElement(Uj.a,{status:this.props.status,button:!0})),_.a.createElement("span",{className:"status status-edit edit"},r)),_.a.createElement(fu.a,{ariaLabel:Object(T.ab)("status_dropdown.menuAriaLabel","set status")},_.a.createElement(Lw.a,null,_.a.createElement(Dp.a,{show:this.isUserOutOfOffice(),onClick:function(){return null},ariaLabel:Object(T.ab)("status_dropdown.set_ooo","Out of office").toLowerCase(),text:Object(T.ab)("status_dropdown.set_ooo","Out of office"),extraText:Object(T.ab)("status_dropdown.set_ooo.extra","Automatic Replies are enabled")})),_.a.createElement(Lw.a,null,_.a.createElement(Dp.a,{onClick:o,ariaLabel:Object(T.ab)("status_dropdown.set_online","Online").toLowerCase(),text:Object(T.ab)("status_dropdown.set_online","Online")}),_.a.createElement(Dp.a,{onClick:i,ariaLabel:Object(T.ab)("status_dropdown.set_away","Away").toLowerCase(),text:Object(T.ab)("status_dropdown.set_away","Away")}),_.a.createElement(Dp.a,{onClick:a,ariaLabel:"".concat(Object(T.ab)("status_dropdown.set_dnd","Do not disturb").toLowerCase(),". ").concat(Object(T.ab)("status_dropdown.set_dnd.extra","Disables Desktop and Push Notifications").toLowerCase()),text:Object(T.ab)("status_dropdown.set_dnd","Do not disturb"),extraText:Object(T.ab)("status_dropdown.set_dnd.extra","Disables Desktop and Push Notifications")}),_.a.createElement(Dp.a,{onClick:s,ariaLabel:Object(T.ab)("status_dropdown.set_offline","Offline").toLowerCase(),text:Object(T.ab)("status_dropdown.set_offline","Offline")}))))}}])&&Hj(n.prototype,r),o&&Hj(n,o),t}();Vj(Wj,"propTypes",{style:v.a.object,status:v.a.string,userId:v.a.string.isRequired,profilePicture:v.a.string,autoResetPref:v.a.string,actions:v.a.shape({openModal:v.a.func.isRequired,setStatus:v.a.func.isRequired}).isRequired}),Vj(Wj,"defaultProps",{userId:"",profilePicture:"",status:P.O.OFFLINE});var Kj=Object(r.connect)(function(e){var t=Object(p.getCurrentUser)(e);if(!t)return{};var n=t.id;return{userId:n,profilePicture:ii.Client4.getProfilePictureUrl(n,t.last_picture_update),autoResetPref:Object(l.get)(e,L.Preferences.CATEGORY_AUTO_RESET_MANUAL_STATUS,n,""),status:Object(p.getStatusForUserId)(e,n)}},function(e){return{actions:Object(o.bindActionCreators)({openModal:U.b,setStatus:i.setStatus},e)}})(Wj),zj=n(1637);function Yj(e){return(Yj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Qj(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Zj(e,t){return!t||"object"!==Yj(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Jj(e){return(Jj=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Xj(e,t){return(Xj=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var $j=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Zj(this,Jj(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xj(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e=_.a.createElement(El.a,{id:"main-menu__tooltip"},_.a.createElement(Y.c,{id:"sidebar.mainMenu",defaultMessage:"Main menu"})),t=null;this.props.showTutorialTip&&(t=_.a.createElement(c_,{onBottom:!1}));var n=_.a.createElement("h1",{id:"headerTeamName",className:"team__name","data-teamid":this.props.teamId},this.props.teamDisplayName);return this.props.teamDescription&&(n=_.a.createElement(vl.a,{delayShow:P.Q.OVERLAY_TIME_DELAY,placement:"bottom",overlay:_.a.createElement(El.a,{id:"team-name__tooltip"},this.props.teamDescription),ref:"descriptionOverlay"},n)),_.a.createElement("div",{className:"SidebarHeaderDropdownButton",id:"sidebarHeaderDropdownButton"},t,_.a.createElement(vl.a,{delayShow:P.Q.OVERLAY_TIME_DELAY,placement:"right",overlay:e},_.a.createElement("div",{id:"headerInfo",className:"header__info"},n,_.a.createElement("div",{id:"headerUsername",className:"user__name"},"@"+this.props.currentUser.username),_.a.createElement("button",{className:"style--none sidebar-header-dropdown__icon","aria-label":Object(T.ab)("navbar_dropdown.menuAriaLabel","main menu")},_.a.createElement(zj.a,null)))))}}])&&Qj(n.prototype,r),o&&Qj(n,o),t}();function eT(e){return(eT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tT(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function nT(e){return(nT=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rT(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oT(e,t){return(oT=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function aT(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}($j,"propTypes",{showTutorialTip:v.a.bool.isRequired,teamDescription:v.a.string.isRequired,teamId:v.a.string.isRequired,currentUser:v.a.object.isRequired,teamDisplayName:v.a.string.isRequired});var iT=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=nT(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==eT(o)&&"function"!=typeof o?rT(r):o,aT(rT(n),"toggleShortcutsModal",function(e){e.preventDefault(),S.n()}),aT(rT(n),"showGetTeamInviteLinkModal",function(e){e.preventDefault(),S.l()}),aT(rT(n),"handleKeyDown",function(e){Object(T.e)(e)&&e.shiftKey&&Object(T.S)(e,P.i.KeyCodes.A)&&n.props.actions.openModal({ModalId:P.r.USER_SETTINGS,dialogType:Qc.a})}),aT(rT(n),"handleEmitUserLoggedOutEvent",function(){S.e()}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&oT(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"render",value:function(){return this.props.currentUser?_.a.createElement(pu.a,null,_.a.createElement($j,{showTutorialTip:this.props.showTutorialTip,teamDescription:this.props.teamDescription,currentUser:this.props.currentUser,teamDisplayName:this.props.teamDisplayName,teamId:this.props.teamId}),_.a.createElement(EC,{id:"sidebarDropdownMenu"})):null}}])&&tT(n.prototype,r),o&&tT(n,o),t}();aT(iT,"propTypes",{teamDescription:v.a.string.isRequired,teamDisplayName:v.a.string.isRequired,teamId:v.a.string.isRequired,currentUser:v.a.object,showTutorialTip:v.a.bool.isRequired,actions:v.a.shape({openModal:v.a.func.isRequred}).isRequired}),aT(iT,"defaultProps",{teamType:"",pluginMenuItems:[]});var sT=Object(r.connect)(function(e){var t=Object(f.getCurrentTeam)(e),n=Object(p.getCurrentUser)(e),r=Object(l.getInt)(e,P.z.TUTORIAL_STEP,n.id)===P.I.MENU_POPOVER&&!T.U();return{currentUser:n,teamDescription:t.description,teamDisplayName:t.display_name,teamId:t.id,showTutorialTip:r}},function(e){return{actions:Object(o.bindActionCreators)({openModal:U.b},e)}})(iT);function cT(e){return(cT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lT(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function uT(e){return(uT=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function pT(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fT(e,t){return(fT=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var dT=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=uT(t).call(this,e),n=!o||"object"!==cT(o)&&"function"!=typeof o?pT(r):o,function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(pT(n),"handleResize",function(){var e=T.U();n.setState({isMobile:e})}),n.state={isMobile:T.U()},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fT(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.handleResize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleResize)}},{key:"render",value:function(){var e=T.ab("accessibility.sections.lhsHeader","team menu region");return _.a.createElement("div",{id:"lhsHeader","aria-label":e,tabIndex:"-1",role:"application",className:"SidebarHeader team__header theme a11y__region","data-a11y-sort-order":"5"},_.a.createElement("div",{className:"d-flex"},!this.state.isMobile&&_.a.createElement(Kj,null),_.a.createElement(sT,null)))}}])&&lT(n.prototype,r),o&&lT(n,o),t}();var mT=Object(r.connect)(function(e){var t=Object(u.getConfig)(e),n=Object(p.getCurrentUser)(e);return{enableTutorial:"true"===t.EnableTutorial,showTutorialTip:Object(l.getInt)(e,P.z.TUTORIAL_STEP,n.id)===P.I.MENU_POPOVER&&!T.U()}})(dT),hT=n(212);function bT(e){return(bT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yT(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gT(e,t){return!t||"object"!==bT(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function vT(e){return(vT=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ET(e,t){return(ET=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var _T=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),gT(this,vT(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ET(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){return _.a.createElement("span",this.props,_.a.createElement(Y.c,{id:"generic_icons.bot",defaultMessage:"Bot Icon"},function(e){return _.a.createElement("svg",{width:"16",height:"13",viewBox:"0 0 36 30",role:"icon","aria-label":e},_.a.createElement("path",{d:"M0,15.7391304 L0,23.0434783 C0,24.0535326 0.786888587,24.8695652 1.76086957,24.8695652 L3.52173913,24.8695652 L3.52173913,13.9130435 L1.76086957,13.9130435 C0.786888587,13.9130435 0,14.7290761 0,15.7391304 Z M26.0496894,6.50271739 L19.7888199,6.50271739 L19.7888199,2.83423913 C19.7888199,1.81967561 18.989441,1 18,1 C17.010559,1 16.2111801,1.81967561 16.2111801,2.83423913 L16.2111801,6.50271739 L9.95031056,6.50271739 C7.47950311,6.50271739 5.47826087,8.55477242 5.47826087,11.0883152 L5.47826087,26.6793478 C5.47826087,28.7027429 7.0826087,30.3478261 9.05590062,30.3478261 L26.9440994,30.3478261 C28.9173913,30.3478261 30.5217391,28.7027429 30.5217391,26.6793478 L30.5217391,11.0883152 C30.5217391,8.55477242 28.5204969,6.50271739 26.0496894,6.50271739 Z M14.4782609,24.8695652 L10.9565217,24.8695652 L10.9565217,22.9130435 L14.4782609,22.9130435 L14.4782609,24.8695652 Z M12.5217391,17.826087 C11.2245652,17.826087 10.173913,16.7754348 10.173913,15.4782609 C10.173913,14.181087 11.2245652,13.1304348 12.5217391,13.1304348 C13.818913,13.1304348 14.8695652,14.181087 14.8695652,15.4782609 C14.8695652,16.7754348 13.818913,17.826087 12.5217391,17.826087 Z M19.9565217,24.8695652 L16.4347826,24.8695652 L16.4347826,22.9130435 L19.9565217,22.9130435 L19.9565217,24.8695652 Z M25.0434783,24.8695652 L21.5217391,24.8695652 L21.5217391,22.9130435 L25.0434783,22.9130435 L25.0434783,24.8695652 Z M23.2826087,17.826087 C22.0935326,17.826087 21.1304348,16.7754348 21.1304348,15.4782609 C21.1304348,14.181087 22.0935326,13.1304348 23.2826087,13.1304348 C24.4716848,13.1304348 25.4347826,14.181087 25.4347826,15.4782609 C25.4347826,16.7754348 24.4716848,17.826087 23.2826087,17.826087 Z M34.2391304,13.9130435 L32.4782609,13.9130435 L32.4782609,24.8695652 L34.2391304,24.8695652 C35.2131114,24.8695652 36,24.0535326 36,23.0434783 L36,15.7391304 C36,14.7290761 35.2131114,13.9130435 34.2391304,13.9130435 Z"}))}))}}])&&yT(n.prototype,r),o&&yT(n,o),t}();function OT(e){return(OT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wT(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function CT(e,t){return!t||"object"!==OT(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ST(e){return(ST=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function PT(e,t){return(PT=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var jT=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),CT(this,ST(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&PT(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e=null;return this.props.channelIsArchived?e=_.a.createElement(Uv.a,{className:"icon icon__archive"}):this.props.hasDraft?e=_.a.createElement(sP,{className:"icon icon__draft"}):this.props.channelType===P.i.OPEN_CHANNEL?e=_.a.createElement(cP.a,{className:"icon icon__globe"}):this.props.channelType===P.i.PRIVATE_CHANNEL?e=_.a.createElement(lP.a,{className:"icon icon__lock"}):this.props.channelType===P.i.GM_CHANNEL?e=_.a.createElement("div",{className:"status status--group"},this.props.membersCount):this.props.channelType===P.i.DM_CHANNEL&&(e=this.props.teammateId&&this.props.teammateDeletedAt?_.a.createElement(Uv.a,{className:"icon icon__archive"}):this.props.teammateId&&this.props.teammateIsBot?_.a.createElement(_T,{className:"icon icon__bot"}):_.a.createElement(Uj.a,{type:"avatar",status:this.props.channelStatus})),e}}])&&wT(n.prototype,r),o&&wT(n,o),t}();function TT(e){return(TT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kT(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function NT(e){return(NT=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function RT(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MT(e,t){return(MT=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function IT(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(jT,"propTypes",{channelIsArchived:v.a.bool.isRequired,channelType:v.a.string.isRequired,channelStatus:v.a.string,hasDraft:v.a.bool.isRequired,membersCount:v.a.number,teammateId:v.a.string,teammateDeletedAt:v.a.number,teammateIsBot:v.a.bool});var xT=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=NT(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==TT(o)&&"function"!=typeof o?RT(r):o,IT(RT(n),"handleClose",function(e){e.stopPropagation(),e.preventDefault(),n.props.handleClose()}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&MT(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e=null;if(this.props.handleClose&&!this.props.badge){var t=_.a.createElement(El.a,{id:"remove-dm-tooltip"},_.a.createElement(Y.c,{id:"sidebar.removeList",defaultMessage:"Remove from list"}));this.props.channelType!==P.i.OPEN_CHANNEL&&this.props.channelType!==P.i.PRIVATE_CHANNEL||(t=_.a.createElement(El.a,{id:"remove-dm-tooltip"},_.a.createElement(Y.c,{id:"sidebar.leave",defaultMessage:"Leave channel"}))),e=_.a.createElement(vl.a,{delayShow:1e3,placement:"top",overlay:t},_.a.createElement("span",{onClick:this.handleClose,className:"btn-close"},"×"))}return e}}])&&kT(n.prototype,r),o&&kT(n,o),t}();function AT(e){return(AT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function LT(e){return(LT=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function DT(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function UT(e,t){return(UT=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function qT(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}IT(xT,"propTypes",{handleClose:v.a.func,channelId:v.a.string.isRequired,channelType:v.a.string.isRequired,teammateId:v.a.string,badge:v.a.bool});var HT=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=LT(t).call(this,e),n=!o||"object"!==AT(o)&&"function"!=typeof o?DT(r):o,qT(DT(n),"trackChannelSelectedEvent",function(){Object(vt.b)("SidebarChannelLink#click"),Object(vt.d)("ui","ui_channel_selected")}),qT(DT(n),"handleClick",function(){n.trackChannelSelectedEvent(),Q.a.push(n.props.link)}),qT(DT(n),"removeTooltipLink",function(){n.gmItemRef.current.removeAttribute("aria-describedby")}),qT(DT(n),"render",function(){var e=null;n.props.badge&&(e=_.a.createElement("span",{id:"unreadMentions",className:"badge"},n.props.unreadMentions));var t,r=_.a.createElement(_.a.Fragment,null,_.a.createElement(jT,{channelStatus:n.props.channelStatus,channelType:n.props.channelType,channelIsArchived:n.props.channelIsArchived,hasDraft:n.props.hasDraft,membersCount:n.props.membersCount,teammateId:n.props.teammateId,teammateDeletedAt:n.props.teammateDeletedAt,teammateIsBot:n.props.teammateIsBot}),_.a.createElement("span",{className:"sidebar-item__name"},_.a.createElement("span",null,n.props.displayName)),e,_.a.createElement(xT,{handleClose:n.props.handleClose,channelId:n.props.channelId,channelType:n.props.channelType,teammateId:n.props.teammateId,badge:n.props.badge})),o=n.props.displayName;if(n.props.channelType===P.Q.OPEN_CHANNEL?o+=" ".concat(Object(T.ab)("accessibility.sidebar.types.public","public channel")):n.props.channelType===P.Q.PRIVATE_CHANNEL&&(o+=" ".concat(Object(T.ab)("accessibility.sidebar.types.private","private channel"))),1===n.props.unreadMentions?o+=" ".concat(n.props.unreadMentions," ").concat(Object(T.ab)("accessibility.sidebar.types.mention","mention")):n.props.unreadMentions>1&&(o+=" ".concat(n.props.unreadMentions," ").concat(Object(T.ab)("accessibility.sidebar.types.mentions","mentions"))),n.props.unreadMsgs>0&&n.props.showUnreadForMsgs&&0===n.props.unreadMentions&&(o+=" ".concat(Object(T.ab)("accessibility.sidebar.types.unread","unread"))),o=o.toLowerCase(),t=Object(j.c)()?_.a.createElement("div",null,_.a.createElement(YC,{link:n.props.link,menuId:n.props.channelId},_.a.createElement("button",{className:"btn btn-link "+n.props.rowClass,"aria-label":o,onClick:n.handleClick},r))):_.a.createElement(Fi.a,{id:"sidebarItem_".concat(n.props.channelName),"aria-label":o,to:n.props.link,className:n.props.rowClass,onClick:n.trackChannelSelectedEvent},r),n.props.channelType===P.Q.GM_CHANNEL){var a=_.a.createElement(El.a,{id:"channel-displayname__tooltip",style:FT.channelTooltip},n.props.displayName);t=_.a.createElement(vl.a,{delayShow:P.Q.OVERLAY_TIME_DELAY,placement:"top",overlay:a,onEntering:n.removeTooltipLink},_.a.createElement("div",{ref:n.gmItemRef},t))}return t}),n.gmItemRef=_.a.createRef(),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&UT(e,t)}(t,_.a.PureComponent),t}();qT(HT,"propTypes",{link:v.a.string.isRequired,rowClass:v.a.string.isRequired,channelType:v.a.string.isRequired,channelId:v.a.string.isRequired,channelName:v.a.string.isRequired,displayName:v.a.string.isRequired,channelStatus:v.a.string,handleClose:v.a.func,hasDraft:v.a.bool.isRequired,badge:v.a.bool,membersCount:v.a.number.isRequired,showUnreadForMsgs:v.a.bool.isRequired,unreadMsgs:v.a.number.isRequired,unreadMentions:v.a.number.isRequired,teammateId:v.a.string,teammateDeletedAt:v.a.number,teammateIsBot:v.a.bool,channelIsArchived:v.a.bool.isRequired});var FT={channelTooltip:{paddingLeft:"8px",maxWidth:"228px"}};function BT(e){return(BT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function GT(e){return(GT=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function VT(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function WT(e,t){return(WT=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function KT(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var zT=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=GT(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==BT(o)&&"function"!=typeof o?VT(r):o,KT(VT(n),"render",function(){var e=[],t=P.i.DEFAULT_CHANNEL_UI_NAME;n.props.townSquareDisplayName&&(t=n.props.townSquareDisplayName);var r=P.i.OFFTOPIC_CHANNEL_UI_NAME;return n.props.offTopicDisplayName&&(r=n.props.offTopicDisplayName),e.push(_.a.createElement("div",null,_.a.createElement("h4",null,_.a.createElement(Y.c,{id:"sidebar.tutorialScreen1.title",defaultMessage:"Channels"})),_.a.createElement("p",null,_.a.createElement(Fu.b,{id:"sidebar.tutorialScreen1.body",defaultMessage:"**Channels** organize conversations across different topics. They're open to everyone on your team. To send private communications use **Direct Messages** for a single person or **Private Channels** for multiple people."})))),e.push(_.a.createElement("div",null,_.a.createElement("h4",null,_.a.createElement(Y.c,{id:"sidebar.tutorialScreen2.title",defaultMessage:'"{townsquare}" and "{offtopic}" channels',values:{townsquare:t,offtopic:r}})),_.a.createElement("p",null,_.a.createElement(Y.c,{id:"sidebar.tutorialScreen2.body1",defaultMessage:"Here are two public channels to start:"})),_.a.createElement("p",null,_.a.createElement(Fu.b,{id:"sidebar.tutorialScreen2.body2",defaultMessage:"**{townsquare}** is a place for team-wide communication. Everyone in your team is a member of this channel.",values:{townsquare:t}})),_.a.createElement("p",null,_.a.createElement(Fu.b,{id:"sidebar.tutorialScreen2.body3",defaultMessage:"**{offtopic}** is a place for fun and humor outside of work-related channels. You and your team can decide what other channels to create.",values:{offtopic:r}})))),e.push(_.a.createElement("div",null,_.a.createElement("h4",null,_.a.createElement(Y.c,{id:"sidebar.tutorialScreen3.title",defaultMessage:"Creating and Joining Channels"})),_.a.createElement("p",null,_.a.createElement(Fu.b,{id:"sidebar.tutorialScreen3.body1",defaultMessage:'Click **"More..."** to create a new channel or join an existing one.'})),_.a.createElement("p",null,_.a.createElement(Fu.b,{id:"sidebar.tutorialScreen3.body2",defaultMessage:'You can also create a new channel by clicking the **"+" symbol** next to the public or private channel header.'})))),_.a.createElement(i_,{placement:"right",screens:e,overlayClass:"tip-overlay--sidebar",diagnosticsTag:"tutorial_tip_2_channels"})}),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&WT(e,t)}(t,_.a.PureComponent),t}();function YT(e){return(YT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function QT(e){return(QT=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ZT(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function JT(e,t){return(JT=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function XT(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}KT(zT,"propTypes",{townSquareDisplayName:v.a.string,offTopicDisplayName:v.a.string});var $T=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=QT(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==YT(o)&&"function"!=typeof o?ZT(r):o,XT(ZT(n),"isLeaving",!1),XT(ZT(n),"handleLeavePublicChannel",function(){n.props.actions.leaveChannel(n.props.channelId),Object(vt.d)("ui","ui_public_channel_x_button_clicked")}),XT(ZT(n),"handleLeavePrivateChannel",function(){S.m({id:n.props.channelId,display_name:n.props.channelDisplayName}),Object(vt.d)("ui","ui_private_channel_x_button_clicked")}),XT(ZT(n),"handleLeaveDirectChannel",function(){if(!n.isLeaving){var e,t;n.isLeaving=!0,n.props.channelType===P.i.DM_CHANNEL?(e=n.props.channelTeammateId,t=P.i.Preferences.CATEGORY_DIRECT_CHANNEL_SHOW):(e=n.props.channelId,t=P.i.Preferences.CATEGORY_GROUP_CHANNEL_SHOW);var r=n.props.currentUserId;n.props.actions.savePreferences(r,[{user_id:r,category:t,name:e,value:"false"}]).then(function(){n.isLeaving=!1}),Object(vt.d)("ui","ui_direct_channel_x_button_clicked")}n.props.active&&Q.a.push("/".concat(n.props.currentTeamName,"/channels/").concat(n.props.redirectChannel))}),XT(ZT(n),"showChannelAsUnread",function(){return n.props.unreadMentions>0||n.props.unreadMsgs>0&&n.props.showUnreadForMsgs}),XT(ZT(n),"render",function(){if(n.props.channelIsArchived&&!n.props.active)return null;if(!n.props.channelDisplayName||!n.props.channelType)return _.a.createElement("div",null);var e=null;if(!n.showChannelAsUnread()){if(n.props.shouldHideChannel)return"";n.props.channelType===P.i.DM_CHANNEL||n.props.channelType===P.i.GM_CHANNEL?e=n.handleLeaveDirectChannel:"true"===n.props.config.EnableXToLeaveChannelsFromLHS&&(n.props.channelType===P.i.OPEN_CHANNEL&&n.props.channelName!==P.i.DEFAULT_CHANNEL?e=n.handleLeavePublicChannel:n.props.channelType===P.i.PRIVATE_CHANNEL&&(e=n.handleLeavePrivateChannel))}var t="";n.props.active&&(t="active");var r="sidebar-item",o=!1;n.showChannelAsUnread()&&(r+=" unread-title"),n.props.unreadMentions>0&&(r+=" has-badge",o=!0),n.props.channelMuted&&(r+=" muted"),e&&!o&&(r+=" has-close");var a=null;n.props.showTutorialTip&&n.props.channelName===P.i.DEFAULT_CHANNEL&&(a=_.a.createElement(zT,{townSquareDisplayName:n.props.townSquareDisplayName,offTopicDisplayName:n.props.offTopicDisplayName}),n.props.actions.openLhs());var i="";i=n.props.channelFake?"/".concat(n.props.currentTeamName,"/channels/").concat(n.props.channelName,"?fakechannel=").concat(encodeURIComponent(n.props.channelStringified)):n.props.channelType===P.i.DM_CHANNEL?"/".concat(n.props.currentTeamName,"/messages/@").concat(n.props.channelTeammateUsername):n.props.channelType===P.i.GM_CHANNEL?"/".concat(n.props.currentTeamName,"/messages/").concat(n.props.channelName):"/".concat(n.props.currentTeamName,"/channels/").concat(n.props.channelName);var s="";return s=n.props.currentUserId===n.props.channelTeammateId?n.context.intl.formatMessage({id:"sidebar.directchannel.you",defaultMessage:"{displayname} (you)"},{displayname:n.props.channelDisplayName}):n.props.channelDisplayName,_.a.createElement("li",{key:n.props.channelName,ref:"channel",className:t},_.a.createElement(HT,{link:i,rowClass:r,channelId:n.props.channelId,channelName:n.props.channelName,channelStatus:n.props.channelStatus,channelType:n.props.channelType,displayName:s,handleClose:e,hasDraft:n.props.hasDraft,badge:o,showUnreadForMsgs:n.props.showUnreadForMsgs,unreadMentions:n.props.unreadMentions,unreadMsgs:n.props.unreadMsgs,membersCount:n.props.membersCount,teammateId:n.props.channelTeammateId,teammateDeletedAt:n.props.channelTeammateDeletedAt,teammateIsBot:n.props.channelTeammateIsBot,channelIsArchived:n.props.channelIsArchived}),a)}),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&JT(e,t)}(t,_.a.PureComponent),t}();XT($T,"propTypes",{config:v.a.object.isRequired,channelId:v.a.string.isRequired,channelName:v.a.string.isRequired,channelDisplayName:v.a.string.isRequired,channelMuted:v.a.bool,channelType:v.a.string.isRequired,channelStatus:v.a.string,channelFake:v.a.bool,channelStringified:v.a.string,channelTeammateId:v.a.string,channelTeammateUsername:v.a.string,channelTeammateDeletedAt:v.a.number,channelTeammateIsBot:v.a.bool,hasDraft:v.a.bool.isRequired,showUnreadForMsgs:v.a.bool.isRequired,unreadMsgs:v.a.number.isRequired,unreadMentions:v.a.number.isRequired,active:v.a.bool.isRequired,currentTeamName:v.a.string.isRequired,currentUserId:v.a.string.isRequired,showTutorialTip:v.a.bool.isRequired,townSquareDisplayName:v.a.string,offTopicDisplayName:v.a.string,membersCount:v.a.number.isRequired,shouldHideChannel:v.a.bool.isRequired,channelIsArchived:v.a.bool.isRequired,redirectChannel:v.a.string.isRequired,actions:v.a.shape({savePreferences:v.a.func.isRequired,leaveChannel:v.a.func.isRequired,openLhs:v.a.func.isRequired}).isRequired}),XT($T,"contextTypes",{intl:Y.i.isRequired});var ek=Object(r.connect)(function(){var e=Object(d.makeGetChannel)();return function(t,n){var r=n.channelId,o=Object(u.getConfig)(t),a=Object(d.getCurrentChannelId)(t),i=e(t,{id:r})||{},s=!!i.id&&Object(Nc.i)(t,P.G.DRAFT,i.id),c="true"===o.EnableTutorial,m=Object(l.getInt)(t,P.i.Preferences.TUTORIAL_STEP,n.currentUserId,P.i.TutorialSteps.FINISHED),h=Object(d.getChannelsNameMapInCurrentTeam)(t),b=Object(p.getUserIdsInChannels)(t),y=0;b&&b[i.id]&&(y=b[i.id].size,b[i.id].has(n.currentUserId)&&y--);var g=Object(hT.getMyChannelMemberships)(t)[r],v=0,E=0,_=!0;g&&(v=g.mention_count,i&&(E=Math.max(i.total_msg_count-g.msg_count,0)),g.notify_props&&(_=g.notify_props.mark_unread!==P.s.MENTION));var O=Object(l.getTeammateNameDisplaySetting)(t),w=null,C="",S=0,j="",T=!1,k=i.display_name;i.type===P.i.DM_CHANNEL&&((w=Object(p.getUser)(t,i.teammate_id))&&(C=w.id,S=w.delete_at,j=w.username,T=w.is_bot),k=Object(ja.displayUsername)(w,O,!1));var N=!1;return i.name!==P.i.DEFAULT_CHANNEL||n.active||!Object(d.shouldHideDefaultChannel)(t,i)||Object(Ka.isFavoriteChannel)(t.entities.preferences.myPreferences,i.id)||(N=!0),{config:o,channelId:r,channelName:i.name,channelDisplayName:k,channelType:i.type,channelStatus:i.status,channelFake:i.fake,channelMuted:Object(Ka.isChannelMuted)(g),channelStringified:i.fake&&JSON.stringify(i),channelTeammateId:C,channelTeammateUsername:j,channelTeammateDeletedAt:S,channelTeammateIsBot:T,hasDraft:s&&Boolean(s.message.trim()||s.fileInfos.length||s.uploadsInProgress.length)&&a!==i.id,showTutorialTip:c&&m===P.i.TutorialSteps.CHANNEL_POPOVER,townSquareDisplayName:h[P.i.DEFAULT_CHANNEL]&&h[P.i.DEFAULT_CHANNEL].display_name,offTopicDisplayName:h[P.i.OFFTOPIC_CHANNEL]&&h[P.i.OFFTOPIC_CHANNEL].display_name,showUnreadForMsgs:_,unreadMsgs:E,unreadMentions:v,membersCount:y,shouldHideChannel:N,channelIsArchived:0!==i.delete_at,redirectChannel:Object(d.getRedirectChannelNameForTeam)(t,Object(f.getCurrentTeamId)(t))}}},function(e){return{actions:Object(o.bindActionCreators)({savePreferences:cc.savePreferences,leaveChannel:Oo.e,openLhs:pS.b},e)}},null,{withRef:!0})($T);function tk(e){return(tk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nk(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function rk(e){return(rk=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ok(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ak(e,t){return(ak=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ik(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var sk=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=rk(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==tk(o)&&"function"!=typeof o?ok(r):o,ik(ok(n),"renderPublic",function(){if(!n.props.canCreatePublicChannel)return null;var e="".concat(T.ab("sidebar.createChannel","Create new public channel").toLowerCase()),t=_.a.createElement(El.a,{id:"new-channel-tooltip"},_.a.createElement(Y.c,{id:"sidebar.createChannel",defaultMessage:"Create new public channel"}));return _.a.createElement("button",{id:"createPublicChannel","aria-label":e,type:"button",className:"add-channel-btn cursor--pointer style--none",onClick:n.props.createPublicChannel},_.a.createElement(vl.a,{delayShow:500,placement:"top",overlay:t},_.a.createElement("span",null,"+")))}),ik(ok(n),"renderPrivate",function(){if(!n.props.canCreatePrivateChannel)return null;var e="".concat(T.ab("sidebar.createGroup","Create new private channel").toLowerCase()),t=_.a.createElement(El.a,{id:"new-group-tooltip"},_.a.createElement(Y.c,{id:"sidebar.createGroup",defaultMessage:"Create new private channel"}));return _.a.createElement("button",{id:"createPrivateChannel","aria-label":e,type:"button",className:"add-channel-btn cursor--pointer style--none",onClick:n.props.createPrivateChannel},_.a.createElement(vl.a,{delayShow:500,placement:"top",overlay:t},_.a.createElement("span",null,"+")))}),ik(ok(n),"renderDirect",function(){var e=T.ab("sidebar.createDirectMessage","Create new direct message").toLowerCase(),t=_.a.createElement(El.a,{id:"new-group-tooltip",className:"hidden-xs"},_.a.createElement(Y.c,{id:"sidebar.createDirectMessage",defaultMessage:"Create new direct message"}));return _.a.createElement("button",{id:"addDirectChannel","aria-label":e,className:"add-channel-btn cursor--pointer style--none",onClick:n.props.createDirectMessage},_.a.createElement(vl.a,{className:"hidden-xs",delayShow:500,placement:"top",overlay:t},_.a.createElement("span",null,"+")))}),ik(ok(n),"renderCombined",function(){var e=n.props,t=e.canCreatePublicChannel,r=e.canCreatePrivateChannel;if(t&&!r)return n.renderPublic();if(r&&!t)return n.renderPrivate();if(!t&&!r)return null;var o=_.a.createElement(El.a,{id:"new-group-tooltip",className:"hidden-xs"},_.a.createElement(Y.c,{id:"sidebar.createPublicPrivateChannel",defaultMessage:"Create new public or private channel"}));return _.a.createElement("button",{type:"button",className:"add-channel-btn cursor--pointer style--none",onClick:n.props.createPublicDirectChannel},_.a.createElement(vl.a,{className:"hidden-xs",delayShow:500,placement:"top",overlay:o},_.a.createElement("span",null,"+")))}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ak(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){switch(this.props.sectionType){case"public":return this.renderPublic();case"private":return this.renderPrivate();case"direct":return this.renderDirect();case"recent":case"alpha":return this.renderCombined()}return null}}])&&nk(n.prototype,r),o&&nk(n,o),t}();function ck(e){return(ck="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lk(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function uk(e,t){return!t||"object"!==ck(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function pk(e){return(pk=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fk(e,t){return(fk=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function dk(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}ik(sk,"propTypes",{sectionType:g.PropTypes.string.isRequired,createPublicChannel:g.PropTypes.func.isRequired,createPrivateChannel:g.PropTypes.func.isRequired,createDirectMessage:g.PropTypes.func.isRequired,createPublicDirectChannel:g.PropTypes.func.isRequired,canCreatePublicChannel:g.PropTypes.bool.isRequired,canCreatePrivateChannel:g.PropTypes.bool.isRequired});var mk=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),uk(this,pk(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fk(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.sectionType,n=e.moreChannels,r=e.moreDirectMessages,o=e.browsePublicDirectChannels,a=this.context.intl.formatMessage;switch(t){case"public":return _.a.createElement("li",{key:"public-channel-more",id:"morePublicButton"},_.a.createElement("button",{id:"sidebarChannelsMore","aria-label":a({id:"sidebar.morePublicAria",defaultMessage:"more public channels"}),className:"nav-more cursor--pointer style--none btn--block",onClick:n},_.a.createElement(Y.c,{id:"sidebar.moreElips",defaultMessage:"More..."})));case"direct":return _.a.createElement("li",{key:"dm-more",id:"moreDMButton"},_.a.createElement("button",{id:"moreDirectMessage","aria-label":a({id:"sidebar.moreDmAria",defaultMessage:"more direct messages"}),className:"nav-more cursor--pointer style--none btn--block",onClick:r},_.a.createElement(Y.c,{id:"sidebar.moreElips",defaultMessage:"More..."})));case"recent":case"alpha":return _.a.createElement("li",{key:"public-dm-more",id:"moreRecentAlphaButton"},_.a.createElement("button",{id:"morePublicDirectChannels","aria-label":a({id:"sidebar.morePublicDmAria",defaultMessage:"more public channels direct messages"}),className:"nav-more cursor--pointer style--none btn--block",onClick:o},_.a.createElement(Y.c,{id:"sidebar.moreElips",defaultMessage:"More..."})))}return null}}])&&lk(n.prototype,r),o&&lk(n,o),t}();function hk(e){return(hk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bk(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function yk(e){return(yk=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function gk(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vk(e,t){return(vk=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ek(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}dk(mk,"propTypes",{sectionType:g.PropTypes.string.isRequired,moreChannels:g.PropTypes.func.isRequired,moreDirectMessages:g.PropTypes.func.isRequired,browsePublicDirectChannels:g.PropTypes.func.isRequired}),dk(mk,"contextTypes",{intl:Y.i});var _k=["recent","alpha"],Ok=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,n=!(o=(e=yk(t)).call.apply(e,[this].concat(i)))||"object"!==hk(o)&&"function"!=typeof o?gk(r):o,Ek(gk(n),"sectionTypeFormatMessageId",function(e){switch(e){case"public":return Object(Ne.b)("sidebar.types.public");case"private":return Object(Ne.b)("sidebar.types.private");case"direct":return Object(Ne.b)("sidebar.types.direct");case"favorite":return Object(Ne.b)("sidebar.types.favorite");case"unreads":return Object(Ne.b)("sidebar.types.unreads");case"recent":return Object(Ne.b)("sidebar.types.recent");default:return Object(Ne.b)("sidebar.types.alpha")}}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vk(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.sectionType,n=e.channelName,r=e.browsePublicDirectChannels,o=["hover","focus"];T.U()&&(o=[]);var a=this.sectionTypeFormatMessageId(t),i=_.a.createElement(Y.c,{id:a,defaultMessage:n});if(-1!==_k.indexOf(t)){var s=_.a.createElement(El.a,{id:"new-group-tooltip",className:"hidden-xs"},_.a.createElement(Y.c,{id:"sidebar.browseChannelDirectChannel",defaultMessage:"Browse Channels and Direct Messages"}));i=_.a.createElement(vl.a,{trigger:o,delayShow:500,placement:"top",overlay:s},_.a.createElement("div",{role:"presentation",className:"public_direct_name",onClick:r},i))}return i}}])&&bk(n.prototype,r),o&&bk(n,o),t}();function wk(e){return(wk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ck(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Sk(e){return(Sk=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Pk(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jk(e,t){return(jk=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Tk(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Ek(Ok,"propTypes",{sectionType:g.PropTypes.string.isRequired,channelName:g.PropTypes.string.isRequired,browsePublicDirectChannels:g.PropTypes.func.isRequired});var kk=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=Sk(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==wk(o)&&"function"!=typeof o?Pk(r):o,Tk(Pk(n),"state",{show:!0,key:"channels"}),Tk(Pk(n),"handleHide",function(){n.setState({show:!1})}),Tk(Pk(n),"handleExit",function(){n.props.onModalDismissed&&n.props.onModalDismissed()}),Tk(Pk(n),"handleSelect",function(e){n.setState({key:e})}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jk(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){return _.a.createElement(z.a,{dialogClassName:"a11y__modal more-modal more-direct-channels more-public-direct-channels",show:this.state.show,onHide:this.handleHide,onExited:this.handleExit,role:"dialog","aria-labelledby":"morePublicModalLabel"},_.a.createElement(z.a.Header,{closeButton:!0},_.a.createElement(z.a.Title,{componentClass:"h1",id:"morePublicModalLabel"},_.a.createElement(Y.c,{id:"more_public_direct_channels.title",defaultMessage:"Channels and Direct Messages"}))),_.a.createElement(z.a.Body,null,_.a.createElement(ce.a,{id:"morePublicDirectChannelTabs",className:"modal-tabs",defaultActiveKey:"channels",activeKey:this.state.key,onSelect:this.handleSelect,unmountOnExit:!0},_.a.createElement(le.a,{eventKey:"channels",title:Object(T.ab)("more_public_direct_channels.channels","Channels")},_.a.createElement(xS,{handleNewChannel:this.props.handleNewChannel,onModalDismissed:this.handleHide,bodyOnly:!0})),_.a.createElement(le.a,{eventKey:"dm",title:Object(T.ab)("more_public_direct_channels.direct_messages","Direct Messages")},_.a.createElement(tP,{onModalDismissed:this.handleHide,isExistingChannel:!1,bodyOnly:!0})))))}}])&&Ck(n.prototype,r),o&&Ck(n,o),t}();function Nk(e){return(Nk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Rk(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Mk(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ik(e){return(Ik=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xk(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ak(e,t){return(Ak=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Lk(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Dk(e){return _.a.createElement("div",Object.assign({},e,{className:"scrollbar--view"}))}function Uk(e){return _.a.createElement("div",Object.assign({},e,{className:"scrollbar--horizontal"}))}function qk(e){return _.a.createElement("div",Object.assign({},e,{className:"scrollbar--vertical"}))}Tk(kk,"propTypes",{handleNewChannel:v.a.func,onModalDismissed:v.a.func});var Hk=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=Ik(t).call(this,e),n=!o||"object"!==Nk(o)&&"function"!=typeof o?xk(r):o,Lk(xk(n),"handleOpenMoreDirectChannelsModal",function(e){e.preventDefault(),n.state.showDirectChannelsModal?n.hideMoreDirectChannelsModal():n.showMoreDirectChannelsModal()}),Lk(xk(n),"updateTitle",function(){var e=n.props,t=e.config,r=e.currentChannel,o=e.currentTeam,a=e.currentTeammate,i=e.unreads;if(r&&o){var s="";null!=t.SiteName&&(s=t.SiteName);var c=r.display_name;r.type===P.i.DM_CHANNEL&&null!=a&&(c=a.display_name);var l=i.mentionCount>0?"("+i.mentionCount+") ":"",u=i.messageCount>0?"* ":"";document.title=l+u+c+" - "+n.props.currentTeam.display_name+" "+s}}),Lk(xk(n),"onScroll",function(){n.updateUnreadIndicators()}),Lk(xk(n),"handleScrollAnimationUpdate",function(e){var t=n.refs.scrollbar,r=e.getCurrentValue();t.scrollTop(r)}),Lk(xk(n),"scrollToFirstUnreadChannel",function(){if(n.firstUnreadChannel){var e,t=n.getDisplayedChannels(n.state.orderedChannelIds);if(n.unreadScrollAnimate.setCurrentValue(n.refs.scrollbar.getScrollTop()).setAtRest(),t.length>0&&t[0]===n.firstUnreadChannel)e=fS.MathUtil.mapValueInRange(0,0,1,0,1);else{var r=qc()(uu.a.findDOMNode(n.refs[n.firstUnreadChannel])).position().top-15;e=fS.MathUtil.mapValueInRange(r,0,1,0,1)}n.unreadScrollAnimate.setEndValue(e)}}),Lk(xk(n),"scrollToLastUnreadChannel",function(){if(n.lastUnreadChannel){var e=n.refs.scrollbar,t=qc()(uu.a.findDOMNode(n.refs[n.lastUnreadChannel])),r=t.position().top+t.height()-e.getClientHeight()+15,o=fS.MathUtil.mapValueInRange(r,0,1,0,1);n.unreadScrollAnimate.setCurrentValue(e.getScrollTop()).setAtRest(),n.unreadScrollAnimate.setEndValue(o)}}),Lk(xk(n),"updateUnreadIndicators",function(){var e=!1,t=!1;if(n.firstUnreadChannel){var r=qc()(uu.a.findDOMNode(n.refs[n.firstUnreadChannel])),o=r?r.position():null;o&&o.top+r.height()-15<n.refs.scrollbar.getScrollTop()&&(e=!0)}if(n.lastUnreadChannel){var a=qc()(uu.a.findDOMNode(n.refs[n.lastUnreadChannel])),i=a?a.position():null;i&&i.top+15>n.refs.scrollbar.getScrollTop()+n.refs.scrollbar.getClientHeight()&&(t=!0)}e===n.state.showTopUnread&&t===n.state.showBottomUnread||n.setState({showTopUnread:e,showBottomUnread:t})}),Lk(xk(n),"updateScrollbarOnChannelChange",function(e){var t=n.refs[e].getWrappedInstance().refs.channel.getBoundingClientRect();(t.top-P.i.CHANNEL_SCROLL_ADJUSTMENT<0||t.top+t.height>n.refs.scrollbar.view.getBoundingClientRect().height)&&n.refs.scrollbar.scrollTop(n.refs.scrollbar.view.scrollTop+(t.top-P.i.CHANNEL_SCROLL_ADJUSTMENT))}),Lk(xk(n),"navigateChannelShortcut",function(e){if(e.altKey&&!e.shiftKey&&(T.S(e,P.i.KeyCodes.UP)||T.S(e,P.i.KeyCodes.DOWN))){if(e.preventDefault(),n.isSwitchingChannel)return;n.isSwitchingChannel=!0;for(var t=n.getDisplayedChannels(n.state.orderedChannelIds),r=n.props.currentChannel.id,o=-1,a=0;a<t.length;a++)t[a]===r&&(o=a);var i=o;i=T.S(e,P.i.KeyCodes.DOWN)?o+1:o-1;var s=t[T.bb(i,t.length)];n.props.actions.switchToChannelById(s),n.updateScrollbarOnChannelChange(s),n.isSwitchingChannel=!1}else T.e(e)&&e.shiftKey&&T.S(e,P.i.KeyCodes.K)&&n.handleOpenMoreDirectChannelsModal(e)}),Lk(xk(n),"navigateUnreadChannelShortcut",function(e){if(e.altKey&&e.shiftKey&&(T.S(e,P.i.KeyCodes.UP)||T.S(e,P.i.KeyCodes.DOWN))){if(e.preventDefault(),n.isSwitchingChannel)return;n.isSwitchingChannel=!0;var t=n.getDisplayedChannels(n.state.orderedChannelIds),r=0;r=T.S(e,P.i.KeyCodes.UP)?-1:1;var o=So.b(n.props.currentChannel.id,t,n.props.unreadChannelIds,r);if(-1!==o){var a=t[o];n.props.actions.switchToChannelById(a),n.updateScrollbarOnChannelChange(a)}n.isSwitchingChannel=!1}}),Lk(xk(n),"getDisplayedChannels",function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).reduce(function(e,t){return e.push.apply(e,Rk(t.items)),e},[])}),Lk(xk(n),"channelIdIsDisplayedForProps",function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,r=n.getDisplayedChannels(e),o=0;o<r.length;o++)if(r[o]===t)return!0;return!1}),Lk(xk(n),"showMorePublicDirectChannelsModal",function(){n.setState({showMorePublicChannelsModal:!0}),Object(vt.d)("ui","ui_channels_more_public_direct")}),Lk(xk(n),"hideMorePublicDirectChannelsModal",function(){n.setState({showMorePublicChannelsModal:!1})}),Lk(xk(n),"onHandleNewChannel",function(){n.hideMorePublicDirectChannelsModal(),n.showNewChannelModal(P.i.OPEN_CHANNEL)}),Lk(xk(n),"showMoreChannelsModal",function(){n.setState({showMoreChannelsModal:!0}),Object(vt.d)("ui","ui_channels_more_public")}),Lk(xk(n),"hideMoreChannelsModal",function(){n.setState({showMoreChannelsModal:!1})}),Lk(xk(n),"showNewPublicChannelModal",function(){n.showNewChannelModal(P.i.OPEN_CHANNEL)}),Lk(xk(n),"showNewPrivateChannelModal",function(){n.showNewChannelModal(P.i.PRIVATE_CHANNEL)}),Lk(xk(n),"showNewChannelModal",function(e){n.setState({newChannelModalType:e})}),Lk(xk(n),"hideNewChannelModal",function(){n.setState({newChannelModalType:""})}),Lk(xk(n),"showMoreDirectChannelsModal",function(){Object(vt.d)("ui","ui_channels_more_direct"),n.setState({showDirectChannelsModal:!0})}),Lk(xk(n),"hideMoreDirectChannelsModal",function(){n.setState({showDirectChannelsModal:!1})}),Lk(xk(n),"openQuickSwitcher",function(e){e.preventDefault(),n.props.actions.openModal({modalId:P.r.QUICK_SWITCH,dialogType:ZP})}),Lk(xk(n),"createSidebarChannel",function(e){return _.a.createElement(ek,{key:e,ref:e,channelId:e,active:e===n.props.currentChannel.id,currentTeamName:n.props.currentTeam.name,currentUserId:n.props.currentUser.id})}),Lk(xk(n),"renderOrderedChannels",function(){var e=n.state.orderedChannelIds,t=[P.D.UNREADS,P.D.FAVORITE];return _.a.createElement(Fc.a,{ref:"scrollbar",autoHide:!0,autoHideTimeout:500,autoHideDuration:500,renderThumbHorizontal:Uk,renderThumbVertical:qk,renderView:Dk,onScroll:n.onScroll,style:{position:"absolute"}},_.a.createElement("div",{id:"sidebarChannelContainer",className:"nav-pills__container"},e.map(function(e){var r={type:e.type,name:e.name,items:e.items.map(n.createSidebarChannel)};if(-1!==t.indexOf(r.type)&&0===r.items.length)return null;var o="".concat(r.type,"Channel"),a=r.name.toLowerCase();return _.a.createElement("ul",{key:r.type,"aria-label":a,role:"presentation",className:"nav nav-pills nav-stacked a11y__section",id:o+"List",tabIndex:"-1"},_.a.createElement("li",{className:"sidebar-section__header"},_.a.createElement("h4",{role:"presentation",id:o},_.a.createElement(Ok,{sectionType:r.type,channelName:r.name,browsePublicDirectChannels:n.showMorePublicDirectChannelsModal})),_.a.createElement(sk,{sectionType:r.type,canCreatePublicChannel:n.props.canCreatePublicChannel,canCreatePrivateChannel:n.props.canCreatePrivateChannel,createPublicChannel:n.showNewPublicChannelModal,createPrivateChannel:n.showNewPrivateChannelModal,createDirectMessage:n.handleOpenMoreDirectChannelsModal,createPublicDirectChannel:n.showNewPublicChannelModal})),r.items,_.a.createElement(mk,{sectionType:r.type,moreChannels:n.showMoreChannelsModal,moreDirectMessages:n.handleOpenMoreDirectChannelsModal,browsePublicDirectChannels:n.showMorePublicDirectChannelsModal}))})))}),n.badgesActive=!1,n.firstUnreadChannel=null,n.lastUnreadChannel=null,n.isLeaving=new Map,n.isSwitchingChannel=!1,n.closedDirectChannel=!1,n.state={newChannelModalType:"",orderedChannelIds:e.orderedChannelIds,showDirectChannelsModal:!1,showMoreChannelsModal:!1,showMorePublicChannelsModal:!1},n.animate=new fS.SpringSystem,n.unreadScrollAnimate=n.animate.createSpring(),n.unreadScrollAnimate.setOvershootClampingEnabled(!0),n.unreadScrollAnimate.addListener({onSpringUpdate:n.handleScrollAnimationUpdate}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ak(e,t)}(t,_.a.PureComponent),n=t,o=[{key:"getDerivedStateFromProps",value:function(e,t){return e.orderedChannelIds[0].type===P.D.UNREADS&&t.orderedChannelIds[0].type===P.D.UNREADS&&t.orderedChannelIds[0].items.length===e.orderedChannelIds[0].items.length&&t.orderedChannelIds[0].items.includes(e.currentChannel.id)?null:e.orderedChannelIds!==t.orderedChannelIds?{orderedChannelIds:e.orderedChannelIds}:null}}],(r=[{key:"componentDidMount",value:function(){this.updateUnreadIndicators(),document.addEventListener("keydown",this.navigateChannelShortcut),document.addEventListener("keydown",this.navigateUnreadChannelShortcut)}},{key:"componentDidUpdate",value:function(e){if(this.props.currentTeam===e.currentTeam&&this.props.currentChannel.id===e.currentChannel.id&&!this.channelIdIsDisplayedForProps(this.props.orderedChannelIds,this.props.currentChannel.id)&&this.channelIdIsDisplayedForProps(e.orderedChannelIds,this.props.currentChannel.id))return this.closedDirectChannel=!0,void Object(S.f)();this.props.currentTeam!==e.currentTeam&&this.refs.scrollbar.scrollToTop(),this.props.currentChannel.id!==e.currentChannel.id&&(this.closedDirectChannel?this.closedDirectChannel=!1:this.props.actions.close()),this.updateTitle(),this.setFirstAndLastUnreadChannels(),this.updateUnreadIndicators()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.navigateChannelShortcut),document.removeEventListener("keydown",this.navigateUnreadChannelShortcut),this.animate.deregisterSpring(this.unreadScrollAnimate),this.animate.removeAllListeners(),this.unreadScrollAnimate.destroy()}},{key:"setBadgesActiveAndFavicon",value:function(){if(this.lastBadgesActive=this.badgesActive,this.badgesActive=this.props.unreads.mentionCount,this.lastBadgesActive!==this.badgesActive){var e=document.createElement("link");e.type="image/x-icon",e.rel="shortcut icon",e.id="favicon",this.badgesActive?e.href="string"==typeof bS.a?bS.a:"":e.href="string"==typeof mS.a?mS.a:"";var t=document.getElementsByTagName("head")[0],n=document.getElementById("favicon");n&&t.removeChild(n),t.appendChild(e)}}},{key:"setFirstAndLastUnreadChannels",value:function(){var e=this,t=this.props,n=t.currentChannel,r=t.unreadChannelIds,o=this.state.orderedChannelIds;this.getDisplayedChannels(o).map(function(t){return t!==n.id&&r.includes(t)&&(e.firstUnreadChannel||(e.firstUnreadChannel=t),e.lastUnreadChannel=t),null})}},{key:"render",value:function(){var e=this,t=this.props.channelSwitcherOption,n=T.ab("accessibility.sections.lhsList","channel sidebar region");if(null==this.props.currentTeam||null==this.props.currentUser)return _.a.createElement("div",null);this.badgesActive=!1,this.firstUnreadChannel=null,this.lastUnreadChannel=null;var r=!1;""!==this.state.newChannelModalType&&(r=!0);var o,a,i=_.a.createElement(Y.c,{id:"sidebar.unreads",defaultMessage:"More unreads"}),s=_.a.createElement(Y.c,{id:"sidebar.unreads",defaultMessage:"More unreads"});this.state.showDirectChannelsModal&&(o=_.a.createElement(tP,{onModalDismissed:this.hideMoreDirectChannelsModal,isExistingChannel:!1})),this.state.showMoreChannelsModal&&(a=_.a.createElement(xS,{onModalDismissed:this.hideMoreChannelsModal,handleNewChannel:function(){e.hideMoreChannelsModal(),e.showNewChannelModal(P.i.OPEN_CHANNEL)}}));var c,l=null;if(t){var u=Object(Ne.b)("quick_switch_modal.channelsShortcut.windows"),p="- CTRL+K";T.T()&&(u=Object(Ne.b)("quick_switch_modal.channelsShortcut.mac"),p="- ⌘K");var f=_.a.createElement("span",{className:"switch__shortcut hidden-xs"},_.a.createElement(Y.c,{id:u,defaultMessage:p}));l=_.a.createElement("div",{className:"sidebar__switcher"},_.a.createElement("button",{id:"sidebarSwitcherButton",className:"btn btn-link",onClick:this.openQuickSwitcher},_.a.createElement(Y.c,{id:"channel_switch_modal.title",defaultMessage:"Switch Channels"}),f))}return this.state.showMorePublicChannelsModal&&(c=_.a.createElement(kk,{onModalDismissed:this.hideMorePublicDirectChannelsModal,handleNewChannel:this.onHandleNewChannel,isExistingChannel:!1})),_.a.createElement("div",{className:Mc()("sidebar--left",{"move--right":this.props.isOpen&&T.U()}),id:"sidebar-left",key:"sidebar-left"},_.a.createElement(wj,{show:r,canCreatePublicChannel:this.props.canCreatePublicChannel,canCreatePrivateChannel:this.props.canCreatePrivateChannel,channelType:this.state.newChannelModalType,onModalDismissed:this.hideNewChannelModal}),c,o,a,_.a.createElement(mT,null),_.a.createElement("div",{className:"sidebar--left__icons"},_.a.createElement(I.a,{pluggableName:"LeftSidebarHeader"})),_.a.createElement("div",{id:"lhsList",role:"application","aria-label":n,tabIndex:"-1",className:"sidebar--left__list a11y__region","data-a11y-sort-order":"6"},_.a.createElement(Dj,{name:"Top",show:this.state.showTopUnread,onClick:this.scrollToFirstUnreadChannel,extraClass:"nav-pills__unread-indicator-top",content:i}),_.a.createElement(Dj,{name:"Bottom",show:this.state.showBottomUnread,onClick:this.scrollToLastUnreadChannel,extraClass:"nav-pills__unread-indicator-bottom",content:s}),this.renderOrderedChannels()),l)}}])&&Mk(n.prototype,r),o&&Mk(n,o),t}();Lk(Hk,"propTypes",{config:g.PropTypes.object.isRequired,isOpen:g.PropTypes.bool.isRequired,unreadChannelIds:g.PropTypes.array,orderedChannelIds:g.PropTypes.arrayOf(g.PropTypes.shape({type:g.PropTypes.string.isRequired,name:g.PropTypes.string.isRequired,items:g.PropTypes.array.isRequired})),currentChannel:g.PropTypes.object,currentTeammate:g.PropTypes.object,currentTeam:g.PropTypes.object,currentUser:g.PropTypes.object,unreads:g.PropTypes.object.isRequired,canCreatePublicChannel:g.PropTypes.bool.isRequired,canCreatePrivateChannel:g.PropTypes.bool.isRequired,channelSwitcherOption:g.PropTypes.bool.isRequired,actions:g.PropTypes.shape({close:g.PropTypes.func.isRequired,switchToChannelById:g.PropTypes.func.isRequired,openModal:g.PropTypes.func.isRequired}).isRequired}),Lk(Hk,"defaultProps",{currentChannel:{}});var Fk=Object(r.connect)(function(e){var t=Object(u.getConfig)(e),n=Object(d.getCurrentChannel)(e),r=n&&n.teammate_id&&Object(d.getCurrentChannel)(e,n.teammate_id),o=Object(f.getCurrentTeam)(e),a=Object(D.haveITeamPermission)(e,{team:o.id,permission:Tp.a.CREATE_PUBLIC_CHANNEL}),i=Object(D.haveITeamPermission)(e,{team:o.id,permission:Tp.a.CREATE_PRIVATE_CHANNEL}),s=Object(l.getSidebarPreferences)(e),c=e.views.channel.keepChannelIdAsUnread;return{config:t,unreadChannelIds:Object(d.getSortedUnreadChannelIds)(e,c),orderedChannelIds:Object(d.getOrderedChannelIds)(e,c,s.grouping,s.sorting,"true"===s.unreads_at_top,"true"===s.favorite_at_top),channelSwitcherOption:Object(l.getBool)(e,L.Preferences.CATEGORY_SIDEBAR_SETTINGS,"channel_switcher_section","true"),currentChannel:n,currentTeammate:r,currentTeam:o,currentUser:Object(p.getCurrentUser)(e),canCreatePublicChannel:a,canCreatePrivateChannel:i,isOpen:UC(e),unreads:Object(d.getUnreads)(e)}},function(e){return{actions:Object(o.bindActionCreators)({close:pS.a,switchToChannelById:Oo.m,openModal:U.b},e)}})(Hk),Bk=n(1660);function Gk(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function Vk(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return function(){var n,r=(n=regeneratorRuntime.mark(function n(r,o){var a,i,c,l,u,d,m,h;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r(Object(A.getPostThread)(e));case 2:if(a=n.sent,i=a.data){n.next=7;break}return Q.a.replace("/error?type=".concat(P.k.PERMALINK_NOT_FOUND,"&returnTo=").concat(t)),n.abrupt("return");case 7:if(c=o(),l=i.posts[i.order[0]].channel_id,u=c.entities.channels.channels[l],d=Object(f.getCurrentTeamId)(c),u){n.next=20;break}return n.next=14,r(Object(s.getChannel)(l));case 14:if(m=n.sent,h=m.data){n.next=19;break}return Q.a.replace("/error?type=".concat(P.k.PERMALINK_NOT_FOUND,"&returnTo=").concat(t)),n.abrupt("return");case 19:u=h;case 20:if(c.entities.channels.myMembers[l]){n.next=27;break}if(u.type!==P.i.DM_CHANNEL&&u.type!==P.i.GM_CHANNEL){n.next=25;break}return Q.a.replace("/error?type=".concat(P.k.PERMALINK_NOT_FOUND,"&returnTo=").concat(t)),n.abrupt("return");case 25:return n.next=27,r(Object(s.joinChannel)(Object(p.getCurrentUserId)(o()),null,l));case 27:if(!u.team_id||u.team_id===d){n.next=30;break}return Q.a.replace("/error?type=".concat(P.k.PERMALINK_NOT_FOUND,"&returnTo=").concat(t)),n.abrupt("return");case 30:u&&u.type===P.i.DM_CHANNEL?Object(lc.d)(u.id):u&&u.type===P.i.GM_CHANNEL&&Object(lc.e)(u.id),r(Object(s.selectChannel)(l)),r({type:P.e.RECEIVED_FOCUSED_POST,data:e,channelId:l}),r(Object(Ya.d)()),r(Object(s.getChannelStats)(l));case 35:case"end":return n.stop()}},n)}),function(){var e=this,t=arguments;return new Promise(function(r,o){var a=n.apply(e,t);function i(e){Gk(a,r,o,i,s,"next",e)}function s(e){Gk(a,r,o,i,s,"throw",e)}i(void 0)})});return function(e,t){return r.apply(this,arguments)}}()}n(1794);function Wk(e){return(Wk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Kk(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function zk(e){return(zk=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Yk(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Qk(e,t){return(Qk=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Zk(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Jk=P.Q.KeyCodes,Xk=Object(Y.g)({error:{id:Object(Ne.b)("edit_channel_header_modal.error"),defaultMessage:"This channel header is too long, please enter a shorter one"}}),$k=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=zk(t).call(this,e),n=!o||"object"!==Wk(o)&&"function"!=typeof o?Yk(r):o,Zk(Yk(n),"updatePreview",function(e){n.setState({preview:e})}),Zk(Yk(n),"handleChange",function(e){n.setState({header:e.target.value})}),Zk(Yk(n),"handleSave",function(){var e=n.props,t=e.channel,r=e.actions.patchChannel,o=n.state.header;r(t.id,{header:o})}),Zk(Yk(n),"onHide",function(){n.setState({show:!1})}),Zk(Yk(n),"focusTextbox",function(){n.refs.editChannelHeaderTextbox&&n.refs.editChannelHeaderTextbox.getWrappedInstance().focus()}),Zk(Yk(n),"blurTextbox",function(){n.refs.editChannelHeaderTextbox&&n.refs.editChannelHeaderTextbox.getWrappedInstance().blur()}),Zk(Yk(n),"handleEntering",function(){n.focusTextbox()}),Zk(Yk(n),"handleKeyDown",function(e){n.props.ctrlSend&&Object(T.S)(e,Jk.ENTER)&&!0===e.ctrlKey&&n.handleKeyPress(e)}),Zk(Yk(n),"handleKeyPress",function(e){var t=n.props.ctrlSend;!Object(j.m)()&&(t&&e.ctrlKey||!t)&&(!Object(T.S)(e,Jk.ENTER)||e.shiftKey||e.altKey||(e.preventDefault(),n.blurTextbox(),n.handleSave(e)))}),n.state={preview:!1,header:e.channel.header,show:!0,showError:!1},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qk(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.requestStatus,n=this.props.requestStatus;n!==t&&t===L.RequestStatus.FAILURE?this.setState({showError:!0}):n!==t&&t===L.RequestStatus.SUCCESS?this.onHide():this.setState({showError:!1})}},{key:"render",value:function(){var e,t=null;this.props.serverError&&this.state.showError&&(e="model.channel.is_valid.header.app_error"===this.props.serverError.server_error_id?this.props.intl.formatMessage(Xk.error):this.props.serverError.message,t=_.a.createElement("div",{className:"form-group has-error"},_.a.createElement("br",null),_.a.createElement("label",{className:"control-label"},e)));var n=null;return n=this.props.channel.type===P.Q.DM_CHANNEL?_.a.createElement(Y.c,{id:"edit_channel_header_modal.title_dm",defaultMessage:"Edit Header"}):_.a.createElement(Y.c,{id:"edit_channel_header_modal.title",defaultMessage:"Edit Header for {channel}",values:{channel:this.props.channel.display_name}}),_.a.createElement(z.a,{dialogClassName:"a11y__modal",show:this.state.show,onHide:this.onHide,onEntering:this.handleEntering,onExited:this.props.onHide,role:"dialog","aria-labelledby":"editChannelHeaderModalLabel"},_.a.createElement(z.a.Header,{closeButton:!0},_.a.createElement(z.a.Title,{componentClass:"h1",id:"editChannelHeaderModalLabel"},n)),_.a.createElement(z.a.Body,{bsClass:"modal-body edit-modal-body"},_.a.createElement("div",null,_.a.createElement("p",null,_.a.createElement(Y.c,{id:"edit_channel_header_modal.description",defaultMessage:"Edit the text appearing next to the channel name in the channel header."})),_.a.createElement("div",{className:"textarea-wrapper"},_.a.createElement(Hi,{value:this.state.header,onChange:this.handleChange,onKeyPress:this.handleKeyPress,onKeyDown:this.handleKeyDown,supportsCommands:!1,suggestionListStyle:"bottom",createMessage:Object(T.ab)("edit_channel_header.editHeader","Edit the Channel Header..."),previewMessageLink:Object(T.ab)("edit_channel_header.previewHeader","Edit Header"),handlePostError:this.handlePostError,id:"edit_textbox",ref:"editChannelHeaderTextbox",characterLimit:1024,preview:this.state.preview})),_.a.createElement("div",{className:"post-create-footer"},_.a.createElement(Qi,{characterLimit:1024,showPreview:this.state.preview,ref:this.setTextboxLinksRef,updatePreview:this.updatePreview,message:this.state.editText})),_.a.createElement("br",null),t)),_.a.createElement(z.a.Footer,null,_.a.createElement("button",{type:"button",className:"btn btn-link cancel-button",onClick:this.onHide},_.a.createElement(Y.c,{id:"edit_channel_header_modal.cancel",defaultMessage:"Cancel"})),_.a.createElement("button",{disabled:this.props.requestStatus===L.RequestStatus.STARTED,type:"button",className:"btn btn-primary save-button",onClick:this.handleSave},_.a.createElement(Y.c,{id:"edit_channel_header_modal.save",defaultMessage:"Save"}))))}}])&&Kk(n.prototype,r),o&&Kk(n,o),t}();Zk($k,"propTypes",{intl:Y.i.isRequired,onHide:v.a.func.isRequired,channel:v.a.object.isRequired,ctrlSend:v.a.bool.isRequired,serverError:v.a.object,requestStatus:v.a.string.isRequired,actions:v.a.shape({patchChannel:v.a.func.isRequired}).isRequired});var eN=Object(Y.h)($k);function tN(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var nN=Object(Kc.a)(function(e){return Object(l.getBool)(e,P.Q.Preferences.CATEGORY_ADVANCED_SETTINGS,"send_on_ctrl_enter")},function(e){var t=e.requests.channels.updateChannel;return{serverError:t.error,requestStatus:t.status}},function(e,t){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){tN(e,t,n[t])})}return e}({ctrlSend:e},t)});var rN=Object(r.connect)(nN,function(e){return{actions:{patchChannel:Object(o.bindActionCreators)(s.patchChannel,e)}}})(eN);function oN(e){return(oN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function aN(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function iN(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){aN(a,r,o,i,s,"next",e)}function s(e){aN(a,r,o,i,s,"throw",e)}i(void 0)})}}function sN(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function cN(e){return(cN=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function lN(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uN(e,t){return(uN=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function pN(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var fN=50,dN=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=cN(t).call(this,e),n=!o||"object"!==oN(o)&&"function"!=typeof o?lN(r):o,pN(lN(n),"addValue",function(e){var t=Object.assign([],n.state.values);-1===t.indexOf(e)&&t.push(e),n.setState({values:t})}),pN(lN(n),"onHide",function(){n.setState({show:!1})}),pN(lN(n),"handleInviteError",function(e){e&&n.setState({saving:!1,inviteError:e.message})}),pN(lN(n),"handleDelete",function(e){n.setState({values:e})}),pN(lN(n),"setUsersLoadingState",function(e){n.setState({loadingUsers:e})}),pN(lN(n),"handlePageChange",function(e,t){e>t&&(n.setUsersLoadingState(!0),n.props.actions.getProfilesNotInChannel(n.props.channel.team_id,n.props.channel.id,n.props.channel.group_constrained,e+1,fN).then(function(){n.setUsersLoadingState(!1)}))}),pN(lN(n),"handleSubmit",function(e){var t=n.props,r=t.actions,o=t.channel;e&&e.preventDefault();var a=n.state.values.map(function(e){return e.id});0!==a.length&&(n.setState({saving:!0}),r.addUsersToChannel(o.id,a).then(function(e){e.error?n.handleInviteError(e.error):(n.setState({saving:!1,inviteError:null}),n.onHide())}))}),pN(lN(n),"search",function(e){var t=e.trim();clearTimeout(n.searchTimeoutId),n.setState({term:t}),n.searchTimeoutId=setTimeout(iN(regeneratorRuntime.mark(function e(){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.setUsersLoadingState(!0),r={team_id:n.props.channel.team_id,not_in_channel_id:n.props.channel.id,group_constrained:n.props.channel.group_constrained},e.next=4,n.props.actions.searchProfiles(t,r);case 4:n.setUsersLoadingState(!1);case 5:case"end":return e.stop()}},e)})),P.Q.SEARCH_TIMEOUT_MILLISECONDS)}),pN(lN(n),"renderAriaLabel",function(e){return e?e.username:null}),pN(lN(n),"renderOption",function(e,t,n){var r="";return t&&(r="more-modal__row--selected"),_.a.createElement("div",{key:e.id,ref:t?"selected":e.id,className:"more-modal__row clickable "+r,onClick:function(){return n(e)}},_.a.createElement(bd.a,{src:ii.Client4.getProfilePictureUrl(e.id,e.last_picture_update),width:"32",height:"32"}),_.a.createElement("div",{className:"more-modal__details"},_.a.createElement("div",{className:"more-modal__name"},Object(T.m)(e),_.a.createElement(ka.a,{show:Boolean(e.is_bot),className:"badge-popoverlist"}))),_.a.createElement("div",{className:"more-modal__actions"},_.a.createElement("div",{className:"more-modal__actions--round"},_.a.createElement(ww.a,null))))}),n.searchTimeoutId=0,n.state={values:[],term:"",show:!0,saving:!1,loadingUsers:!0},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&uN(e,t)}(t,_.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){var e=this;this.props.actions.getProfilesNotInChannel(this.props.channel.team_id,this.props.channel.id,this.props.channel.group_constrained,0).then(function(){e.setUsersLoadingState(!1)}),this.props.actions.getTeamStats(this.props.channel.team_id)}},{key:"renderValue",value:function(e){return e.data.username}},{key:"render",value:function(){var e=null;this.state.inviteError&&(e=_.a.createElement("label",{className:"has-error control-label"},this.state.inviteError));var t=_.a.createElement(Y.c,{id:"multiselect.numPeopleRemaining",defaultMessage:"Use ↑↓ to browse, ↵ to select. You can add {num, number} more {num, plural, one {person} other {people}}. ",values:{num:20-this.state.values.length}}),n=Object(T.ab)("multiselect.add","Add"),r=Object(T.ab)("multiselect.adding","Adding..."),o=Object(ja.filterProfilesMatchingTerm)(this.props.profilesNotInCurrentChannel,this.state.term);o=o.filter(function(e){return 0===e.delete_at});var a=_.a.createElement(Ow.a,{key:"addUsersToChannelKey",options:o,optionRenderer:this.renderOption,values:this.state.values,valueRenderer:this.renderValue,ariaLabelRenderer:this.renderAriaLabel,perPage:fN,handlePageChange:this.handlePageChange,handleInput:this.search,handleDelete:this.handleDelete,handleAdd:this.addValue,handleSubmit:this.handleSubmit,maxValues:20,numRemainingText:t,buttonSubmitText:n,buttonSubmitLoadingText:r,saving:this.state.saving,loading:this.state.loadingUsers,placeholderText:Object(T.ab)("multiselect.placeholder","Search and add members")});return _.a.createElement(z.a,{dialogClassName:"a11y__modal more-modal",show:this.state.show,onHide:this.onHide,onExited:this.props.onHide,role:"dialog","aria-labelledby":"channelInviteModalLabel"},_.a.createElement(z.a.Header,{closeButton:!0},_.a.createElement(z.a.Title,{componentClass:"h1",id:"channelInviteModalLabel"},_.a.createElement(Y.c,{id:"channel_invite.addNewMembers",defaultMessage:"Add New Members to "}),_.a.createElement("span",{className:"name"},this.props.channel.display_name))),_.a.createElement(z.a.Body,{role:"application"},e,a))}}])&&sN(n.prototype,r),o&&sN(n,o),t}();pN(dN,"propTypes",{profilesNotInCurrentChannel:v.a.array.isRequired,onHide:v.a.func.isRequired,channel:v.a.object.isRequired,actions:v.a.shape({addUsersToChannel:v.a.func.isRequired,getProfilesNotInChannel:v.a.func.isRequired,getTeamStats:v.a.func.isRequired,searchProfiles:v.a.func.isRequired}).isRequired});var mN=Object(r.connect)(function(e){return{profilesNotInCurrentChannel:Object(p.getProfilesNotInCurrentChannel)(e)}},function(e){return{actions:Object(o.bindActionCreators)({addUsersToChannel:Ya.a,getProfilesNotInChannel:i.getProfilesNotInChannel,getTeamStats:c.getTeamStats,searchProfiles:i.searchProfiles},e)}})(dN);function hN(e){return(hN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bN(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function yN(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){bN(a,r,o,i,s,"next",e)}function s(e){bN(a,r,o,i,s,"throw",e)}i(void 0)})}}function gN(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function vN(e){return(vN=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function EN(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _N(e,t){return(_N=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ON(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var wN=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=vN(t).call(this,e),n=!o||"object"!==hN(o)&&"function"!=typeof o?EN(r):o,ON(EN(n),"handleRemoveFromChannel",function(){if(!n.state.removing){var e=n.props,t=e.actions,r=e.channel,o=e.user;n.setState({removing:!0}),t.removeChannelMember(r.id,o.id).then(function(e){e.error?n.setState({serverError:e.error.message,removing:!1}):(n.setState({removing:!1}),t.getChannelStats(r.id))})}}),ON(EN(n),"handleMakeChannelMember",yN(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.props.actions.updateChannelMemberSchemeRoles(n.props.channel.id,n.props.user.id,!0,!1);case 2:t=e.sent,(r=t.error)?n.setState({serverError:r.message}):n.props.actions.getChannelStats(n.props.channel.id);case 5:case"end":return e.stop()}},e)}))),ON(EN(n),"handleMakeChannelAdmin",yN(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.props.actions.updateChannelMemberSchemeRoles(n.props.channel.id,n.props.user.id,!0,!0);case 2:t=e.sent,(r=t.error)?n.setState({serverError:r.message}):n.props.actions.getChannelStats(n.props.channel.id);case 5:case"end":return e.stop()}},e)}))),n.state={serverError:null,removing:!1},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_N(e,t)}(t,_.a.Component),n=t,(r=[{key:"renderRole",value:function(e){return e?_.a.createElement(Y.c,{id:"channel_members_dropdown.channel_admin",defaultMessage:"Channel Admin"}):_.a.createElement(Y.c,{id:"channel_members_dropdown.channel_member",defaultMessage:"Channel Member"})}},{key:"render",value:function(){var e=this.props.isLicensed,t=e&&(T.M(this.props.isLicensed,this.props.channelMember.roles)||this.props.channelMember.scheme_admin),n=null;if(this.state.serverError&&(n=_.a.createElement("div",{className:"has-error"},_.a.createElement("label",{className:"has-error control-label"},this.state.serverError))),this.props.user.id===this.props.currentUserId)return null;var r=this.renderRole(t);if(this.props.canChangeMemberRoles){var o=this.props.canRemoveMember&&this.props.channel.name!==P.i.DEFAULT_CHANNEL&&!this.props.channel.group_constrained,a=t,i=e&&!t;if(a||i){var s=this.props,c=s.index,l=s.totalUsers,u=!1;return l>3&&l-c<=3&&(u=!0),_.a.createElement(pu.a,null,_.a.createElement("button",{className:"dropdown-toggle theme color--link style--none",type:"button"},_.a.createElement("span",null,r," "),_.a.createElement("span",{className:"sr-only"},this.props.user.username),_.a.createElement(nO,null)),_.a.createElement(fu.a,{openLeft:!0,openUp:u,ariaLabel:T.ab("channel_members_dropdown.menuAriaLabel","Channel member role change")},_.a.createElement(Dp.a,{show:a,onClick:this.handleMakeChannelMember,text:T.ab("channel_members_dropdown.make_channel_member","Make Channel Member")}),_.a.createElement(Dp.a,{show:i,onClick:this.handleMakeChannelAdmin,text:T.ab("channel_members_dropdown.make_channel_admin","Make Channel Admin")}),_.a.createElement(Dp.a,{show:o,onClick:this.handleRemoveFromChannel,text:T.ab("channel_members_dropdown.remove_from_channel","Remove From Channel")}),n))}}return this.props.canRemoveMember&&this.props.channel.name!==P.i.DEFAULT_CHANNEL&&!this.props.channel.group_constrained?_.a.createElement("button",{id:"removeMember",type:"button",className:"btn btn-danger btn-message",onClick:this.handleRemoveFromChannel,disabled:this.state.removing},_.a.createElement("span",{className:"sr-only"},r),_.a.createElement("span",{className:"sr-only"},this.props.user.username),_.a.createElement(Y.c,{id:"channel_members_dropdown.remove_member",defaultMessage:"Remove Member"})):this.props.channel.name===P.i.DEFAULT_CHANNEL?_.a.createElement("div",null):_.a.createElement("div",null,this.renderRole(t))}}])&&gN(n.prototype,r),o&&gN(n,o),t}();ON(wN,"propTypes",{channel:v.a.object.isRequired,user:v.a.object.isRequired,currentUserId:v.a.string.isRequired,channelMember:v.a.object.isRequired,isLicensed:v.a.bool.isRequired,canChangeMemberRoles:v.a.bool.isRequired,canRemoveMember:v.a.bool.isRequired,index:v.a.number.isRequired,totalUsers:v.a.number.isRequired,actions:v.a.shape({getChannelStats:v.a.func.isRequired,updateChannelMemberSchemeRoles:v.a.func.isRequired,removeChannelMember:v.a.func.isRequired}).isRequired});var CN=Object(r.connect)(function(e,t){var n=t.channel,r=Object(D.haveIChannelPermission)(e,{channel:n.id,team:n.team_id,permission:L.Permissions.MANAGE_CHANNEL_ROLES}),o="true"===Object(u.getLicense)(e).IsLicensed,a=Object(So.a)(n);return{currentUserId:Object(p.getCurrentUserId)(e),isLicensed:o,canChangeMemberRoles:r,canRemoveMember:a}},function(e){return{actions:Object(o.bindActionCreators)({getChannelStats:s.getChannelStats,updateChannelMemberSchemeRoles:s.updateChannelMemberSchemeRoles,removeChannelMember:s.removeChannelMember},e)}})(wN);function SN(e){return(SN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function PN(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function jN(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){PN(a,r,o,i,s,"next",e)}function s(e){PN(a,r,o,i,s,"throw",e)}i(void 0)})}}function TN(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function kN(e){return(kN=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function NN(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function RN(e,t){return(RN=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function MN(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var IN=50,xN=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=kN(t).call(this,e),n=!o||"object"!==SN(o)&&"function"!=typeof o?NN(r):o,MN(NN(n),"loadComplete",function(){n.setState({loading:!1})}),MN(NN(n),"nextPage",function(e){n.props.actions.loadProfilesAndTeamMembersAndChannelMembers(e+1,IN)}),MN(NN(n),"handleSearch",function(e){n.props.actions.setModalSearchTerm(e)}),n.searchTimeoutId=0,n.state={loading:!0},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&RN(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.actions,r=t.currentChannelId,o=t.currentTeamId;n.loadProfilesAndTeamMembersAndChannelMembers(0,P.Q.PROFILE_CHUNK_SIZE,o,r).then(function(t){t.data&&e.loadComplete()}),n.getChannelStats(r)}},{key:"componentWillUnmount",value:function(){this.props.actions.setModalSearchTerm("")}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this;if(this.props.searchTerm!==e.searchTerm){clearTimeout(this.searchTimeoutId);var n=e.searchTerm;if(""===n)return this.loadComplete(),void(this.searchTimeoutId="");var r=setTimeout(jN(regeneratorRuntime.mark(function o(){var a,i;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,t.props.actions.searchProfiles(n,{team_id:e.currentTeamId,in_channel_id:e.currentChannelId});case 2:if(a=o.sent,i=a.data,r===t.searchTimeoutId){o.next=6;break}return o.abrupt("return");case 6:t.setState({loading:!0}),e.actions.loadStatusesForProfilesList(i),e.actions.loadTeamMembersAndChannelMembersForProfilesList(i,e.currentTeamId,e.currentChannelId).then(function(e){e.data&&t.loadComplete()});case 9:case"end":return o.stop()}},o)})),P.Q.SEARCH_TIMEOUT_MILLISECONDS);this.searchTimeoutId=r}}},{key:"render",value:function(){var e=0!==this.props.channel.delete_at;return _.a.createElement(Z_,{users:this.props.usersToDisplay,usersPerPage:IN,total:this.props.totalChannelMembers,nextPage:this.nextPage,search:this.handleSearch,actions:e?[]:[CN],actionUserProps:this.props.actionUserProps,focusOnMount:!j.m()})}}])&&TN(n.prototype,r),o&&TN(n,o),t}();function AN(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}MN(xN,"propTypes",{currentTeamId:v.a.string.isRequired,currentChannelId:v.a.string.isRequired,searchTerm:v.a.string.isRequired,usersToDisplay:v.a.arrayOf(v.a.object).isRequired,actionUserProps:v.a.object.isRequired,totalChannelMembers:v.a.number.isRequired,channel:v.a.object.isRequired,actions:v.a.shape({searchProfiles:v.a.func.isRequired,getChannelStats:v.a.func.isRequired,setModalSearchTerm:v.a.func.isRequired,loadProfilesAndTeamMembersAndChannelMembers:v.a.func.isRequired,loadStatusesForProfilesList:v.a.func.isRequired,loadTeamMembersAndChannelMembersForProfilesList:v.a.func.isRequired}).isRequired});var LN=Object(Kc.a)(function(e,t){return t},f.getMembersInCurrentTeam,d.getMembersInCurrentChannel,d.getCurrentChannel,function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o={},a=[],i=0;i<e.length;i++){var s=e[i];t[s.id]&&n[s.id]&&0===s.delete_at&&(a.push(s),o[s.id]={channel:r,teamMember:t[s.id],channelMember:n[s.id]})}return{usersToDisplay:a.sort(ja.sortByUsername),actionUserProps:o}});var DN=Object(r.connect)(function(e){var t,n=e.views.search.modalSearch;t=n?Object(p.searchProfilesInCurrentChannel)(e,n):Object(p.getProfilesInCurrentChannel)(e);var r=Object(d.getCurrentChannelStats)(e)||{member_count:0};return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){AN(e,t,n[t])})}return e}({},LN(e,t),{currentTeamId:e.entities.teams.currentTeamId,currentChannelId:e.entities.channels.currentChannelId,searchTerm:n,totalChannelMembers:r.member_count})},function(e){return{actions:Object(o.bindActionCreators)({searchProfiles:i.searchProfiles,getChannelStats:s.getChannelStats,setModalSearchTerm:G_.a,loadProfilesAndTeamMembersAndChannelMembers:lc.h,loadStatusesForProfilesList:m.b,loadTeamMembersAndChannelMembersForProfilesList:lc.l},e)}})(xN);function UN(e){return(UN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qN(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function HN(e){return(HN=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function FN(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BN(e,t){return(BN=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function GN(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var VN=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=HN(t).call(this,e),n=!o||"object"!==UN(o)&&"function"!=typeof o?FN(r):o,GN(FN(n),"handleHide",function(){n.setState({show:!1})}),GN(FN(n),"handleExit",function(){n.props.onHide()}),GN(FN(n),"onAddNewMembersButton",function(){var e=n.props,t=e.channel;e.actions.openModal({modalId:P.r.CHANNEL_INVITE,dialogType:mN,dialogProps:{channel:t}}),n.handleExit()}),n.state={show:!0},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&BN(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e=0!==this.props.channel.delete_at;return _.a.createElement("div",null,_.a.createElement(z.a,{dialogClassName:"a11y__modal more-modal more-modal--action",show:this.state.show,onHide:this.handleHide,onExited:this.handleExit,role:"dialog","aria-labelledby":"channelMembersModalLabel"},_.a.createElement(z.a.Header,{closeButton:!0},_.a.createElement(z.a.Title,{componentClass:"h1",id:"channelMembersModalLabel"},_.a.createElement("span",{className:"name"},this.props.channel.display_name),_.a.createElement(Y.c,{id:"channel_members_modal.members",defaultMessage:" Members"})),this.props.canManageChannelMembers&&!e&&_.a.createElement("a",{id:"showInviteModal",className:"btn btn-md btn-primary",href:"#",onClick:this.onAddNewMembersButton},_.a.createElement(Y.c,{id:"channel_members_modal.addNew",defaultMessage:" Add New Members"}))),_.a.createElement(z.a.Body,null,_.a.createElement(DN,{channel:this.props.channel}))))}}])&&qN(n.prototype,r),o&&qN(n,o),t}();GN(VN,"propTypes",{canManageChannelMembers:v.a.bool.isRequired,channel:v.a.object.isRequired,onHide:v.a.func.isRequired,actions:v.a.shape({openModal:v.a.func.isRequired}).isRequired});var WN=Object(r.connect)(function(e){return{canManageChannelMembers:Object(d.canManageChannelMembers)(e)}},function(e){return{actions:Object(o.bindActionCreators)({openModal:U.b},e)}})(VN);function KN(e){return(KN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zN(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function YN(e,t){return!t||"object"!==KN(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function QN(e){return(QN=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ZN(e,t){return(ZN=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var JN=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),YN(this,QN(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ZN(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){return _.a.createElement("span",this.props,_.a.createElement(Y.c,{id:"generic_icons.member",defaultMessage:"Member Icon"},function(e){return _.a.createElement("svg",{width:"14px",height:"14px",viewBox:"0 0 16 16",role:"icon","aria-label":e},_.a.createElement("g",{id:"Symbols",stroke:"none",strokeWidth:"1",fill:"inherit",fillRule:"evenodd"},_.a.createElement("g",{id:"Channel-Header/Web-HD",transform:"translate(-725.000000, -32.000000)",fillRule:"nonzero",fill:"inherit"},_.a.createElement("g",{id:"Channel-Header"},_.a.createElement("g",{id:"user-count",transform:"translate(676.000000, 22.000000)"},_.a.createElement("path",{d:"M64.9481342,24 C64.6981342,20.955 63.2551342,19.076 60.6731342,18.354 C61.4831342,17.466 61.9881342,16.296 61.9881342,15 C61.9881342,12.238 59.7501342,10 56.9881342,10 C54.2261342,10 51.9881342,12.238 51.9881342,15 C51.9881342,16.297 52.4941342,17.467 53.3031342,18.354 C50.7221342,19.076 49.2771342,20.955 49.0271342,24 C49.0161342,24.146 49.0061342,24.577 49.0001342,25.001 C48.9911342,25.553 49.4361342,26 49.9881342,26 L63.9881342,26 C64.5411342,26 64.9851342,25.553 64.9761342,25.001 C64.9701342,24.577 64.9601342,24.146 64.9481342,24 Z M56.9881342,12 C58.6421342,12 59.9881342,13.346 59.9881342,15 C59.9881342,16.654 58.6421342,18 56.9881342,18 C55.3341342,18 53.9881342,16.654 53.9881342,15 C53.9881342,13.346 55.3341342,12 56.9881342,12 Z M51.0321342,24 C51.2981342,21.174 52.7911342,20 55.9881342,20 L57.9881342,20 C61.1851342,20 62.6781342,21.174 62.9441342,24 L51.0321342,24 Z",id:"User_4_x2C__Profile_5-Copy-9"}))))))}))}}])&&zN(n.prototype,r),o&&zN(n,o),t}();function XN(e){return(XN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $N(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function eR(e,t){return!t||"object"!==XN(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function tR(e){return(tR=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function nR(e,t){return(nR=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var rR=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),eR(this,tR(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nR(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){return _.a.createElement("span",this.props,_.a.createElement(Y.c,{id:"generic_icons.message",defaultMessage:"Message Icon"},function(e){return _.a.createElement("svg",{width:"18px",height:"16px",viewBox:"0 0 18 16",role:"icon","aria-label":e},_.a.createElement("g",{stroke:"none",strokeWidth:"1",fill:"inherit",fillRule:"evenodd"},_.a.createElement("g",{transform:"translate(-200.000000, -174.000000)",fill:"inherit"},_.a.createElement("g",{transform:"translate(200.000000, 174.000000)"},_.a.createElement("path",{d:"M7.2546625,1.42801356 C10.458475,1.42801356 12.999475,3.24528136 12.999475,5.52023729 C12.9895,8.04188475 10.6062625,9.89326102 7.40245,9.89326102 C7.40245,9.89326102 6.9134125,9.91229831 6.4115125,9.83747119 L5.82535,9.79622373 L5.15335,10.3586169 C4.997425,10.5397356 4.3199125,11.1095322 3.736375,11.4794373 C4.0915375,10.4598847 4.07605,10.1370441 4.07605,10.1370441 L4.1251375,9.49004068 L3.55315,9.19549153 C2.0986375,8.44616271 1.4444875,6.88616271 1.4444875,5.52023729 C1.4444875,3.24528136 4.05085,1.42801356 7.2546625,1.42801356 M7.2546625,0.370386441 C3.465475,0.370386441 0.3944875,2.65829831 0.3944875,5.52023729 C0.3944875,7.3028678 1.2623125,9.20342373 3.0751375,10.1370441 C3.0751375,10.1478847 3.07225,10.1560814 3.07225,10.1679797 C3.07225,10.9426915 2.43175,12.0048136 2.1794875,12.4429356 L2.1805375,12.4429356 C2.1605875,12.4902644 2.148775,12.5420881 2.148775,12.5973492 C2.148775,12.8141627 2.322025,12.9881424 2.5375375,12.9881424 C2.5693,12.9881424 2.6210125,12.9815322 2.6393875,12.9815322 C2.6446375,12.9815322 2.6467375,12.9815322 2.6462125,12.9831186 C3.986275,12.762339 5.9642125,11.2435864 6.2576875,10.8837288 C6.5585125,10.928678 6.761425,10.9358169 7.0136875,10.9358169 C7.120525,10.9358169 7.2347125,10.9342305 7.3696375,10.9342305 C11.1583,10.9342305 14.094625,8.75446102 14.049475,5.52023729 C14.049475,2.65829831 11.0435875,0.370386441 7.2546625,0.370386441"}),_.a.createElement("path",{d:"M17.2055125,9.79172881 C17.2055125,8.35811525 16.6498,7.26532203 15.2624875,6.4451322 C15.228625,6.82614237 15.120475,7.23517966 15.0031375,7.59477288 C15.8998375,8.21903729 16.1555125,8.85995932 16.1555125,9.79172881 C16.1555125,10.9323797 15.62815,11.7597085 14.40175,12.3919051 L13.879375,12.653139 C13.879375,12.653139 13.9337125,14.0082237 14.0140375,14.3511593 C12.9895,13.5946915 12.6374875,12.9630237 12.6374875,12.9630237 L12.08545,13.0486915 C11.86705,13.0809492 11.276425,13.0812136 11.276425,13.0812136 C9.85,13.0812136 8.7929125,12.7388068 7.8909625,12.0278169 C8.135875,12.0124814 6.42805,12.0132746 6.3899875,12.0468542 C7.4326375,13.3297559 9.1373125,14.1388407 11.276425,14.1388407 C11.3927125,14.1388407 11.49115,14.1398983 11.58355,14.1398983 C11.801425,14.1398983 11.9773,14.1338169 12.237175,14.095478 C12.491275,14.4058915 13.914025,15.7728746 15.0724375,15.9629831 C15.0719125,15.9619254 15.073225,15.9619254 15.078475,15.9619254 C15.0939625,15.9619254 15.13885,15.967478 15.16615,15.967478 C15.3522625,15.967478 15.5024125,15.8167661 15.5024125,15.6293017 C15.5024125,15.5817085 15.49165,15.5367593 15.47485,15.4960407 L15.4759,15.4960407 C15.258025,15.117939 14.9159875,14.0129831 14.9159875,13.3435051 C14.9159875,13.3331932 14.9128375,13.3260542 14.9128375,13.3168 C16.4797,12.5095661 17.2055125,11.3321627 17.2055125,9.79172881"})))))}))}}])&&$N(n.prototype,r),o&&$N(n,o),t}();function oR(e){return(oR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function aR(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function iR(e){return(iR=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function sR(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cR(e,t){return(cR=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function lR(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var uR=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=iR(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==oR(o)&&"function"!=typeof o?sR(r):o,lR(sR(n),"handleClick",function(){n.props.onItemClick(n.props.user)}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&cR(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){if(!this.props.user)return null;var e,t=T.v(this.props.user);if(!t)return null;this.props.showMessageIcon&&(e=_.a.createElement(rR,{className:"icon icon__message","aria-hidden":"true"}));var n=this.props.user.is_bot?" more-modal__row--bot":"",r=this.props.user.is_bot?null:this.props.status;return _.a.createElement("div",{className:"more-modal__row"+n,onClick:this.handleClick},_.a.createElement(bd.a,{src:ii.Client4.getProfilePictureUrl(this.props.user.id,this.props.user.last_picture_update),status:r,width:"32",height:"32"}),_.a.createElement("div",{className:"more-modal__details d-flex whitespace--nowrap"},_.a.createElement("div",{className:"more-modal__name"},t),_.a.createElement(ka.a,{show:Boolean(this.props.user.is_bot),className:"badge-popoverlist"})),_.a.createElement("div",{className:"more-modal__actions"},e))}}])&&aR(n.prototype,r),o&&aR(n,o),t}();function pR(e){return(pR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fR(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function dR(e){return(dR=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function mR(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hR(e,t){return(hR=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function bR(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}lR(uR,"propTypes",{showMessageIcon:v.a.bool.isRequired,onItemClick:v.a.func.isRequired,status:v.a.string.isRequired,user:v.a.object.isRequired}),lR(uR,"defaultProps",{status:P.O.OFFLINE});var yR=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=dR(t).call(this,e),n=!o||"object"!==pR(o)&&"function"!=typeof o?mR(r):o,bR(mR(n),"sortUsers",function(e,t){return T.jb(e,t)}),bR(mR(n),"handleShowDirectChannel",function(e){var t=n.props.actions,r=e.id;r&&t.openDirectChannelToUserId(r).then(function(e){var t=e.data;t&&Q.a.push(n.props.teamUrl+"/channels/"+t.name),n.closePopover()})}),bR(mR(n),"closePopover",function(){n.setState({showPopover:!1})}),bR(mR(n),"showMembersModal",function(e){e.preventDefault(),n.setState({showPopover:!1,showChannelMembersModal:!0})}),bR(mR(n),"hideChannelMembersModal",function(){n.setState({showChannelMembersModal:!1})}),bR(mR(n),"showChannelInviteModal",function(){n.setState({showChannelInviteModal:!0})}),bR(mR(n),"hideChannelInviteModal",function(){n.setState({showChannelInviteModal:!1})}),bR(mR(n),"hideTeamMembersModal",function(){n.setState({showTeamMembersModal:!1})}),bR(mR(n),"handleGetProfilesInChannel",function(e){n.setState({popoverTarget:e.target,showPopover:!n.state.showPopover}),n.props.actions.loadProfilesAndStatusesInChannel(n.props.channel.id,0,void 0,"status")}),bR(mR(n),"getTargetPopover",function(){return n.state.popoverTarget}),n.state={showPopover:!1,showTeamMembersModal:!1,showChannelMembersModal:!1,showChannelInviteModal:!1,sortedUsers:n.sortUsers(e.users,e.statuses)},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hR(e,t)}(t,_.a.Component),n=t,(r=[{key:"componentDidUpdate",value:function(){qc()(".member-list__popover .popover-content .more-modal__body").perfectScrollbar()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){if(this.props.users!==e.users||this.props.statuses!==e.statuses){var t=this.sortUsers(e.users,e.statuses);this.setState({sortedUsers:t})}}},{key:"render",value:function(){var e,t=this,n=this.props.channel.type===P.i.DM_CHANNEL,r=this.state.sortedUsers.map(function(e){return _.a.createElement(uR,{key:e.id,onItemClick:t.handleShowDirectChannel,showMessageIcon:t.props.currentUserId!==e.id&&!n,status:t.props.statuses[e.id],user:e})}),o=0!==this.props.channel.delete_at;if(this.props.channel.type!==P.i.GM_CHANNEL&&!o){var a=_.a.createElement(Y.c,{id:"members_popover.manageMembers",defaultMessage:"Manage Members"}),i=Object(So.a)(this.props.channel);!(this.props.channel.name===P.i.DEFAULT_CHANNEL)&&i||(a=_.a.createElement(Y.c,{id:"members_popover.viewMembers",defaultMessage:"View Members"})),e=_.a.createElement("div",{className:"more-modal__button",key:"popover-member-more"},_.a.createElement("button",{className:"btn btn-link",onClick:this.showMembersModal},a))}var s=this.props.memberCount,c="-";s>0&&(c=s.toString());var l,u,p,f=_.a.createElement(Y.c,{id:"members_popover.title",defaultMessage:"Channel Members"});this.state.showChannelMembersModal&&(l=_.a.createElement(WN,{onHide:this.hideChannelMembersModal,showInviteModal:this.showChannelInviteModal,channel:this.props.channel})),this.state.showTeamMembersModal&&(u=_.a.createElement(RO,{onHide:this.hideTeamMembersModal})),this.state.showChannelInviteModal&&(p=_.a.createElement(mN,{onHide:this.hideChannelInviteModal,channel:this.props.channel}));var d=_.a.createElement(El.a,{id:"channelMembersTooltip"},_.a.createElement(Y.c,{id:"channel_header.channelMembers",defaultMessage:"Members"})),m="".concat(T.ab("channel_header.channelMembers","Members")).toLowerCase();return _.a.createElement("div",{id:"channelMember"},_.a.createElement("button",{id:"member_popover","aria-label":m,className:"style--none member-popover__trigger channel-header__icon wide "+(this.state.showPopover?"active":""),ref:"member_popover_target",onClick:this.handleGetProfilesInChannel},_.a.createElement(vl.a,{delayShow:P.i.OVERLAY_TIME_DELAY,placement:"bottom",overlay:d},_.a.createElement("div",null,_.a.createElement("span",{id:"channelMemberCountText",className:"icon__text"},c),_.a.createElement(JN,{id:"channelMemberIcon",className:"icon icon__members","aria-hidden":"true"})))),_.a.createElement(ie.a,{rootClose:!0,onHide:this.closePopover,show:this.state.showPopover,target:this.getTargetPopover,placement:"bottom"},_.a.createElement(Vy.a,{ref:"memebersPopover",className:"member-list__popover",id:"member-list-popover"},_.a.createElement("div",{className:"more-modal__header"},f,this.props.channel.group_constrained&&_.a.createElement("div",{className:"subhead"},_.a.createElement(Y.c,{id:"channel_header.groupConstrained",defaultMessage:"Members managed by linked groups."}))),_.a.createElement("div",{className:"more-modal__body"},_.a.createElement("div",{className:"more-modal__list"},r)),e)),l,u,p)}}])&&fR(n.prototype,r),o&&fR(n,o),t}();bR(yR,"propTypes",{channel:v.a.object.isRequired,statuses:v.a.object.isRequired,users:v.a.array.isRequired,memberCount:v.a.number,currentUserId:v.a.string.isRequired,teamUrl:v.a.string,actions:v.a.shape({openModal:v.a.func.isRequired,loadProfilesAndStatusesInChannel:v.a.func.isRequired,openDirectChannelToUserId:v.a.func.isRequired}).isRequired});var gR=Object(r.connect)(function(){var e=Object(p.makeGetProfilesInChannel)();return function(t,n){var r=Object(d.getAllChannelStats)(t)[n.channel.id]||{},o=e(t,n.channel.id,!0);return{currentUserId:Object(p.getCurrentUserId)(t),memberCount:r.member_count,users:o,statuses:Object(p.getUserStatuses)(t),teamUrl:Object(f.getCurrentRelativeTeamUrl)(t)}}},function(e){return{actions:Object(o.bindActionCreators)({openModal:U.b,loadProfilesAndStatusesInChannel:lc.f,openDirectChannelToUserId:Ya.e},e)}})(yR);function vR(e){return(vR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ER(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _R(e,t){return!t||"object"!==vR(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function OR(e){return(OR=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wR(e,t){return(wR=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var CR=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),_R(this,OR(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wR(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){return _.a.createElement("span",this.props,_.a.createElement(Y.c,{id:"generic_icons.pin",defaultMessage:"Pin Icon"},function(e){return _.a.createElement("svg",{width:"14px",height:"14px",viewBox:"0 0 16 16",version:"1.1",role:"icon","aria-label":e},_.a.createElement("g",{id:"Symbols",stroke:"inherit",strokeWidth:"1",fill:"inherit",fillRule:"evenodd"},_.a.createElement("g",{transform:"translate(-775.000000, -32.000000)",fillRule:"nonzero",fill:"inherit"},_.a.createElement("g",null,_.a.createElement("g",{transform:"translate(764.000000, 22.000000)"},_.a.createElement("g",{transform:"translate(10.000000, 10.000000)"},_.a.createElement("path",{d:"M16.456,7.291 L9.483,0.25 C9.31,0.078 9.178,0 9.08,0 C8.896,0 8.831,0.276 8.831,0.732 L8.831,3.044 L5.831,5.96 L2.578,6.268 C1.887,6.405 1.668,6.917 2.167,7.41 L4.781,10.011 L3.83,10.961 L1.05,15.511 C0.93,15.761 1.03,15.862 1.28,15.74 L5.83,12.961 L6.786,12.005 L9.359,14.565 C9.556,14.76 9.754,14.854 9.929,14.854 C10.197,14.854 10.413,14.634 10.497,14.219 L10.83,10.961 L13.746,7.961 L16.082,7.961 C16.788,7.961 16.955,7.785 16.456,7.291 Z M12.312,6.567 L9.396,9.567 L8.911,10.065 L8.84,10.757 L8.797,11.184 L5.589,7.992 L6.018,7.952 L6.72,7.886 L7.225,7.396 L10.225,4.48 L10.547,4.167 L12.616,6.256 L12.312,6.567 Z"})))))))}))}}])&&ER(n.prototype,r),o&&ER(n,o),t}();function SR(e){return(SR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function PR(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function jR(e,t){return!t||"object"!==SR(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function TR(e){return(TR=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function kR(e,t){return(kR=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var NR=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),jR(this,TR(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kR(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){return _.a.createElement(fu.a,{id:"channelHeaderDropdownMenu",ariaLabel:Object(T.ab)("channel_header.menuAriaLabel","Channel Menu").toLowerCase()},_.a.createElement(gx,{isMobile:!1}))}}])&&PR(n.prototype,r),o&&PR(n,o),t}();function RR(e){return(RR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function MR(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function IR(e){return(IR=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xR(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function AR(e,t){return(AR=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function LR(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var DR=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=IR(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==RR(o)&&"function"!=typeof o?xR(r):o,LR(xR(n),"createButton",function(e){var t=function(){return n.fireAction(e)};return n.props.isDropdown?_.a.createElement("li",{key:"mobileChannelHeaderItem"+e.id,role:"presentation",className:"MenuItem"},_.a.createElement("a",{role:"menuitem",href:"#",onClick:t},e.dropdownText)):_.a.createElement("li",{className:"flex-parent--center"},_.a.createElement("button",{className:"navbar-toggle navbar-right__icon",onClick:t},_.a.createElement("span",{className:"icon navbar-plugin-button"},e.icon)))}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&AR(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"createList",value:function(e){return e.map(this.createButton)}},{key:"fireAction",value:function(e){return e.action(this.props.channel,this.props.channelMember)}},{key:"render",value:function(){var e=this.props.components||[];return 0===e.length?null:1===e.length?this.createButton(e[0]):this.props.isDropdown?this.createList(e):null}}])&&MR(n.prototype,r),o&&MR(n,o),t}();LR(DR,"propTypes",{components:v.a.array,isDropdown:v.a.bool.isRequired,channel:v.a.object.isRequired,channelMember:v.a.object.isRequired,theme:v.a.object.isRequired});var UR=Object(r.connect)(function(e){return{channelMember:Object(d.getMyCurrentChannelMembership)(e),components:e.plugins.components.MobileChannelHeaderButton,theme:Object(l.getTheme)(e)}})(DR);function qR(e){var t=e.section,n=e.isCollapsed,r=e.memberNotifyLevel,o=e.globalNotifyLevel,a=e.ignoreChannelMentions;if(r===P.s.DEFAULT&&o){Object(Ne.b)("channel_notifications.levels.default"),Object(Ne.b)("channel_notifications.levels.all"),Object(Ne.b)("channel_notifications.levels.mention"),Object(Ne.b)("channel_notifications.levels.none");var i="channel_notifications.levels."+o;return _.a.createElement(_.a.Fragment,null,_.a.createElement(Y.c,{id:"channel_notifications.globalDefault",defaultMessage:"Global default"}),_.a.createElement("span",null," ("),_.a.createElement(Y.c,{id:i,defaultMessage:o}),_.a.createElement("span",null,")"))}return r===P.s.MENTION&&t===P.t.MARK_UNREAD?n?_.a.createElement(Y.c,{id:"channel_notifications.muteChannel.on.title.collapse",defaultMessage:"Mute is enabled. Desktop, email and push notifications will not be sent for this channel."}):_.a.createElement(Y.c,{id:"channel_notifications.muteChannel.on.title",defaultMessage:"On"}):t===P.t.IGNORE_CHANNEL_MENTIONS&&a===P.n.ON?_.a.createElement(Y.c,{id:"channel_notifications.ignoreChannelMentions.on.title",defaultMessage:"On"}):t===P.t.IGNORE_CHANNEL_MENTIONS&&a===P.n.OFF?_.a.createElement(Y.c,{id:"channel_notifications.ignoreChannelMentions.off.title",defaultMessage:"Off"}):r===P.s.MENTION?_.a.createElement(Y.c,{id:"channel_notifications.onlyMentions",defaultMessage:"Only for mentions"}):t!==P.t.DESKTOP&&t!==P.t.PUSH||r!==P.s.ALL?t===P.t.MARK_UNREAD&&r===P.s.ALL?_.a.createElement(Y.c,{id:"channel_notifications.muteChannel.off.title",defaultMessage:"Off"}):_.a.createElement(Y.c,{id:"channel_notifications.never",defaultMessage:"Never"}):_.a.createElement(Y.c,{id:"channel_notifications.allActivity",defaultMessage:"For all activity"})}function HR(e){var t=e.section;return t===P.t.DESKTOP?_.a.createElement(Y.c,{id:"channel_notifications.sendDesktop",defaultMessage:"Send desktop notifications"}):t===P.t.PUSH?_.a.createElement(Y.c,{id:"channel_notifications.push",defaultMessage:"Send mobile push notifications"}):t===P.t.MARK_UNREAD?_.a.createElement(Y.c,{id:"channel_notifications.muteChannel.settings",defaultMessage:"Mute Channel"}):t===P.t.IGNORE_CHANNEL_MENTIONS?_.a.createElement(Y.c,{id:"channel_notifications.ignoreChannelMentions",defaultMessage:"Ignore mentions for @channel, @here and @all"}):null}function FR(e){var t=e.onExpandSection,n=e.globalNotifyLevel,r=e.memberNotifyLevel,o=e.section,a=e.ignoreChannelMentions;return _.a.createElement(AO.a,{title:_.a.createElement(HR,{section:o}),describe:_.a.createElement(qR,{section:o,ignoreChannelMentions:a,memberNotifyLevel:r,globalNotifyLevel:n,isCollapsed:!0}),updateSection:t,section:o})}function BR(e){switch(e.section){case P.t.DESKTOP:return _.a.createElement("span",null,_.a.createElement(Y.c,{id:"channel_notifications.override",defaultMessage:'Selecting an option other than "Default" will override the global notification settings. Desktop notifications are available on Firefox, Safari, and Chrome.'}));case P.t.PUSH:return _.a.createElement("span",null,_.a.createElement(Y.c,{id:"channel_notifications.overridePush",defaultMessage:'Selecting an option other than "Global default" will override the global notification settings for mobile push notifications in account settings. Push notifications must be enabled by the System Admin.'}));case P.t.MARK_UNREAD:return _.a.createElement("span",null,_.a.createElement(Y.c,{id:"channel_notifications.muteChannel.help",defaultMessage:"Muting turns off desktop, email and push notifications for this channel. The channel will not be marked as unread unless you are mentioned."}));case P.t.IGNORE_CHANNEL_MENTIONS:return _.a.createElement("span",null,_.a.createElement(Y.c,{id:"channel_notifications.ignoreChannelMentions.help",defaultMessage:"When enabled, @channel, @here and @all will not trigger mentions or mention notifications in this channel."}));default:return null}}function GR(e){var t=e.section,n=e.memberNotifyLevel,r=e.globalNotifyLevel,o=e.onChange,a=e.onSubmit,i=e.serverError,s=e.onCollapseSection,c=e.ignoreChannelMentions,l=[_.a.createElement("div",{key:"channel-notification-level-radio"},(t===P.t.DESKTOP||t===P.t.PUSH)&&_.a.createElement("fieldset",null,_.a.createElement("div",{className:"radio"},_.a.createElement("label",{className:""},_.a.createElement("input",{id:"channelNotificationGlobalDefault",name:"channelDesktopNotifications",type:"radio",value:P.s.DEFAULT,checked:n===P.s.DEFAULT,onChange:o}),_.a.createElement(qR,{section:t,memberNotifyLevel:P.s.DEFAULT,globalNotifyLevel:r}))),_.a.createElement("div",{className:"radio"},_.a.createElement("label",{className:""},_.a.createElement("input",{id:"channelNotificationAllActivity",name:"channelDesktopNotifications",type:"radio",value:P.s.ALL,checked:n===P.s.ALL,onChange:o}),_.a.createElement(qR,{section:t,memberNotifyLevel:P.s.ALL}))),_.a.createElement("div",{className:"radio"},_.a.createElement("label",{className:""},_.a.createElement("input",{id:"channelNotificationMentions",name:"channelDesktopNotifications",type:"radio",value:P.s.MENTION,checked:n===P.s.MENTION,onChange:o}),_.a.createElement(qR,{section:t,memberNotifyLevel:P.s.MENTION}))),_.a.createElement("div",{className:"radio"},_.a.createElement("label",null,_.a.createElement("input",{id:"channelNotificationNever",name:"channelDesktopNotifications",type:"radio",value:P.s.NONE,checked:n===P.s.NONE,onChange:o}),_.a.createElement(qR,{section:t,memberNotifyLevel:P.s.NONE})))),t===P.t.IGNORE_CHANNEL_MENTIONS&&_.a.createElement("fieldset",null,_.a.createElement("div",{className:"radio"},_.a.createElement("label",null,_.a.createElement("input",{id:"ignoreChannelMentionsOn",name:"ignoreChannelMentions",type:"radio",value:P.n.ON,checked:c===P.n.ON,onChange:o}),_.a.createElement(qR,{section:t,ignoreChannelMentions:P.n.ON,memberNotifyLevel:n,globalNotifyLevel:r}))),_.a.createElement("div",{className:"radio"},_.a.createElement("label",null,_.a.createElement("input",{id:"ignoreChannelMentionsOff",name:"ignoreChannelMentions",type:"radio",value:P.n.OFF,checked:c===P.n.OFF,onChange:o}),_.a.createElement(qR,{section:t,ignoreChannelMentions:P.n.OFF,memberNotifyLevel:n,globalNotifyLevel:r})))),t===P.t.MARK_UNREAD&&_.a.createElement("fieldset",null,_.a.createElement("div",{className:"radio"},_.a.createElement("label",{className:""},_.a.createElement("input",{id:"channelNotificationUnmute",name:"channelNotificationMute",type:"radio",value:P.s.MENTION,checked:n===P.s.MENTION,onChange:o}),_.a.createElement(qR,{section:t,memberNotifyLevel:P.s.MENTION}))),_.a.createElement("div",{className:"radio"},_.a.createElement("label",{className:""},_.a.createElement("input",{id:"channelNotificationMute",name:"channelNotificationMute",type:"radio",value:P.s.ALL,checked:n===P.s.ALL,onChange:o}),_.a.createElement(qR,{section:t,memberNotifyLevel:P.s.ALL})))))];return _.a.createElement(xO.a,{title:_.a.createElement(HR,{section:t}),inputs:l,submit:a,server_error:i,updateSection:s,extraInfo:_.a.createElement(BR,{section:t})})}function VR(e){return(VR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function WR(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function KR(e){return(KR=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function zR(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function YR(e,t){return(YR=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function QR(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}qR.propTypes={globalNotifyLevel:v.a.string,ignoreChannelMentions:v.a.string,memberNotifyLevel:v.a.string.isRequired,section:v.a.string.isRequired,isCollapsed:v.a.bool},HR.propTypes={section:v.a.string.isRequired},FR.propTypes={ignoreChannelMentions:v.a.string,onExpandSection:v.a.func.isRequired,globalNotifyLevel:v.a.string,memberNotifyLevel:v.a.string.isRequired,section:v.a.string.isRequired},BR.propTypes={section:v.a.string.isRequired},GR.propTypes={ignoreChannelMentions:v.a.string,onChange:v.a.func.isRequired,onCollapseSection:v.a.func.isRequired,onSubmit:v.a.func.isRequired,globalNotifyLevel:v.a.string,memberNotifyLevel:v.a.string.isRequired,section:v.a.string.isRequired,serverError:v.a.string};var ZR=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=KR(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==VR(o)&&"function"!=typeof o?zR(r):o,QR(zR(n),"handleOnChange",function(e){n.props.onChange(e.target.value)}),QR(zR(n),"handleExpandSection",function(){n.props.onUpdateSection(n.props.section)}),QR(zR(n),"handleCollapseSection",function(){n.props.onUpdateSection(P.t.NONE)}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&YR(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.expand,n=e.globalNotificationLevel,r=e.memberNotificationLevel,o=e.ignoreChannelMentions,a=e.onSubmit,i=e.section,s=e.serverError;return t?_.a.createElement(GR,{section:i,memberNotifyLevel:r,globalNotifyLevel:n,ignoreChannelMentions:o,onChange:this.handleOnChange,onSubmit:a,serverError:s,onCollapseSection:this.handleCollapseSection}):_.a.createElement(FR,{section:i,onExpandSection:this.handleExpandSection,memberNotifyLevel:r,globalNotifyLevel:n,ignoreChannelMentions:o})}}])&&WR(n.prototype,r),o&&WR(n,o),t}();function JR(e){return(JR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function XR(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function $R(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function eM(e){return(eM=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function tM(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nM(e,t){return(nM=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function rM(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}QR(ZR,"propTypes",{section:v.a.string.isRequired,expand:v.a.bool.isRequired,memberNotificationLevel:v.a.string.isRequired,ignoreChannelMentions:v.a.string,globalNotificationLevel:v.a.string,onChange:v.a.func.isRequired,onSubmit:v.a.func.isRequired,onUpdateSection:v.a.func.isRequired,serverError:v.a.string});var oM=function(e){function t(e){var n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=eM(t).call(this,e),n=!o||"object"!==JR(o)&&"function"!=typeof o?tM(r):o,rM(tM(n),"handleHide",function(){n.setState({show:!1})}),rM(tM(n),"handleExit",function(){n.updateSection(P.t.NONE),n.props.onHide()}),rM(tM(n),"updateSection",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P.t.NONE;if(qc()(".section-max").length&&qc()(".settings-modal .modal-body").scrollTop(0).perfectScrollbar("update"),n.setState({activeSection:e}),e===P.t.NONE){var t=n.props.channelMember&&n.props.channelMember.notify_props;n.resetStateFromNotifyProps(t,n.props.currentUser.notify_props)}}),rM(tM(n),"handleUpdateChannelNotifyProps",function(){var e,t=(e=regeneratorRuntime.mark(function e(t){var r,o,a,i,s,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.props,o=r.actions,a=r.channel,i=r.currentUser,e.next=3,o.updateChannelNotifyProps(i.id,a.id,t);case 3:s=e.sent,(c=s.error)?n.setState({serverError:c.message}):n.updateSection(P.t.NONE);case 6:case"end":return e.stop()}},e)}),function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){XR(a,r,o,i,s,"next",e)}function s(e){XR(a,r,o,i,s,"throw",e)}i(void 0)})});return function(e){return t.apply(this,arguments)}}()),rM(tM(n),"handleSubmitDesktopNotifyLevel",function(){var e=n.props.channelMember&&n.props.channelMember.notify_props,t=n.state.desktopNotifyLevel;if(e.desktop!==t){var r={desktop:t};n.handleUpdateChannelNotifyProps(r)}else n.updateSection(P.t.NONE)}),rM(tM(n),"handleUpdateDesktopNotifyLevel",function(e){n.setState({desktopNotifyLevel:e})}),rM(tM(n),"handleSubmitMarkUnreadLevel",function(){var e=n.props.channelMember&&n.props.channelMember.notify_props,t=n.state.markUnreadNotifyLevel;if(e.mark_unread!==t){var r={mark_unread:t};n.handleUpdateChannelNotifyProps(r)}else n.updateSection(P.t.NONE)}),rM(tM(n),"handleUpdateMarkUnreadLevel",function(e){n.setState({markUnreadNotifyLevel:e})}),rM(tM(n),"handleSubmitPushNotificationLevel",function(){var e=n.props.channelMember&&n.props.channelMember.notify_props,t=n.state.pushNotifyLevel;if(e.push!==t){var r={push:t};n.handleUpdateChannelNotifyProps(r)}else n.updateSection(P.t.NONE)}),rM(tM(n),"handleUpdatePushNotificationLevel",function(e){n.setState({pushNotifyLevel:e})}),rM(tM(n),"handleUpdateIgnoreChannelMentions",function(e){n.setState({ignoreChannelMentions:e})}),rM(tM(n),"handleSubmitIgnoreChannelMentions",function(){var e=n.props.channelMember&&n.props.channelMember.notify_props,t=n.state.ignoreChannelMentions;if(e.ignore_channel_mentions!==t){var r={ignore_channel_mentions:t};n.handleUpdateChannelNotifyProps(r)}else n.updateSection("")});var a=e.channelMember&&e.channelMember.notify_props;return n.state=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){rM(e,t,n[t])})}return e}({show:!0,activeSection:P.t.NONE,serverError:null},n.getStateFromNotifyProps(a,e.currentUser.notify_props)),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nM(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"componentDidUpdate",value:function(e){var t=e.channelMember&&e.channelMember.notify_props,n=this.props.channelMember&&this.props.channelMember.notify_props;T.c(n,t)||this.resetStateFromNotifyProps(n,this.props.currentUser.notify_props)}},{key:"resetStateFromNotifyProps",value:function(e,t){this.setState(this.getStateFromNotifyProps(e,t))}},{key:"getStateFromNotifyProps",value:function(e,t){var n=P.n.OFF;t.channel&&"false"===t.channel&&(n=P.n.ON);var r=e.ignore_channel_mentions;return r&&r!==P.n.DEFAULT||(r=n),{desktopNotifyLevel:e.desktop||P.s.DEFAULT,markUnreadNotifyLevel:e.mark_unread||P.s.ALL,pushNotifyLevel:e.push||P.s.DEFAULT,ignoreChannelMentions:r}}},{key:"render",value:function(){var e=this.state,t=e.activeSection,n=e.desktopNotifyLevel,r=e.markUnreadNotifyLevel,o=e.pushNotifyLevel,a=e.ignoreChannelMentions,i=e.serverError,s=this.props,c=s.channel,l=s.channelMember,u=s.currentUser,p=s.sendPushNotifications,f=null;return i&&(f=_.a.createElement("div",{className:"form-group has-error"},_.a.createElement("label",{className:"control-label"},i))),_.a.createElement(z.a,{dialogClassName:"a11y__modal settings-modal settings-modal--tabless",show:this.state.show,onHide:this.handleHide,onExited:this.handleExit,role:"dialog","aria-labelledby":"channelNotificationModalLabel"},_.a.createElement(z.a.Header,{closeButton:!0},_.a.createElement(z.a.Title,{componentClass:"h1",id:"channelNotificationModalLabel"},_.a.createElement(Y.c,{id:"channel_notifications.preferences",defaultMessage:"Notification Preferences for "}),_.a.createElement("span",{className:"name"},c.display_name))),_.a.createElement(z.a.Body,null,_.a.createElement("div",{className:"settings-table"},_.a.createElement("div",{className:"settings-content"},_.a.createElement("div",{ref:"wrapper",className:"user-settings"},_.a.createElement("br",null),_.a.createElement("div",{className:"divider-dark first"}),_.a.createElement(ZR,{section:P.t.MARK_UNREAD,expand:t===P.t.MARK_UNREAD,memberNotificationLevel:r,onChange:this.handleUpdateMarkUnreadLevel,onSubmit:this.handleSubmitMarkUnreadLevel,onUpdateSection:this.updateSection,serverError:i}),_.a.createElement("div",{className:"divider-light"}),_.a.createElement(ZR,{section:P.t.IGNORE_CHANNEL_MENTIONS,expand:t===P.t.IGNORE_CHANNEL_MENTIONS,memberNotificationLevel:r,ignoreChannelMentions:a,onChange:this.handleUpdateIgnoreChannelMentions,onSubmit:this.handleSubmitIgnoreChannelMentions,onUpdateSection:this.updateSection,serverError:i}),!Object(Ka.isChannelMuted)(l)&&_.a.createElement("div",null,_.a.createElement("div",{className:"divider-light"}),_.a.createElement(ZR,{section:P.t.DESKTOP,expand:t===P.t.DESKTOP,memberNotificationLevel:n,globalNotificationLevel:u.notify_props?u.notify_props.desktop:P.s.ALL,onChange:this.handleUpdateDesktopNotifyLevel,onSubmit:this.handleSubmitDesktopNotifyLevel,onUpdateSection:this.updateSection,serverError:i}),_.a.createElement("div",{className:"divider-light"}),p&&_.a.createElement(ZR,{section:P.t.PUSH,expand:t===P.t.PUSH,memberNotificationLevel:o,globalNotificationLevel:u.notify_props?u.notify_props.push:P.s.ALL,onChange:this.handleUpdatePushNotificationLevel,onSubmit:this.handleSubmitPushNotificationLevel,onUpdateSection:this.updateSection,serverError:i})),_.a.createElement("div",{className:"divider-dark"})))),f))}}])&&$R(n.prototype,r),o&&$R(n,o),t}();rM(oM,"propTypes",{onHide:v.a.func.isRequired,channel:v.a.object.isRequired,channelMember:v.a.object.isRequired,currentUser:v.a.object.isRequired,sendPushNotifications:v.a.bool.isRequired,actions:v.a.shape({updateChannelNotifyProps:v.a.func.isRequired})});var aM=Object(r.connect)(function(e){return{channelMember:Object(d.getMyCurrentChannelMembership)(e),sendPushNotifications:"true"===Object(u.getConfig)(e).SendPushNotifications}},function(e){return{actions:Object(o.bindActionCreators)({updateChannelNotifyProps:s.updateChannelNotifyProps},e)}})(oM);function iM(e){return(iM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sM(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function cM(e){return(cM=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function lM(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uM(e,t){return(uM=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function pM(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var fM={singleline:!1,mentionHighlight:!1},dM=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=cM(t).call(this,e),n=!o||"object"!==iM(o)&&"function"!=typeof o?lM(r):o,pM(lM(n),"onHide",function(){n.setState({show:!1})}),n.state={show:!0},n.getHeaderMarkdownOptions=Object(l_.memoizeResult)(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){pM(e,t,n[t])})}return e}({},fM,{channelNamesMap:e})}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&uM(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e,t=this.props.channel,n=0!==t.delete_at;if(!t){var r=T.ab("channel_info.notFound","No Channel Found");t={display_name:r,name:r,purpose:r,header:r,id:r}}var o=this.props.channel.props&&this.props.channel.props.channel_mentions;n?e=_.a.createElement(Uv.a,{className:"icon icon__archive"}):"O"===t.type?e=_.a.createElement(cP.a,{className:"icon icon__globe icon--body"}):"P"===t.type&&(e=_.a.createElement(lP.a,{className:"icon icon__globe icon--body"}));var a,i,s=Object(ss.e)()+"/"+this.props.currentTeam.name+"/channels/"+t.name;t.purpose?a=t.purpose:t.name===P.Q.DEFAULT_CHANNEL&&(a=_.a.createElement(Y.c,{id:"default_channel.purpose",defaultMessage:"Post messages here that you want everyone to see. Everyone automatically becomes a permanent member of this channel when they join the team."})),a&&(i=_.a.createElement("div",{className:"form-group"},_.a.createElement("div",{className:"info__label"},_.a.createElement(Y.c,{id:"channel_info.purpose",defaultMessage:"Purpose:"})),_.a.createElement("div",{className:"info__value"},a)));var c=null;return t.header&&(c=_.a.createElement("div",{className:"form-group"},_.a.createElement("div",{className:"info__label"},_.a.createElement(Y.c,{id:"channel_info.header",defaultMessage:"Header:"})),_.a.createElement("div",{className:"info__value"},_.a.createElement(Co.a,{message:t.header,options:this.getHeaderMarkdownOptions(o)})))),_.a.createElement(z.a,{dialogClassName:"a11y__modal about-modal",show:this.state.show,onHide:this.onHide,onExited:this.props.onHide,role:"dialog","aria-labelledby":"channelInfoModalLabel"},_.a.createElement(z.a.Header,{closeButton:!0},_.a.createElement(z.a.Title,{componentClass:"h1",id:"channelInfoModalLabel"},_.a.createElement(Y.c,{id:"channel_info.about",defaultMessage:"About"}),_.a.createElement("strong",null,e,t.display_name))),_.a.createElement(z.a.Body,{ref:"modalBody"},i,c,_.a.createElement("div",{className:"form-group"},_.a.createElement("div",{className:"info__label"},_.a.createElement(Y.c,{id:"channel_info.url",defaultMessage:"URL:"})),_.a.createElement("div",{className:"info__value"},s)),_.a.createElement("div",{className:"about-modal__hash form-group padding-top x2"},_.a.createElement("p",null,_.a.createElement(Y.c,{id:"channel_info.id",defaultMessage:"ID: "}),t.id))))}}])&&sM(n.prototype,r),o&&sM(n,o),t}();pM(dM,"propTypes",{onHide:v.a.func.isRequired,channel:v.a.object.isRequired,currentTeam:v.a.object.isRequired});var mM=Object(r.connect)(function(e){return{currentTeam:Object(f.getCurrentTeam)(e)}})(dM);function hM(e){return(hM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bM(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function yM(e){return(yM=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function gM(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vM(e,t){return(vM=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function EM(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _M=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=yM(t).call(this,e),n=!o||"object"!==hM(o)&&"function"!=typeof o?gM(r):o,EM(gM(n),"setError",function(e){"api.context.invalid_param.app_error"===e.id?n.setState({serverError:T.ab("edit_channel_purpose_modal.error","This channel purpose is too long, please enter a shorter one")}):n.setState({serverError:e.message})}),EM(gM(n),"unsetError",function(){n.setState({serverError:""})}),EM(gM(n),"handleEntering",function(){T.eb(n.purpose)}),EM(gM(n),"onHide",function(){n.setState({show:!1})}),EM(gM(n),"handleKeyDown",function(e){var t=n.props.ctrlSend;t&&T.S(e,P.Q.KeyCodes.ENTER)&&e.ctrlKey?(e.preventDefault(),n.handleSave(e)):t||!T.S(e,P.Q.KeyCodes.ENTER)||e.shiftKey||e.altKey||(e.preventDefault(),n.handleSave(e))}),EM(gM(n),"handleSave",function(){var e=n.props,t=e.channel,r=e.actions.patchChannel,o=n.state.purpose;t&&r(t.id,{purpose:o})}),EM(gM(n),"handleChange",function(e){e.preventDefault(),n.setState({purpose:e.target.value})}),EM(gM(n),"getPurpose",function(e){n.purpose=e}),n.state={purpose:e.channel.purpose||"",serverError:"",show:!0,submitted:!1},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vM(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.requestStatus,n=e.serverError,r=this.props.requestStatus;r!==t&&t===L.RequestStatus.SUCCESS&&this.onHide(),r!==t&&t===L.RequestStatus.FAILURE?this.setError(n):this.unsetError()}},{key:"render",value:function(){var e=null;this.state.serverError&&(e=_.a.createElement("div",{className:"form-group has-error"},_.a.createElement("br",null),_.a.createElement("label",{className:"control-label"},this.state.serverError)));var t=_.a.createElement("span",null,_.a.createElement(Y.c,{id:"edit_channel_purpose_modal.title1",defaultMessage:"Edit Purpose"}));this.props.channel.display_name&&(t=_.a.createElement("span",null,_.a.createElement(Y.c,{id:"edit_channel_purpose_modal.title2",defaultMessage:"Edit Purpose for "}),_.a.createElement("span",{className:"name"},this.props.channel.display_name)));var n=_.a.createElement(Y.c,{id:"edit_channel_purpose_modal.body",defaultMessage:'Describe how this channel should be used. This text appears in the channel list in the "More..." menu and helps others decide whether to join.'});return"P"===this.props.channel.type&&(n=_.a.createElement(Y.c,{id:"edit_channel_private_purpose_modal.body",defaultMessage:'This text appears in the \\"View Info\\" modal of the private channel.'})),_.a.createElement(z.a,{dialogClassName:"a11y__modal",show:this.state.show,onHide:this.onHide,onEntering:this.handleEntering,onExited:this.props.onHide,role:"dialog","aria-labelledby":"editChannelPurposeModalLabel"},_.a.createElement(z.a.Header,{closeButton:!0},_.a.createElement(z.a.Title,{componentClass:"h1",id:"editChannelPurposeModalLabel"},t)),_.a.createElement(z.a.Body,null,_.a.createElement("p",null,n),_.a.createElement("textarea",{ref:this.getPurpose,className:"form-control no-resize",rows:"6",maxLength:"250",value:this.state.purpose,onKeyDown:this.handleKeyDown,onChange:this.handleChange}),e),_.a.createElement(z.a.Footer,null,_.a.createElement("button",{type:"button",className:"btn btn-link cancel-button",onClick:this.onHide},_.a.createElement(Y.c,{id:"edit_channel_purpose_modal.cancel",defaultMessage:"Cancel"})),_.a.createElement("button",{type:"button",className:"btn btn-primary save-button",disabled:this.props.requestStatus===L.RequestStatus.STARTED,onClick:this.handleSave},_.a.createElement(Y.c,{id:"edit_channel_purpose_modal.save",defaultMessage:"Save"}))))}}])&&bM(n.prototype,r),o&&bM(n,o),t}();function OM(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}EM(_M,"propTypes",{onHide:v.a.func.isRequired,channel:v.a.object,ctrlSend:v.a.bool.isRequired,serverError:v.a.object,requestStatus:v.a.string.isRequired,actions:v.a.shape({patchChannel:v.a.func.isRequired}).isRequired});var wM=Object(Kc.a)(function(e){return Object(l.getBool)(e,P.Q.Preferences.CATEGORY_ADVANCED_SETTINGS,"send_on_ctrl_enter")},function(e){var t=e.requests.channels.updateChannel;return{serverError:t.error,requestStatus:t.status}},function(e,t){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){OM(e,t,n[t])})}return e}({ctrlSend:e},t)});var CM=Object(r.connect)(wM,function(e){return{actions:{patchChannel:Object(o.bindActionCreators)(s.patchChannel,e)}}})(_M);function SM(e){return(SM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function PM(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function jM(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function TM(e){return(TM=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function kM(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function NM(e,t){return(NM=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function RM(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var MM=Object(Y.g)({required:{id:Object(Ne.b)("rename_channel.required"),defaultMessage:"This field is required"},maxLength:{id:Object(Ne.b)("rename_channel.maxLength"),defaultMessage:"This field must be less than {maxLength, number} characters"},lowercase:{id:Object(Ne.b)("rename_channel.lowercase"),defaultMessage:"Must be lowercase alphanumeric characters"},url:{id:Object(Ne.b)("rename_channel.url"),defaultMessage:"URL"},defaultError:{id:Object(Ne.b)("rename_channel.defaultError"),defaultMessage:" - Cannot be changed for the default channel"},displayNameHolder:{id:Object(Ne.b)("rename_channel.displayNameHolder"),defaultMessage:"Enter display name"},handleHolder:{id:Object(Ne.b)("rename_channel.handleHolder"),defaultMessage:"lowercase alphanumeric characters"}}),IM=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=TM(t).call(this,e),n=!o||"object"!==SM(o)&&"function"!=typeof o?kM(r):o,RM(kM(n),"setError",function(e){n.setState({serverError:e.message})}),RM(kM(n),"unsetError",function(){n.setState({serverError:""})}),RM(kM(n),"handleEntering",function(){T.eb(n.textbox)}),RM(kM(n),"handleHide",function(e){e&&e.preventDefault(),n.setState({serverError:"",nameError:"",displayNameError:"",invalid:!1,show:!1})}),RM(kM(n),"handleSubmit",function(){var e,t=(e=regeneratorRuntime.mark(function e(t){var r,o,a,i,s,c,l,u,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.preventDefault(),r=Object.assign({},n.props.channel),o=r.name,a=r.display_name,i={serverError:""},s=n.props.intl.formatMessage,c=n.props.actions.patchChannel,r.display_name=n.state.displayName.trim(),r.display_name?r.display_name.length>P.Q.MAX_CHANNELNAME_LENGTH?(i.displayNameError=s(MM.maxLength,{maxLength:P.Q.MAX_CHANNELNAME_LENGTH}),i.invalid=!0):r.display_name.length<P.Q.MIN_CHANNELNAME_LENGTH?(i.displayNameError=_.a.createElement(Y.c,{id:"rename_channel.minLength",defaultMessage:"Channel name must be {minLength, number} or more characters",values:{minLength:P.Q.MIN_CHANNELNAME_LENGTH}}),i.invalid=!0):i.displayNameError="":(i.displayNameError=s(MM.required),i.invalid=!0),r.name=n.state.channelName.trim(),r.name?r.name.length>P.Q.MAX_CHANNELNAME_LENGTH?(i.nameError=s(MM.maxLength,{maxLength:P.Q.MAX_CHANNELNAME_LENGTH}),i.invalid=!0):Object(ss.a)(r.name)===r.name?i.nameError="":(i.nameError=s(MM.lowercase),i.invalid=!0):(i.nameError=s(MM.required),i.invalid=!0),n.setState(i),!i.invalid){e.next=14;break}return e.abrupt("return");case 14:if(o!==r.name||a!==r.display_name){e.next=17;break}return n.onSaveSuccess(),e.abrupt("return");case 17:return e.next=19,c(r.id,r);case 19:l=e.sent,u=l.data,p=l.error,u?n.onSaveSuccess():p&&n.setError(p);case 23:case"end":return e.stop()}},e)}),function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){PM(a,r,o,i,s,"next",e)}function s(e){PM(a,r,o,i,s,"throw",e)}i(void 0)})});return function(e){return t.apply(this,arguments)}}()),RM(kM(n),"onSaveSuccess",function(){n.handleHide(),n.unsetError(),Q.a.push("/"+n.props.team.name+"/channels/"+n.state.channelName)}),RM(kM(n),"handleCancel",function(e){n.setState({displayName:n.props.channel.display_name,channelName:n.props.channel.name}),n.handleHide(e)}),RM(kM(n),"onNameChange",function(e){n.setState({channelName:e.target.value})}),RM(kM(n),"onDisplayNameChange",function(e){n.setState({displayName:e.target.value})}),RM(kM(n),"getTextbox",function(e){n.textbox=e}),n.state={displayName:e.channel.display_name,channelName:e.channel.name,serverError:"",nameError:"",displayNameError:"",invalid:!1,show:!0},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&NM(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"UNSAFE_componentWillReceiveProps",value:function(e){T.c(e.channel,this.props.channel)||this.setState({displayName:e.channel.display_name,channelName:e.channel.name})}},{key:"render",value:function(){var e=null,t="form-group";this.state.displayNameError&&(e=_.a.createElement("label",{className:"control-label"},this.state.displayNameError),t+=" has-error");var n=null,r="form-group";this.state.nameError&&(n=_.a.createElement("label",{className:"control-label"},this.state.nameError),r+=" has-error");var o=null;this.state.serverError&&(o=_.a.createElement("div",{className:"form-group has-error"},_.a.createElement("label",{className:"control-label"},this.state.serverError)));var a=this.props.intl.formatMessage,i=a(MM.url),s=!1;this.props.channel.name===P.Q.DEFAULT_CHANNEL&&(i+=a(MM.defaultError),s=!0);var c=this.props.currentTeamUrl+"/channels",l=Object(ss.d)(c,35),u=_.a.createElement(El.a,{id:"urlTooltip"},c);return _.a.createElement(z.a,{dialogClassName:"a11y__modal",show:this.state.show,onHide:this.handleCancel,onEntering:this.handleEntering,onExited:this.props.onHide,role:"dialog","aria-labelledby":"renameChannelModalLabel"},_.a.createElement(z.a.Header,{closeButton:!0},_.a.createElement(z.a.Title,{componentClass:"h1",id:"renameChannelModalLabel"},_.a.createElement(Y.c,{id:"rename_channel.title",defaultMessage:"Rename Channel"}))),_.a.createElement("form",{role:"form"},_.a.createElement(z.a.Body,null,_.a.createElement("div",{className:t},_.a.createElement("label",{className:"control-label"},_.a.createElement(Y.c,{id:"rename_channel.displayName",defaultMessage:"Display Name"})),_.a.createElement(ke.a,{onChange:this.onDisplayNameChange,type:"text",ref:this.getTextbox,id:"display_name",className:"form-control",placeholder:MM.displayNameHolder,value:this.state.displayName,maxLength:P.Q.MAX_CHANNELNAME_LENGTH}),e),_.a.createElement("div",{className:r},_.a.createElement("label",{className:"control-label"},i),_.a.createElement("div",{className:"input-group input-group--limit"},_.a.createElement(vl.a,{delayShow:P.Q.OVERLAY_TIME_DELAY,placement:"top",overlay:u},_.a.createElement("span",{className:"input-group-addon"},l)),_.a.createElement(ke.a,{onChange:this.onNameChange,type:"text",className:"form-control",id:"channel_name",placeholder:MM.handleHolder,value:this.state.channelName,maxLength:P.Q.MAX_CHANNELNAME_LENGTH,readOnly:s})),n),o),_.a.createElement(z.a.Footer,null,_.a.createElement("button",{type:"button",className:"btn btn-link",onClick:this.handleCancel},_.a.createElement(Y.c,{id:"rename_channel.cancel",defaultMessage:"Cancel"})),_.a.createElement("button",{onClick:this.handleSubmit,type:"submit",id:"save-button",className:"btn btn-primary"},_.a.createElement(Y.c,{id:"rename_channel.save",defaultMessage:"Save"})))))}}])&&jM(n.prototype,r),o&&jM(n,o),t}();RM(IM,"propTypes",{intl:Y.i.isRequired,onHide:v.a.func.isRequired,channel:v.a.object.isRequired,team:v.a.object.isRequired,currentTeamUrl:v.a.string.isRequired,actions:v.a.shape({patchChannel:v.a.func.isRequired}).isRequired});var xM=Object(Y.h)(IM);function AM(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var LM=Object(Kc.a)(function(e){var t=e.entities.teams.currentTeamId,n=Object(f.getTeam)(e,t);return{currentTeamUrl:"".concat(Object(ss.e)(),"/").concat(n.name),team:n}},function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){AM(e,t,n[t])})}return e}({},e)});var DM=Object(r.connect)(LM,function(e){return{actions:{patchChannel:Object(o.bindActionCreators)(s.patchChannel,e)}}})(xM);function UM(e){return(UM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qM(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function HM(e){return(HM=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function FM(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BM(e,t){return(BM=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function GM(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var VM=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=HM(t).call(this,e),n=!o||"object"!==UM(o)&&"function"!=typeof o?FM(r):o,GM(FM(n),"handleConvert",function(){var e=n.props,t=e.actions,r=e.channelId;r.length===P.Q.CHANNEL_ID_LENGTH&&(t.convertChannelToPrivate(r),Object(vt.d)("actions","convert_to_private_channel",{channel_id:r}),n.onHide())}),GM(FM(n),"onHide",function(){n.setState({show:!1})}),n.state={show:!0},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&BM(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.channelDisplayName,n=e.onHide;return _.a.createElement(z.a,{dialogClassName:"a11y__modal",show:this.state.show,onHide:this.onHide,onExited:n,role:"dialog","aria-labelledby":"convertChannelModalLabel"},_.a.createElement(z.a.Header,{closeButton:!0},_.a.createElement(z.a.Title,{componentClass:"h1",id:"convertChannelModalLabel"},_.a.createElement(Y.c,{id:"convert_channel.title",defaultMessage:"Convert {display_name} to a private channel?",values:{display_name:t}}))),_.a.createElement(z.a.Body,null,_.a.createElement("p",null,_.a.createElement(Fu.b,{id:"convert_channel.question1",defaultMessage:"When you convert **{display_name}** to a private channel, history and membership are preserved. Publicly shared files remain accessible to anyone with the link. Membership in a private channel is by invitation only.",values:{display_name:t}})),_.a.createElement("p",null,_.a.createElement(Y.b,{id:"convert_channel.question2",defaultMessage:"The change is permanent and cannot be undone."})),_.a.createElement("p",null,_.a.createElement(Fu.b,{id:"convert_channel.question3",defaultMessage:"Are you sure you want to convert **{display_name}** to a private channel?",values:{display_name:t}}))),_.a.createElement(z.a.Footer,null,_.a.createElement("button",{type:"button",className:"btn btn-link",onClick:this.onHide,tabIndex:"2"},_.a.createElement(Y.c,{id:"convert_channel.cancel",defaultMessage:"No, cancel"})),_.a.createElement("button",{type:"button",className:"btn btn-primary","data-dismiss":"modal",onClick:this.handleConvert,autoFocus:!0,tabIndex:"1"},_.a.createElement(Y.c,{id:"convert_channel.confirm",defaultMessage:"Yes, convert to private channel"}))))}}])&&qM(n.prototype,r),o&&qM(n,o),t}();GM(VM,"propTypes",{onHide:v.a.func.isRequired,channelId:v.a.string.isRequired,channelDisplayName:v.a.string.isRequired,actions:v.a.shape({convertChannelToPrivate:v.a.func.isRequired})});var WM=Object(r.connect)(function(e){return{currentTeamDetails:Object(f.getCurrentTeam)(e)}},function(e){return{actions:Object(o.bindActionCreators)({convertChannelToPrivate:s.convertChannelToPrivate},e)}})(VM);function KM(e){return(KM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zM(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function YM(e){return(YM=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function QM(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ZM(e,t){return(ZM=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var JM=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=YM(t).call(this,e))||"object"!==KM(o)&&"function"!=typeof o?QM(r):o).handleDelete=n.handleDelete.bind(QM(n)),n.onHide=n.onHide.bind(QM(n)),n.state={show:!0},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ZM(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"handleDelete",value:function(){if(this.props.channel.id.length===P.Q.CHANNEL_ID_LENGTH){if(!this.props.canViewArchivedChannels){var e=this.props.penultimateViewedChannelName;Q.a.push("/"+this.props.currentTeamDetails.name+"/channels/"+e)}this.props.actions.deleteChannel(this.props.channel.id),this.onHide()}}},{key:"onHide",value:function(){this.setState({show:!1})}},{key:"render",value:function(){var e=this.props.canViewArchivedChannels;return _.a.createElement(z.a,{dialogClassName:"a11y__modal",show:this.state.show,onHide:this.onHide,onExited:this.props.onHide,role:"dialog","aria-labelledby":"deleteChannelModalLabel"},_.a.createElement(z.a.Header,{closeButton:!0},_.a.createElement(z.a.Title,{componentClass:"h1",id:"deleteChannelModalLabel"},_.a.createElement(Y.c,{id:"delete_channel.confirm",defaultMessage:"Confirm ARCHIVE Channel"}))),_.a.createElement(z.a.Body,null,_.a.createElement("div",{className:"alert alert-danger"},!e&&_.a.createElement(Fu.b,{id:"delete_channel.question",defaultMessage:"This will archive the channel from the team and make its contents inaccessible for all users. \\n \\nAre you sure you wish to archive the **{display_name}** channel?",values:{display_name:this.props.channel.display_name}}),e&&_.a.createElement(Fu.b,{id:"delete_channel.viewArchived.question",defaultMessage:"This will archive the channel from the team. Channel contents will still be accessible by channel members.\n \nAre you sure you wish to archive the **{display_name}** channel?",values:{display_name:this.props.channel.display_name}}))),_.a.createElement(z.a.Footer,null,_.a.createElement("button",{type:"button",className:"btn btn-link",onClick:this.onHide},_.a.createElement(Y.c,{id:"delete_channel.cancel",defaultMessage:"Cancel"})),_.a.createElement("button",{type:"button",className:"btn btn-danger","data-dismiss":"modal",onClick:this.handleDelete,autoFocus:!0},_.a.createElement(Y.c,{id:"delete_channel.del",defaultMessage:"Archive"}))))}}])&&zM(n.prototype,r),o&&zM(n,o),t}();!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(JM,"propTypes",{onHide:v.a.func.isRequired,channel:v.a.object.isRequired,currentTeamDetails:v.a.object.isRequired,canViewArchivedChannels:v.a.bool,penultimateViewedChannelName:v.a.string.isRequired,actions:v.a.shape({deleteChannel:v.a.func.isRequired})});var XM=Object(r.connect)(function(e){return{canViewArchivedChannels:"true"===Object(u.getConfig)(e).ExperimentalViewArchivedChannels,currentTeamDetails:Object(f.getCurrentTeam)(e)}},function(e){return{actions:Object(o.bindActionCreators)({deleteChannel:s.deleteChannel},e)}})(JM),$M=n(1657);function eI(e){return(eI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tI(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function nI(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){tI(a,r,o,i,s,"next",e)}function s(e){tI(a,r,o,i,s,"throw",e)}i(void 0)})}}function rI(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function oI(e){return(oI=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function aI(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iI(e,t){return(iI=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function sI(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var cI=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=oI(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==eI(o)&&"function"!=typeof o?aI(r):o,sI(aI(n),"loadItems",function(){var e=nI(regeneratorRuntime.mark(function e(t,r){var o,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.props.actions.getGroupsAssociatedToChannel(n.props.channel.id,r,t,$w);case 2:return o=e.sent,a=o.data,e.abrupt("return",{items:a.groups,totalCount:a.totalGroupCount});case 5:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()),sI(aI(n),"onClickRemoveGroup",function(e,t){return n.props.actions.unlinkGroupSyncable(e.id,n.props.channel.id,L.Groups.SYNCABLE_TYPE_CHANNEL).then(nI(regeneratorRuntime.mark(function e(){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.setState({loading:!0}),e.next=3,t.props.loadItems(t.setState.page,t.state.searchTerm);case 3:n=e.sent,r=n.items,t.setState({loading:!1,items:r});case 6:case"end":return e.stop()}},e)})))}),sI(aI(n),"onHide",function(){n.props.actions.closeModal(P.r.MANAGE_CHANNEL_GROUPS)}),sI(aI(n),"titleButtonOnClick",function(){n.onHide(),n.props.actions.openModal({modalId:P.r.ADD_GROUPS_TO_TEAM,dialogType:$M.a})}),sI(aI(n),"renderRow",function(e,t){return _.a.createElement("div",{key:e.id,className:"more-modal__row"},_.a.createElement("img",{className:"more-modal__image",src:nC.a,alt:"group picture",width:"32",height:"32"}),_.a.createElement("div",{className:"more-modal__details"},_.a.createElement("div",{className:"more-modal__name"},e.display_name," ","-"," ",_.a.createElement("span",null,_.a.createElement(Y.c,{id:"numMembers",defaultMessage:"{num, number} {num, plural, one {member} other {members}}",values:{num:e.member_count}})))),_.a.createElement("div",{className:"more-modal__actions"},_.a.createElement("button",{id:"removeMember",type:"button",className:"btn btn-danger btn-message",onClick:function(){return n.onClickRemoveGroup(e,t)}},_.a.createElement(Y.c,{id:"group_list_modal.removeGroupButton",defaultMessage:"Remove Group"}))))}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&iI(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e=this.context.intl.formatMessage;return _.a.createElement(eC,{titleText:e({id:"groups",defaultMessage:"{channel} Groups"},{channel:this.props.channel.display_name}),searchPlaceholderText:e({id:"manage_channel_groups_modal.search_placeholder",defaultMessage:"Search groups"}),renderRow:this.renderRow,loadItems:this.loadItems,onHide:this.onHide,titleBarButtonText:e({id:"group_list_modal.addGroupButton",defaultMessage:"Add Groups"}),titleBarButtonOnClick:this.titleButtonOnClick})}}])&&rI(n.prototype,r),o&&rI(n,o),t}();sI(cI,"propTypes",{channel:v.a.object.isRequired,actions:v.a.shape({getGroupsAssociatedToChannel:v.a.func.isRequired,unlinkGroupSyncable:v.a.func.isRequired,closeModal:v.a.func.isRequired,openModal:v.a.func.isRequired}).isRequired}),sI(cI,"contextTypes",{intl:Y.i});var lI=Object(r.connect)(function(e,t){return{channel:e.entities.channels.channels[t.channelID]}},function(e){return{actions:Object(o.bindActionCreators)({getGroupsAssociatedToChannel:Gw.getGroupsAssociatedToChannel,closeModal:U.a,openModal:U.b,unlinkGroupSyncable:Gw.unlinkGroupSyncable},e)}})(cI);function uI(e){return(uI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pI(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fI(e){return(fI=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function dI(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mI(e,t){return(mI=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function hI(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var bI=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=fI(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==uI(o)&&"function"!=typeof o?dI(r):o,hI(dI(n),"handleLeave",function(e){e.preventDefault();var t=n.props,r=t.channel,o=t.actions.leaveChannel;r.type===P.i.PRIVATE_CHANNEL?Object(S.m)(r):o(r.id)}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mI(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.channel,n=e.isDefault,r=e.id;return _.a.createElement(Dp.a,{id:r,show:!n&&t.type!==P.i.DM_CHANNEL&&t.type!==P.i.GM_CHANNEL,onClick:this.handleLeave,text:Object(T.ab)("channel_header.leave","Leave Channel")})}}])&&pI(n.prototype,r),o&&pI(n,o),t}();hI(bI,"propTypes",{channel:v.a.object.isRequired,isDefault:v.a.bool.isRequired,id:v.a.string,actions:v.a.shape({leaveChannel:v.a.func.isRequired}).isRequired});var yI=Object(r.connect)(null,function(e){return{actions:Object(o.bindActionCreators)({leaveChannel:Oo.e},e)}})(bI);function gI(e){return(gI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vI(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function EI(e){return(EI=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _I(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function OI(e,t){return(OI=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function wI(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var CI=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=EI(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==gI(o)&&"function"!=typeof o?_I(r):o,wI(_I(n),"handleClose",function(){n.props.actions.goToLastViewedChannel()}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&OI(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){return _.a.createElement(Dp.a,{show:this.props.isArchived,onClick:this.handleClose,text:Object(T.ab)("center_panel.archived.closeChannel","Close Channel")})}}])&&vI(n.prototype,r),o&&vI(n,o),t}();wI(CI,"propTypes",{isArchived:v.a.bool.isRequired,actions:v.a.shape({goToLastViewedChannel:v.a.func.isRequired}).isRequired});var SI=Object(r.connect)(null,function(e){return{actions:Object(o.bindActionCreators)({goToLastViewedChannel:Oo.c},e)}})(CI);function PI(e){return(PI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jI(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function TI(e){return(TI=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function kI(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function NI(e,t){return(NI=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function RI(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var MI=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=TI(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==PI(o)&&"function"!=typeof o?kI(r):o,RI(kI(n),"handleClick",function(){var e=n.props,t=e.user,r=e.channel,o=e.isMuted;(0,e.actions.updateChannelNotifyProps)(t.id,r.id,{mark_unread:o?P.s.ALL:P.s.MENTION})}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&NI(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e,t=this.props,n=t.channel,r=t.id;return e=t.isMuted?Object(T.ab)("channel_header.unmute","Unmute Channel"):Object(T.ab)("channel_header.mute","Mute Channel"),_.a.createElement(Dp.a,{id:r,show:n.type!==P.i.DM_CHANNEL,onClick:this.handleClick,text:e})}}])&&jI(n.prototype,r),o&&jI(n,o),t}();RI(MI,"propTypes",{user:v.a.object.isRequired,channel:v.a.object.isRequired,isMuted:v.a.bool.isRequired,id:v.a.string,actions:v.a.shape({updateChannelNotifyProps:v.a.func.isRequired}).isRequired});var II=Object(r.connect)(null,function(e){return{actions:Object(o.bindActionCreators)({updateChannelNotifyProps:s.updateChannelNotifyProps},e)}})(MI);function xI(e){return(xI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function AI(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function LI(e){return(LI=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function DI(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function UI(e,t){return(UI=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function qI(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var HI=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=LI(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==xI(o)&&"function"!=typeof o?DI(r):o,qI(DI(n),"toggleFavoriteChannel",function(e){var t=n.props,r=t.isFavorite,o=t.actions,a=o.favoriteChannel,i=o.unfavoriteChannel;return r?i(e):a(e)}),qI(DI(n),"handleClick",function(e){e.preventDefault(),n.toggleFavoriteChannel(n.props.channel.id)}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&UI(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e;return e=this.props.isFavorite?Object(T.ab)("channelHeader.removeFromFavorites","Remove from Favorites"):Object(T.ab)("channelHeader.addToFavorites","Add to Favorites"),_.a.createElement(Dp.a,{show:this.props.show,onClick:this.handleClick,text:e})}}])&&AI(n.prototype,r),o&&AI(n,o),t}();qI(HI,"propTypes",{show:v.a.bool.isRequired,channel:v.a.object.isRequired,isFavorite:v.a.bool.isRequired,actions:v.a.shape({favoriteChannel:v.a.func.isRequired,unfavoriteChannel:v.a.func.isRequired}).isRequired}),qI(HI,"defaultProps",{show:!0});var FI=Object(r.connect)(null,function(e){return{actions:Object(o.bindActionCreators)({favoriteChannel:s.favoriteChannel,unfavoriteChannel:s.unfavoriteChannel},e)}})(HI);function BI(e){return(BI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function GI(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function VI(e){return(VI=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function WI(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function KI(e,t){return(KI=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function zI(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var YI=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=VI(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==BI(o)&&"function"!=typeof o?WI(r):o,zI(WI(n),"handleClick",function(e){e.preventDefault();var t=n.props,r=t.channel,o=t.hasPinnedPosts,a=t.actions,i=a.closeRightHandSide,s=a.showPinnedPosts;o?i():s(r.id)}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&KI(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){return _.a.createElement(Dp.a,{show:this.props.show,onClick:this.handleClick,text:Object(T.ab)("navbar.viewPinnedPosts","View Pinned Posts")})}}])&&GI(n.prototype,r),o&&GI(n,o),t}();zI(YI,"propTypes",{show:v.a.bool,channel:v.a.object.isRequired,hasPinnedPosts:v.a.bool.isRequired,actions:v.a.shape({closeRightHandSide:v.a.func.isRequired,showPinnedPosts:v.a.func.isRequired}).isRequired});var QI=Object(r.connect)(function(e){return{hasPinnedPosts:Object(Nc.k)(e)===P.A.PIN}},function(e){return{actions:Object(o.bindActionCreators)({closeRightHandSide:kc.b,showPinnedPosts:kc.l},e)}})(YI);function ZI(e){return(ZI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function JI(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function XI(e,t){return!t||"object"!==ZI(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $I(e){return($I=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ex(e,t){return(ex=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var tx=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),XI(this,$I(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ex(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e,t=this.props,n=t.user,r=t.channel,o=t.isDefault,a=t.isFavorite,i=t.isMuted,s=t.isReadonly,c=t.isArchived,l=t.isMobile,u=t.penultimateViewedChannelName,p=r.type===P.i.PRIVATE_CHANNEL,f=!0===r.group_constrained,d=p?L.Permissions.MANAGE_PRIVATE_CHANNEL_MEMBERS:L.Permissions.MANAGE_PUBLIC_CHANNEL_MEMBERS,m=p?L.Permissions.MANAGE_PRIVATE_CHANNEL_PROPERTIES:L.Permissions.MANAGE_PUBLIC_CHANNEL_PROPERTIES,h=p?L.Permissions.DELETE_PRIVATE_CHANNEL:L.Permissions.DELETE_PUBLIC_CHANNEL;return l&&(e=_.a.createElement("li",{className:"MenuGroup mobile-menu-divider"},_.a.createElement("hr",null))),_.a.createElement(_.a.Fragment,null,_.a.createElement(Lw.a,{divider:e},_.a.createElement(Bw.a,{id:"channelViewInfo",show:r.type!==P.i.DM_CHANNEL&&r.type!==P.i.GM_CHANNEL,modalId:P.r.CHANNEL_INFO,dialogType:mM,dialogProps:{channel:r},text:Object(T.ab)("navbar.viewInfo","View Info")}),_.a.createElement(FI,{id:"channelToggleFavorite",show:l,channel:r,isFavorite:a}),_.a.createElement(QI,{id:"channelViewPinnedPosts",show:l,channel:r}),_.a.createElement(Bw.a,{id:"channelNotificationPreferences",show:r.type!==P.i.DM_CHANNEL&&!c,modalId:P.r.CHANNEL_NOTIFICATIONS,dialogType:aM,dialogProps:{channel:r,currentUser:n},text:Object(T.ab)("navbar.preferences","Notification Preferences")}),_.a.createElement(II,{id:"channelToggleMuteChannel",user:n,channel:r,isMuted:i,isArchived:c})),_.a.createElement(Lw.a,{divider:e},_.a.createElement(Lp,{channelId:r.id,teamId:r.team_id,permissions:[d]},_.a.createElement(Bw.a,{id:"channelAddMembers",show:r.type!==P.i.DM_CHANNEL&&r.type!==P.i.GM_CHANNEL&&!c&&!o&&!f,modalId:P.r.CHANNEL_INVITE,dialogType:mN,dialogProps:{channel:r},text:Object(T.ab)("navbar.addMembers","Add Members")}),_.a.createElement(Bw.a,{id:"channelAddMembers",show:r.type===P.i.GM_CHANNEL&&!c&&!f,modalId:P.r.CREATE_DM_CHANNEL,dialogType:tP,dialogProps:{isExistingChannel:!0},text:Object(T.ab)("navbar.addMembers","Add Members")})),_.a.createElement(Bw.a,{id:"channelViewMembers",show:r.type!==P.i.DM_CHANNEL&&r.type!==P.i.GM_CHANNEL&&(c||o),modalId:P.r.CHANNEL_MEMBERS,dialogType:WN,dialogProps:{channel:r},text:Object(T.ab)("channel_header.viewMembers","View Members")}),_.a.createElement(Lp,{channelId:r.id,teamId:r.team_id,permissions:[d]},_.a.createElement(Bw.a,{id:"channelAddGroups",show:r.type!==P.i.DM_CHANNEL&&r.type!==P.i.GM_CHANNEL&&!c&&!o&&f,modalId:P.r.ADD_GROUPS_TO_CHANNEL,dialogType:$M.a,dialogProps:{},text:Object(T.ab)("navbar.addGroups","Add Groups")}),_.a.createElement(Bw.a,{id:"channelManageGroups",show:r.type!==P.i.DM_CHANNEL&&r.type!==P.i.GM_CHANNEL&&!c&&!o&&f,modalId:P.r.MANAGE_CHANNEL_GROUPS,dialogType:lI,dialogProps:{channelID:r.id},text:Object(T.ab)("navbar_dropdown.manageGroups","Manage Groups")}),_.a.createElement(Bw.a,{id:"channelManageMembers",show:r.type!==P.i.DM_CHANNEL&&r.type!==P.i.GM_CHANNEL&&!c&&!o,modalId:P.r.CHANNEL_MEMBERS,dialogType:WN,dialogProps:{channel:r},text:Object(T.ab)("channel_header.manageMembers","Manage Members")})),_.a.createElement(Lp,{channelId:r.id,teamId:r.team_id,permissions:[d],invert:!0},_.a.createElement(Bw.a,{id:"channelViewMembers",show:r.type!==P.i.DM_CHANNEL&&r.type!==P.i.GM_CHANNEL&&!c&&!o,modalId:P.r.CHANNEL_MEMBERS,dialogType:WN,dialogProps:{channel:r},text:Object(T.ab)("channel_header.viewMembers","View Members")}))),_.a.createElement(Lw.a,{divider:e},_.a.createElement(Bw.a,{id:"channelEditHeader",show:!(r.type!==P.i.DM_CHANNEL&&r.type!==P.i.GM_CHANNEL||c||s),modalId:P.r.EDIT_CHANNEL_HEADER,dialogType:rN,dialogProps:{channel:r},text:Object(T.ab)("channel_header.setHeader","Edit Channel Header")}),_.a.createElement(Lp,{channelId:r.id,teamId:r.team_id,permissions:[m]},_.a.createElement(Bw.a,{id:"channelEditHeader",show:r.type!==P.i.DM_CHANNEL&&r.type!==P.i.GM_CHANNEL&&!c&&!s,modalId:P.r.EDIT_CHANNEL_HEADER,dialogType:rN,dialogProps:{channel:r},text:Object(T.ab)("channel_header.setHeader","Edit Channel Header")}),_.a.createElement(Bw.a,{id:"channelEditPurpose",show:!c&&!s&&r.type!==P.i.DM_CHANNEL&&r.type!==P.i.GM_CHANNEL,modalId:P.r.EDIT_CHANNEL_PURPOSE,dialogType:CM,dialogProps:{channel:r},text:Object(T.ab)("channel_header.setPurpose","Edit Channel Purpose")}),_.a.createElement(Bw.a,{id:"channelRename",show:!c&&r.type!==P.i.DM_CHANNEL&&r.type!==P.i.GM_CHANNEL,modalId:P.r.RENAME_CHANNEL,dialogType:DM,dialogProps:{channel:r},text:Object(T.ab)("channel_header.rename","Rename Channel")})),_.a.createElement(C_.a,{teamId:r.team_id,permissions:[L.Permissions.MANAGE_TEAM]},_.a.createElement(Bw.a,{id:"channelCovertToPrivate",show:!c&&!o&&r.type===P.i.OPEN_CHANNEL,modalId:P.r.CONVERT_CHANNEL,dialogType:WM,dialogProps:{channelId:r.id,channelDisplayName:r.display_name},text:Object(T.ab)("channel_header.convert","Convert to Private Channel")})),_.a.createElement(Lp,{channelId:r.id,teamId:r.team_id,permissions:[h]},_.a.createElement(Bw.a,{id:"channelArchiveChannel",show:!c&&!o&&r.type!==P.i.DM_CHANNEL&&r.type!==P.i.GM_CHANNEL,modalId:P.r.DELETE_CHANNEL,dialogType:XM,dialogProps:{channel:r,penultimateViewedChannelName:u},text:Object(T.ab)("channel_header.delete","Archive Channel")}))),_.a.createElement(Lw.a,{divider:e},l&&_.a.createElement(UR,{channel:r,isDropdown:!0}),_.a.createElement(yI,{id:"channelLeaveChannel",channel:r,isDefault:o}),_.a.createElement(SI,{id:"channelCloseChannel",isArchived:c})))}}])&&JI(n.prototype,r),o&&JI(n,o),t}();function nx(e){return(nx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rx(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ox(e,t){return!t||"object"!==nx(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ax(e){return(ax=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ix(e,t){return(ix=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(tx,"propTypes",{user:v.a.object.isRequired,channel:v.a.object.isRequired,isDefault:v.a.bool.isRequired,isFavorite:v.a.bool.isRequired,isReadonly:v.a.bool.isRequired,isMuted:v.a.bool.isRequired,isArchived:v.a.bool.isRequired,isMobile:v.a.bool.isRequired,penultimateViewedChannelName:v.a.string.isRequired});var sx=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ox(this,ax(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ix(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){return _.a.createElement(KE.a,{in:this.props.show,classNames:"mobile-channel-header-dropdown",enter:!0,exit:!0,mountOnEnter:!0,unmountOnExit:!0,timeout:{enter:350,exit:350}},this.props.children)}}])&&rx(n.prototype,r),o&&rx(n,o),t}();function cx(e){return(cx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lx(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ux(e){return(ux=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function px(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fx(e,t){return(fx=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function dx(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(sx,"propTypes",{children:v.a.node,show:v.a.bool.isRequired});var mx=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=ux(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==cx(o)&&"function"!=typeof o?px(r):o,dx(px(n),"getChannelTitle",function(){var e=n.props,t=e.user,r=e.channel,o=e.teammateId;if(r.type===P.i.DM_CHANNEL){var a=Object(T.w)(o);return t.id===o?_.a.createElement(Y.c,{id:"channel_header.directchannel.you",defaultMessage:"{displayname} (you)",values:{displayname:a}}):a}return r.display_name}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fx(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e,t=this.props,n=t.teammateIsBot,r=t.teammateStatus;return n||(e=_.a.createElement(Uj.a,{status:r})),_.a.createElement(pu.a,{animationComponent:sx},_.a.createElement("a",null,_.a.createElement("span",{className:"heading"},e,this.getChannelTitle()),_.a.createElement(Y.c,{id:"generic_icons.dropdown",defaultMessage:"Dropdown Icon"},function(e){return _.a.createElement("span",{className:"fa fa-angle-down header-dropdown__icon",title:e})})),_.a.createElement(Y.c,{id:"channel_header.menuAriaLabel",defaultMessage:"Channel Menu"},function(e){return _.a.createElement(fu.a,{ariaLabel:e},_.a.createElement(gx,{isMobile:!0}),_.a.createElement("div",{className:"close visible-xs-block"},"×"))}))}}])&&lx(n.prototype,r),o&&lx(n,o),t}();dx(mx,"propTypes",{user:v.a.object.isRequired,channel:v.a.object.isRequired,teammateId:v.a.string,teammateIsBot:v.a.bool,teammateStatus:v.a.string});var hx=Object(Kc.a)(d.getCurrentChannel,function(e){return e.type!==P.i.DM_CHANNEL?null:T.F(e)}),bx=Object(Kc.a)(p.getUserStatuses,hx,function(e,t){return t?e[t]:null}),yx=NR,gx=Object(r.connect)(function(e){return{user:Object(p.getCurrentUser)(e),channel:Object(d.getCurrentChannel)(e),isDefault:Object(d.isCurrentChannelDefault)(e),isFavorite:Object(d.isCurrentChannelFavorite)(e),isMuted:Object(d.isCurrentChannelMuted)(e),isReadonly:Object(d.isCurrentChannelReadOnly)(e),isArchived:Object(d.isCurrentChannelArchived)(e),penultimateViewedChannelName:Object(Bk.c)(e)||Object(d.getRedirectChannelNameForTeam)(e,Object(f.getCurrentTeamId)(e))}})(tx),vx=Object(r.connect)(function(e){var t=Object(p.getCurrentUser)(e),n=Object(d.getCurrentChannel)(e),r=hx(e),o=!1;if(r){var a=Object(p.getUser)(e,r);o=a&&a.is_bot}return{user:t,channel:n,teammateId:r,teammateIsBot:o,teammateStatus:bx(e)}})(mx),Ex=n(1615),_x=n(2353);function Ox(e){return(Ox="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wx(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Cx(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Sx(e,t,n){return t&&Cx(e.prototype,t),n&&Cx(e,n),e}function Px(e,t){return!t||"object"!==Ox(t)&&"function"!=typeof t?Tx(e):t}function jx(e){return(jx=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Tx(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kx(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Nx(e,t)}function Nx(e,t){return(Nx=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Rx(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Mx=function(e){function t(){var e,n;wx(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return Rx(Tx(n=Px(this,(e=jx(t)).call.apply(e,[this].concat(o)))),"handleRootClose",function(){n.props.onClose()}),n}return kx(t,_.a.PureComponent),Sx(t,[{key:"render",value:function(){var e=this.props,t=e.open,n=e.rootCloseEvent,r=e.children;return _.a.createElement(_x.a,{disabled:!t,onRootClose:this.handleRootClose,event:n},_.a.createElement("ul",{role:"menu",className:"dropdown-menu channel-header_plugin-dropdown"},r))}}]),t}();Rx(Mx,"propTypes",{open:v.a.bool,children:v.a.node,onClose:v.a.func.isRequired,rootCloseEvent:v.a.oneOf(["click","mousedown"])});var Ix=function(e){function t(){var e,n;wx(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return Rx(Tx(n=Px(this,(e=jx(t)).call.apply(e,[this].concat(o)))),"handleClick",function(e){n.props.onClick(e)}),n}return kx(t,_.a.PureComponent),Sx(t,[{key:"render",value:function(){var e=this.props.children,t="";return this.props.dropdownOpen&&(t=" active"),_.a.createElement("button",{id:"pluginChannelHeaderButtonDropdown",className:"channel-header__icon style--none"+t,type:"button",onClick:this.handleClick},e)}}]),t}();Rx(Ix,"propTypes",{children:v.a.element,dropdownOpen:v.a.bool,onClick:v.a.func});var xx=function(e){function t(e){var n;return wx(this,t),Rx(Tx(n=Px(this,jx(t).call(this,e))),"toggleDropdown",function(e){n.setState({dropdownOpen:e})}),Rx(Tx(n),"onClose",function(){n.toggleDropdown(!1)}),Rx(Tx(n),"fireActionAndClose",function(e){e(n.props.channel,n.props.channelMember),n.onClose()}),Rx(Tx(n),"createButton",function(e){return _.a.createElement(Vg,{buttonClass:"channel-header__icon style--none",iconComponent:e.icon,onClick:function(){return e.action(n.props.channel,n.props.channelMember)},buttonId:e.id,tooltipKey:"plugin",tooltipText:e.tooltipText?e.tooltipText:e.dropdownText})}),Rx(Tx(n),"createDropdown",function(e){var t=e.map(function(e){return _.a.createElement("li",{key:"channelHeaderPlug"+e.id},_.a.createElement("a",{href:"#",className:"d-flex align-items-center",onClick:function(){return n.fireActionAndClose(e.action)}},_.a.createElement("span",{className:"d-flex align-items-center overflow--ellipsis"},e.icon),_.a.createElement("span",null,e.dropdownText)))});return _.a.createElement("div",{className:"flex-child"},_.a.createElement(Ex.a,{ref:"dropdown",id:"channelHeaderPlugDropdown",onToggle:n.toggleDropdown,onSelect:n.onSelect,open:n.state.dropdownOpen},_.a.createElement(Ix,{dropdownOpen:n.state.dropdownOpen,bsRole:"toggle"},_.a.createElement("span",{className:"fa fa-ellipsis-h icon__ellipsis"})),_.a.createElement(Mx,{bsRole:"menu",open:n.state.dropdownOpen,onClose:n.onClose},t)))}),n.state={dropdownOpen:!1},n}return kx(t,_.a.PureComponent),Sx(t,[{key:"render",value:function(){var e=this.props.components||[];return 0===e.length?null:1===e.length?this.createButton(e[0]):this.createDropdown(e)}}]),t}();Rx(xx,"propTypes",{components:v.a.array,channel:v.a.object.isRequired,channelMember:v.a.object.isRequired,theme:v.a.object.isRequired});var Ax=Object(r.connect)(function(e){return{components:e.plugins.components.ChannelHeaderButton,theme:Object(l.getTheme)(e)}})(xx);function Lx(e){return(Lx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Dx(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){Bx(e,t,n[t])})}return e}function Ux(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qx(e){return(qx=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Hx(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Fx(e,t){return(Fx=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Bx(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Gx={singleline:!0,mentionHighlight:!1,atMentions:!0},Vx={singleline:!1,mentionHighlight:!1,atMentions:!0},Wx=1140,Kx=function(e){function t(e){var n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=qx(t).call(this,e),n=!o||"object"!==Lx(o)&&"function"!=typeof o?Hx(r):o,Bx(Hx(n),"handleResize",function(){var e=T.mb();n.setState({showSearchBar:e>Wx})}),Bx(Hx(n),"handleClose",function(){n.props.actions.goToLastViewedChannel()}),Bx(Hx(n),"toggleFavorite",function(e){e.stopPropagation(),n.props.isFavorite?n.props.actions.unfavoriteChannel(n.props.channel.id):n.props.actions.favoriteChannel(n.props.channel.id)}),Bx(Hx(n),"unmute",function(){var e=n.props,t=e.actions,r=e.channel,o=e.channelMember,a=e.currentUser;if(o&&a&&r){var i={mark_unread:P.s.ALL};t.updateChannelNotifyProps(a.id,r.id,i)}}),Bx(Hx(n),"mute",function(){var e=n.props,t=e.actions,r=e.channel,o=e.channelMember,a=e.currentUser;if(o&&a&&r){var i={mark_unread:P.s.MENTION};t.updateChannelNotifyProps(a.id,r.id,i)}}),Bx(Hx(n),"searchMentions",function(e){e.preventDefault(),n.props.rhsState===P.A.MENTION?n.props.actions.closeRightHandSide():n.props.actions.showMentions()}),Bx(Hx(n),"showPinnedPosts",function(e){e.preventDefault(),n.props.rhsState===P.A.PIN?n.props.actions.closeRightHandSide():n.props.actions.showPinnedPosts()}),Bx(Hx(n),"getFlagged",function(e){e.preventDefault(),n.props.rhsState===P.A.FLAG?n.props.actions.closeRightHandSide():n.props.actions.showFlaggedPosts()}),Bx(Hx(n),"searchButtonClick",function(e){e.preventDefault(),n.props.actions.updateRhsState(P.A.SEARCH)}),Bx(Hx(n),"handleShortcut",function(e){T.e(e)&&e.shiftKey&&T.S(e,P.i.KeyCodes.M)&&(e.preventDefault(),n.searchMentions(e))}),Bx(Hx(n),"handleOnMouseOver",function(){n.refs.headerOverlay&&n.refs.headerOverlay.show()}),Bx(Hx(n),"handleOnMouseOut",function(){n.refs.headerOverlay&&n.refs.headerOverlay.hide()}),Bx(Hx(n),"handleQuickSwitchKeyPress",function(e){T.e(e)&&!e.shiftKey&&T.S(e,P.i.KeyCodes.K)&&(e.altKey||(e.preventDefault(),n.toggleQuickSwitchModal()))}),Bx(Hx(n),"toggleQuickSwitchModal",function(){n.props.isQuickSwitcherOpen?n.props.actions.closeModal(P.r.QUICK_SWITCH):n.props.actions.openModal({modalId:P.r.QUICK_SWITCH,dialogType:ZP})}),Bx(Hx(n),"removeTooltipLink",function(){n.toggleFavoriteRef.current.removeAttribute("aria-describedby")}),Bx(Hx(n),"showEditChannelHeaderModal",function(){n.refs.headerOverlay&&n.refs.headerOverlay.hide();var e=n.props,t=e.actions,r=e.channel,o={modalId:P.r.EDIT_CHANNEL_HEADER,dialogType:rN,dialogProps:{channel:r}};t.openModal(o)}),n.toggleFavoriteRef=_.a.createRef();var a=T.mb()>Wx;return n.state={showSearchBar:a},n.getHeaderMarkdownOptions=Object(l_.memoizeResult)(function(e){return Dx({},Gx,{channelNamesMap:e})}),n.getPopoverMarkdownOptions=Object(l_.memoizeResult)(function(e){return Dx({},Vx,{channelNamesMap:e})}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fx(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"componentDidMount",value:function(){this.props.actions.getCustomEmojisInText(this.props.channel?this.props.channel.header:""),document.addEventListener("keydown",this.handleShortcut),document.addEventListener("keydown",this.handleQuickSwitchKeyPress),window.addEventListener("resize",this.handleResize)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleShortcut),document.removeEventListener("keydown",this.handleQuickSwitchKeyPress),window.removeEventListener("resize",this.handleResize)}},{key:"componentDidUpdate",value:function(e){var t=this.props.channel?this.props.channel.header:"";t!==(e.channel?e.channel.header:"")&&this.props.actions.getCustomEmojisInText(t)}},{key:"render",value:function(){var e=this.props,t=e.teamId,n=e.currentUser,r=e.channel,o=e.channelMember,a=e.isMuted,i=e.isReadOnly,s=e.isFavorite,c=e.dmUser,l=e.rhsState,u=this.context.intl.formatMessage,p=T.ab("accessibility.sections.channelHeader","channel header region"),f=0!==r.delete_at;if(T.O(r)||T.O(o)||T.O(n)||!c&&r.type===P.i.DM_CHANNEL)return _.a.createElement("div",{className:"channel-header"});var d=r.props&&r.props.channel_mentions,m=r.display_name,h=null;f&&(h=_.a.createElement(Uv.a,{className:"icon icon__archive icon channel-header-archived-icon svg-text-color"}));var b,y,g,v,E=r.type===P.i.DM_CHANNEL,O=r.type===P.i.GM_CHANNEL,w=r.type===P.i.PRIVATE_CHANNEL;if(E){var C=c.id;m=n.id===C?_.a.createElement(Y.c,{id:"channel_header.directchannel.you",defaultMessage:"{displayname} (you) ",values:{displayname:T.w(C)}}):T.w(C)+" "}E||(b=_.a.createElement(gR,{channel:r})),!E||c.delete_at||c.is_bot||(y=_.a.createElement(Uj.a,{type:"avatar",status:r.status}),g=_.a.createElement("span",{className:"header-status__text"},_.a.createElement(Y.c,{id:"status_dropdown.set_".concat(r.status),defaultMessage:T.kb(r.status)})));var S,j=E&&c.is_bot?c.bot_description:r.header;if(j){var k=_.a.createElement(Vy.a,{id:"header-popover",bStyle:"info",bSize:"large",placement:"bottom",className:"channel-header__popover",onMouseOver:this.handleOnMouseOver,onMouseOut:this.handleOnMouseOut},_.a.createElement(Co.a,{message:j,options:this.getPopoverMarkdownOptions(d)}));v=_.a.createElement(vl.a,{trigger:"click",placement:"bottom",rootClose:!0,overlay:k,ref:"headerOverlay"},_.a.createElement("div",{id:"channelHeaderDescription",className:"channel-header__description"},y,g,_.a.createElement("span",{onClick:T.G},_.a.createElement(Co.a,{message:j,options:this.getHeaderMarkdownOptions(d)}))))}else{var N;i||f||(E||O?E&&c.is_bot||(N=_.a.createElement("button",{className:"style--none",onClick:this.showEditChannelHeaderModal},_.a.createElement(Y.c,{id:"channel_header.addChannelHeader",defaultMessage:"Add a channel description"}))):N=_.a.createElement(Lp,{channelId:r.id,teamId:t,permissions:[w?L.Permissions.MANAGE_PRIVATE_CHANNEL_PROPERTIES:L.Permissions.MANAGE_PUBLIC_CHANNEL_PROPERTIES]},_.a.createElement("button",{className:"style--none",onClick:this.showEditChannelHeaderModal},_.a.createElement(Y.c,{id:"channel_header.addChannelHeader",defaultMessage:"Add a channel description"})))),v=_.a.createElement("div",{id:"channelHeaderDescription",className:"channel-header__description light"},y,g,N)}var R=null,M="";f||(s?(S=_.a.createElement(El.a,{id:"favoriteTooltip"},_.a.createElement(Y.c,{id:"channelHeader.removeFromFavorites",defaultMessage:"Remove from Favorites"})),M=u({id:"channelHeader.removeFromFavorites",defaultMessage:"Remove from Favorites"}).toLowerCase()):(S=_.a.createElement(El.a,{id:"favoriteTooltip"},_.a.createElement(Y.c,{id:"channelHeader.addToFavorites",defaultMessage:"Add to Favorites"})),M=u({id:"channelHeader.addToFavorites",defaultMessage:"Add to Favorites"}).toLowerCase()),R=_.a.createElement(vl.a,{delayShow:P.i.OVERLAY_TIME_DELAY,placement:"bottom",overlay:S,onEntering:this.removeTooltipLink},_.a.createElement("button",{id:"toggleFavorite",ref:this.toggleFavoriteRef,onClick:this.toggleFavorite,className:"style--none color--link channel-header__favorites "+(this.props.isFavorite?"active":"inactive"),"aria-label":M},_.a.createElement("i",{className:"icon fa "+(this.props.isFavorite?"fa-star":"fa-star-o")}))));var I,x=_.a.createElement(El.a,{id:"channelMutedTooltip"},_.a.createElement(Y.c,{id:"channelHeader.unmute",defaultMessage:"Unmute"}));a&&(I=_.a.createElement(vl.a,{delayShow:P.i.OVERLAY_TIME_DELAY,placement:"bottom",overlay:x},_.a.createElement("button",{id:"toggleMute",onClick:this.unmute,className:"style--none color--link channel-header__mute inactive","aria-label":u({id:"generic_icons.muted",defaultMessage:"Muted Icon"})},_.a.createElement("i",{className:"icon fa fa-bell-slash-o"}))));var A="channel-header__icon";l===P.A.PIN&&(A+=" active");var D=_.a.createElement(_.a.Fragment,null,R,_.a.createElement(pu.a,null,_.a.createElement("div",{id:"channelHeaderDropdownButton",className:"channel-header__top"},_.a.createElement("button",{className:"channel-header__trigger style--none","aria-label":u({id:"channel_header.menuAriaLabel",defaultMessage:"Channel Menu"}).toLowerCase()},_.a.createElement("strong",{role:"heading","aria-level":"2",id:"channelHeaderTitle",className:"heading"},_.a.createElement("span",null,h,m)),_.a.createElement("span",{id:"channelHeaderDropdownIcon",className:"fa fa-angle-down header-dropdown__icon","aria-label":u({id:"generic_icons.dropdown",defaultMessage:"Dropdown Icon"}).toLowerCase()}))),_.a.createElement(yx,null)));return E&&c.is_bot&&(D=_.a.createElement("div",{id:"channelHeaderDropdownButton",className:"channel-header__top"},R,_.a.createElement("strong",{role:"heading","aria-level":"2",id:"channelHeaderTitle",className:"heading"},_.a.createElement("span",null,h,m)),_.a.createElement(ka.a,{className:"badge-popoverlist"}))),_.a.createElement("div",{id:"channel-header","aria-label":p,role:"application",tabIndex:"-1","data-channelid":"".concat(r.id),className:"channel-header alt a11y__region","data-a11y-sort-order":"7"},_.a.createElement("div",{className:"flex-parent"},_.a.createElement("div",{className:"flex-child"},_.a.createElement("div",{id:"channelHeaderInfo",className:"channel-header__info"},_.a.createElement("div",{className:"channel-header__title dropdown"},_.a.createElement("div",null,D),I),v)),_.a.createElement("div",{className:"flex-child"},b),_.a.createElement(Ax,{channel:r,channelMember:o}),_.a.createElement(Vg,{iconComponent:_.a.createElement(CR,{className:"icon icon__pin","aria-hidden":"true"}),ariaLabel:!0,buttonClass:"style--none "+A,buttonId:"channelHeaderPinButton",onClick:this.showPinnedPosts,tooltipKey:"pinnedPosts"}),this.state.showSearchBar?_.a.createElement("div",{className:"flex-child search-bar__container"},_.a.createElement(mv,{showMentionFlagBtns:!1,isFocus:T.U()})):_.a.createElement(Vg,{iconComponent:_.a.createElement(rv.a,{className:"icon icon__search icon--stroke","aria-hidden":"true"}),buttonId:"channelHeaderSearchButton",onClick:this.searchButtonClick,tooltipKey:"search"}),_.a.createElement(Vg,{iconComponent:_.a.createElement(nv,{className:"icon icon__mentions","aria-hidden":"true"}),ariaLabel:!0,buttonId:"channelHeaderMentionButton",onClick:this.searchMentions,tooltipKey:"recentMentions"}),_.a.createElement(Vg,{iconComponent:_.a.createElement(qd,{className:"icon icon__flag"}),ariaLabel:!0,buttonId:"channelHeaderFlagButton",onClick:this.getFlagged,tooltipKey:"flaggedPosts"})))}}])&&Ux(n.prototype,r),o&&Ux(n,o),t}();Bx(Kx,"propTypes",{teamId:v.a.string.isRequired,currentUser:v.a.object.isRequired,channel:v.a.object,channelMember:v.a.object,dmUser:v.a.object,isFavorite:v.a.bool,isReadOnly:v.a.bool,isMuted:v.a.bool,rhsState:v.a.oneOf(Object.values(P.A)),isQuickSwitcherOpen:v.a.bool,actions:v.a.shape({favoriteChannel:v.a.func.isRequired,unfavoriteChannel:v.a.func.isRequired,showFlaggedPosts:v.a.func.isRequired,showPinnedPosts:v.a.func.isRequired,showMentions:v.a.func.isRequired,closeRightHandSide:v.a.func.isRequired,updateRhsState:v.a.func.isRequired,getCustomEmojisInText:v.a.func.isRequired,updateChannelNotifyProps:v.a.func.isRequired,goToLastViewedChannel:v.a.func.isRequired,openModal:v.a.func.isRequired,closeModal:v.a.func.isRequired}).isRequired}),Bx(Kx,"contextTypes",{intl:Y.i.isRequired});var zx=Object(a.f)(Object(r.connect)(function(e){var t,n=Object(d.getCurrentChannel)(e)||{},r=Object(p.getCurrentUser)(e);if(n&&n.type===L.General.DM_CHANNEL){var o=Object(Ka.getUserIdFromChannelName)(r.id,n.name);t=Object(p.getUser)(e,o)}return{teamId:Object(f.getCurrentTeamId)(e),channel:n,channelMember:Object(d.getMyCurrentChannelMembership)(e),currentUser:r,dmUser:t,rhsState:Object(Nc.k)(e),isFavorite:Object(d.isCurrentChannelFavorite)(e),isReadOnly:Object(d.isCurrentChannelReadOnly)(e),isMuted:Object(d.isCurrentChannelMuted)(e),isQuickSwitcherOpen:Object(I_.a)(e,P.r.QUICK_SWITCH)}},function(e){return{actions:Object(o.bindActionCreators)({favoriteChannel:s.favoriteChannel,unfavoriteChannel:s.unfavoriteChannel,showFlaggedPosts:kc.j,showPinnedPosts:kc.l,showMentions:kc.k,closeRightHandSide:kc.b,updateRhsState:kc.q,getCustomEmojisInText:rr.getCustomEmojisInText,updateChannelNotifyProps:s.updateChannelNotifyProps,goToLastViewedChannel:Oo.c,openModal:U.b,closeModal:U.a},e)}})(Kx)),Yx=(n(2075),n(425)),Qx=n.n(Yx);function Zx(e){return(Zx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Jx(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Xx(e,t){return!t||"object"!==Zx(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $x(e){return($x=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function eA(e,t){return(eA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function tA(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var nA=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Xx(this,$x(t).call(this,e))).state={visible:!1,rendered:!1},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&eA(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this;e.newMessages>0&&!e.atBottom?this.setState({rendered:!0},function(){t.setState({visible:!0})}):this.setState({visible:!1})}},{key:"render",value:function(){var e="new-messages__button";return this.state.visible&&(e+=" visible"),this.state.rendered||(e+=" disabled"),_.a.createElement("div",{className:e,onTransitionEnd:this.setRendered.bind(this),ref:"indicator"},_.a.createElement("div",{onClick:this.props.onClick},_.a.createElement(Y.c,{id:"posts_view.newMsgBelow",defaultMessage:"New {count, plural, one {message} other {messages}}",values:{count:this.props.newMessages}}),_.a.createElement(kj,{className:"icon icon__unread"})))}},{key:"setRendered",value:function(){this.setState({rendered:this.state.visible})}}])&&Jx(n.prototype,r),o&&Jx(n,o),t}();tA(nA,"propTypes",{atBottom:v.a.bool,onClick:v.a.func.isRequired,newMessages:v.a.number}),tA(nA,"defaultProps",{newMessages:0});var rA=Object(r.connect)(function(){var e=Object(Kc.a)(ea.getAllPosts,p.getCurrentUserId,function(e,t){return t},function(e,t,n){return n},function(e,t,n,r){return n?n.map(function(t){return e[t]}).filter(function(e){return e&&e.user_id!==t&&e.state!==L.Posts.POST_DELETED&&e.create_at>r}).length:0}),t=Object(vp.makePreparePostIdsForPostList)();return function(n,r){var o=Object(ea.getPostIdsInChannel)(n,r.channelId);return o&&(o=t(n,{postIds:o,lastViewedAt:r.lastViewedBottom})),{newMessages:e(n,o,r.lastViewedBottom)}}})(nA),oA=n(148);function aA(e){return(aA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function iA(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function sA(e,t){return!t||"object"!==aA(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function cA(e){return(cA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function lA(e,t){return(lA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var uA=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),sA(this,cA(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lA(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){if(!this.props.fileInfos||0===this.props.fileInfos.length)return null;var e=null;return this.props.fileInfos.length>1&&(e=_.a.createElement(Y.c,{id:"post_body.plusMore",defaultMessage:" plus {count, number} other {count, plural, one {file} other {files}}",values:{count:this.props.fileInfos.length-1}})),_.a.createElement("span",null,this.props.fileInfos[0].name,e)}}])&&iA(n.prototype,r),o&&iA(n,o),t}();!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(uA,"propTypes",{parentPostId:v.a.string.isRequired,fileInfos:v.a.arrayOf(v.a.object)});var pA=Object(r.connect)(function(){var e=Object(Gs.makeGetFilesForPost)();return function(t,n){var r;return n.parentPostId&&(r=e(t,n.parentPostId)),{fileInfos:r}}})(uA);function fA(e){return(fA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dA(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function mA(e){return(mA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function hA(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bA(e,t){return(bA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function yA(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var gA=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=mA(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==fA(o)&&"function"!=typeof o?hA(r):o,yA(hA(n),"handleOnClick",function(){var e=n.props.actions,t=n.makeUsername();e.updateSearchTerms(t),e.showSearchResults()}),yA(hA(n),"makeUsername",function(){var e=n.props.post.props,t=n.props.displayName;return n.props.enablePostUsernameOverride&&e&&"true"===e.from_webhook&&e.override_username&&(t=e.override_username),t}),yA(hA(n),"makeCommentedOnMessage",function(){var e=n.props.post,t="";if(e.message)t=T.gb(e.message);else if(e.file_ids&&e.file_ids.length>0)t=_.a.createElement(pA,{parentPostId:e.id});else if(e.props&&e.props.attachments&&e.props.attachments.length>0){var r=e.props.attachments[0],o=r.pretext||r.title||r.text||r.fallback||"";t=T.gb(o)}return t}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bA(e,t)}(t,E["PureComponent"]),n=t,(r=[{key:"render",value:function(){var e=this.makeUsername(),t=this.makeCommentedOnMessage(),n=_.a.createElement("a",{className:"theme",onClick:this.handleOnClick},e);return _.a.createElement("div",{className:"post__link"},_.a.createElement("span",null,_.a.createElement(Y.c,{id:"post_body.commentedOn",defaultMessage:"Commented on {name}'s message: ",values:{name:n}}),_.a.createElement("a",{className:"theme",onClick:this.props.onCommentClick},Object(oA.c)(t))))}}])&&dA(n.prototype,r),o&&dA(n,o),t}();yA(gA,"propTypes",{displayName:v.a.string,enablePostUsernameOverride:v.a.bool,onCommentClick:v.a.func.isRequired,post:v.a.object.isRequired,actions:v.a.shape({showSearchResults:v.a.func.isRequired,updateSearchTerms:v.a.func.isRequired}).isRequired});var vA=Object(r.connect)(function(e,t){var n="";if(t.post){var r=Object(p.getUser)(e,t.post.user_id);n=Object(T.v)(r)}return{displayName:n,enablePostUsernameOverride:"true"===Object(u.getConfig)(e).EnablePostUsernameOverride}},function(e){return{actions:Object(o.bindActionCreators)({showSearchResults:kc.n,updateSearchTerms:kc.r},e)}})(gA);function EA(e){return(EA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _A(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function OA(e,t){return!t||"object"!==EA(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function wA(e){return(wA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function CA(e,t){return(CA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function SA(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var PA=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=OA(this,wA(t).call(this,e))).sendingAction=new Gc(function(){var e=n.props.post;e&&e.id===e.pending_post_id&&n.setState({sending:!0})}),n.state={sending:!1},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&CA(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"componentDidMount",value:function(){var e=this.props.post;e&&e.id===e.pending_post_id&&this.sendingAction.fireAfter(3e3)}},{key:"componentWillUnmount",value:function(){this.sendingAction.cancel()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.post;t&&t.id!==t.pending_post_id&&(this.sendingAction.cancel(),this.setState({sending:!1}))}},{key:"render",value:function(){var e,t,n=this.props.post,r=this.props.parentPost,o="",a=T.V(n);this.props.isFirstReply&&r&&!a&&(e=_.a.createElement(vA,{post:r,onCommentClick:this.props.handleCommentClick})),this.props.post.failed&&(o+=" post--fail",t=_.a.createElement(Id,{post:this.props.post})),Et.j(this.props.post)&&(o+=" post--edited");var i=null;(n.file_ids&&n.file_ids.length>0||n.filenames&&n.filenames.length>0)&&this.props.post.state!==L.Posts.POST_DELETED&&(i=_.a.createElement(hd,{post:n,compactDisplay:this.props.compactDisplay})),this.state.sending&&(o+=" post-waiting");var s,c=_.a.createElement(_.a.Fragment,null,t,this.state.sending&&_.a.createElement(Cf.a,null),_.a.createElement(Sb,{post:this.props.post,compactDisplay:this.props.compactDisplay,hasMention:!0})),l=n.type&&this.props.pluginPostTypes.hasOwnProperty(n.type)||n.props&&n.props.type&&this.props.pluginPostTypes.hasOwnProperty(n.props.type);s=this.props.post.state===L.Posts.POST_DELETED||l?c:_.a.createElement(yb,{post:this.props.post,isEmbedVisible:this.props.isEmbedVisible},c);var u="";this.props.isCommentMention&&(u="mention-comment");var p="";return a&&(p="post--ephemeral"),_.a.createElement("div",null,e,_.a.createElement("div",{id:"".concat(n.id,"_message"),className:"post__body ".concat(u," ").concat(p," ").concat(o)},s,i,_.a.createElement(Am,{post:n,isReadOnly:this.props.isReadOnly})))}}])&&_A(n.prototype,r),o&&_A(n,o),t}();SA(PA,"propTypes",{post:v.a.object.isRequired,parentPost:v.a.object,parentPostUser:v.a.object,handleCommentClick:v.a.func.isRequired,compactDisplay:v.a.bool,isCommentMention:v.a.bool,isFirstReply:v.a.bool,pluginPostTypes:v.a.object,isEmbedVisible:v.a.bool,enablePostUsernameOverride:v.a.bool.isRequired,isReadOnly:v.a.bool}),SA(PA,"defaultProps",{isReadOnly:!1});var jA=Object(r.connect)(function(e,t){var n,r;t.post.root_id&&(r=(n=Object(ea.getPost)(e,t.post.root_id))?Object(p.getUser)(e,n.user_id):null);var o="true"===Object(u.getConfig)(e).EnablePostUsernameOverride,a=0!==Object(d.getCurrentChannel)(e).delete_at;return{parentPost:n,parentPostUser:r,pluginPostTypes:e.plugins.postTypes,enablePostUsernameOverride:o,isReadOnly:Object(d.isCurrentChannelReadOnly)(e)||a}})(PA);function TA(e){return(TA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kA(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function NA(e){return(NA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function RA(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MA(e,t){return(MA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function IA(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var xA=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=NA(t).call(this,e),n=!o||"object"!==TA(o)&&"function"!=typeof o?RA(r):o,IA(RA(n),"toggleEmojiPicker",function(){var e=!n.state.showEmojiPicker;n.setState({showEmojiPicker:e}),n.props.handleDropdownOpened(e||n.state.showDotMenu)}),IA(RA(n),"removePost",function(){n.props.actions.removePost(n.props.post)}),IA(RA(n),"createRemovePostButton",function(){return _.a.createElement("button",{className:"post__remove theme color--link style--none",type:"button",onClick:n.removePost},"×")}),IA(RA(n),"handleDotMenuOpened",function(e){n.setState({showDotMenu:e}),n.props.handleDropdownOpened(e||n.state.showEmojiPicker)}),IA(RA(n),"getDotMenu",function(){return n.refs.dotMenu}),IA(RA(n),"buildOptions",function(e,t,r){if(!Et.q(e))return null;var o,a,i,s=n.props,c=s.isMobile,l=s.isReadOnly,u=n.props.hover||n.state.showEmojiPicker||n.state.showDotMenu,p=c?"":"pull-right";return(r||!t&&(c||u||!e.root_id&&Boolean(n.props.replyCount)||n.props.isFirstReply))&&(o=_.a.createElement(Dv,{handleCommentClick:n.props.handleCommentClick,commentCount:n.props.replyCount,postId:e.id,extraClass:p})),!t&&u&&!l&&n.props.enableEmojiPicker&&(a=_.a.createElement(bm,{channelId:e.channel_id,postId:e.id,teamId:n.props.teamId,getDotMenuRef:n.getDotMenu,showEmojiPicker:n.state.showEmojiPicker,toggleEmojiPicker:n.toggleEmojiPicker})),(c||u)&&(i=_.a.createElement(Kp,{post:e,commentCount:n.props.replyCount,isFlagged:n.props.isFlagged,handleCommentClick:n.props.handleCommentClick,handleDropdownOpened:n.handleDotMenuOpened,handleAddReactionClick:n.toggleEmojiPicker,isReadOnly:l,enableEmojiPicker:n.props.enableEmojiPicker})),_.a.createElement("div",{ref:"dotMenu",className:"col col__reply"},i,a,o)}),n.state={showEmojiPicker:!1},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&MA(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e,t,n,r,o,a,i=this,s=this.props.post,c=T.V(s),l=Et.m(s),u=Et.e(s);if(!c&&!s.failed&&!l&&(this.props.hover||this.props.isFlagged)&&(e=_.a.createElement($d,{postId:s.id,isFlagged:this.props.isFlagged,isEphemeral:c})),s.props&&s.props.card&&(t=_.a.createElement(vl.a,{delayShow:P.Q.OVERLAY_TIME_DELAY,placement:"top",overlay:_.a.createElement(El.a,null,_.a.createElement(Y.c,{id:"post_info.info.view_additional_info",defaultMessage:"View additional info"}))},_.a.createElement("button",{className:"card-icon__container icon--show style--none "+(this.props.isCardOpen?"active":""),onClick:function(e){e.preventDefault(),i.props.handleCardClick(i.props.post)}},_.a.createElement(Ib,{className:"icon icon__info","aria-hidden":"true"})))),c?n=_.a.createElement("div",{className:"col col__remove"},this.createRemovePostButton()):s.failed||(n=this.buildOptions(s,l,u)),c&&!this.props.compactDisplay&&s.state!==L.Posts.POST_DELETED&&(r=_.a.createElement("span",{className:"post__visibility"},_.a.createElement(Y.c,{id:"post_info.message.visible",defaultMessage:"(Only visible to you)"}))),s.is_pinned&&(o=_.a.createElement("span",{className:"post__pinned-badge"},_.a.createElement(Y.c,{id:"post_info.pinned",defaultMessage:"Pinned"}))),this.props.hover||this.props.showTimeWithoutHover){var p=!(c||L.Posts.POST_DELETED===s.state||Yc.isPostPendingOrFailed(s)||s.type===L.Posts.POST_TYPES.COMBINED_USER_ACTIVITY);a=_.a.createElement(cm,{isPermalink:p,eventTime:s.create_at,postId:s.id})}return _.a.createElement("div",{className:"post__header--info"},_.a.createElement("div",{className:"col"},a,o,t,e,r),n)}}])&&kA(n.prototype,r),o&&kA(n,o),t}();IA(xA,"propTypes",{post:v.a.object.isRequired,teamId:v.a.string,handleCommentClick:v.a.func.isRequired,handleCardClick:v.a.func.isRequired,handleDropdownOpened:v.a.func.isRequired,isFlagged:v.a.bool,isCardOpen:v.a.bool,replyCount:v.a.number,isFirstReply:v.a.bool,isMobile:v.a.bool,compactDisplay:v.a.bool,hover:v.a.bool.isRequired,showTimeWithoutHover:v.a.bool.isRequired,enableEmojiPicker:v.a.bool.isRequired,isReadOnly:v.a.bool,actions:v.a.shape({removePost:v.a.func.isRequired}).isRequired});var AA=Object(r.connect)(function(e,t){var n=Object(Nc.p)(e),r=Object(u.getConfig)(e),o=e.entities.channels.channels[t.post.channel_id],a=o?0!==o.delete_at:null,i="true"===r.EnableEmojiPicker&&!a;return{teamId:Object(f.getCurrentTeamId)(e),isFlagged:null!=Object(l.get)(e,P.z.CATEGORY_FLAGGED_POST,t.post.id,null),isMobile:e.views.channel.mobileView,isCardOpen:n&&n.id===t.post.id,enableEmojiPicker:i,isReadOnly:Object(d.isCurrentChannelReadOnly)(e)||a}},function(e){return{actions:Object(o.bindActionCreators)({removePost:A.removePost},e)}})(xA);function LA(e){return(LA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function DA(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function UA(e,t){return!t||"object"!==LA(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qA(e){return(qA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function HA(e,t){return(HA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var FA=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),UA(this,qA(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&HA(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e,t,n=this.props.post,r=Et.m(n),o=Et.e(n),a=n&&n.props&&"true"===n.props.from_webhook,i=_.a.createElement(Bb,{userId:n.user_id,hasMention:!0});return a&&!this.props.isBot?(i=n.props.override_username&&this.props.enablePostUsernameOverride?_.a.createElement(Bb,{userId:n.user_id,hideStatus:!0,overwriteName:n.props.override_username}):_.a.createElement(Bb,{userId:n.user_id,hideStatus:!0}),e=_.a.createElement(ka.a,null)):o?(i=_.a.createElement(Bb,{userId:n.user_id,hideStatus:!0,hasMention:!0}),e=_.a.createElement(jb.a,null,_.a.createElement(Y.c,{id:"post_info.auto_responder",defaultMessage:"AUTOMATIC REPLY"}))):r&&this.props.isBot?i=_.a.createElement(Bb,{userId:n.user_id,hideStatus:!0}):r&&(i=_.a.createElement(Bb,{overwriteName:_.a.createElement(Y.c,{id:"post_info.system",defaultMessage:"System"}),overwriteImage:P.Q.SYSTEM_MESSAGE_PROFILE_IMAGE,disablePopover:!0})),this.props.compactDisplay&&(t=_.a.createElement("strong",{className:"colon"},":")),_.a.createElement("div",{className:"post__header"},_.a.createElement("div",{className:"col col__name"},i,t,e),_.a.createElement("div",{className:"col"},_.a.createElement(AA,{post:n,handleCommentClick:this.props.handleCommentClick,handleCardClick:this.props.handleCardClick,handleDropdownOpened:this.props.handleDropdownOpened,compactDisplay:this.props.compactDisplay,replyCount:this.props.replyCount,isFirstReply:this.props.isFirstReply,showTimeWithoutHover:this.props.showTimeWithoutHover,hover:this.props.hover})))}}])&&DA(n.prototype,r),o&&DA(n,o),t}();!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(FA,"propTypes",{post:v.a.object.isRequired,handleCommentClick:v.a.func.isRequired,handleCardClick:v.a.func.isRequired,handleDropdownOpened:v.a.func.isRequired,compactDisplay:v.a.bool,replyCount:v.a.number,isFirstReply:v.a.bool,hover:v.a.bool.isRequired,showTimeWithoutHover:v.a.bool,enablePostUsernameOverride:v.a.bool.isRequired,isBot:v.a.bool.isRequired});var BA=Object(r.connect)(function(e,t){var n="true"===Object(u.getConfig)(e).EnablePostUsernameOverride,r=Object(p.getUser)(e,t.post.user_id);return{enablePostUsernameOverride:n,isBot:Boolean(r&&r.is_bot)}})(FA);function GA(e){return(GA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function VA(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function WA(e){return(WA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function KA(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zA(e,t){return(zA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function YA(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var QA=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=WA(t).call(this,e),n=!o||"object"!==GA(o)&&"function"!=typeof o?KA(r):o,YA(KA(n),"handleCommentClick",function(e){e.preventDefault();var t=n.props.post;t&&n.props.actions.selectPost(t)}),YA(KA(n),"handleCardClick",function(e){e&&n.props.actions.selectPostCard(e)}),YA(KA(n),"handleDropdownOpened",function(e){n.props.togglePostMenu&&n.props.togglePostMenu(e),n.setState({dropdownOpened:e})}),YA(KA(n),"hasSameRoot",function(e){var t=e.post;return!e.isFirstReply&&(!(t.root_id||e.previousPostIsComment||!e.consecutivePostByUser)||!!t.root_id)}),YA(KA(n),"getClassName",function(e,t,r,o,a,i){var s="post";(e.failed||e.state===L.Posts.POST_DELETED)&&(s+=" post--hide-controls"),n.props.shouldHighlight&&(s+=" post--highlight");var c="";c=n.state.sameRoot&&!i?"same--root":"other--root";var l="";n.props.currentUserId!==e.user_id||o||t||(l="current--user");var u="";n.props.consecutivePostByUser&&(u="same--user");var p="";return e.root_id&&e.root_id.length>0?p="post--comment":n.props.replyCount>0&&(p="post--root",u="",c=""),(t||r)&&(s+=" post--system",t&&(l="",p="",c="")),a&&(p="post--comment same--root"),n.props.compactDisplay&&(s+=" post--compact"),(n.state.dropdownOpened||n.state.a11yActive)&&(s+=" post--hovered"),e.is_pinned&&(s+=" post--pinned"),s+" "+u+" "+c+" "+p+" "+l}),YA(KA(n),"setHover",function(){n.setState({hover:!0})}),YA(KA(n),"unsetHover",function(){n.setState({hover:!1})}),YA(KA(n),"handleA11yActivateEvent",function(){n.setState({a11yActive:!0,ariaHidden:!1})}),YA(KA(n),"handleA11yDeactivateEvent",function(){n.setState({a11yActive:!1,ariaHidden:!0})}),YA(KA(n),"handlePostFocus",function(){n.setState({currentAriaLabel:n.props.createAriaLabel(n.context.intl)})}),n.postRef=_.a.createRef(),n.state={dropdownOpened:!1,hover:!1,a11yActive:!1,sameRoot:n.hasSameRoot(e),currentAriaLabel:"",ariaHidden:!0},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zA(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.setState({sameRoot:this.hasSameRoot(e)})}},{key:"componentDidMount",value:function(){this.postRef.current.addEventListener(P.c.ACTIVATE,this.handleA11yActivateEvent),this.postRef.current.addEventListener(P.c.DEACTIVATE,this.handleA11yDeactivateEvent)}},{key:"componentWillUnmount",value:function(){this.postRef.current.removeEventListener(P.c.ACTIVATE,this.handleA11yActivateEvent),this.postRef.current.removeEventListener(P.c.DEACTIVATE,this.handleA11yDeactivateEvent)}},{key:"componentDidUpdate",value:function(){this.state.a11yActive&&this.postRef.current.dispatchEvent(new Event(P.c.UPDATE))}},{key:"render",value:function(){var e=this.props.post;if(!e.id)return null;var t,n=Et.m(e),r=Object(Yc.isMeMessage)(e),o=Et.e(e),a=e&&e.props&&"true"===e.props.from_webhook,i=e&&e.props&&"true"===e.props.from_bot,s=this.state.sameRoot&&this.props.consecutivePostByUser&&!e.root_id&&0===this.props.replyCount&&!i;s||(t=_.a.createElement(Sd,{compactDisplay:this.props.compactDisplay,post:e,userId:e.user_id}),o&&(t=_.a.createElement("span",{className:"auto-responder"},t)));var c="";return this.props.center&&(c="center"),_.a.createElement("div",{ref:this.postRef,id:"post_"+e.id,role:"listitem",className:"a11y__section ".concat(this.getClassName(e,n,r,a,o,i)),tabIndex:"0",onFocus:this.handlePostFocus,onBlur:this.removeFocus,onMouseOver:this.setHover,onMouseLeave:this.unsetHover,onTouchStart:this.setHover,"aria-label":this.state.currentAriaLabel,"aria-atomic":!0},_.a.createElement("div",{role:"application",id:"postContent",className:"post__content "+c,"aria-hidden":this.state.ariaHidden},_.a.createElement("div",{className:"post__img"},t),_.a.createElement("div",null,_.a.createElement(BA,{post:e,handleCommentClick:this.handleCommentClick,handleCardClick:this.handleCardClick,handleDropdownOpened:this.handleDropdownOpened,compactDisplay:this.props.compactDisplay,isFirstReply:this.props.isFirstReply,replyCount:this.props.replyCount,showTimeWithoutHover:!s,hover:this.state.hover||this.state.a11yActive}),_.a.createElement(jA,{post:e,handleCommentClick:this.handleCommentClick,compactDisplay:this.props.compactDisplay,isCommentMention:this.props.isCommentMention,isFirstReply:this.props.isFirstReply}))))}}])&&VA(n.prototype,r),o&&VA(n,o),t}();function ZA(e,t){return!!e.root_id&&(!t||e.root_id!==t.id&&e.root_id!==t.root_id)}YA(QA,"propTypes",{post:v.a.object.isRequired,createAriaLabel:v.a.func.isRequired,currentUserId:v.a.string.isRequired,center:v.a.bool,compactDisplay:v.a.bool,isFirstReply:v.a.bool,shouldHighlight:v.a.bool,consecutivePostByUser:v.a.bool,previousPostIsComment:v.a.bool,togglePostMenu:v.a.func,isCommentMention:v.a.bool,replyCount:v.a.number,actions:v.a.shape({selectPost:v.a.func.isRequired,selectPostCard:v.a.func.isRequired}).isRequired}),YA(QA,"contextTypes",{intl:Y.i.isRequired}),YA(QA,"defaultProps",{post:{}});var JA=Object(r.connect)(function(){var e=Object(Kc.a)(function(e){return e.entities.posts.posts},function(e,t){return e.entities.posts.postsInThread[t.root_id||t.id]},function(e,t){return t?t.map(function(t){return e[t]}).filter(function(e){return e&&!Object(Yc.isPostEphemeral)(e)}).length:0}),t=Object(ea.makeIsPostCommentMention)(),n=Object(Et.n)();return function(r,o){var a=o.post||Object(ea.getPost)(r,o.postId),i=null;o.previousPostId&&(i=Object(ea.getPost)(r,o.previousPostId));var s=!1,c=!1;return i&&(s=!(!(a.user_id===i.user_id&&a.create_at-i.create_at<=L.Posts.POST_COLLAPSE_TIMEOUT)||a.props&&a.props.from_webhook||i.props&&i.props.from_webhook||Object(Yc.isSystemMessage)(a)||Object(Yc.isSystemMessage)(i)),c=Boolean(i.root_id)),{post:a,createAriaLabel:n(r,a),currentUserId:Object(p.getCurrentUserId)(r),isFirstReply:ZA(a,i),consecutivePostByUser:s,previousPostIsComment:c,replyCount:e(r,a),isCommentMention:t(r,a.id),center:Object(l.get)(r,P.z.CATEGORY_DISPLAY_SETTINGS,P.z.CHANNEL_DISPLAY_MODE,P.z.CHANNEL_DISPLAY_MODE_DEFAULT)===P.z.CHANNEL_DISPLAY_MODE_CENTERED,compactDisplay:Object(l.get)(r,P.z.CATEGORY_DISPLAY_SETTINGS,P.z.MESSAGE_DISPLAY,P.z.MESSAGE_DISPLAY_DEFAULT)===P.z.MESSAGE_DISPLAY_COMPACT}}},function(e){return{actions:Object(o.bindActionCreators)({selectPost:kc.d,selectPostCard:kc.e},e)}})(QA);var XA=Object(r.connect)(function(){var e=Object(vp.makeGenerateCombinedPost)();return function(t,n){return{post:e(t,n.combinedId),postId:n.combinedId}}})(JA);function $A(e){return($A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eL(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tL(e,t){return!t||"object"!==$A(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function nL(e){return(nL=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rL(e,t){return(rL=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var oL=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),tL(this,nL(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rL(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){return _.a.createElement("span",this.props,_.a.createElement(Y.c,{id:"generic_icons.arrow.down",defaultMessage:"Down Arrow Icon"},function(e){return _.a.createElement("svg",{id:"Layer_1",x:"0px",y:"0px",viewBox:"-239 239 21 23",style:aL,role:"icon","aria-label":e},_.a.createElement("path",{d:"M-239,241.4l2.4-2.4l8.1,8.2l8.1-8.2l2.4,2.4l-10.5,10.6L-239,241.4z M-228.5,257.2l8.1-8.2l2.4,2.4l-10.5,10.6l-10.5-10.6 l2.4-2.4L-228.5,257.2z"}))}))}}])&&eL(n.prototype,r),o&&eL(n,o),t}(),aL={enableBackground:"new -239 239 21 23"};function iL(e){return(iL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sL(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function cL(e,t){return!t||"object"!==iL(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function lL(e){return(lL=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function uL(e,t){return(uL=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var pL=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),cL(this,lL(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&uL(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){if(qc()(window).width()>768)return null;var e="post-list__arrows";return this.props.isScrolling&&!this.props.atBottom&&(e+=" scrolling"),_.a.createElement("div",{className:e,onClick:this.props.onClick},_.a.createElement(oL,null))}}])&&sL(n.prototype,r),o&&sL(n,o),t}();!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(pL,"propTypes",{isScrolling:v.a.bool.isRequired,atBottom:v.a.bool.isRequired,onClick:v.a.func.isRequired});var fL=n(1655),dL=n(1602),mL=n(1788);function hL(e){return(hL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bL(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function yL(e,t){return!t||"object"!==hL(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function gL(e){return(gL=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function vL(e,t){return(vL=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var EL=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),yL(this,gL(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vL(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.currentUserId,n=e.channel,r=e.fullWidth,o=e.locale,a=e.enableUserCreation,i=e.isReadOnly,s=e.channelProfiles,c=e.teamIsGroupConstrained,l="";return r||(l="channel-intro--centered"),n.type===P.i.DM_CHANNEL?function(e,t){var n=T.u(e.id);if(n){var r=n.username;return n.nickname.length>0&&(r=n.nickname),_.a.createElement("div",{id:"channelIntro",className:"channel-intro "+t},_.a.createElement("div",{className:"post-profile-img__container channel-intro-img"},_.a.createElement(bd.a,{src:T.J(n),width:"50",height:"50",userId:n.id,username:n.username,hasMention:!0})),_.a.createElement("div",{className:"channel-intro-profile d-flex"},_.a.createElement(Bb,{userId:n.id,disablePopover:!1,hasMention:!0})),_.a.createElement("p",{className:"channel-intro-text"},_.a.createElement(Fu.b,{id:"intro_messages.DM",defaultMessage:"This is the start of your direct message history with {teammate}.\\nDirect messages and files shared here are not shown to people outside this area.",values:{teammate:r}})),n.is_bot?null:OL(e))}return _.a.createElement("div",{id:"channelIntro",className:"channel-intro "+t},_.a.createElement("p",{className:"channel-intro-text"},_.a.createElement(Y.c,{id:"intro_messages.teammate",defaultMessage:"This is the start of your direct message history with this teammate. Direct messages and files shared here are not shown to people outside this area."})))}(n,l):n.type===P.i.GM_CHANNEL?function(e,t,n,r){if(n.length>0){var o=n.filter(function(e){return e.id!==r}).map(function(e){return _.a.createElement(bd.a,{key:"introprofilepicture"+e.id,src:T.J(e),width:"50",height:"50",userId:e.id,username:e.username})});return _.a.createElement("div",{id:"channelIntro",className:"channel-intro "+t},_.a.createElement("div",{className:"post-profile-img__container channel-intro-img"},o),_.a.createElement("p",{className:"channel-intro-text"},_.a.createElement(Fu.b,{id:"intro_messages.GM",defaultMessage:"This is the start of your group message history with {names}.\\nMessages and files shared here are not shown to people outside this area.",values:{names:e.display_name}})),OL(e))}return _.a.createElement("div",{id:"channelIntro",className:"channel-intro "+t},_.a.createElement("p",{className:"channel-intro-text"},_.a.createElement(Y.c,{id:"intro_messages.group_message",defaultMessage:"This is the start of your group message history with these teammates. Messages and files shared here are not shown to people outside this area."})))}(n,l,s,t):n.name===P.i.DEFAULT_CHANNEL?function(e,t,n,r,o){var a=null;!r&&n&&(a=_.a.createElement(C_.a,{teamId:e.team_id,permissions:[L.Permissions.INVITE_USER]},_.a.createElement(C_.a,{teamId:e.team_id,permissions:[L.Permissions.ADD_USER_TO_TEAM]},!o&&_.a.createElement("span",{className:"intro-links color--link cursor--pointer",onClick:S.l},_.a.createElement(Y.c,{id:"generic_icons.add",defaultMessage:"Add Icon"},function(e){return _.a.createElement("i",{className:"fa fa-user-plus",title:e})}),_.a.createElement(Y.c,{id:"intro_messages.inviteOthers",defaultMessage:"Invite others to this team"})),o&&_.a.createElement(dL.a,{className:"intro-links color--link",dialogType:Aw.a,dialogProps:{channel:e}},_.a.createElement(Y.c,{id:"generic_icons.add",defaultMessage:"Add Icon"},function(e){return _.a.createElement("i",{className:"fa fa-user-plus",title:e})}),_.a.createElement(Y.c,{id:"intro_messages.addGroupsToTeam",defaultMessage:"Add other groups to this team"})))));var i=e.type===P.i.PRIVATE_CHANNEL,s=null;if(!r){var c=OL(e);c&&(s=_.a.createElement(Lp,{teamId:e.team_id,channelId:e.id,permissions:[i?L.Permissions.MANAGE_PRIVATE_CHANNEL_PROPERTIES:L.Permissions.MANAGE_PUBLIC_CHANNEL_PROPERTIES]},c))}return _.a.createElement("div",{id:"channelIntro",className:"channel-intro "+t},_.a.createElement("h4",{className:"channel-intro__title"},_.a.createElement(Y.c,{id:"intro_messages.beginning",defaultMessage:"Beginning of {name}",values:{name:e.display_name}})),_.a.createElement("p",{className:"channel-intro__content"},!r&&_.a.createElement(Fu.b,{id:"intro_messages.default",defaultMessage:"**Welcome to {display_name}!**\\n \\nPost messages here that you want everyone to see. Everyone automatically becomes a permanent member of this channel when they join the team.",values:{display_name:e.display_name}}),r&&_.a.createElement(Fu.b,{id:"intro_messages.readonly.default",defaultMessage:"**Welcome to {display_name}!**\\n \\nMessages can only be posted by system admins. Everyone automatically becomes a permanent member of this channel when they join the team.",values:{display_name:e.display_name}})),a,s,_.a.createElement("br",null))}(n,l,a,i,c):n.name===P.i.OFFTOPIC_CHANNEL?function(e,t){var n=e.type===P.i.PRIVATE_CHANNEL,r=OL(e),o=null;r&&(o=_.a.createElement(Lp,{teamId:e.team_id,channelId:e.id,permissions:[n?L.Permissions.MANAGE_PRIVATE_CHANNEL_PROPERTIES:L.Permissions.MANAGE_PUBLIC_CHANNEL_PROPERTIES]},r));var a=_L(e);return _.a.createElement("div",{id:"channelIntro",className:"channel-intro "+t},_.a.createElement("h4",{className:"channel-intro__title"},_.a.createElement(Y.c,{id:"intro_messages.beginning",defaultMessage:"Beginning of {name}",values:{name:e.display_name}})),_.a.createElement("p",{className:"channel-intro__content"},_.a.createElement(Y.c,{id:"intro_messages.offTopic",defaultMessage:"This is the start of {display_name}, a channel for non-work-related conversations.",values:{display_name:e.display_name}})),a,o)}(n,l):n.type===P.i.OPEN_CHANNEL||n.type===P.i.PRIVATE_CHANNEL?function(e,t,n){var r,o=e.display_name,a=T.w(e.creator_id);r=0!==e.delete_at?"":e.type===P.i.PRIVATE_CHANNEL?_.a.createElement(Y.c,{id:"intro_messages.onlyInvited",defaultMessage:" Only invited members can see this private channel."}):_.a.createElement(Y.c,{id:"intro_messages.anyMember",defaultMessage:" Any member can join and read this channel."});var i,s=_.a.createElement(Y.a,{value:e.create_at,month:Object(Ne.a)(n),day:"2-digit",year:"numeric"});""===a?e.type===P.i.PRIVATE_CHANNEL?i=_.a.createElement(Y.c,{id:"intro_messages.noCreatorPrivate",defaultMessage:"This is the start of the {name} private channel, created on {date}.",values:{name:o,date:s}}):e.type===P.i.OPEN_CHANNEL&&(i=_.a.createElement(Y.c,{id:"intro_messages.noCreator",defaultMessage:"This is the start of the {name} channel, created on {date}.",values:{name:o,date:s}})):e.type===P.i.PRIVATE_CHANNEL?i=_.a.createElement("span",null,_.a.createElement(Y.c,{id:"intro_messages.creatorPrivate",defaultMessage:"This is the start of the {name} private channel, created by {creator} on {date}.",values:{name:o,creator:a,date:s}})):e.type===P.i.OPEN_CHANNEL&&(i=_.a.createElement("span",null,_.a.createElement(Y.c,{id:"intro_messages.creator",defaultMessage:"This is the start of the {name} channel, created by {creator} on {date}.",values:{name:o,creator:a,date:s}})));var c="";e.purpose&&""!==e.purpose&&(e.type===P.i.PRIVATE_CHANNEL?c=_.a.createElement("span",null,_.a.createElement(Y.c,{id:"intro_messages.purposePrivate",defaultMessage:" This private channel's purpose is: {purpose}",values:{purpose:e.purpose}})):e.type===P.i.OPEN_CHANNEL&&(c=_.a.createElement("span",null,_.a.createElement(Y.c,{id:"intro_messages.purpose",defaultMessage:" This channel's purpose is: {purpose}",values:{purpose:e.purpose}}))));var l=e.type===P.i.PRIVATE_CHANNEL,u=null,p=OL(e);p&&(u=_.a.createElement(Lp,{teamId:e.team_id,channelId:e.id,permissions:[l?L.Permissions.MANAGE_PRIVATE_CHANNEL_PROPERTIES:L.Permissions.MANAGE_PUBLIC_CHANNEL_PROPERTIES]},p));var f=_L(e);return _.a.createElement("div",{id:"channelIntro",className:"channel-intro "+t},_.a.createElement("h4",{className:"channel-intro__title"},_.a.createElement(Y.c,{id:"intro_messages.beginning",defaultMessage:"Beginning of {name}",values:{name:o}})),_.a.createElement("p",{className:"channel-intro__content"},i,r,c,_.a.createElement("br",null)),f,u)}(n,l,o):null}}])&&bL(n.prototype,r),o&&bL(n,o),t}();function _L(e){var t=e.group_constrained?$M.a:mN;if(0!==e.delete_at)return null;var n=e.type===P.i.PRIVATE_CHANNEL;return _.a.createElement(Lp,{channelId:e.id,teamId:e.team_id,permissions:[n?L.Permissions.MANAGE_PRIVATE_CHANNEL_MEMBERS:L.Permissions.MANAGE_PUBLIC_CHANNEL_MEMBERS]},_.a.createElement(dL.a,{className:"intro-links color--link",dialogType:t,dialogProps:{channel:e}},_.a.createElement(Y.c,{id:"generic_icons.add",defaultMessage:"Add Icon"},function(e){return _.a.createElement("i",{className:"fa fa-user-plus",title:e})}),n&&e.group_constrained&&_.a.createElement(Y.c,{id:"intro_messages.addGroups",defaultMessage:"Add groups to this private channel"}),n&&!e.group_constrained&&_.a.createElement(Y.c,{id:"intro_messages.invitePrivate",defaultMessage:"Invite others to this private channel"}),!n&&_.a.createElement(Y.c,{id:"intro_messages.invite",defaultMessage:"Invite others to this channel"})))}function OL(e){return 0!==e.delete_at?null:_.a.createElement(Y.c,{id:"intro_messages.setHeader",defaultMessage:"Set a Header"},function(t){return _.a.createElement(fL.a,{modalId:"editChannelHeaderModal",accessibilityLabel:t,className:"intro-links color--link",dialogType:rN,dialogProps:{channel:e}},_.a.createElement(mL.a,null),t)})}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(EL,"propTypes",{currentUserId:v.a.string.isRequired,channel:v.a.object.isRequired,fullWidth:v.a.bool.isRequired,locale:v.a.string.isRequired,channelProfiles:v.a.array.isRequired,enableUserCreation:v.a.bool,isReadOnly:v.a.bool,teamIsGroupConstrained:v.a.bool});var wL=Object(r.connect)(function(e){var t="true"===Object(u.getConfig)(e).EnableUserCreation,n=Object(d.isCurrentChannelReadOnly)(e),r=Object(f.getCurrentTeam)(e);return{currentUserId:Object(p.getCurrentUserId)(e),channel:Object(d.getCurrentChannel)(e),locale:Object(Wc.a)(e),channelProfiles:Object(p.getProfilesInCurrentChannel)(e),enableUserCreation:t,isReadOnly:n,fullWidth:Object(l.get)(e,P.z.CATEGORY_DISPLAY_SETTINGS,P.z.CHANNEL_DISPLAY_MODE,P.z.CHANNEL_DISPLAY_MODE_DEFAULT)===P.z.CHANNEL_DISPLAY_MODE_FULL_SCREEN,teamIsGroupConstrained:Boolean(r.group_constrained)}})(EL);function CL(e){return(CL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function SL(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function PL(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){SL(a,r,o,i,s,"next",e)}function s(e){SL(a,r,o,i,s,"throw",e)}i(void 0)})}}function jL(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function TL(e){return(TL=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function kL(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function NL(e,t){return(NL=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function RL(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ML=10,IL=P.Q.POST_CHUNK_SIZE/2,xL=10,AL=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=TL(t).call(this,e),n=!o||"object"!==CL(o)&&"function"!=typeof o?kL(r):o,RL(kL(n),"loadPostsToFillScreenIfNecessary",function(){n.props.focusedPostId||n.state.isDoingInitialLoad||!n.state.atEnd&&n.refs.postListContent&&n.refs.postlist&&(n.refs.postListContent.scrollHeight>=n.refs.postlist.clientHeight||n.extraPagesLoaded>xL||n.doLoadPostsToFillScreen())}),RL(kL(n),"doLoadPostsToFillScreen",Object(au.debounce)(function(){n.extraPagesLoaded+=1,n.loadMorePosts()},100)),RL(kL(n),"initialScroll",function(){if(n.hasScrolledToNewMessageSeparator)return!1;var e=n.refs.postlist,t=n.props.posts;if(!e||!t)return!1;var r=n.refs.newMessageSeparator;return r&&e.scrollHeight-r.offsetTop>e.clientHeight?(r.scrollIntoView(),n.setUnreadsBelow(t,n.props.currentUserId),!0):(e.scrollTop=e.scrollHeight,n.atBottom=!0,!0)}),RL(kL(n),"setUnreadsBelow",function(e,t){var r=e.reduce(function(e,r){return r.create_at>n.state.lastViewed&&r.user_id!==t&&r.state!==P.Q.POST_DELETED?e+1:e},0);n.mounted&&n.setState({unViewedCount:r})}),RL(kL(n),"handleScrollStop",function(){n.mounted&&n.setState({isScrolling:!1})}),RL(kL(n),"checkBottom",function(){return!n.refs.postlist||(n.refs.postlist.scrollHeight<=n.refs.postlist.clientHeight||n.refs.postlist.clientHeight+n.refs.postlist.scrollTop>=n.refs.postlist.scrollHeight-ML)}),RL(kL(n),"handleWindowResize",function(){n.handleResize()}),RL(kL(n),"handleResize",function(e){var t=n.refs.postlist,r=n.refs.newMessageSeparator,o=n.atBottom||e;if(t){if(o)t.scrollTop=t.scrollHeight;else if(!n.hasScrolled&&r){uu.a.findDOMNode(r).scrollIntoView()}n.previousScrollHeight=t.scrollHeight,n.previousScrollTop=t.scrollTop,n.previousClientHeight=t.clientHeight,n.atBottom=n.checkBottom()}n.props.actions.checkAndSetMobileView()}),RL(kL(n),"loadPosts",function(){var e=PL(regeneratorRuntime.mark(function e(t,r){var o,a,i,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:if(!r){e.next=9;break}return e.next=5,n.props.actions.loadPostsAround(t,r);case 5:a=e.sent,o=a.atOldestmessage,e.next=13;break;case 9:return e.next=11,n.props.actions.loadLatestPosts(t);case 11:i=e.sent,o=i.atOldestmessage;case 13:n.mounted&&n.setState({isDoingInitialLoad:!1,atEnd:o}),r?n.hasScrolledToFocusedPost=!0:(n.checkBottom()||(s=(void 0).order.map(function(e){return(void 0).posts[e]}),n.setUnreadsBelow(s,n.props.currentUserId)),n.hasScrolledToNewMessageSeparator=!0);case 15:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()),RL(kL(n),"loadMorePosts",function(){var e=PL(regeneratorRuntime.mark(function e(t){var r,o,a,i,s,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.preventDefault(),r=n.props,o=r.posts,a=r.channel,i=o.length,o){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,n.props.actions.loadPosts({channelId:a.id,postId:o[i-1].id,type:P.x.BEFORE_ID});case 7:s=e.sent,c=s.moreToLoad,n.setState({atEnd:!c});case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),RL(kL(n),"handleScroll",function(){n.hasScrolled=n.hasScrolledToNewMessageSeparator||n.hasScrolledToFocusedPost,n.refs.postlist&&(n.updateFloatingTimestamp(),n.previousScrollTop=n.refs.postlist.scrollTop,n.refs.postlist.scrollHeight===n.previousScrollHeight&&(n.atBottom=n.checkBottom()),n.state.isScrolling||n.setState({isScrolling:!0}),n.checkBottom()&&n.setState({lastViewed:(new Date).getTime(),unViewedCount:0,isScrolling:!1}),n.scrollStopAction.fireAfter(P.Q.SCROLL_DELAY))}),RL(kL(n),"updateFloatingTimestamp",function(){if(T.U()&&n.props.posts)for(var e=0;e<n.props.posts.length;e++){var t=n.props.posts[e],r=n.refs[t.id],o=uu.a.findDOMNode(r);if(!r||!o||o.offsetTop+o.clientHeight<=n.refs.postlist.scrollTop){var a=void 0;a=e>0?n.props.posts[e-1]:t,n.state.topPost&&a.id===n.state.topPost.id||n.setState({topPost:a});break}}}),RL(kL(n),"scrollToBottom",function(){n.refs.postlist&&(n.refs.postlist.scrollTop=n.refs.postlist.scrollHeight)}),RL(kL(n),"createPosts",function(e){for(var t=[],r=new Date(0),o="",a=n.props.currentUserId,i=n.props.lastViewedAt||0,s=!1,c=e.length-1;c>=0;c--){var l=e[c],u=void 0;if(null!=l&&l.type!==P.y.EPHEMERAL_ADD_TO_CHANNEL){u=Object(vp.isCombinedUserActivityPost)(l.id)?_.a.createElement(XA,{combinedId:l.id,previousPostId:o}):_.a.createElement(JA,{ref:l.id,key:"post "+(l.id||l.pending_post_id),post:l,shouldHighlight:n.props.focusedPostId===l.id,previousPostId:o});var p=T.s(l.create_at);if(p.toDateString()!==r.toDateString()&&t.push(_.a.createElement(gp,{key:p,date:p})),(l.user_id!==a||Object(Et.l)(l))&&0!==i&&l.create_at>i&&!T.V(l)&&!s){s=!0;var f="";j.f()||(f="new_message_"+l.id),t.push(_.a.createElement("div",{id:f,key:"unviewed",ref:"newMessageSeparator",className:"new-separator"},_.a.createElement("hr",{className:"separator__hr"}),_.a.createElement("div",{className:"separator__text"},_.a.createElement(Y.c,{id:"posts_view.newMsg",defaultMessage:"New Messages"}))))}t.push(u),r=p,o=l.id}}return t}),n.scrollStopAction=new Gc(n.handleScrollStop),n.previousScrollTop=Number.MAX_SAFE_INTEGER,n.previousScrollHeight=0,n.previousClientHeight=0,n.atBottom=!1,n.extraPagesLoaded=0,n.loadingPosts=!1,n.state={atEnd:!1,unViewedCount:0,isDoingInitialLoad:!0,isScrolling:!1,lastViewed:e.lastViewedAt},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&NL(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"componentDidMount",value:function(){this.mounted=!0,this.loadPosts(this.props.channel.id,this.props.focusedPostId),this.props.actions.checkAndSetMobileView(),Qx.a.addListener(P.l.POST_LIST_SCROLL_CHANGE,this.handleResize),window.addEventListener("resize",this.handleWindowResize),this.initialScroll()}},{key:"componentWillUnmount",value:function(){this.mounted=!1,Qx.a.removeListener(P.l.POST_LIST_SCROLL_CHANGE,this.handleResize),window.removeEventListener("resize",this.handleWindowResize)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){if(e.focusedPostId&&this.props.focusedPostId!==e.focusedPostId)return this.hasScrolledToFocusedPost=!1,this.hasScrolledToNewMessageSeparator=!1,this.setState({atEnd:!1,isDoingInitialLoad:!e.posts}),void this.loadPosts(e.channel.id,e.focusedPostId);var t=this.props.channel||{},n=e.channel||{};null==e.focusedPostId&&t.id!==n.id&&(this.hasScrolled=!1,this.hasScrolledToFocusedPost=!1,this.hasScrolledToNewMessageSeparator=!1,this.atBottom=!1,this.extraPagesLoaded=0,this.setState({atEnd:!1,lastViewed:e.lastViewedAt,isDoingInitialLoad:!e.posts,unViewedCount:0}),n.id&&this.loadPosts(n.id))}},{key:"UNSAFE_componentWillUpdate",value:function(){this.refs.postlist&&(this.previousScrollTop=this.refs.postlist.scrollTop,this.previousScrollHeight=this.refs.postlist.scrollHeight,this.previousClientHeight=this.refs.postlist.clientHeight)}},{key:"componentDidUpdate",value:function(e,t){if(this.props.focusedPostId&&this.props.focusedPostId!==e.focusedPostId?(this.hasScrolledToFocusedPost=!1,this.hasScrolledToNewMessageSeparator=!1,this.loadPosts(this.props.channel.id,this.props.focusedPostId)):!this.props.channel||e.channel&&this.props.channel.id===e.channel.id||(this.hasScrolled=!1,this.hasScrolledToFocusedPost=!1,this.hasScrolledToNewMessageSeparator=!1,this.extraPagesLoaded=0,this.setState({atEnd:!1,isDoingInitialLoad:!this.props.posts,unViewedCount:0}),this.loadPosts(this.props.channel.id)),this.loadPostsToFillScreenIfNecessary(),this.props.posts!==e.posts||this.props.postVisibility!==e.postVisibility||this.state.atEnd!==t.atEnd){var n=e.posts||[],r=this.props.posts||[];if(null==this.props.focusedPostId){var o=0===n.length&&r.length>0||n.length>0&&r.length>0&&n[0].id!==r[0].id;!this.checkBottom()&&o&&this.setUnreadsBelow(r,this.props.currentUserId)}var a=this.refs.postlist;if(a){var i=this.refs[this.props.focusedPostId];if(i&&this.props.posts)if(this.hasScrolledToFocusedPost)this.previousScrollHeight!==a.scrollHeight&&r[0].id===n[0].id&&(a.scrollTop=this.previousScrollTop+(a.scrollHeight-this.previousScrollHeight));else{var s=uu.a.findDOMNode(i).getBoundingClientRect(),c=a.clientHeight/2;a.scrollTop+=s.top-c,this.atBottom=this.checkBottom()}else{var l=this.initialScroll();if(r.length>=IL&&(this.hasScrolledToNewMessageSeparator=!0),!l&&a&&n&&r&&r[0]&&n[0]){var u=!1,p=r[0].id,f=n[0].id,d=r[0].pending_post_id;if(p!==f&&d!==f&&(this.atBottom&&(u=!0),T.V(r[0])&&(u=!0)),u)return this.atBottom=!0,void(a.scrollTop=a.scrollHeight);this.previousScrollHeight!==a.scrollHeight&&r[0].id===n[0].id&&(a.scrollTop=this.previousScrollTop+(a.scrollHeight-this.previousScrollHeight))}}}}}},{key:"render",value:function(){var e,t=this.props.posts||[],n=this.props.channel;if(0===t.length&&this.state.isDoingInitialLoad||null==n)return _.a.createElement("div",{id:"post-list",className:"a11y__region","data-a11y-sort-order":"1","data-a11y-focus-child":!0,"data-a11y-order-reversed":!0,"data-a11y-loop-navigation":!1},_.a.createElement(Vw.a,{position:"absolute",key:"loading"}));e=this.state.atEnd?_.a.createElement(wL,{channel:n}):this.props.postVisibility>=P.Q.MAX_POST_VISIBILITY?_.a.createElement("div",{className:"post-list__loading post-list__loading-search"},_.a.createElement(Y.c,{id:"posts_view.maxLoaded",defaultMessage:"Looking for a specific message? Try searching for it"})):_.a.createElement("button",{ref:"loadmoretop",className:"more-messages-text theme style--none color--link",onClick:this.loadMorePosts},_.a.createElement(Y.c,{id:"posts_view.loadMore",defaultMessage:"Load more messages"}));var r=this.state.topPost?this.state.topPost.create_at:0,o=this.props.postVisibility;return this.props.focusedPostId&&(o+=P.Q.POST_CHUNK_SIZE/2),_.a.createElement("div",{id:"post-list",className:"a11y__region","data-a11y-sort-order":"1","data-a11y-focus-child":!0,"data-a11y-order-reversed":!0,"data-a11y-loop-navigation":!1},_.a.createElement(Pp,{isScrolling:this.state.isScrolling,isMobile:T.U(),createAt:r}),_.a.createElement(pL,{isScrolling:this.state.isScrolling,atBottom:this.atBottom,onClick:this.scrollToBottom}),!this.props.focusedPostId&&_.a.createElement(rA,{atBottom:this.atBottom,lastViewedBottom:this.state.lastViewed,onClick:this.scrollToBottom,channelId:this.props.channel.id}),_.a.createElement("div",{ref:"postlist",className:"post-list-holder-by-time normal_post_list",key:"postlist-"+n.id,onScroll:this.handleScroll},_.a.createElement("div",{className:"post-list__table"},_.a.createElement("div",{id:"postListContent",ref:"postListContent",className:"post-list__content"},e,this.createPosts(t.slice(0,o))))))}}])&&jL(n.prototype,r),o&&jL(n,o),t}();RL(AL,"propTypes",{posts:v.a.array,postVisibility:v.a.number,channel:v.a.object.isRequired,lastViewedAt:v.a.number,currentUserId:v.a.string,focusedPostId:v.a.string,actions:v.a.shape({loadLatestPosts:v.a.func.isRequired,loadPosts:v.a.func.isRequired,checkAndSetMobileView:v.a.func.isRequired,loadPostsAround:v.a.func.isRequired}).isRequired});var LL=Object(r.connect)(function(){var e=Object(ea.makeGetPostsInChannel)(),t=Object(ea.makeGetPostsAroundPost)(),n=Object(K.c)();return function(r,o){var a,i=r.views.channel.postVisibility[o.channelId];return a=o.focusedPostId?t(r,o.focusedPostId,o.channelId):e(r,o.channelId,i),{posts:n(a||[]),currentUserId:Object(p.getCurrentUserId)(r),lastViewedAt:r.views.channel.lastChannelViewTime[o.channelId],channel:Object(d.getCurrentChannel)(r),postVisibility:i}}})(AL),DL=n(2076),UL=n(2379);function qL(e){return(qL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function HL(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function FL(e,t){return!t||"object"!==qL(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function BL(e){return(BL=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function GL(e,t){return(GL=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var VL=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),FL(this,BL(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&GL(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){return _.a.createElement("div",{id:this.props.separatorId,className:"new-separator"},_.a.createElement("hr",{className:"separator__hr"}),_.a.createElement("div",{className:"separator__text"},_.a.createElement(Y.c,{id:"posts_view.newMsg",defaultMessage:"New Messages"})))}}])&&HL(n.prototype,r),o&&HL(n,o),t}();function WL(e){return(WL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function KL(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function zL(e,t){return!t||"object"!==WL(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function YL(e){return(YL=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function QL(e,t){return(QL=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(VL,"propTypes",{separatorId:v.a.string.isRequired});var ZL=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),zL(this,YL(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&QL(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.listId,n=e.previousListId;if(vp.isDateLine(t)){var r=vp.getDateForDateLine(t);return _.a.createElement(gp,{key:r,date:r})}if(vp.isStartOfNewMessages(t))return _.a.createElement(VL,{separatorId:t});if(t===P.w.CHANNEL_INTRO_MESSAGE)return _.a.createElement(wL,null);if(t===P.w.LOAD_OLDER_MESSAGES_TRIGGER||t===P.w.LOAD_NEWER_MESSAGES_TRIGGER)return _.a.createElement("button",{className:"more-messages-text theme style--none color--link",onClick:t===P.w.LOAD_OLDER_MESSAGES_TRIGGER?this.props.loadOlderPosts:this.props.loadNewerPosts},_.a.createElement(Y.c,{id:"posts_view.loadMore",defaultMessage:"Load more messages"}));if(t===P.w.OLDER_MESSAGES_LOADER||t===P.w.NEWER_MESSAGES_LOADER)return _.a.createElement("div",{className:"loading-screen"},_.a.createElement("div",{className:"loading__content"},_.a.createElement("div",{className:"round round-1"}),_.a.createElement("div",{className:"round round-2"}),_.a.createElement("div",{className:"round round-3"})));var o={previousPostId:n,shouldHighlight:this.props.shouldHighlight,togglePostMenu:this.props.togglePostMenu};return vp.isCombinedUserActivityPost(t)?_.a.createElement(XA,Object.assign({combinedId:t},o)):_.a.createElement(JA,Object.assign({postId:t},o))}}])&&KL(n.prototype,r),o&&KL(n,o),t}();!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(ZL,"propTypes",{listId:v.a.string.isRequired,previousListId:v.a.string,fullWidth:v.a.bool,shouldHighlight:v.a.bool,loadOlderPosts:v.a.func,loadNewerPosts:v.a.func,togglePostMenu:v.a.func});var JL=Object(r.connect)(function(e,t){return{post:t.post,channel:t.channel}})(ZL);function XL(e){return(XL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $L(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function eD(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){aD(e,t,n[t])})}return e}function tD(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function nD(e){return(nD=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rD(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oD(e,t){return(oD=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function aD(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var iD=window.OVERSCAN_COUNT_BACKWARD||80,sD=window.OVERSCAN_COUNT_FORWARD||80,cD=window.HEIGHT_TRIGGER_FOR_MORE_POSTS||1e3,lD=10,uD={channel:50,permalink:100},pD={padding:"14px 0px 7px"},fD={position:"absolute",bottom:"0",maxHeight:"100%"},dD=function(e){function t(e){var n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=nD(t).call(this,e),n=!o||"object"!==XL(o)&&"function"!=typeof o?rD(r):o,aD(rD(n),"getNewMessagesSeparatorIndex",function(e){return e.findIndex(function(e){return 0===e.indexOf(P.w.START_OF_NEW_MESSAGES)})}),aD(rD(n),"scrollChange",function(e){e&&n.scrollToLatestMessages()}),aD(rD(n),"handleWindowResize",function(){n.props.actions.checkAndSetMobileView();var e=T.U();if(e!==n.state.isMobile){var t=n.state.dynamicListStyle;n.state.postMenuOpened&&(e||"unset"!==t.willChange?e&&"transform"===t.willChange&&(t.willChange="unset"):t.willChange="transform"),n.setState({isMobile:e,dynamicListStyle:t}),n.scrollStopAction=new Gc(n.handleScrollStop)}}),aD(rD(n),"togglePostMenu",function(e){var t=n.state.dynamicListStyle;n.state.isMobile&&(t.willChange=e?"unset":"transform"),n.setState({postMenuOpened:e,dynamicListStyle:t})}),aD(rD(n),"renderRow",function(e){var t=e.data,r=e.itemId,o=e.style,a=t.indexOf(r),i="",s=-1!==a&&a<t.length-1?t[a+1]:"",c=a>0&&a<t.length?t[a-1]:"";return(Object(vp.isDateLine)(c)||Object(vp.isStartOfNewMessages)(c))&&(i+="post-row__padding bottom"),(Object(vp.isDateLine)(s)||Object(vp.isStartOfNewMessages)(s))&&(i.includes("post-row__padding")?i+=" top":i+="post-row__padding top"),_.a.createElement("div",{style:o,className:i},_.a.createElement(JL,{listId:r,previousListId:Object(Et.i)(t,a),shouldHighlight:r===n.props.focusedPostId,loadOlderPosts:n.props.actions.loadOlderPosts,loadNewerPosts:n.props.actions.loadNewerPosts,togglePostMenu:n.togglePostMenu}))}),aD(rD(n),"itemKey",function(e){var t=n.state.postListIds;return t[e]?t[e]:e}),aD(rD(n),"onScroll",function(e){var t=e.scrollDirection,r=e.scrollOffset,o=e.scrollUpdateWasRequested,a=e.clientHeight,i=e.scrollHeight,s="backward"===t&&!o,c="forward"===t&&!o,l=r<cD,u=i-a-r<cD,p=!n.props.olderPosts.allLoaded&&!n.props.olderPosts.loading,f=!n.props.newerPosts.allLoaded&&!n.props.newerPosts.loading;(s&&l&&p?n.props.actions.loadOlderPosts():c&&u&&f&&n.props.actions.loadNewerPosts(),n.state.isMobile&&(n.state.isScrolling||n.setState({isScrolling:!0}),n.scrollStopAction&&n.scrollStopAction.fireAfter(P.Q.SCROLL_DELAY)),o)&&(n.listRef.current._getRangeToRender()[3]<=1&&f&&n.props.actions.canLoadMorePosts(P.x.AFTER_ID));n.checkBottom(r,i,a)}),aD(rD(n),"checkBottom",function(e,t,r){n.updateAtBottom(n.isAtBottom(e,t,r))}),aD(rD(n),"isAtBottom",function(e,t,n){return t-n-e<=lD&&t>0}),aD(rD(n),"updateAtBottom",function(e){if(e!==n.state.atBottom){var t=Date.now();n.props.latestPostTimeStamp>t&&(t=n.props.latestPostTimeStamp),n.setState({atBottom:e,lastViewedBottom:t})}}),aD(rD(n),"handleScrollStop",function(){n.mounted&&n.setState({isScrolling:!1})}),aD(rD(n),"updateFloatingTimestamp",function(e){n.state.isMobile&&n.props.postListIds&&n.setState({topPostId:Object(Et.g)(n.props.postListIds.slice(e))})}),aD(rD(n),"onItemsRendered",function(e){var t=e.visibleStartIndex;n.updateFloatingTimestamp(t)}),aD(rD(n),"initScrollToIndex",function(){if(n.props.focusedPostId)return{index:n.state.postListIds.findIndex(function(e){return e===n.props.focusedPostId}),position:"center"};var e=n.state.postListIds.findIndex(function(e){return 0===e.indexOf(P.w.START_OF_NEW_MESSAGES)});return e>0?Object(vp.isDateLine)(n.state.postListIds[e+1])?{index:e+1,position:"start"}:{index:e,position:"start"}:(n.setState({atBottom:!0}),{index:0,position:"end"})}),aD(rD(n),"scrollToLatestMessages",function(){n.props.newerPosts.allLoaded?n.scrollToBottom():n.props.actions.changeUnreadChunkTimeStamp("")}),aD(rD(n),"scrollToBottom",function(){n.listRef.current.scrollToItem(0,"end")});var a=P.w.CHANNEL_INTRO_MESSAGE,i=T.U();n.state={isScrolling:!1,isMobile:i,atBottom:!1,lastViewedBottom:Date.now(),postListIds:[a],topPostId:"",postMenuOpened:!1,dynamicListStyle:{willChange:"transform"}},n.listRef=_.a.createRef(),n.postListRef=_.a.createRef(),i&&(n.scrollStopAction=new Gc(n.handleScrollStop)),n.initRangeToRender=n.props.focusedPostId?[0,uD.permalink]:[0,uD.channel];var s=0;s=e.focusedPostId?n.props.postListIds.findIndex(function(e){return e===n.props.focusedPostId}):n.getNewMessagesSeparatorIndex(e.postListIds);var c=e.focusedPostId?uD.permalink:uD.channel;return n.initRangeToRender=[Math.max(s-30,0),Math.max(s+30,Math.min(e.postListIds.length-1,c))],n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&oD(e,t)}(t,_.a.PureComponent),n=t,o=[{key:"getDerivedStateFromProps",value:function(e){var t,n=e.postListIds;return t=e.olderPosts.allLoaded?[].concat($L(n),[P.w.CHANNEL_INTRO_MESSAGE]):e.autoRetryEnable?[].concat($L(n),[P.w.OLDER_MESSAGES_LOADER]):[].concat($L(n),[P.w.LOAD_OLDER_MESSAGES_TRIGGER]),e.newerPosts.allLoaded||(t=e.autoRetryEnable?[P.w.NEWER_MESSAGES_LOADER].concat($L(t)):[P.w.LOAD_NEWER_MESSAGES_TRIGGER].concat($L(t))),{postListIds:t}}}],(r=[{key:"componentDidMount",value:function(){this.mounted=!0,this.props.actions.checkAndSetMobileView(),window.addEventListener("resize",this.handleWindowResize),Qx.a.addListener(P.l.POST_LIST_SCROLL_CHANGE,this.scrollChange)}},{key:"getSnapshotBeforeUpdate",value:function(e){if(this.postListRef&&this.postListRef.current){var t=this.props.postListIds.length!==e.postListIds.length&&this.props.postListIds[0]===e.postListIds[0],n=this.props.olderPosts.allLoaded!==e.olderPosts.allLoaded;if((t||n)&&!this.state.atBottom){var r=this.postListRef.current;return{previousScrollTop:r.parentElement.scrollTop,previousScrollHeight:r.scrollHeight}}}return null}},{key:"componentDidUpdate",value:function(e,t,n){if(this.postListRef.current&&n){var r=this.postListRef.current.scrollHeight,o=this.props.postListIds.length!==e.postListIds.length&&this.props.postListIds[0]===e.postListIds[0],a=this.props.olderPosts.allLoaded!==e.olderPosts.allLoaded;if((o||a)&&!this.state.atBottom){var i=n.previousScrollTop+(r-n.previousScrollHeight);0!==i&&i-n.previousScrollTop!=0&&this.listRef.current.scrollTo(i,i-n.previousScrollTop,!0)}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1,window.removeEventListener("resize",this.handleWindowResize),Qx.a.removeListener(P.l.POST_LIST_SCROLL_CHANGE,this.scrollChange)}},{key:"render",value:function(){var e,t=this,n=this.props.channelId;this.props.latestAriaLabelFunc&&this.props.postListIds.indexOf(P.w.START_OF_NEW_MESSAGES)>=0&&(e=this.props.latestAriaLabelFunc(this.context.intl));var r=this.state.dynamicListStyle,o=null;return this.props.focusedPostId||(o=_.a.createElement(rA,{atBottom:this.state.atBottom,lastViewedBottom:this.state.lastViewedBottom,postIds:this.state.postListIds,onClick:this.scrollToLatestMessages,channelId:n})),_.a.createElement("div",{id:"post-list",className:"a11y__region","data-a11y-sort-order":"1","data-a11y-focus-child":!0,"data-a11y-order-reversed":!0,"data-a11y-loop-navigation":!1,"aria-label":T.ab("accessibility.sections.centerContent","message list main region")},this.state.isMobile&&_.a.createElement(_.a.Fragment,null,_.a.createElement(Pp,{isScrolling:this.state.isScrolling,isMobile:!0,postId:this.state.topPostId}),_.a.createElement(pL,{isScrolling:this.state.isScrolling,atBottom:this.state.atBottom,onClick:this.scrollToBottom})),o,_.a.createElement("div",{role:"presentation",className:"post-list-holder-by-time",key:"postlist-"+n},_.a.createElement("div",{role:"presentation",className:"post-list__table"},_.a.createElement("div",{id:"postListContent",className:"post-list__content"},_.a.createElement("span",{className:"sr-only","aria-live":"polite"},e),_.a.createElement(DL.a,null,function(e){var n=e.height,o=e.width;return _.a.createElement(UL.a,{role:"listbox",ref:t.listRef,height:n,width:o,className:"post-list__dynamic",itemCount:t.state.postListIds.length,itemData:t.state.postListIds,itemKey:t.itemKey,overscanCountForward:sD,overscanCountBackward:iD,onScroll:t.onScroll,onItemsRendered:t.onItemsRendered,initScrollToIndex:t.initScrollToIndex,canLoadMorePosts:t.props.actions.canLoadMorePosts,skipResizeClass:"col__reply",innerRef:t.postListRef,style:eD({},fD,r),innerListStyle:pD,initRangeToRender:t.initRangeToRender,loaderId:P.w.OLDER_MESSAGES_LOADER,correctScrollToBottom:t.props.newerPosts.allLoaded},t.renderRow)})))))}}])&&tD(n.prototype,r),o&&tD(n,o),t}();function mD(e){return(mD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hD(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function bD(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){hD(a,r,o,i,s,"next",e)}function s(e){hD(a,r,o,i,s,"throw",e)}i(void 0)})}}function yD(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gD(e){return(gD=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function vD(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ED(e,t){return(ED=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _D(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}aD(dD,"propTypes",{postListIds:v.a.array.isRequired,focusedPostId:v.a.string,channelId:v.a.string.isRequired,autoRetryEnable:v.a.bool,newerPosts:v.a.shape({loading:v.a.bool,allLoaded:v.a.bool}),olderPosts:v.a.shape({loading:v.a.bool,allLoaded:v.a.bool}),latestPostTimeStamp:v.a.number,latestAriaLabelFunc:v.a.func,actions:v.a.shape({loadOlderPosts:v.a.func.isRequired,loadNewerPosts:v.a.func.isRequired,canLoadMorePosts:v.a.func.isRequired,checkAndSetMobileView:v.a.func.isRequired,changeUnreadChunkTimeStamp:v.a.func.isRequired}).isRequired}),aD(dD,"contextTypes",{intl:Y.i.isRequired});var OD=3,wD=10,CD=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=gD(t).call(this,e),n=!o||"object"!==mD(o)&&"function"!=typeof o?vD(r):o,_D(vD(n),"postsOnLoad",function(){var e=bD(regeneratorRuntime.mark(function e(t){var r,o,a,i,s,c,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.props.focusedPostId){e.next=9;break}return e.next=3,n.props.actions.loadPostsAround(t,n.props.focusedPostId);case 3:i=e.sent,a=i.atLatestMessage,o=i.atOldestmessage,r=i.error,e.next=31;break;case 9:if(!n.props.isFirstLoad){e.next=18;break}return e.next=12,n.props.actions.loadUnreads(t);case 12:s=e.sent,a=s.atLatestMessage,o=s.atOldestmessage,r=s.error,e.next=31;break;case 18:if(!n.props.latestPostTimeStamp){e.next=25;break}return e.next=21,n.props.actions.syncPostsInChannel(t,n.props.latestPostTimeStamp);case 21:c=e.sent,r=c.error,e.next=31;break;case 25:return e.next=27,n.props.actions.loadLatestPosts(t);case 27:l=e.sent,a=l.atLatestMessage,o=l.atOldestmessage,r=l.error;case 31:if(!r){e.next=33;break}return e.abrupt("return");case 33:void 0!==a&&n.setState({olderPosts:{loading:!1,allLoaded:o},newerPosts:{loading:!1,allLoaded:a}});case 34:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),_D(vD(n),"setLoadingPosts",function(e){n.setState(_D({},e,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){_D(e,t,n[t])})}return e}({},n.state[e],{loading:!0})))}),_D(vD(n),"callLoadPosts",function(){var e=bD(regeneratorRuntime.mark(function e(t,r,o){var a,i,s,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={},e.next=3,n.props.actions.loadPosts({channelId:t,postId:r,type:o});case 3:if(i=e.sent,s=i.moreToLoad,c=i.error,a=o===P.x.BEFORE_ID?{olderPosts:{loading:!1,allLoaded:!s}}:{newerPosts:{loading:!1,allLoaded:!s}},n.setState(a),!c){e.next=18;break}if(!(n.autoRetriesCount<OD)){e.next=15;break}return n.autoRetriesCount++,e.next=13,n.callLoadPosts(t,r,o);case 13:e.next=16;break;case 15:n.mounted&&n.setState({autoRetryEnable:!1});case 16:e.next=20;break;case 18:n.mounted&&n.setState({autoRetryEnable:!0}),n.state.autoRetryEnable||(n.autoRetriesCount=0);case 20:return e.abrupt("return",{moreToLoad:s,error:c});case 21:case"end":return e.stop()}},e)}));return function(t,n,r){return e.apply(this,arguments)}}()),_D(vD(n),"getOldestVisiblePostId",function(){return Object(Et.h)(n.props.postListIds)}),_D(vD(n),"getLatestVisiblePostId",function(){return Object(Et.g)(n.props.postListIds)}),_D(vD(n),"canLoadMorePosts",bD(regeneratorRuntime.mark(function e(){var t,r,o,a=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.length>0&&void 0!==a[0]?a[0]:P.x.BEFORE_ID,n.props.postListIds){e.next=3;break}return e.abrupt("return");case 3:if(!n.state.olderPosts.loading&&!n.state.newerPosts.loading){e.next=5;break}return e.abrupt("return");case 5:if(!(n.extraPagesLoaded>wD)){e.next=8;break}return n.state.autoRetryEnable&&n.setState({autoRetryEnable:!1}),e.abrupt("return");case 8:if(n.state.olderPosts.allLoaded||t!==P.x.BEFORE_ID){e.next=14;break}return r=n.getOldestVisiblePostId(),e.next=12,n.getPostsBefore(r);case 12:e.next=18;break;case 14:if(n.state.newerPosts.allLoaded){e.next=18;break}return o=n.getLatestVisiblePostId(),e.next=18,n.getPostsAfter(o);case 18:n.extraPagesLoaded+=1;case 19:case"end":return e.stop()}},e)}))),_D(vD(n),"getPostsBefore",bD(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.state.olderPosts.loading){e.next=2;break}return e.abrupt("return");case 2:return t=n.getOldestVisiblePostId(),n.setLoadingPosts("olderPosts"),e.next=6,n.callLoadPosts(n.props.channelId,t,P.x.BEFORE_ID);case 6:case"end":return e.stop()}},e)}))),_D(vD(n),"getPostsAfter",bD(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.state.newerPosts.loading){e.next=2;break}return e.abrupt("return");case 2:return t=n.getLatestVisiblePostId(),n.setLoadingPosts("newerPosts"),e.next=6,n.callLoadPosts(n.props.channelId,t,P.x.AFTER_ID);case 6:case"end":return e.stop()}},e)}))),n.state={newerPosts:{loading:!1,allLoaded:e.atLatestPost},olderPosts:{loading:!1,allLoaded:!1},autoRetryEnable:!0},n.autoRetriesCount=0,n.loadingMorePosts=null,n.actionsForPostList={loadOlderPosts:n.getPostsBefore,loadNewerPosts:n.getPostsAfter,checkAndSetMobileView:e.actions.checkAndSetMobileView,canLoadMorePosts:n.canLoadMorePosts,changeUnreadChunkTimeStamp:e.changeUnreadChunkTimeStamp},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ED(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"componentDidMount",value:function(){this.mounted=!0,this.props.channelId&&this.postsOnLoad(this.props.channelId)}},{key:"componentDidUpdate",value:function(e){this.props.channelId!==e.channelId&&this.postsOnLoad(this.props.channelId)}},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"render",value:function(){return this.props.postListIds?_.a.createElement("div",{id:"post-list"},_.a.createElement("div",{ref:"postlist",className:"post-list-holder-by-time",key:"postlist-"+this.props.channelId},_.a.createElement("div",{className:"post-list__table"},_.a.createElement("div",{id:"virtualizedPostListContent",ref:"postListContent",className:"post-list__content"},_.a.createElement(dD,{newerPosts:this.state.newerPosts,olderPosts:this.state.olderPosts,focusedPostId:this.props.focusedPostId,channelId:this.props.channelId,autoRetryEnable:this.state.autoRetryEnable,actions:this.actionsForPostList,postListIds:this.props.formattedPostIds,latestPostTimeStamp:this.props.latestPostTimeStamp,latestAriaLabelFunc:this.props.latestAriaLabelFunc}))))):_.a.createElement("div",{id:"post-list"},_.a.createElement(Vw.a,{position:"absolute",key:"loading"}))}}])&&yD(n.prototype,r),o&&yD(n,o),t}();_D(CD,"propTypes",{formattedPostIds:v.a.array,postListIds:v.a.array,channelId:v.a.string,focusedPostId:v.a.string,atLatestPost:v.a.bool,isFirstLoad:v.a.bool,latestPostTimeStamp:v.a.number,latestAriaLabelFunc:v.a.func,changeUnreadChunkTimeStamp:v.a.func.isRequired,actions:v.a.shape({loadPostsAround:v.a.func.isRequired,loadUnreads:v.a.func.isRequired,loadPosts:v.a.func.isRequired,checkAndSetMobileView:v.a.func.isRequired,syncPostsInChannel:v.a.func.isRequired,loadLatestPosts:v.a.func.isRequired}).isRequired});var SD=CD;Object(T.k)()&&(SD=LL);var PD=function(e,t){return!e.entities.posts.postsInChannel[t]},jD=Object(l_.memoizeResult)(function(e){return Object(Et.g)(e)});var TD=Object(a.f)(Object(r.connect)(function(){var e=Object(ea.makeGetPostsChunkAroundPost)(),t=Object(vp.makePreparePostIdsForPostList)(),n=Object(Et.n)();return function(r,o){var a,i,s,c,l=0,u=!1,p=r.views.channel.lastChannelViewTime[o.channelId];if((i=o.match.params.postid?e(r,o.match.params.postid,o.channelId):o.unreadChunkTimeStamp?Object(ea.getUnreadPostsChunk)(r,o.channelId,o.unreadChunkTimeStamp):Object(ea.getRecentPostsChunkInChannel)(r,o.channelId))&&(a=i.order,u=i.recent),a&&(s=t(r,{postIds:a,lastViewedAt:p,indicateNewMessages:!0}),a.length)){var f=jD(a),d=Object(ea.getPost)(r,f);l=d.create_at,c=n(r,d)}return{lastViewedAt:p,isFirstLoad:PD(r,o.channelId),formattedPostIds:s,atLatestPost:u,focusedPostId:o.match.params.postid,latestPostTimeStamp:l,postListIds:a,latestAriaLabelFunc:c}}},function(e){return{actions:Object(o.bindActionCreators)({loadUnreads:Oo.i,loadPosts:Oo.g,loadLatestPosts:Oo.f,loadPostsAround:Oo.h,checkAndSetMobileView:Oo.b,syncPostsInChannel:Oo.n},e)}})(SD));function kD(e){return(kD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ND(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function RD(e){return(RD=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function MD(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ID(e,t){return(ID=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function xD(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var AD=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=RD(t).call(this,e),n=!o||"object"!==kD(o)&&"function"!=typeof o?MD(r):o,xD(MD(n),"changeUnreadChunkTimeStamp",function(e){n.setState({unreadChunkTimeStamp:e,loaderForChangeOfPostsChunk:!0},function(){window.requestAnimationFrame(function(){n.setState({loaderForChangeOfPostsChunk:!1})})})}),n.state={unreadChunkTimeStamp:e.lastViewedAt,loaderForChangeOfPostsChunk:!1,channelLoading:e.channelLoading},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ID(e,t)}(t,_.a.PureComponent),n=t,o=[{key:"getDerivedStateFromProps",value:function(e,t){return null===t.unreadChunkTimeStamp&&e.lastViewedAt?{unreadChunkTimeStamp:e.lastViewedAt}:e.channelLoading!==t.channelLoading?{unreadChunkTimeStamp:e.lastViewedAt,channelLoading:e.channelLoading}:null}}],(r=[{key:"render",value:function(){return this.props.channelLoading||this.state.loaderForChangeOfPostsChunk?_.a.createElement("div",{id:"post-list"},_.a.createElement(Vw.a,{position:"absolute",key:"loading"})):_.a.createElement(TD,{unreadChunkTimeStamp:this.state.unreadChunkTimeStamp,channelId:this.props.channelId,changeUnreadChunkTimeStamp:this.changeUnreadChunkTimeStamp,focusedPostId:this.props.focusedPostId})}}])&&ND(n.prototype,r),o&&ND(n,o),t}();xD(AD,"propTypes",{lastViewedAt:v.a.number,channelLoading:v.a.bool,channelId:v.a.string,focusedPostId:v.a.string});var LD=function(e,t,n,r,o){if(e.postid)return!1;if(t&&n){if(t.type!==P.i.DM_CHANNEL&&t.name!==e.identifier)return!0;if(t.type===P.i.DM_CHANNEL&&r&&e.identifier!=="@".concat(r.username))return!0;var a=n.id;return!!(t.team_id&&t.team_id!==a||o&&!o[a])}return!0};var DD=Object(a.f)(Object(r.connect)(function(){return function(e,t){var n,r=Object(f.getTeamByName)(e,t.match.params.team),o=Object(d.getChannel)(e,t.channelId),a=e.views.channel.lastChannelViewTime[t.channelId];o&&(o.type===P.i.DM_CHANNEL&&o.teammate_id&&(n=Object(p.getUser)(e,o.teammate_id)),a=o.last_post_at?a:o.last_post_at);var i=Object(f.getTeamMemberships)(e);return{lastViewedAt:a,channelLoading:LD(t.match.params,o,r,n,i),channel:o}}})(AD));function UD(e){return(UD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qD(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function HD(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function FD(e){return(FD=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function BD(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function GD(e,t){return(GD=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function VD(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var WD=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=FD(t).call(this,e),n=!o||"object"!==UD(o)&&"function"!=typeof o?BD(r):o,VD(BD(n),"doPermalinkEvent",function(){var e,t=(e=regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({valid:!1}),r=t.match.params.postid,e.next=4,n.props.actions.focusPost(r,n.props.returnTo);case 4:n.setState({valid:!0});case 5:case"end":return e.stop()}},e)}),function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){qD(a,r,o,i,s,"next",e)}function s(e){qD(a,r,o,i,s,"throw",e)}i(void 0)})});return function(e){return t.apply(this,arguments)}}()),VD(BD(n),"isStateValid",function(){return n.state.valid&&n.props.channelId&&n.props.teamName}),n.state={valid:!1},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&GD(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"componentDidMount",value:function(){this.doPermalinkEvent(this.props),document.body.classList.add("app__body")}},{key:"componentWillUnmount",value:function(){document.body.classList.remove("app__body")}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.props.match.params.postid!==e.match.params.postid&&this.doPermalinkEvent(e)}},{key:"render",value:function(){var e=this.props,t=e.channelId,n=e.channelName,r=e.channelIsArchived,o=e.match,a=e.teamName,i=this.context.intl.formatMessage;return this.isStateValid()?_.a.createElement("div",{id:"app-content",className:"app__content"},_.a.createElement(zx,{channelId:t}),_.a.createElement(DD,{channelId:t,focusedPostId:o.params.postid}),_.a.createElement("div",{id:"archive-link-home"},_.a.createElement(Fi.a,{to:"/"+a+"/channels/"+n},r&&_.a.createElement(Fu.b,{id:"center_panel.permalink.archivedChannel",defaultMessage:"You are viewing an **archived channel**. "}),_.a.createElement(Y.c,{id:"center_panel.recent",defaultMessage:"Click here to jump to recent messages. "}),_.a.createElement("i",{className:"fa fa-arrow-down",title:i({id:"center_panel.recent.icon",defaultMessage:"Jump to recent messages Icon"})})))):_.a.createElement("div",{id:"app-content",className:"app__content"})}}])&&HD(n.prototype,r),o&&HD(n,o),t}();VD(WD,"propTypes",{channelId:v.a.string,channelName:v.a.string,channelIsArchived:v.a.bool,match:v.a.shape({params:v.a.shape({postid:v.a.string.isRequired}).isRequired}).isRequired,returnTo:v.a.string.isRequired,teamName:v.a.string,actions:v.a.shape({focusPost:v.a.func.isRequired}).isRequired}),VD(WD,"contextTypes",{intl:Y.i.isRequired});var KD=Object(r.connect)(function(e){var t,n=Object(f.getCurrentTeam)(e),r=Object(d.getCurrentChannel)(e),o="",a="";r&&(o=r.id,a=r.name,t=0!==r.delete_at);var i="";return n&&(i=n.name),{channelId:o,channelName:a,teamName:i,channelIsArchived:t}},function(e){return{actions:Object(o.bindActionCreators)({focusPost:Vk},e)}})(WD);function zD(e){return(zD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function YD(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function QD(e,t){return!t||"object"!==zD(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ZD(e){return(ZD=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function JD(e,t){return(JD=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var XD=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),QD(this,ZD(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&JD(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){return this.props.mentionCount?_.a.createElement("span",{className:"badge badge-notify"},this.props.mentionCount):this.props.messageCount?_.a.createElement("span",{className:"badge badge-notify"},"•"):null}}])&&YD(n.prototype,r),o&&YD(n,o),t}();!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(XD,"propTypes",{mentionCount:v.a.number.isRequired,messageCount:v.a.number.isRequired});var $D=Object(r.connect)(function(e){var t=Object(d.getUnreadsInCurrentTeam)(e);return{mentionCount:t.mentionCount,messageCount:t.messageCount}})(XD),eU=function(e){var t=e.actions.toggleLhs;return _.a.createElement("button",{key:"navbar-toggle-sidebar",type:"button",className:"navbar-toggle","data-toggle":"collapse","data-target":"#sidebar-nav",onClick:t},_.a.createElement("span",{className:"sr-only"},_.a.createElement(Y.c,{id:"navbar.toggle2",defaultMessage:"Toggle sidebar"})),_.a.createElement(zj.a,{className:"style--none icon icon__menu icon--sidebarHeaderTextColor"}),_.a.createElement($D,null))};eU.propTypes={actions:v.a.shape({toggleLhs:v.a.func.isRequired}).isRequired};var tU=eU,nU=Object(r.connect)(null,function(e){return{actions:Object(o.bindActionCreators)({toggleLhs:pS.c},e)}})(tU),rU=function(e){var t=e.actions.toggleRhsMenu;return _.a.createElement("button",{key:"navbar-toggle-menu",type:"button",className:"navbar-toggle navbar-right__icon menu-toggle pull-right","data-toggle":"collapse","data-target":"#sidebar-nav",onClick:t},_.a.createElement(zj.a,null))};rU.propTypes={actions:v.a.shape({toggleRhsMenu:v.a.func.isRequired}).isRequired};var oU=rU,aU=Object(r.connect)(null,function(e){return{actions:Object(o.bindActionCreators)({toggleRhsMenu:kc.o},e)}})(oU);function iU(e){return(iU="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sU(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function cU(e,t){return!t||"object"!==iU(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function lU(e){return(lU=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function uU(e,t){return(uU=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var pU=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),cU(this,lU(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&uU(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){return _.a.createElement("span",this.props,_.a.createElement(Y.c,{id:"generic_icons.info",defaultMessage:"Info Icon"},function(e){return _.a.createElement("svg",{width:"18px",height:"18px",viewBox:"0 0 22 22",role:"icon","aria-label":e},_.a.createElement("g",{stroke:"none",strokeWidth:"1",fill:"inherit",fillRule:"evenodd"},_.a.createElement("g",{transform:"translate(-388.000000, -18.000000)",fill:"inherit"},_.a.createElement("g",null,_.a.createElement("g",{transform:"translate(381.000000, 11.000000)"},_.a.createElement("g",{transform:"translate(7.000000, 7.000000)"},_.a.createElement("path",{d:"M11,22 C4.92486775,22 0,17.0751322 0,11 C0,4.92486775 4.92486775,0 11,0 C17.0751322,0 22,4.92486775 22,11 C22,17.0751322 17.0751322,22 11,22 Z M11,20.7924685 C16.408231,20.7924685 20.7924685,16.408231 20.7924685,11 C20.7924685,5.59176898 16.408231,1.20753149 11,1.20753149 C5.59176898,1.20753149 1.20753149,5.59176898 1.20753149,11 C1.20753149,16.408231 5.59176898,20.7924685 11,20.7924685 Z M10.1572266,16.0625 L10.1572266,8.69335938 L11.3466797,8.69335938 L11.3466797,16.0625 L10.1572266,16.0625 Z M10.7519531,7.50390625 C10.3417969,7.50390625 10,7.16210938 10,6.75195312 C10,6.33496094 10.3417969,6 10.7519531,6 C11.1689453,6 11.5039062,6.33496094 11.5039062,6.75195312 C11.5039062,7.16210938 11.1689453,7.50390625 10.7519531,7.50390625 Z"})))))))}))}}])&&sU(n.prototype,r),o&&sU(n,o),t}();function fU(e){return(fU="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dU(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function mU(e){return(mU=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function hU(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bU(e,t){return(bU=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function yU(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var gU={mentionHighlight:!1},vU=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=mU(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==fU(o)&&"function"!=typeof o?hU(r):o,yU(hU(n),"showEditChannelHeaderModal",function(){n.refs.headerOverlay&&n.refs.headerOverlay.hide();var e=n.props,t=e.actions,r=e.channel,o={modalId:P.r.EDIT_CHANNEL_HEADER,dialogType:rN,dialogProps:{channel:r}};t.openModal(o)}),yU(hU(n),"hide",function(){n.refs.headerOverlay&&n.refs.headerOverlay.hide()}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bU(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.channel,n=e.isReadOnly,r=null;if(t.header)r=_.a.createElement(Co.a,{message:t.header,options:gU});else{var o;if(!n){var a=_.a.createElement("a",{href:"#",onClick:this.showEditChannelHeaderModal},_.a.createElement(Y.c,{id:"navbar.click",defaultMessage:"Click here"}));o=_.a.createElement(_.a.Fragment,null,_.a.createElement("br",null),_.a.createElement(Y.c,{id:"navbar.clickToAddHeader",defaultMessage:"{clickHere} to add one.",values:{clickHere:a}}))}r=_.a.createElement("div",null,_.a.createElement(Y.c,{id:"navbar.noHeader",defaultMessage:"No channel header yet."}),o)}var i=_.a.createElement(Vy.a,{bsStyle:"info",placement:"bottom",className:"navbar__popover",id:"header-popover"},r,_.a.createElement("div",{className:"close visible-xs-block",onClick:this.hide},"×"));return _.a.createElement(vl.a,{ref:"headerOverlay",trigger:"click",placement:"bottom",overlay:i,className:"description",rootClose:!0},_.a.createElement("button",{className:"navbar-toggle navbar-right__icon navbar-info-button pull-right"},_.a.createElement(pU,{className:"icon icon__info","aria-hidden":"true"})))}}])&&dU(n.prototype,r),o&&dU(n,o),t}();yU(vU,"propTypes",{channel:v.a.object.isRequired,isReadOnly:v.a.bool.isRequired,actions:v.a.shape({openModal:v.a.func.isRequired}).isRequired});var EU=Object(r.connect)(null,function(e){return{actions:Object(o.bindActionCreators)({openModal:U.b},e)}})(vU);function _U(e){return(_U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function OU(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function wU(e){return(wU=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function CU(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function SU(e,t){return(SU=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function PU(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var jU=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=wU(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==_U(o)&&"function"!=typeof o?CU(r):o,PU(CU(n),"handleClick",function(){n.props.actions.updateRhsState(P.A.SEARCH)}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&SU(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){return _.a.createElement("button",{type:"button",className:"navbar-toggle navbar-right__icon navbar-search pull-right",onClick:this.handleClick},_.a.createElement(rv.a,{className:"icon icon__search","aria-hidden":"true"}))}}])&&OU(n.prototype,r),o&&OU(n,o),t}();PU(jU,"propTypes",{actions:v.a.shape({updateRhsState:v.a.func.isRequired}).isRequired});var TU=Object(r.connect)(null,function(e){return{actions:Object(o.bindActionCreators)({updateRhsState:kc.q},e)}})(jU);function kU(e){return(kU="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function NU(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function RU(e){return(RU=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function MU(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function IU(e,t){return(IU=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function xU(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var AU=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=RU(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==kU(o)&&"function"!=typeof o?MU(r):o,xU(MU(n),"handleClick",function(){var e=n.props,t=e.user,r=e.channel;(0,e.actions.updateChannelNotifyProps)(t.id,r.id,{mark_unread:P.s.ALL})}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&IU(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"render",value:function(){return _.a.createElement("button",{type:"button",className:"navbar-toggle icon icon__mute",onClick:this.handleClick},_.a.createElement("span",{className:"fa fa-bell-slash-o icon"}))}}])&&NU(n.prototype,r),o&&NU(n,o),t}();xU(AU,"propTypes",{user:v.a.shape({id:v.a.string.isRequired}).isRequired,channel:v.a.shape({id:v.a.string.isRequired}).isRequired,actions:v.a.shape({updateChannelNotifyProps:v.a.func.isRequired}).isRequired});var LU=Object(r.connect)(null,function(e){return{actions:Object(o.bindActionCreators)({updateChannelNotifyProps:s.updateChannelNotifyProps},e)}})(AU);function DU(e){return(DU="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function UU(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qU(e){return(qU=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function HU(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function FU(e,t){return(FU=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function BU(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var GU=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=qU(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==DU(o)&&"function"!=typeof o?HU(r):o,BU(HU(n),"hideSidebars",function(e){T.U()&&(n.props.actions.closeRhs(),"navbar-toggle"!==e.target.className&&"icon-bar"!==e.target.className&&(n.props.actions.closeLhs(),n.props.actions.closeRhsMenu()))}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&FU(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"componentDidMount",value:function(){document.querySelector(".inner-wrap").addEventListener("click",this.hideSidebars)}},{key:"componentWillUnmount",value:function(){document.querySelector(".inner-wrap").removeEventListener("click",this.hideSidebars)}},{key:"render",value:function(){var e=this.props,t=e.user,n=e.channel,r=e.isMuted;return _.a.createElement("nav",{id:"navbar",className:"navbar navbar-default navbar-fixed-top",role:"navigation"},_.a.createElement("div",{className:"container-fluid theme"},_.a.createElement("div",{className:"navbar-header"},_.a.createElement(nU,null),n&&_.a.createElement(_.a.Fragment,null,_.a.createElement("div",{className:"navbar-brand"},_.a.createElement(vx,null),r&&_.a.createElement(LU,{user:t,channel:n})),_.a.createElement(EU,{ref:"headerOverlay",channel:n,isReadOnly:this.props.isReadOnly}),_.a.createElement(TU,null),_.a.createElement(UR,{channel:n,isDropdown:!1})),_.a.createElement(aU,null))))}}])&&UU(n.prototype,r),o&&UU(n,o),t}();BU(GU,"propTypes",{user:v.a.object.isRequired,channel:v.a.object,isReadOnly:v.a.bool,isMuted:v.a.bool,actions:v.a.shape({closeLhs:v.a.func.isRequired,closeRhs:v.a.func.isRequired,closeRhsMenu:v.a.func.isRequired}).isRequired});var VU=Object(Kc.a)(d.getMyCurrentChannelMembership,function(e){return Object(Ka.isChannelMuted)(e)}),WU=Object(r.connect)(function(e){return{user:Object(p.getCurrentUser)(e),channel:Object(d.getCurrentChannel)(e),isMuted:VU(e),isReadOnly:Object(d.isCurrentChannelReadOnly)(e)}},function(e){return{actions:Object(o.bindActionCreators)({closeLhs:pS.a,closeRhs:kc.b,closeRhsMenu:kc.a},e)}})(GU);function KU(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function zU(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){KU(a,r,o,i,s,"next",e)}function s(e){KU(a,r,o,i,s,"throw",e)}i(void 0)})}}var YU=26,QU=40,ZU=54;function JU(e){var t=e.match,n=e.history;return function(e,r){var o=r(),a=t.params,c=a.path,l=a.identifier,u=a.team;if(l){var m=Object(f.getTeamByName)(o,u);if(m)if("channels"===c)if(l.length===YU){var h=Object(d.getChannelByName)(o,l),b=Object(d.getOtherChannels)(o).find(function(e){return e.name===l});e(h||b?XU(t,n):function(e,t){return n=zU(regeneratorRuntime.mark(function n(r,o){var a,i,c,l,u,m,h,b,y,g;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(a=o(),i=e.params,c=i.team,l=i.identifier,u=l.toLowerCase(),m=Object(d.getChannel)(a,u),h=a.entities.channels.myMembers[u],b=Object(f.getTeamByName)(a,c),m&&h){n.next=16;break}return n.next=9,r(Object(s.joinChannel)(Object(p.getCurrentUserId)(a),b.id,u,null));case 9:if(y=n.sent,g=y.data,!y.error){n.next=15;break}return oq(e,t,Object(d.getRedirectChannelNameForTeam)(a,b.id)),n.abrupt("return");case 15:m=g.channel;case 16:m.type===P.i.DM_CHANNEL?r($U(e,t,T.E(m.name))):m.type===P.i.GM_CHANNEL?t.replace("/".concat(c,"/messages/").concat(m.name)):t.replace("/".concat(c,"/channels/").concat(m.name));case 17:case"end":return n.stop()}},n)})),function(e,t){return n.apply(this,arguments)};var n}(t,n))}else l.length===QU?e(tq(t,n)):l.length===ZU?e(eq(t,n)):e(XU(t,n));else"messages"===c&&(0===l.indexOf("@")?e(function(e,t){return n=zU(regeneratorRuntime.mark(function n(r,o){var a,s,c,l,u,m,h,b,y,g,v,E;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(a=o(),s=e.params,c=s.team,l=s.identifier,u=l.slice(1,l.length).toLowerCase(),m=Object(f.getTeamByName)(a,c),h=Object(p.getUserByUsername)(a,u)){n.next=15;break}return n.next=8,r(Object(i.getUserByUsername)(u));case 8:if(b=n.sent,y=b.data,!b.error){n.next=14;break}return rq(e,t,Object(d.getRedirectChannelNameForTeam)(a,m.id)),n.abrupt("return");case 14:h=y;case 15:return n.next=17,r(Object(Ya.e)(h.id));case 17:if(g=n.sent,v=g.error,E=g.data,!v){n.next=23;break}return rq(e,t,Object(d.getRedirectChannelNameForTeam)(a,m.id)),n.abrupt("return");case 23:nq(E);case 24:case"end":return n.stop()}},n)})),function(e,t){return n.apply(this,arguments)};var n}(t,n)):l.indexOf("@")>0?e(function(e,t){return n=zU(regeneratorRuntime.mark(function n(r,o){var a,s,c,l,u,m,h,b,y;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(a=o(),s=e.params,c=s.team,l=s.identifier,u=l.toLowerCase(),m=Object(f.getTeamByName)(a,c),h=Object(p.getUserByEmail)(a,u)){n.next=15;break}return n.next=8,r(Object(i.getUserByEmail)(u));case 8:if(b=n.sent,y=b.data,!b.error){n.next=14;break}return rq(e,t,Object(d.getRedirectChannelNameForTeam)(a,m.id)),n.abrupt("return");case 14:h=y;case 15:t.replace("/".concat(c,"/messages/@").concat(h.username));case 16:case"end":return n.stop()}},n)})),function(e,t){return n.apply(this,arguments)};var n}(t,n)):l.length===YU?e($U(t,n,l)):l.length===QU?e(tq(t,n)):rq(t,n,Object(d.getRedirectChannelNameForTeam)(o,m.id)))}}}function XU(e,t){return function(){var n=zU(regeneratorRuntime.mark(function n(r,o){var a,i,c,l,u,m,h,b,y,g,v,E;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(a=o(),i=e.params,c=i.team,l=i.identifier,u=l.toLowerCase(),m=Object(f.getTeamByName)(a,c)){n.next=6;break}return n.abrupt("return");case 6:if((h=Object(d.getChannelsNameMapInTeam)(a,m.id)[u])&&(b=a.entities.channels.myMembers[h.id]),h&&b){n.next=27;break}return n.next=11,r(Object(s.joinChannel)(Object(p.getCurrentUserId)(a),m.id,null,u));case 11:if(y=n.sent,g=y.data,!y.error){n.next=26;break}return n.next=17,r(Object(s.getChannelByNameAndTeamName)(c,u,!0));case 17:if(v=n.sent,E=v.data,!v.error&&0!==E.delete_at){n.next=23;break}return oq(e,t,Object(d.getRedirectChannelNameForTeam)(a,m.id)),n.abrupt("return");case 23:h=E,n.next=27;break;case 26:h=g.channel;case 27:h.type===P.i.DM_CHANNEL?r(eq(e,t)):h.type===P.i.GM_CHANNEL?t.replace("/".concat(c,"/messages/").concat(h.name)):nq(h);case 28:case"end":return n.stop()}},n)}));return function(e,t){return n.apply(this,arguments)}}()}function $U(e,t,n){return function(){var r=zU(regeneratorRuntime.mark(function r(o,a){var s,c,l,u,m,h;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(s=a(),c=e.params.team,l=Object(f.getTeamByName)(s,c),u=Object(p.getUser)(s,n)){r.next=14;break}return r.next=7,o(Object(i.getUser)(n));case 7:if(m=r.sent,h=m.data,!m.error){r.next=13;break}return rq(e,t,Object(d.getRedirectChannelNameForTeam)(s,l.id)),r.abrupt("return");case 13:u=h;case 14:t.replace("/".concat(c,"/messages/@").concat(u.username));case 15:case"end":return r.stop()}},r)}));return function(e,t){return r.apply(this,arguments)}}()}function eq(e,t){return function(){var n=zU(regeneratorRuntime.mark(function n(r,o){var a,s,c,l,u,m,h,b,y;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(a=o(),s=e.params,c=s.team,l=s.identifier,u=T.E(l.toLowerCase(),Object(p.getCurrentUserId)(o())),m=Object(f.getTeamByName)(a,c),h=Object(p.getUser)(a,u)){n.next=15;break}return n.next=8,r(Object(i.getUser)(u));case 8:if(b=n.sent,y=b.data,!b.error){n.next=14;break}return rq(e,t,Object(d.getRedirectChannelNameForTeam)(a,m.id)),n.abrupt("return");case 14:h=y;case 15:t.replace("/".concat(c,"/messages/@").concat(h.username));case 16:case"end":return n.stop()}},n)}));return function(e,t){return n.apply(this,arguments)}}()}function tq(e,t){return function(){var n=zU(regeneratorRuntime.mark(function n(r,o){var a,i,c,l,u,m,h,b,y;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(a=o(),i=e.params,c=i.identifier,l=i.team,u=c.toLowerCase(),t.replace(e.url.replace("/channels/","/messages/")),m=Object(d.getChannelByName)(a,u),h=Object(f.getTeamByName)(a,l),m){n.next=16;break}return n.next=9,r(Object(s.joinChannel)(Object(p.getCurrentUserId)(a),h.id,null,u));case 9:if(b=n.sent,y=b.data,!b.error){n.next=15;break}return rq(e,t,Object(d.getRedirectChannelNameForTeam)(a,h.id)),n.abrupt("return");case 15:m=y.channel;case 16:r(Object(s.markGroupChannelOpen)(m.id)),nq(m);case 18:case"end":return n.stop()}},n)}));return function(e,t){return n.apply(this,arguments)}}()}function nq(e){S.b(e)}function rq(e,t,n){var r=e.params.team;t.push(r?"/".concat(r,"/channels/").concat(n):"/")}function oq(e,t,n){var r=e.params.team;t.push(r?"/error?type=channel_not_found&returnTo=/".concat(r,"/channels/").concat(n):"/")}var aq=n(206),iq=n.n(aq);function sq(e){return(sq="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cq(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function lq(e,t){return!t||"object"!==sq(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function uq(e){return(uq=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function pq(e,t){return(pq=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function fq(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=function(n){function r(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(n=lq(this,uq(r).call(this,e,t))).state={shouldRender:!1},n}var o,a,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pq(e,t)}(r,_.a.Component),o=r,(a=[{key:"componentDidMount",value:function(){var e=this;window.requestAnimationFrame(function(){window.requestAnimationFrame(function(){return e.setState({shouldRender:!0})})})}},{key:"render",value:function(){return this.state.shouldRender?_.a.createElement(e,this.props):t}}])&&cq(o.prototype,a),i&&cq(o,i),r}();return iq()(n,e)}n(2077);function dq(e){return(dq="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mq(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function hq(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){Oq(e,t,n[t])})}return e}function bq(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function yq(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){bq(a,r,o,i,s,"next",e)}function s(e){bq(a,r,o,i,s,"throw",e)}i(void 0)})}}function gq(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function vq(e){return(vq=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Eq(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _q(e,t){return(_q=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Oq(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var wq=P.Q.KeyCodes;function Cq(e){return String.prototype.trimRight?e.trimRight():e.replace(/\s*$/,"")}var Sq=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=vq(t).call(this,e),n=!o||"object"!==dq(o)&&"function"!=typeof o?Eq(r):o,Oq(Eq(n),"updatePreview",function(e){n.setState({showPreview:e})}),Oq(Eq(n),"setOrientationListeners",function(){window.screen.orientation&&"onchange"in window.screen.orientation?window.screen.orientation.addEventListener("change",n.onOrientationChange):"onorientationchange"in window&&window.addEventListener("orientationchange",n.onOrientationChange)}),Oq(Eq(n),"removeOrientationListeners",function(){window.screen.orientation&&"onchange"in window.screen.orientation?window.screen.orientation.removeEventListener("change",n.onOrientationChange):"onorientationchange"in window&&window.removeEventListener("orientationchange",n.onOrientationChange)}),Oq(Eq(n),"onOrientationChange",function(){if(j.k()){var e=n.state.orientation,t="portrait";window.orientation&&(t=90===Math.abs(window.orientation)?"landscape":"portrait"),window.screen.orientation&&(t=window.screen.orientation.type.split("-")[0]),n.setState({orientation:t}),e&&t!==e&&"post_textbox"===(document.activeElement||{}).id&&n.refs.textbox.getWrappedInstance().blur()}}),Oq(Eq(n),"handlePostError",function(e){n.setState({postError:e})}),Oq(Eq(n),"toggleEmojiPicker",function(){n.setState({showEmojiPicker:!n.state.showEmojiPicker})}),Oq(Eq(n),"hideEmojiPicker",function(){n.setState({showEmojiPicker:!1})}),Oq(Eq(n),"doSubmit",function(){var e=yq(regeneratorRuntime.mark(function e(t){var r,o,a,i,s,c,l,u,p,f,d,m;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.props.currentChannel.id,t&&t.preventDefault(),!(n.props.draft.uploadsInProgress.length>0||n.state.submitting)){e.next=4;break}return e.abrupt("return");case 4:if(o=n.state.message,a=!1,(i=n.state.serverError)&&Object(Et.k)(i)&&i.submittedMessage===o&&(o=i.submittedMessage,a=!0),(s={}).file_ids=[],s.message=o,0!==s.message.trim().length||0!==n.props.draft.fileInfos.length){e.next=13;break}return e.abrupt("return");case 13:if(!n.state.postError){e.next=17;break}return n.setState({errorClass:"animation--highlight"}),setTimeout(function(){n.setState({errorClass:null})},P.Q.ANIMATION_TIMEOUT),e.abrupt("return");case 17:if(n.props.actions.addMessageIntoHistory(n.state.message),n.setState({submitting:!0,serverError:null}),c=T.a.exec(s.message),0!==s.message.indexOf("/")||a){e.next=50;break}return n.setState({message:"",postError:null,enableSendButton:!1}),(l={}).channel_id=r,l.team_id=n.props.currentTeamId,e.next=27,n.props.actions.runSlashCommandWillBePostedHooks(s.message,l);case 27:if(!(u=e.sent).error){e.next=32;break}n.setState({serverError:hq({},u.error,{submittedMessage:s.message}),message:s.message}),e.next=48;break;case 32:if(u.data.message||u.data.args){e.next=35;break}e.next=48;break;case 35:return s.message=u.data.message,l=u.data.args,e.next=39,n.props.actions.executeCommand(s.message,l);case 39:if(p=e.sent,!(f=p.error)){e.next=48;break}if(!f.sendMessage){e.next=47;break}return e.next=45,n.sendMessage(s);case 45:e.next=48;break;case 47:n.setState({serverError:hq({},f,{submittedMessage:s.message}),message:s.message});case 48:e.next=60;break;case 50:if(!c||!n.props.emojiMap.has(c[2])){e.next=55;break}n.sendReaction(c),n.setState({message:""}),e.next=60;break;case 55:return e.next=57,n.sendMessage(s);case 57:d=e.sent,d.error||n.setState({message:""});case 60:n.setState({submitting:!1,postError:null,enableSendButton:!1}),n.props.actions.setDraft(P.G.DRAFT+r,null),n.draftsForChannel[r]=null,150,m=Date.now()-n.lastBlurAt<150,n.focusTextbox(m);case 66:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),Oq(Eq(n),"handleNotifyAllConfirmation",function(e){n.hideNotifyAllModal(),n.doSubmit(e)}),Oq(Eq(n),"hideNotifyAllModal",function(){n.setState({showConfirmModal:!1})}),Oq(Eq(n),"showNotifyAllModal",function(){n.setState({showConfirmModal:!0})}),Oq(Eq(n),"getStatusFromSlashCommand",function(){var e=n.state.message.split(" ");return e.length>0?e[0].substring(1):""}),Oq(Eq(n),"isStatusSlashCommand",function(e){return"online"===e||"away"===e||"dnd"===e||"offline"===e}),Oq(Eq(n),"handleSubmit",function(){var e=yq(regeneratorRuntime.mark(function e(t){var r,o,a,i,s,c,l,u,p,f,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.props,o=r.currentChannel,a=r.userIsOutOfOffice,i=n.props.currentChannelMembersCount,!(n.props.enableConfirmNotificationsToChannel&&i>P.Q.NOTIFY_ALL_MEMBERS&&Object(Et.c)(n.state.message))){e.next=12;break}if(!n.props.isTimezoneEnabled){e.next=10;break}return e.next=7,n.props.actions.getChannelTimezones(n.props.currentChannel.id);case 7:s=e.sent,(c=s.data)?n.setState({channelTimezoneCount:c.length}):n.setState({channelTimezoneCount:0});case 10:return n.showNotifyAllModal(),e.abrupt("return");case 12:if(l=n.getStatusFromSlashCommand(),!a||!n.isStatusSlashCommand(l)){e.next=18;break}return u={ModalId:P.r.RESET_STATUS,dialogType:gc,dialogProps:{newStatus:l}},n.props.actions.openModal(u),n.setState({message:""}),e.abrupt("return");case 18:if("/header"!==Cq(n.state.message)){e.next=23;break}return p={modalId:P.r.EDIT_CHANNEL_HEADER,dialogType:rN,dialogProps:{channel:o}},n.props.actions.openModal(p),n.setState({message:""}),e.abrupt("return");case 23:if((f=o.type===P.Q.DM_CHANNEL||o.type===P.Q.GM_CHANNEL)||"/purpose"!==Cq(n.state.message)){e.next=29;break}return d={modalId:P.r.EDIT_CHANNEL_PURPOSE,dialogType:CM,dialogProps:{channel:o}},n.props.actions.openModal(d),n.setState({message:""}),e.abrupt("return");case 29:if(f||"/rename"!==Cq(n.state.message)){e.next=33;break}return S.i(o),n.setState({message:""}),e.abrupt("return");case 33:return e.next=35,n.doSubmit(t);case 35:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),Oq(Eq(n),"sendMessage",function(){var e=yq(regeneratorRuntime.mark(function e(t){var r,o,a,i,s,c,l,u,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.props,o=r.actions,a=r.currentChannel,i=r.currentUserId,s=r.draft,(c=t).channel_id=a.id,l=T.D(),u=i,c.pending_post_id="".concat(u,":").concat(l),c.user_id=u,c.create_at=l,c.parent_id=n.state.parentId,c.metadata={},c.props={},e.next=13,o.runMessageWillBePostedHooks(c);case 13:if(!(p=e.sent).error){e.next=17;break}return n.setState({serverError:p.error,submitting:!1}),e.abrupt("return",p);case 17:return c=p.data,o.onSubmitPost(c,s.fileInfos),o.scrollPostListToBottom(),n.setState({submitting:!1}),e.abrupt("return",{data:!0});case 22:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),Oq(Eq(n),"focusTextbox",function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];!n.refs.textbox||!e&&j.m()||n.refs.textbox.getWrappedInstance().focus()}),Oq(Eq(n),"postMsgKeyPress",function(e){var t=n.props,r=t.ctrlSend,o=t.codeBlockOnCtrlEnter,a=Object(Et.o)(e,n.state.message,r,o,Date.now(),n.lastChannelSwitchAt),i=a.allowSending,s=a.withClosedCodeBlock,c=a.ignoreKeyPress,l=a.message;if(c)return e.preventDefault(),void e.stopPropagation();i&&(e.persist(),n.refs.textbox&&n.refs.textbox.getWrappedInstance().blur(),s&&l?n.setState({message:l},function(){return n.handleSubmit(e)}):n.handleSubmit(e),n.updatePreview(!1)),n.emitTypingEvent()}),Oq(Eq(n),"emitTypingEvent",function(){var e=n.props.currentChannel.id;S.d(e,"")}),Oq(Eq(n),"handleChange",function(e){var t=e.target.value,r=n.props.currentChannel.id,o=n.handleEnableSendButton(t,n.props.draft.fileInfos),a=n.state.serverError;Object(Et.k)(a)&&(a=null),n.setState({message:t,enableSendButton:o,serverError:a});var i=hq({},n.props.draft,{message:t});n.props.actions.setDraft(P.G.DRAFT+r,i),n.draftsForChannel[r]=i}),Oq(Eq(n),"pasteHandler",function(e){if(e.clipboardData&&e.clipboardData.items&&"post_textbox"===e.target.id){var t=bl(e.clipboardData);if(t){e.preventDefault();var r=gl(t,n.state.message.trim());n.setState({message:r})}}}),Oq(Eq(n),"handleFileUploadChange",function(){n.focusTextbox()}),Oq(Eq(n),"handleUploadStart",function(e,t){var r=[].concat(mq(n.props.draft.uploadsInProgress),mq(e)),o=hq({},n.props.draft,{uploadsInProgress:r});n.props.actions.setDraft(P.G.DRAFT+t,o),n.draftsForChannel[t]=o,n.focusTextbox()}),Oq(Eq(n),"handleUploadProgress",function(e){var t=e.clientId,r=e.name,o=e.percent,a=e.type,i=hq({},n.state.uploadsProgressPercent,Oq({},t,{percent:o,name:r,type:a}));n.setState({uploadsProgressPercent:i})}),Oq(Eq(n),"handleFileUploadComplete",function(e,t,r){for(var o=hq({},n.draftsForChannel[r]),a=0;a<t.length;a++)o.uploadsInProgress&&function(){var e=o.uploadsInProgress.indexOf(t[a]);-1!==e&&(o.uploadsInProgress=o.uploadsInProgress.filter(function(t,n){return e!==n}))}();o.fileInfos&&(o.fileInfos=Object(hl.sortFileInfos)(o.fileInfos.concat(e),n.props.locale)),n.draftsForChannel[r]=o,n.props.actions.setDraft(P.G.DRAFT+r,o);var i=n.handleEnableSendButton(n.state.message,o.fileInfos);n.setState({enableSendButton:i})}),Oq(Eq(n),"handleUploadError",function(e,t,r){var o=hq({},n.draftsForChannel[r]),a=e;if("string"==typeof e&&(a=new Error(e)),-1!==t&&o.uploadsInProgress){var i=o.uploadsInProgress.indexOf(t);if(-1!==i){var s=o.uploadsInProgress.filter(function(e,t){return i!==t}),c=hq({},o,{uploadsInProgress:s});n.props.actions.setDraft(P.G.DRAFT+r,c),n.draftsForChannel[r]=c}}n.setState({serverError:a})}),Oq(Eq(n),"removePreview",function(e){var t={},r=hq({},n.props.draft),o=n.props.currentChannel.id;n.setState({serverError:null});var a=r.fileInfos.findIndex(function(t){return t.id===e});if(-1===a){if(-1!==(a=r.uploadsInProgress.indexOf(e))){var i=r.uploadsInProgress.filter(function(e,t){return a!==t});t=hq({},r,{uploadsInProgress:i}),n.refs.fileUpload&&n.refs.fileUpload.getWrappedInstance()&&n.refs.fileUpload.getWrappedInstance().cancelUpload(e)}}else{var s=r.fileInfos.filter(function(e,t){return a!==t});t=hq({},r,{fileInfos:s})}n.props.actions.setDraft(P.G.DRAFT+o,t),n.draftsForChannel[o]=t;var c=n.handleEnableSendButton(n.state.message,t.fileInfos);n.setState({enableSendButton:c}),n.handleFileUploadChange()}),Oq(Eq(n),"focusTextboxIfNecessary",function(e){n.props.rhsExpanded||document.getElementsByClassName("channel-switch-modal").length||Object(Et.p)(e,document.activeElement)&&n.focusTextbox()}),Oq(Eq(n),"documentKeyHandler",function(e){if((e.ctrlKey||e.metaKey)&&T.S(e,wq.FORWARD_SLASH))return e.preventDefault(),void S.n();n.focusTextboxIfNecessary(e)}),Oq(Eq(n),"getFileCount",function(){var e=n.props.draft;return e.fileInfos.length+e.uploadsInProgress.length}),Oq(Eq(n),"getFileUploadTarget",function(){return n.refs.textbox?n.refs.textbox.getWrappedInstance():null}),Oq(Eq(n),"getCreatePostControls",function(){return n.refs.createPostControls}),Oq(Eq(n),"handleKeyDown",function(e){var t=e.ctrlKey||e.metaKey,r=0===n.state.message.length,o=0===n.props.draft.message.length,a=(n.props.ctrlSend||n.props.codeBlockOnCtrlEnter)&&T.S(e,wq.ENTER)&&t,i=!t&&!e.altKey&&!e.shiftKey&&T.S(e,wq.UP),s=!t&&!e.altKey&&e.shiftKey&&T.S(e,wq.UP),c=t&&!e.altKey&&!e.shiftKey;a?n.postMsgKeyPress(e):i&&r?n.editLastPost(e):s&&r?n.replyToLastPost(e):c&&o&&T.S(e,wq.UP)?n.loadPrevMessage(e):c&&o&&T.S(e,wq.DOWN)&&n.loadNextMessage(e)}),Oq(Eq(n),"handleKeyDownEmojiPicker",function(e){T.S(e,wq.ENTER)&&n.toggleEmojiPicker()}),Oq(Eq(n),"editLastPost",function(e){e.preventDefault();var t,r=n.props.currentUsersLatestPost;r&&(t=r.root_id&&r.root_id.length>0?T.ab("create_post.comment",L.Posts.MESSAGE_TYPES.COMMENT):T.ab("create_post.post",L.Posts.MESSAGE_TYPES.POST),n.refs.textbox&&n.refs.textbox.getWrappedInstance().blur(),n.props.actions.setEditingPost(r.id,n.props.commentCountForPost,"post_textbox",t))}),Oq(Eq(n),"replyToLastPost",function(e){e.preventDefault();var t=n.props.latestReplyablePostId,r=document.getElementById("reply_textbox");r&&r.focus(),t&&n.props.actions.selectPostFromRightHandSideSearchByPostId(t)}),Oq(Eq(n),"loadPrevMessage",function(e){e.preventDefault(),n.props.actions.moveHistoryIndexBack(L.Posts.MESSAGE_TYPES.POST).then(function(){return n.fillMessageFromHistory()})}),Oq(Eq(n),"loadNextMessage",function(e){e.preventDefault(),n.props.actions.moveHistoryIndexForward(L.Posts.MESSAGE_TYPES.POST).then(function(){return n.fillMessageFromHistory()})}),Oq(Eq(n),"handleBlur",function(){n.lastBlurAt=Date.now()}),Oq(Eq(n),"showPostDeletedModal",function(){n.setState({showPostDeletedModal:!0})}),Oq(Eq(n),"hidePostDeletedModal",function(){n.setState({showPostDeletedModal:!1})}),Oq(Eq(n),"handleEmojiClose",function(){n.setState({showEmojiPicker:!1}),n.focusTextbox()}),Oq(Eq(n),"handleEmojiClick",function(e){var t=e.name||e.aliases[0];if(t){if(""===n.state.message)n.setState({message:":"+t+": "});else{var r=/\s+$/.test(n.state.message)?n.state.message+":"+t+": ":n.state.message+" :"+t+": ";n.setState({message:r})}n.setState({showEmojiPicker:!1}),n.focusTextbox()}}),Oq(Eq(n),"handleGifClick",function(e){if(""===n.state.message)n.setState({message:e});else{var t=/\s+$/.test(n.state.message)?n.state.message+e:n.state.message+" "+e;n.setState({message:t})}n.setState({showEmojiPicker:!1}),n.focusTextbox()}),Oq(Eq(n),"handleHeightChange",function(e,t){n.setState({renderScrollbar:e>t})}),n.state={message:n.props.draft.message,submitting:!1,showPostDeletedModal:!1,enableSendButton:!1,showEmojiPicker:!1,showConfirmModal:!1,channelTimezoneCount:0,showPreview:!1,uploadsProgressPercent:{},renderScrollbar:!1,orientation:null},n.lastBlurAt=0,n.lastChannelSwitchAt=0,n.draftsForChannel={},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_q(e,t)}(t,_.a.Component),n=t,(r=[{key:"UNSAFE_componentWillMount",value:function(){var e=this.handleEnableSendButton(this.state.message,this.props.draft.fileInfos);this.props.actions.clearDraftUploads(P.G.DRAFT,function(e,t){return t?hq({},t,{uploadsInProgress:[]}):t}),this.onOrientationChange(),this.setState({enableSendButton:e})}},{key:"componentDidMount",value:function(){this.focusTextbox(),document.addEventListener("paste",this.pasteHandler),document.addEventListener("keydown",this.documentKeyHandler),this.setOrientationListeners()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){if(e.currentChannel.id!==this.props.currentChannel.id){var t=e.draft;this.setState({message:t.message,submitting:!1,serverError:null,showPreview:!1})}}},{key:"componentDidUpdate",value:function(e){e.currentChannel.id!==this.props.currentChannel.id&&(this.lastChannelSwitchAt=Date.now(),this.focusTextbox())}},{key:"componentWillUnmount",value:function(){document.removeEventListener("paste",this.pasteHandler),document.removeEventListener("keydown",this.documentKeyHandler),this.removeOrientationListeners()}},{key:"sendReaction",value:function(e){var t=this.props.currentChannel.id,n=e[1],r=e[2],o=this.props.latestReplyablePostId;o&&"+"===n?this.props.actions.addReaction(o,r):o&&"-"===n&&this.props.actions.removeReaction(o,r),this.props.actions.setDraft(P.G.DRAFT+t,null),this.draftsForChannel[t]=null}},{key:"fillMessageFromHistory",value:function(){var e=this.props.messageInHistoryItem;e&&this.setState({message:e})}},{key:"createTutorialTip",value:function(){var e=[];return e.push(_.a.createElement("div",null,_.a.createElement("h4",null,_.a.createElement(Y.c,{id:"create_post.tutorialTip.title",defaultMessage:"Sending Messages"})),_.a.createElement("p",null,_.a.createElement(Fu.b,{id:"create_post.tutorialTip1",defaultMessage:"Type here to write a message and press **Enter** to post it."})),_.a.createElement("p",null,_.a.createElement(Fu.b,{id:"create_post.tutorialTip2",defaultMessage:"Click the **Attachment** button to upload an image or a file."})))),_.a.createElement(i_,{id:"postTextboxTipMessage",placement:"top",screens:e,overlayClass:"tip-overlay--chat",diagnosticsTag:"tutorial_tip_1_sending_messages"})}},{key:"handleEnableSendButton",value:function(e,t){return 0!==e.trim().length||0!==t.length}},{key:"render",value:function(){var e=this.props,t=e.currentChannel,n=e.currentChannelMembersCount,r=e.draft,o=e.fullWidthTextBox,a=e.showTutorialTip,i=e.readOnlyChannel,s=this.context.intl.formatMessage,c=n-1,l=this.state.renderScrollbar,u=T.ab("accessibility.sections.centerFooter","message input complimentary region"),p=_.a.createElement(Y.c,{id:"notify_all.title.confirm",defaultMessage:"Confirm sending notifications to entire channel"}),f=_.a.createElement(Y.c,{id:"notify_all.confirm",defaultMessage:"Confirm"}),d="";d=this.state.channelTimezoneCount&&this.props.isTimezoneEnabled?_.a.createElement(Fu.b,{id:"notify_all.question_timezone",defaultMessage:"By using @all or @channel you are about to send notifications to **{totalMembers} people** in **{timezones, number} {timezones, plural, one {timezone} other {timezones}}**. Are you sure you want to do this?",values:{totalMembers:c,timezones:this.state.channelTimezoneCount}}):_.a.createElement(Y.c,{id:"notify_all.question",defaultMessage:"By using @all or @channel you are about to send notifications to {totalMembers} people. Are you sure you want to do this?",values:{totalMembers:c}});var m=null;this.state.serverError&&(m=_.a.createElement(Qu,{id:"postServerError",error:this.state.serverError,submittedMessage:this.state.serverError.submittedMessage,handleSubmit:this.handleSubmit}));var h=null;if(this.state.postError){var b="post-error"+(this.state.errorClass?" "+this.state.errorClass:"");h=_.a.createElement("label",{className:b},this.state.postError)}var y=null;!i&&(r.fileInfos.length>0||r.uploadsInProgress.length>0)&&(y=_.a.createElement(tu,{fileInfos:r.fileInfos,onRemove:this.removePreview,uploadsInProgress:r.uploadsInProgress,uploadsProgressPercent:this.state.uploadsProgressPercent}));var g="post-create-footer";h&&(g+=" has-error");var v=null;a&&(v=this.createTutorialTip());var E="";o||(E="center");var O="send-button theme";this.state.enableSendButton||(O+=" disabled");var w,C="";this.props.canUploadFiles||(C=" post-create--attachment-disabled"),i||this.state.showPreview||(w=_.a.createElement(Cu,{ref:"fileUpload",fileCount:this.getFileCount(),getTarget:this.getFileUploadTarget,onFileUploadChange:this.handleFileUploadChange,onUploadStart:this.handleUploadStart,onFileUpload:this.handleFileUploadComplete,onUploadError:this.handleUploadError,onUploadProgress:this.handleUploadProgress,postType:"post"}));var S,P=null,j=s({id:"emoji_picker.emojiPicker",defaultMessage:"Emoji Picker"}).toLowerCase();!this.props.enableEmojiPicker||i||this.state.showPreview||(P=_.a.createElement("div",null,_.a.createElement(Eo,{show:this.state.showEmojiPicker,target:this.getCreatePostControls,onHide:this.hideEmojiPicker,onEmojiClose:this.handleEmojiClose,onEmojiClick:this.handleEmojiClick,onGifClick:this.handleGifClick,enableGifPicker:this.props.enableGifPicker,topOffset:-7}),_.a.createElement("button",{type:"button","aria-label":j,onClick:this.toggleEmojiPicker,className:"style--none emoji-picker__container post-action"},_.a.createElement(Vn,{id:"emojiPickerButton",className:"icon icon--emoji "+(this.state.showEmojiPicker?"active":"")})))),S=i?T.ab("create_post.read_only","This channel is read-only. Only members with permission can post here."):s({id:"create_post.write",defaultMessage:"Write to {channelDisplayName}"},{channelDisplayName:t.display_name});var k="";return l&&(k=" scroll"),_.a.createElement("form",{id:"create_post",ref:"topDiv",className:E,onSubmit:this.handleSubmit},_.a.createElement("div",{className:"post-create"+C+k},_.a.createElement("div",{className:"post-create-body"},_.a.createElement("div",{role:"application",id:"centerChannelFooter","aria-label":u,tabIndex:"-1",className:"post-body__cell a11y__region","data-a11y-sort-order":"2"},_.a.createElement(Hi,{onChange:this.handleChange,onKeyPress:this.postMsgKeyPress,onKeyDown:this.handleKeyDown,onComposition:this.emitTypingEvent,onHeightChange:this.handleHeightChange,handlePostError:this.handlePostError,value:i?"":this.state.message,onBlur:this.handleBlur,emojiEnabled:this.props.enableEmojiPicker,createMessage:S,channelId:t.id,id:"post_textbox",ref:"textbox",disabled:i,characterLimit:this.props.maxPostSize,preview:this.state.showPreview,badConnection:this.props.badConnection,listenForMentionKeyClick:!0}),_.a.createElement("span",{ref:"createPostControls",className:"post-body__actions"},w,P,_.a.createElement("a",{role:"button",tabIndex:"0","aria-label":s({id:"create_post.send_message",defaultMessage:"Send a message"}),className:O,onClick:this.handleSubmit},_.a.createElement("i",{className:"fa fa-paper-plane",title:s({id:"create_post.icon",defaultMessage:"Send Post Icon"})})))),v),_.a.createElement("div",{id:"postCreateFooter",className:g},_.a.createElement("div",{className:"d-flex justify-content-between"},_.a.createElement(xu,{channelId:t.id,postId:""}),_.a.createElement(Qi,{characterLimit:this.props.maxPostSize,showPreview:this.state.showPreview,updatePreview:this.updatePreview,message:i?"":this.state.message})),_.a.createElement("div",null,h,y,m))),_.a.createElement(Hu,{show:this.state.showPostDeletedModal,onHide:this.hidePostDeletedModal}),_.a.createElement(Xs.a,{title:p,message:d,confirmButtonText:f,show:this.state.showConfirmModal,onConfirm:this.handleNotifyAllConfirmation,onCancel:this.hideNotifyAllModal}))}}])&&gq(n.prototype,r),o&&gq(n,o),t}();function Pq(e,t){return function(n){n(Object(q.b)(e,t))}}Oq(Sq,"propTypes",{getChannelView:v.a.func,currentChannelMembersCount:v.a.number,currentChannel:v.a.object,currentTeamId:v.a.string,currentUserId:v.a.string,codeBlockOnCtrlEnter:v.a.bool,ctrlSend:v.a.bool,fullWidthTextBox:v.a.bool,showTutorialTip:v.a.bool.isRequired,messageInHistoryItem:v.a.string,draft:v.a.shape({message:v.a.string.isRequired,uploadsInProgress:v.a.array.isRequired,fileInfos:v.a.array.isRequired}).isRequired,commentCountForPost:v.a.number,latestReplyablePostId:v.a.string,locale:v.a.string.isRequired,currentUsersLatestPost:v.a.object,readOnlyChannel:v.a.bool,canUploadFiles:v.a.bool.isRequired,enableEmojiPicker:v.a.bool.isRequired,enableGifPicker:v.a.bool.isRequired,enableConfirmNotificationsToChannel:v.a.bool.isRequired,maxPostSize:v.a.number.isRequired,emojiMap:v.a.object.isRequired,badConnection:v.a.bool.isRequired,userIsOutOfOffice:v.a.bool.isRequired,rhsExpanded:v.a.bool.isRequired,isTimezoneEnabled:v.a.bool.isRequired,actions:v.a.shape({addMessageIntoHistory:v.a.func.isRequired,moveHistoryIndexBack:v.a.func.isRequired,moveHistoryIndexForward:v.a.func.isRequired,addReaction:v.a.func.isRequired,onSubmitPost:v.a.func.isRequired,removeReaction:v.a.func.isRequired,clearDraftUploads:v.a.func.isRequired,runMessageWillBePostedHooks:v.a.func.isRequired,runSlashCommandWillBePostedHooks:v.a.func.isRequired,setDraft:v.a.func.isRequired,setEditingPost:v.a.func.isRequired,selectPostFromRightHandSideSearchByPostId:v.a.func.isRequired,openModal:v.a.func.isRequired,executeCommand:v.a.func.isRequired,getChannelTimezones:v.a.func.isRequired,scrollPostListToBottom:v.a.func.isRequired}).isRequired}),Oq(Sq,"contextTypes",{intl:Y.i.isRequired}),Oq(Sq,"defaultProps",{latestReplyablePostId:""});var jq=Object(r.connect)(function(){var e=Object(ea.makeGetCommentCountForPost)(),t=Object(ea.makeGetMessageInHistoryItem)(L.Posts.MESSAGE_TYPES.POST);return function(n,r){var o=Object(u.getConfig)(n),a=Object(d.getCurrentChannel)(n)||{},i=Object(Nc.i)(n,P.G.DRAFT,a.id),s=Object(ea.getMostRecentPostIdInChannel)(n,a.id),c=Object(ea.getPost)(n,s),m=Object(ea.getLatestReplyablePostId)(n),h=Object(d.getCurrentChannelStats)(n)?Object(d.getCurrentChannelStats)(n).member_count:1,b="true"===o.EnableTutorial,y=Object(l.getInt)(n,P.z.TUTORIAL_STEP,Object(p.getCurrentUserId)(n),P.I.FINISHED),g="true"===o.EnableEmojiPicker,v="true"===o.EnableGifPicker,E="true"===o.EnableConfirmNotificationsToChannel,_=Object(p.getCurrentUserId)(n),O=Object(p.getStatusForUserId)(n,_)===P.O.OUT_OF_OFFICE,w=Vc(n)>1,C="true"===o.ExperimentalTimezone;return{currentTeamId:Object(f.getCurrentTeamId)(n),currentChannel:a,currentChannelMembersCount:h,currentUserId:_,codeBlockOnCtrlEnter:Object(l.getBool)(n,L.Preferences.CATEGORY_ADVANCED_SETTINGS,"code_block_ctrl_enter",!0),ctrlSend:Object(l.getBool)(n,P.z.CATEGORY_ADVANCED_SETTINGS,"send_on_ctrl_enter"),fullWidthTextBox:Object(l.get)(n,P.z.CATEGORY_DISPLAY_SETTINGS,P.z.CHANNEL_DISPLAY_MODE,P.z.CHANNEL_DISPLAY_MODE_DEFAULT)===P.z.CHANNEL_DISPLAY_MODE_FULL_SCREEN,showTutorialTip:b&&y===P.I.POST_POPOVER,messageInHistoryItem:t(n),draft:i,commentCountForPost:e(n,{post:c}),latestReplyablePostId:m,locale:Object(Wc.a)(n),currentUsersLatestPost:Object(ea.getCurrentUsersLatestPost)(n),readOnlyChannel:r.readOnlyChannel||!Object(p.isCurrentUserSystemAdmin)(n)&&"true"===o.ExperimentalTownSquareIsReadOnly&&a.name===P.i.DEFAULT_CHANNEL,canUploadFiles:Object(jl.b)(o),enableEmojiPicker:g,enableGifPicker:v,enableConfirmNotificationsToChannel:E,maxPostSize:parseInt(o.MaxPostSize,10)||P.i.DEFAULT_CHARACTER_LIMIT,userIsOutOfOffice:O,rhsExpanded:Object(Nc.a)(n),emojiMap:Object(ar.a)(n),badConnection:w,isTimezoneEnabled:C}}},function(e){return{actions:Object(o.bindActionCreators)({addMessageIntoHistory:A.addMessageIntoHistory,onSubmitPost:Pq,moveHistoryIndexBack:A.moveHistoryIndexBack,moveHistoryIndexForward:A.moveHistoryIndexForward,addReaction:q.a,removeReaction:A.removeReaction,setDraft:nl.e,clearDraftUploads:nl.a,selectPostFromRightHandSideSearchByPostId:kc.h,setEditingPost:q.j,openModal:U.b,executeCommand:Jc,getChannelTimezones:s.getChannelTimezones,runMessageWillBePostedHooks:el,runSlashCommandWillBePostedHooks:tl,scrollPostListToBottom:Oo.k},e)}})(Sq),Tq=n(2078),kq=n.n(Tq);function Nq(e){return(Nq="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Rq(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Mq(e){return(Mq=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Iq(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xq(e,t){return(xq=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Aq(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Lq=3,Dq=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=Mq(t).call(this,e),n=!o||"object"!==Nq(o)&&"function"!=typeof o?Iq(r):o,Aq(Iq(n),"handleNext",function(){switch(n.state.currentScreen){case 0:Object(vt.d)("tutorial","tutorial_screen_1_welcome_to_mattermost_next");break;case 1:Object(vt.d)("tutorial","tutorial_screen_2_how_mattermost_works_next");break;case 2:Object(vt.d)("tutorial","tutorial_screen_3_youre_all_set_next")}if(n.state.currentScreen<2)n.setState({currentScreen:n.state.currentScreen+1});else{var e=n.props.currentUserId,t=[{user_id:e,category:P.z.TUTORIAL_STEP,name:e,value:(n.props.step+1).toString()}];n.props.actions.savePreferences(e,t)}}),Aq(Iq(n),"skipTutorial",function(e){switch(e.preventDefault(),n.state.currentScreen){case 0:Object(vt.d)("tutorial","tutorial_screen_1_welcome_to_mattermost_skip");break;case 1:Object(vt.d)("tutorial","tutorial_screen_2_how_mattermost_works_skip");break;case 2:Object(vt.d)("tutorial","tutorial_screen_3_youre_all_set_skip")}var t=n.props.currentUserId,r=[{user_id:t,category:P.z.TUTORIAL_STEP,name:t,value:P.i.TutorialSteps.FINISHED.toString()}];n.props.actions.savePreferences(t,r)}),Aq(Iq(n),"createScreen",function(){switch(n.state.currentScreen){case 0:return n.createScreenOne();case 1:return n.createScreenTwo();case 2:return n.createScreenThree()}return null}),Aq(Iq(n),"handleCircleClick",function(e,t){e.preventDefault(),n.setState({currentScreen:t})}),Aq(Iq(n),"createCircles",function(){for(var e=[],t=function(t){var r="circle";t===n.state.currentScreen&&(r+=" active"),e.push(_.a.createElement("a",{id:"tutorialIntroCircle"+t,href:"#",key:"circle"+t,className:r,"data-screen":t,onClick:function(e){return n.handleCircleClick(e,t)}}))},r=0;r<Lq;r++)t(r);return _.a.createElement("div",{className:"tutorial__circles"},e)}),n.state={currentScreen:0},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xq(e,t)}(t,_.a.Component),n=t,(r=[{key:"createScreenOne",value:function(){var e=this.createCircles();return _.a.createElement("div",{id:"tutorialIntroOne"},_.a.createElement("h3",null,_.a.createElement(Y.c,{id:"tutorial_intro.screenOne.title1",defaultMessage:"Welcome to:"})),_.a.createElement("h1",null,_.a.createElement(Y.c,{id:"tutorial_intro.screenOne.title2",defaultMessage:"Mattermost"})),_.a.createElement("p",null,_.a.createElement(Y.c,{id:"tutorial_intro.screenOne.body1",defaultMessage:"Your team communication all in one place, instantly searchable and available anywhere."})),_.a.createElement("p",null,_.a.createElement(Y.c,{id:"tutorial_intro.screenOne.body2",defaultMessage:"Keep your team connected to help them achieve what matters most."})),e)}},{key:"createScreenTwo",value:function(){var e=this.createCircles(),t=null,n=null;if(this.props.appDownloadLink){var r=Object(ss.g)(this.props.appDownloadLink);t=_.a.createElement(Y.c,{id:"tutorial_intro.mobileApps",defaultMessage:"Install the apps for {link} for easy access and notifications on the go.",values:{link:_.a.createElement("a",{id:"appDownloadLink",href:r,target:"_blank",rel:"noopener noreferrer"},_.a.createElement(Y.c,{id:"tutorial_intro.mobileAppsLinkText",defaultMessage:"PC, Mac, iOS and Android"}))}}),n=_.a.createElement("a",{id:"appDownloadImage",href:r,target:"_blank",rel:"noopener noreferrer"},_.a.createElement("img",{alt:"tutorial icons",className:"tutorial__app-icons",src:kq.a}))}return _.a.createElement("div",{id:"tutorialIntroTwo"},_.a.createElement("h3",null,_.a.createElement(Y.c,{id:"tutorial_intro.screenTwo.title",defaultMessage:"How Mattermost works:"})),_.a.createElement("p",null,_.a.createElement(Y.c,{id:"tutorial_intro.screenTwo.body1",defaultMessage:"Communication happens in public discussion channels, private channels and direct messages."})),_.a.createElement("p",null,_.a.createElement(Y.c,{id:"tutorial_intro.screenTwo.body2",defaultMessage:"Everything is archived and searchable from any web-enabled desktop, laptop or phone."})),t,n,e)}},{key:"createScreenThree",value:function(){var e,t,n=this.props.teamType,r=this.context.intl.formatMessage;if(!this.props.isLicensed||!this.props.restrictTeamInvite){if(n===P.i.INVITE_TEAM){var o=r({id:"tutorial_intro.invite",defaultMessage:"Invite teammates"});e=_.a.createElement(fL.a,{accessibilityLabel:o,id:"tutorialIntroInvite",className:"intro-links color--link style--none",modalId:P.r.EMAIL_INVITE,dialogType:w_,dialogProps:{}},o)}else e=_.a.createElement("button",{id:"tutorialIntroInvite",className:"intro-links color--link style--none",onClick:S.l},_.a.createElement(Y.c,{id:"tutorial_intro.teamInvite",defaultMessage:"Invite teammates"}));t=_.a.createElement("p",null,e,_.a.createElement(Y.c,{id:"tutorial_intro.whenReady",defaultMessage:" when you're ready."}))}var a=this.createCircles(),i=null;return this.props.supportEmail&&(i=_.a.createElement("p",{id:"supportInfo"},_.a.createElement(Y.c,{id:"tutorial_intro.support",defaultMessage:"Need anything, just email us at "}),_.a.createElement("a",{href:"mailto:"+this.props.supportEmail,target:"_blank",rel:"noopener noreferrer"},this.props.supportEmail),".")),_.a.createElement("div",{id:"tutorialIntroThree"},_.a.createElement("h3",null,_.a.createElement(Y.c,{id:"tutorial_intro.allSet",defaultMessage:"You're all set"})),t,i,_.a.createElement(Y.c,{id:"tutorial_intro.end",defaultMessage:'Click "Next" to enter {channel}. This is the first channel teammates see when they sign up. Use it for posting updates everyone needs to know.',values:{channel:this.props.townSquareDisplayName}}),a)}},{key:"render",value:function(){var e=this.createScreen();return _.a.createElement("div",{className:"tutorial-steps__container"},_.a.createElement("div",{id:"tutorialIntroContent",className:"tutorial__content"},_.a.createElement("div",{className:"tutorial__steps"},e,_.a.createElement("div",{className:"tutorial__footer"},_.a.createElement("button",{id:"tutorialNextButton",className:"btn btn-primary",tabIndex:"1",onClick:this.handleNext},_.a.createElement(Y.c,{id:"tutorial_intro.next",defaultMessage:"Next"})),_.a.createElement("a",{id:"tutorialSkipLink",className:"tutorial-skip",href:"#",onClick:this.skipTutorial},_.a.createElement(Y.c,{id:"tutorial_intro.skip",defaultMessage:"Skip tutorial"}))))))}}])&&Rq(n.prototype,r),o&&Rq(n,o),t}();Aq(Dq,"propTypes",{currentUserId:v.a.string.isRequired,teamType:v.a.string,step:v.a.number,townSquareDisplayName:v.a.string.isRequired,appDownloadLink:v.a.string,isLicensed:v.a.bool.isRequired,restrictTeamInvite:v.a.bool.isRequired,supportEmail:v.a.string.isRequired,actions:v.a.shape({savePreferences:v.a.func.isRequired}).isRequired}),Aq(Dq,"contextTypes",{intl:Y.i.isRequired});var Uq=Object(r.connect)(function(e){var t=Object(p.getCurrentUserId)(e);return{currentUserId:t,teamType:(Object(f.getCurrentTeam)(e)||{}).type,step:Object(l.getInt)(e,P.z.TUTORIAL_STEP,t,0)}},function(e){return{actions:Object(o.bindActionCreators)({savePreferences:cc.savePreferences},e)}})(Dq);function qq(e){return(qq="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hq(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Fq(e,t){return!t||"object"!==qq(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Bq(e){return(Bq=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Gq(e,t){return(Gq=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Vq=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Fq(this,Bq(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gq(e,t)}(t,_.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){this.props.isRoot&&qc()("body").addClass("app__body")}},{key:"componentWillUnmount",value:function(){this.props.isRoot&&qc()("body").removeClass("app__body")}},{key:"render",value:function(){return _.a.createElement("div",{id:"app-content",className:"app__content"},_.a.createElement(Uq,{townSquareDisplayName:this.props.townSquareDisplayName,appDownloadLink:this.props.appDownloadLink,isLicensed:this.props.isLicensed,restrictTeamInvite:this.props.restrictTeamInvite,supportEmail:this.props.supportEmail}))}}])&&Hq(n.prototype,r),o&&Hq(n,o),t}();Vq.propTypes={isRoot:v.a.bool,townSquareDisplayName:v.a.string.isRequired,appDownloadLink:v.a.string,isLicensed:v.a.bool.isRequired,restrictTeamInvite:v.a.bool.isRequired,supportEmail:v.a.string.isRequired},Vq.defaultProps={isRoot:!0};var Wq=Object(r.connect)(function(e){var t=Object(u.getLicense)(e),n=Object(u.getConfig)(e),r=Object(f.getCurrentTeam)(e),o=Object(d.getChannelsNameMapInCurrentTeam)(e)[P.Q.DEFAULT_CHANNEL];return{townSquareDisplayName:o?o.display_name:P.Q.DEFAULT_CHANNEL_UI_NAME,appDownloadLink:n.AppDownloadLink,isLicensed:"true"===t.IsLicensed,restrictTeamInvite:!Object(D.haveITeamPermission)(e,{team:r.id,permission:L.Permissions.INVITE_USER}),supportEmail:n.SupportEmail}})(Vq);function Kq(e){return(Kq="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zq(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Yq(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Qq(e){return(Qq=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Zq(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Jq(e,t){return(Jq=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Xq(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var $q=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=Qq(t).call(this,e),n=!o||"object"!==Kq(o)&&"function"!=typeof o?Zq(r):o,Xq(Zq(n),"createDeferredPostView",function(){n.deferredPostView=fq(DD,_.a.createElement("div",{id:"post-list",className:"a11y__region","data-a11y-sort-order":"1","data-a11y-focus-child":!0,"data-a11y-order-reversed":!0}))}),Xq(Zq(n),"getChannelView",function(){return n.refs.channelView}),Xq(Zq(n),"onClickCloseChannel",function(){n.props.actions.goToLastViewedChannel()}),n.createDeferredPostView(),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Jq(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"componentDidMount",value:function(){var e=window.navigator.platform;qc()("body").addClass("app__body"),(j.f()||j.d())&&qc()("body").addClass("browser--ie"),"Win32"===e||"Win64"===e?qc()("body").addClass("os--windows"):"MacIntel"!==e&&"MacPPC"!==e||qc()("body").addClass("os--mac")}},{key:"componentWillUnmount",value:function(){qc()("body").removeClass("app__body")}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.props.match.url!==e.match.url&&this.createDeferredPostView()}},{key:"componentDidUpdate",value:function(e){if(e.channelId!==this.props.channelId||e.channelIsArchived!==this.props.channelIsArchived){Object(vt.b)("ChannelView#componentDidUpdate");var t=zq(Object(vt.c)("SidebarChannelLink#click","ChannelView#componentDidUpdate"),1)[0],n=zq(Object(vt.c)("TeamLink#click","ChannelView#componentDidUpdate"),1)[0];Object(vt.a)(["SidebarChannelLink#click","ChannelView#componentDidUpdate","TeamLink#click"]),-1!==t&&Object(vt.d)("performance","channel_switch",{duration:Math.round(t)}),-1!==n&&Object(vt.d)("performance","team_switch",{duration:Math.round(n)}),this.props.channelIsArchived&&!this.props.viewArchivedChannels&&this.props.actions.goToLastViewedChannel()}}},{key:"render",value:function(){var e,t=this.props.channelIsArchived;if(this.props.showTutorial)return _.a.createElement(Wq,{isRoot:!1});e=this.props.deactivatedChannel?_.a.createElement("div",{className:"post-create-message"},_.a.createElement(Y.c,{id:"create_post.deactivated",defaultMessage:"You are viewing an archived channel with a deactivated user."})):_.a.createElement("div",{className:"post-create__container",id:"post-create"},!t&&_.a.createElement(jq,{getChannelView:this.getChannelView}),t&&_.a.createElement("div",{className:"channel-archived__message"},_.a.createElement(Fu.b,{id:"archivedChannelMessage",defaultMessage:"You are viewing an **archived channel**. New messages cannot be posted."}),_.a.createElement("button",{className:"btn btn-primary channel-archived__close-btn",onClick:this.onClickCloseChannel},_.a.createElement(Y.c,{id:"center_panel.archived.closeChannel",defaultMessage:"Close Channel"}))));var n=this.deferredPostView;return _.a.createElement("div",{ref:"channelView",id:"app-content",className:"app__content"},_.a.createElement(Dc,{overlayType:"center"}),_.a.createElement(zx,{channelId:this.props.channelId}),_.a.createElement(n,{channelId:this.props.channelId}),e)}}])&&Yq(n.prototype,r),o&&Yq(n,o),t}();Xq($q,"propTypes",{channelId:v.a.string.isRequired,deactivatedChannel:v.a.bool.isRequired,match:v.a.shape({url:v.a.string.isRequired}).isRequired,showTutorial:v.a.bool.isRequired,channelIsArchived:v.a.bool.isRequired,viewArchivedChannels:v.a.bool.isRequired,actions:v.a.shape({goToLastViewedChannel:v.a.func.isRequired})});var eH=Object(Kc.a)(function(e){return e.entities.users.profiles},function(e,t){return t},function(e,t){var n=Object(T.u)(t);return Boolean(n&&n.delete_at)});var tH=Object(a.f)(Object(r.connect)(function(e){var t=Object(d.getCurrentChannel)(e),n=Object(u.getConfig)(e),r="true"===n.EnableTutorial,o=Object(l.getInt)(e,P.z.TUTORIAL_STEP,Object(p.getCurrentUserId)(e),P.I.FINISHED),a="true"===n.ExperimentalViewArchivedChannels;return{channelId:t?t.id:"",deactivatedChannel:!!t&&eH(e,t.id),showTutorial:r&&o<=P.I.INTRO_SCREENS,channelIsArchived:!!t&&0!==t.delete_at,viewArchivedChannels:a}},function(e){return{actions:Object(o.bindActionCreators)({goToLastViewedChannel:Oo.c},e)}})($q));function nH(e){return(nH="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rH(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function oH(e,t){return!t||"object"!==nH(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function aH(e){return(aH=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function iH(e,t){return(iH=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var sH=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=oH(this,aH(t).call(this,e))).props.actions.onChannelByIdentifierEnter(e),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&iH(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.props.match.params.team===e.match.params.team&&this.props.match.params.identifier===e.match.params.identifier||this.props.actions.onChannelByIdentifierEnter(e)}},{key:"render",value:function(){return _.a.createElement(tH,null)}}])&&rH(n.prototype,r),o&&rH(n,o),t}();!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(sH,"propTypes",{match:v.a.shape({params:v.a.shape({identifier:v.a.string.isRequired,team:v.a.string.isRequired}).isRequired}).isRequired,actions:v.a.shape({onChannelByIdentifierEnter:v.a.func.isRequired}).isRequired});var cH=Object(a.f)(Object(r.connect)(null,function(e){return{actions:Object(o.bindActionCreators)({onChannelByIdentifierEnter:JU},e)}})(sH));function lH(e){return(lH="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function uH(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pH(e,t){return!t||"object"!==lH(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function fH(e){return(fH=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function dH(e,t){return(dH=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var mH=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=pH(this,fH(t).call(this,e))).state={returnTo:""},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dH(e,t)}(t,_.a.PureComponent),n=t,(r=[{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.props.location.pathname!==e.location.pathname&&e.location.pathname.includes("/pl/")&&this.setState({returnTo:this.props.location.pathname})}},{key:"render",value:function(){var e=this,t=this.props.lastChannelPath,n=this.props.match.url;return _.a.createElement("div",{key:"inner-wrap",className:Mc()("inner-wrap","channel__wrap",{"move--right":this.props.lhsOpen,"move--left":this.props.rhsOpen,"move--left-small":this.props.rhsMenuOpen})},_.a.createElement("div",{className:"row header"},_.a.createElement("div",{id:"navbar"},_.a.createElement(WU,null))),_.a.createElement("div",{className:"row main"},_.a.createElement(a.d,null,_.a.createElement(a.b,{path:"".concat(n,"/pl/:postid"),render:function(t){return _.a.createElement(KD,Object.assign({},t,{returnTo:e.state.returnTo}))}}),_.a.createElement(a.b,{path:"/:team/:path(channels|messages)/:identifier",component:cH}),_.a.createElement(a.a,{to:t}))))}}])&&uH(n.prototype,r),o&&uH(n,o),t}();!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(mH,"propTypes",{match:v.a.object.isRequired,location:v.a.object.isRequired,lastChannelPath:v.a.string.isRequired,lhsOpen:v.a.bool.isRequired,rhsOpen:v.a.bool.isRequired,rhsMenuOpen:v.a.bool.isRequired});var hH=Object(r.connect)(function(e,t){var n=Object(Bk.b)(e,t.match.params.team);if(!n){var r=Object(f.getTeamByName)(e,t.match.params.team);n=Object(d.getRedirectChannelNameForTeam)(e,r.id)}return{lastChannelPath:"".concat(t.match.url,"/channels/").concat(n),lhsOpen:UC(e),rhsOpen:Object(Nc.c)(e),rhsMenuOpen:Object(Nc.b)(e)}})(mH);function bH(e){return(bH="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yH(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gH(e,t){return!t||"object"!==bH(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function vH(e){return(vH=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function EH(e,t){return(EH=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var _H=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),gH(this,vH(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&EH(e,t)}(t,_.a.Component),n=t,(r=[{key:"shouldComponentUpdate",value:function(e){return this.props.teamType!==e.teamType||this.props.pathName!==e.pathName}},{key:"render",value:function(){return _.a.createElement("div",{id:"channel_view",className:"channel-view"},_.a.createElement(M.a,null),_.a.createElement(x.a,null),_.a.createElement("div",{className:"container-fluid"},_.a.createElement(WE,null),_.a.createElement(TC,{teamType:this.props.teamType}),_.a.createElement(a.b,{component:uS}),_.a.createElement(a.b,{component:Fk}),_.a.createElement(a.b,{component:hH}),_.a.createElement(I.a,{pluggableName:"Root"}),_.a.createElement(Is,null),_.a.createElement(Js,null),_.a.createElement(Fs,null),_.a.createElement(LC,null),_.a.createElement(is,null),_.a.createElement(gc,null),_.a.createElement(sc,null),_.a.createElement(Tc,{isMac:T.T()}),_.a.createElement(DC.a,null)))}}])&&yH(n.prototype,r),o&&yH(n,o),t}();function OH(e){return(OH="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wH(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function CH(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function SH(e,t){return!t||"object"!==OH(t)&&"function"!=typeof t?jH(e):t}function PH(e){return(PH=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function jH(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function TH(e,t){return(TH=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function kH(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(_H,"propTypes",{pathName:v.a.string.isRequired,teamType:v.a.string.isRequired});var NH,RH=Object(k.b)(R.a),MH=Date.now(),IH=3e4,xH=6e4,AH=1e4,LH=function(e){function t(e){var n;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),kH(jH(n=SH(this,PH(t).call(this,e))),"handleBlur",function(){window.isActive=!1,n.blurTime=(new Date).getTime(),n.props.currentUser&&n.props.actions.viewChannel("")}),kH(jH(n),"handleFocus",function(){n.props.actions.markChannelAsRead(n.props.currentChannelId),window.isActive=!0,Date.now()-n.blurTime>AH&&(n.props.actions.fetchMyChannelsAndMembers(n.props.currentTeamId),n.props.actions.loadProfilesForDirect())}),kH(jH(n),"joinTeam",function(){var e,t=(e=regeneratorRuntime.mark(function e(t){var r,o,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.props.actions.getTeamByName(t.match.params.team);case 2:if(r=e.sent,!(o=r.data)){e.next=12;break}return e.next=7,t.actions.addUserToTeam(o.id,t.currentUser&&t.currentUser.id);case 7:a=e.sent,a.error?t.history.push("/error?type=team_not_found"):(n.setState({team:o}),n.initTeam(o)),e.next=13;break;case 12:t.history.push("/error?type=team_not_found");case 13:case"end":return e.stop()}},e)}),function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){wH(a,r,o,i,s,"next",e)}function s(e){wH(a,r,o,i,s,"throw",e)}i(void 0)})});return function(e){return t.apply(this,arguments)}}()),kH(jH(n),"initTeam",function(e){return n.props.actions.getMyTeamUnreads(),n.props.actions.selectTeam(e),n.props.actions.setPreviousTeamId(e.id),S.c(),n.props.actions.fetchMyChannelsAndMembers(e.id).then(function(){n.setState({finishedFetchingChannels:!0})}),n.props.actions.loadStatusesForChannelAndSidebar(),n.props.actions.loadProfilesForDirect(),e}),kH(jH(n),"updateCurrentTeam",function(e){var t=e.teamsList?e.teamsList.find(function(t){return t.name===e.match.params.team}):null;return t?(n.initTeam(t),t):null}),kH(jH(n),"onShortcutKeyDown",function(e){if(e.shiftKey&&T.e(e)&&T.S(e,P.Q.KeyCodes.L)){var t=document.getElementById("sidebar-right");if(t)if(t.className.match("sidebar--right sidebar--right--expanded move--left")){var n=document.getElementById("reply_textbox");n&&n.focus()}else{var r=document.getElementById("post_textbox");r&&r.focus()}}}),n.blurTime=(new Date).getTime(),n.props.mfaRequired)return n.props.history.push("/mfa/setup"),SH(n);clearInterval(NH),NH=setInterval(function(){var e=(new Date).getTime();e>MH+xH&&(console.log("computer woke up - fetching latest"),Object(C.c)(!1)),MH=e},IH);var r=n.updateCurrentTeam(n.props);return n.state={team:r,finishedFetchingChannels:!1},r||n.joinTeam(n.props),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&TH(e,t)}(t,_.a.Component),n=t,(r=[{key:"UNSAFE_componentWillReceiveProps",value:function(e){if(this.props.match.params.team!==e.match.params.team){var t=this.updateCurrentTeam(e);this.setState({team:t}),t||this.joinTeam(e)}}},{key:"componentDidMount",value:function(){Object(m.d)(),Object(C.f)(),window.isActive=!0,T.b(this.props.theme),j.j()&&w.a.enable(),window.addEventListener("focus",this.handleFocus),window.addEventListener("blur",this.handleBlur),window.addEventListener("keydown",this.onShortcutKeyDown)}},{key:"componentDidUpdate",value:function(e){var t=this.props.theme;T.c(e.theme,t)||T.b(t)}},{key:"componentWillUnmount",value:function(){window.isActive=!1,Object(m.e)(),Object(C.g)(),j.j()&&w.a.disable(),clearInterval(NH),window.removeEventListener("focus",this.handleFocus),window.removeEventListener("blur",this.handleBlur),window.removeEventListener("keydown",this.onShortcutKeyDown)}},{key:"render",value:function(){if(null===this.state.team||!1===this.state.finishedFetchingChannels)return _.a.createElement("div",null);var e=this.state.team?this.state.team.type:"";return _.a.createElement(a.d,null,_.a.createElement(a.b,{path:"/:team/integrations",component:RH}),_.a.createElement(a.b,{path:"/:team/emoji",component:RH}),_.a.createElement(a.b,{render:function(t){return _.a.createElement(_H,{pathName:t.location.pathname,teamType:e})}}))}}])&&CH(n.prototype,r),o&&CH(n,o),t}();kH(LH,"propTypes",{params:v.a.object,currentUser:v.a.object,currentChannelId:v.a.string,currentTeamId:v.a.string,actions:v.a.shape({fetchMyChannelsAndMembers:v.a.func.isRequired,getMyTeamUnreads:v.a.func.isRequired,viewChannel:v.a.func.isRequired,markChannelAsRead:v.a.func.isRequired,getTeamByName:v.a.func.isRequired,addUserToTeam:v.a.func.isRequired,selectTeam:v.a.func.isRequired,setPreviousTeamId:v.a.func.isRequired,loadStatusesForChannelAndSidebar:v.a.func.isRequired,loadProfilesForDirect:v.a.func.isRequired}).isRequired,theme:v.a.object.isRequired,mfaRequired:v.a.bool.isRequired,match:v.a.shape({params:v.a.shape({team:v.a.string.isRequired}).isRequired}).isRequired,history:v.a.object.isRequired});t.a=Object(a.f)(Object(r.connect)(function(e,t){var n=Object(u.getLicense)(e),r=Object(u.getConfig)(e),o=Object(p.getCurrentUser)(e);return{theme:Object(l.getTheme)(e),mfaRequired:Object(y.a)(o,n,r,t.match.url),currentUser:o,currentTeamId:Object(f.getCurrentTeamId)(e),teamsList:Object(f.getMyTeams)(e),currentChannelId:Object(d.getCurrentChannelId)(e)}},function(e){return{actions:Object(o.bindActionCreators)({fetchMyChannelsAndMembers:s.fetchMyChannelsAndMembers,getMyTeamUnreads:c.getMyTeamUnreads,viewChannel:s.viewChannel,markChannelAsRead:s.markChannelAsRead,getTeamByName:c.getTeamByName,addUserToTeam:b.a,setPreviousTeamId:h.a,selectTeam:c.selectTeam,loadStatusesForChannelAndSidebar:m.a,loadProfilesForDirect:i.loadProfilesForDirect},e)}})(LH))},2369:function(e,t,n){"use strict";var r=n(20),o=n(417),a=n(12),i=n(1510),s=(n(88),n(43),n(7)),c=n.n(s),l=n(30),u=n.n(l),p=n(1738),f=n(55);function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var v=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=h(t).call(this,e),n=!o||"object"!==d(o)&&"function"!=typeof o?b(r):o,g(b(n),"onHide",function(){n.setState({show:!1})}),n.state={show:!0},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(t,c.a.PureComponent),n=t,(r=[{key:"componentDidMount",value:function(){this.props.actions.goToLastViewedChannel()}},{key:"render",value:function(){var e=c.a.createElement(f.c,{id:"removed_channel.channelName",defaultMessage:"the channel"});this.props.channelName&&(e=this.props.channelName);var t=c.a.createElement(f.c,{id:"removed_channel.someone",defaultMessage:"Someone"});return this.props.remover&&(t=this.props.remover),""===this.props.currentUserId?null:c.a.createElement(p.a,{dialogClassName:"a11y__modal",show:this.state.show,onHide:this.onHide,onExited:this.props.onHide,role:"dialog","aria-labelledby":"removeFromChannelModalLabel"},c.a.createElement(p.a.Header,{closeButton:!0},c.a.createElement(p.a.Title,{componentClass:"h1",id:"removeFromChannelModalLabel"},c.a.createElement(f.c,{id:"removed_channel.from",defaultMessage:"Removed from "}),c.a.createElement("span",{className:"name"},e))),c.a.createElement(p.a.Body,{ref:"modalBody"},c.a.createElement("p",null,c.a.createElement(f.c,{id:"removed_channel.remover",defaultMessage:"{remover} removed you from {channel}",values:{remover:t,channel:e}}))),c.a.createElement(p.a.Footer,null,c.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:this.onHide},c.a.createElement(f.c,{id:"removed_channel.okay",defaultMessage:"Okay"}))))}}])&&m(n.prototype,r),o&&m(n,o),t}();g(v,"propTypes",{currentUserId:u.a.string.isRequired,onHide:u.a.func.isRequired,channelName:u.a.string,remover:u.a.string,actions:u.a.shape({goToLastViewedChannel:u.a.func.isRequired})});t.a=Object(o.connect)(function(e){return{currentUserId:Object(a.getCurrentUserId)(e)}},function(e){return{actions:Object(r.bindActionCreators)({goToLastViewedChannel:i.c},e)}})(v)},2377:function(e,t,n){"use strict";var r=n(417),o=n(20),a=n(430),i=n(306),s=(n(88),n(43),n(30)),c=n.n(s),l=n(7),u=n.n(l),p=n(55),f=n(31),d=n(954),m=n(428),h=n(23);function b(e){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function E(e,t){return(E=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var O=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=this,o=(e=g(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==b(o)&&"function"!=typeof o?v(r):o,_(v(n),"handleLocaleChange",function(e){f.Client4.setAcceptLanguage(e),n.loadTranslationsIfNecessary(e)}),_(v(n),"loadTranslationsIfNecessary",function(e){if(!n.props.translations){var t=m.c(e);t&&n.props.actions.loadTranslations(e,t.url)}}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&E(e,t)}(t,u.a.PureComponent),n=t,(r=[{key:"componentDidMount",value:function(){m.a(),Object(d.setLocalizeFunction)(h.ab),this.handleLocaleChange(this.props.locale)}},{key:"componentDidUpdate",value:function(e){e.locale!==this.props.locale&&this.handleLocaleChange(this.props.locale)}},{key:"render",value:function(){return this.props.translations?u.a.createElement(p.e,{key:this.props.locale,locale:this.props.locale,messages:this.props.translations},this.props.children):null}}])&&y(n.prototype,r),o&&y(n,o),t}();_(O,"propTypes",{children:c.a.element.isRequired,locale:c.a.string.isRequired,translations:c.a.object,actions:c.a.shape({loadTranslations:c.a.func.isRequired}).isRequired});t.a=Object(r.connect)(function(e){var t=Object(i.a)(e);return{locale:t,translations:Object(i.b)(e,t)}},function(e){return{actions:Object(o.bindActionCreators)({loadTranslations:a.c},e)}})(O)},2378:function(e,t,n){"use strict";var r=n(1653),o=n(87),a=n(6),i=n(1501),s=n(0),c=n(1733),l=n(13);window.React=n(7),window.ReactDOM=n(418),window.Redux=n(20),window.ReactRedux=n(417),window.ReactBootstrap=n(1484),window.PostUtils={formatText:o.e,messageHtmlToComponent:r.a},window.PropTypes=n(30),window.PDFJS=n(438),window.openInteractiveDialog=function(e){l.a.dispatch({type:a.IntegrationTypes.RECEIVED_DIALOG,data:e}),l.a.dispatch(Object(i.b)({modalId:s.r.INTERACTIVE_DIALOG,dialogType:c.a}))}}}]);
//# sourceMappingURL=5.ac8ae3845df569b1f1f5.js.map